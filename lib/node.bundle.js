module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/Users/raven/Projects/botpress/packages/core/botpress";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nif (!global._babelPolyfill) {\n  __webpack_require__(/*! babel-polyfill */ \"babel-polyfill\");\n}\n\nvar DatabaseHelpers = __webpack_require__(/*! ./src/database/helpers.js */ \"./src/database/helpers.js\");\n\nvar CLI = function CLI() {\n  return __webpack_require__(/*! ./src/cli */ \"./src/cli/index.js\");\n};\nvar Botpress = function Botpress() {\n  return __webpack_require__(/*! ./src/botpress.js */ \"./src/botpress.js\");\n};\n\nmodule.exports = { Botpress: Botpress, DatabaseHelpers: DatabaseHelpers, CLI: CLI };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9pbmRleC5qcz80MWY1Il0sIm5hbWVzIjpbImdsb2JhbCIsIl9iYWJlbFBvbHlmaWxsIiwicmVxdWlyZSIsIkRhdGFiYXNlSGVscGVycyIsIkNMSSIsIkJvdHByZXNzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJLENBQUNBLE9BQU9DLGNBQVosRUFBNEI7QUFDMUJDLEVBQUEsbUJBQUFBLENBQVEsc0NBQVI7QUFDRDs7QUFFRCxJQUFNQyxrQkFBa0IsbUJBQUFELENBQVEsNERBQVIsQ0FBeEI7O0FBRUEsSUFBTUUsTUFBTSxTQUFOQSxHQUFNO0FBQUEsU0FBTSxtQkFBQUYsQ0FBUSxxQ0FBUixDQUFOO0FBQUEsQ0FBWjtBQUNBLElBQU1HLFdBQVcsU0FBWEEsUUFBVztBQUFBLFNBQU0sbUJBQUFILENBQVEsNENBQVIsQ0FBTjtBQUFBLENBQWpCOztBQUVBSSxPQUFPQyxPQUFQLEdBQWlCLEVBQUVGLGtCQUFGLEVBQVlGLGdDQUFaLEVBQTZCQyxRQUE3QixFQUFqQiIsImZpbGUiOiIuL2luZGV4LmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaWYgKCFnbG9iYWwuX2JhYmVsUG9seWZpbGwpIHtcbiAgcmVxdWlyZSgnYmFiZWwtcG9seWZpbGwnKVxufVxuXG5jb25zdCBEYXRhYmFzZUhlbHBlcnMgPSByZXF1aXJlKCcuL3NyYy9kYXRhYmFzZS9oZWxwZXJzLmpzJylcblxuY29uc3QgQ0xJID0gKCkgPT4gcmVxdWlyZSgnLi9zcmMvY2xpJylcbmNvbnN0IEJvdHByZXNzID0gKCkgPT4gcmVxdWlyZSgnLi9zcmMvYm90cHJlc3MuanMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgQm90cHJlc3MsIERhdGFiYXNlSGVscGVycywgQ0xJIH1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./index.js\n");

/***/ }),

/***/ "./package.json":
/*!**********************!*\
  !*** ./package.json ***!
  \**********************/
/*! exports provided: name, description, version, author, bin, bugs, dependencies, devDependencies, engines, homepage, keywords, license, main, repository, os, scripts, watch, default */
/***/ (function(module) {

eval("module.exports = {\"name\":\"botpress\",\"description\":\"The world's first CMS for bots. Easily create, manage and extend chatbots.\",\"version\":\"10.19.0\",\"author\":\"Botpress\",\"bin\":{\"bp\":\"./bin/botpress\",\"botpress\":\"./bin/botpress\"},\"bugs\":{\"url\":\"https://github.com/botpress/botpress/issues\"},\"dependencies\":{\"@botpress/util-roles\":\"^10.19.0\",\"axios\":\"^0.15.2\",\"babel-polyfill\":\"^6.23.0\",\"bluebird\":\"^3.4.6\",\"body-parser\":\"^1.15.2\",\"chalk\":\"^2.4.1\",\"commander\":\"^2.9.0\",\"compression\":\"^1.7.1\",\"dotenv\":\"^4.0.0\",\"eventemitter2\":\"^2.1.3\",\"express\":\"^4.14.0\",\"glob\":\"^7.1.2\",\"history\":\"^4.7.2\",\"howler\":\"^2.0.3\",\"joi\":\"^13.2.0\",\"js-yaml\":\"^3.8.4\",\"json5\":\"^1.0.1\",\"jsonwebtoken\":\"^7.1.9\",\"knex\":\"^0.12.6\",\"loaders.css\":\"^0.1.2\",\"lodash\":\"^4.16.4\",\"mkdirp\":\"^0.5.1\",\"moment\":\"^2.15.1\",\"monitorctrlc\":\"^2.0.1\",\"ms\":\"^0.7.1\",\"multer\":\"^1.3.0\",\"mustache\":\"^2.3.0\",\"mware\":\"0.0.3\",\"nanoid\":\"^1.0.1\",\"node-machine-id\":\"^1.1.3\",\"nodemon\":\"^1.12.1\",\"pg\":\"^6.1.2\",\"prepend-file\":\"^1.3.1\",\"prompt\":\"^1.0.0\",\"prompt-confirm\":\"^1.2.0\",\"query-string\":\"^5.0.1\",\"randomstring\":\"^1.1.5\",\"react-jsonschema-form\":\"^1.0.3\",\"react-loaders\":\"^3.0.1\",\"react-router-dom\":\"^4.2.2\",\"react-toastify\":\"^3.3.3\",\"socket.io\":\"^1.5.0\",\"socket.io-client\":\"^2.0.3\",\"socketio-jwt\":\"^4.5.0\",\"source-map-support\":\"^0.4.6\",\"sqlite3\":\"^3.1.13\",\"universal-analytics\":\"^0.4.8\",\"username\":\"^3.0.0\",\"valid-url\":\"^1.0.9\",\"verror\":\"^1.10.0\",\"vm2\":\"^3.5.2\",\"winston\":\"^2.2.0\",\"yn\":\"^2.0.0\"},\"devDependencies\":{\"autoprefixer\":\"^6.5.3\",\"babel-cli\":\"^6.16.0\",\"babel-core\":\"^6.18.0\",\"babel-eslint\":\"^8.0.2\",\"babel-loader\":\"^7.1.2\",\"babel-plugin-root-import\":\"^5.1.0\",\"babel-plugin-transform-class-properties\":\"^6.24.1\",\"babel-preset-env\":\"^1.6.1\",\"babel-preset-react\":\"^6.24.1\",\"babel-preset-stage-3\":\"^6.24.1\",\"babel-register\":\"^6.16.3\",\"bootstrap\":\"^3.3.7\",\"chai\":\"^3.5.0\",\"classnames\":\"^2.2.5\",\"concurrently\":\"^3.5.1\",\"copy-webpack-plugin\":\"^4.5.1\",\"css-loader\":\"^0.28.11\",\"exports-loader\":\"^0.6.3\",\"expose-loader\":\"^0.7.1\",\"extract-text-webpack-plugin\":\"^3.0.2\",\"file-loader\":\"^1.1.11\",\"html-webpack-plugin\":\"^3.2.0\",\"json-loader\":\"^0.5.4\",\"keymirror\":\"^0.1.1\",\"minami\":\"^1.2.3\",\"mkdirp\":\"^0.5.1\",\"mocha\":\"^3.1.2\",\"node-sass\":\"^4.8.3\",\"postcss-loader\":\"^2.0.8\",\"prop-types\":\"^15.6.0\",\"react\":\"^16.4.0\",\"react-bootstrap\":\"^0.32.1\",\"react-bootstrap-button-loader\":\"^1.0.11\",\"react-dom\":\"^16.4.0\",\"react-emoji\":\"^0.4.4\",\"react-fontawesome\":\"^1.2.0\",\"react-ga\":\"^2.1.2\",\"react-highlight-words\":\"^0.11.0\",\"react-markdown\":\"^2.4.5\",\"react-redux\":\"^5.0.6\",\"react-router\":\"^4.2.0\",\"react-select\":\"^1.0.0-rc.10\",\"react-sidebar\":\"^2.2.1\",\"react-sortable\":\"^1.2.0\",\"react-split-pane\":\"^0.1.66\",\"react-treebeard\":\"^2.1.0\",\"reduce-reducers\":\"^0.1.2\",\"redux\":\"^3.7.2\",\"redux-actions\":\"^2.2.1\",\"redux-thunk\":\"^2.2.0\",\"sass-loader\":\"^6.0.6\",\"script-loader\":\"^0.7.0\",\"simple-line-icons\":\"^2.4.1\",\"sinon\":\"^4.2.2\",\"storm-react-diagrams\":\"^4.0.0\",\"style-loader\":\"^0.13.1\",\"thread-loader\":\"^1.1.5\",\"tmp\":\"0.0.31\",\"uglifyjs-webpack-plugin\":\"^1.2.5\",\"webpack\":\"^4.12.0\",\"webpack-node-externals\":\"^1.7.2\"},\"engines\":{\"node\":\">=6.10.0 <9.0.0\"},\"homepage\":\"https://botpress.io\",\"keywords\":[\"bots\",\"chatbots\",\"bot framework\",\"messenger\",\"facebook\",\"slack\",\"botkit\",\"microsoft bot framework\",\"bot builder\",\"bot\",\"chatbot\",\"conversational\"],\"license\":\"AGPL-3.0\",\"main\":\"lib/node.bundle.js\",\"repository\":\"git+https://github.com/botpress/botpress.git\",\"os\":[\"darwin\",\"linux\",\"win32\"],\"scripts\":{\"prepublishOnly\":\"npm run compile-prod\",\"compile\":\"./build.sh\",\"compile-prod\":\"NODE_ENV=production ./build.sh\",\"test\":\"BABEL_ENV=tests mocha --compilers js:babel-core/register --require tests/index.js tests/**\",\"watch\":\"rm -rf ./lib/web && concurrently -k \\\"node ./webpack.server.js --watch\\\" \\\"node ./webpack.web.js --watch\\\"\"},\"watch\":{\"compile\":{\"patterns\":[\"src\"],\"extensions\":\"js,jsx,scss,json,html\"}}};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiIuL3BhY2thZ2UuanNvbi5qcyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./package.json\n");

/***/ }),

/***/ "./src/about.js":
/*!**********************!*\
  !*** ./src/about.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (projectLocation) {\n  var getBotInformation = function getBotInformation() {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n    var packageJson = JSON.parse(_fs2.default.readFileSync(packageJsonPath));\n\n    return {\n      name: packageJson.name,\n      version: packageJson.version,\n      description: packageJson.description || '<no description>',\n      author: packageJson.author || '<no author>',\n      license: packageJson.license || 'AGPL-v3.0'\n    };\n  };\n\n  return { getBotInformation: getBotInformation };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWJvdXQuanM/NTg2NCJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZ2V0Qm90SW5mb3JtYXRpb24iLCJwYWNrYWdlSnNvblBhdGgiLCJwcm9qZWN0TG9jYXRpb24iLCJwYWNrYWdlSnNvbiIsIkpTT04iLCJwYXJzZSIsImZzIiwicmVhZEZpbGVTeW5jIiwibmFtZSIsInZlcnNpb24iLCJkZXNjcmlwdGlvbiIsImF1dGhvciIsImxpY2Vuc2UiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLDJCQUFtQjtBQUNsQyxNQUFNQyxvQkFBb0IsU0FBcEJBLGlCQUFvQixHQUFNO0FBQzlCLFFBQU1DLGtCQUFrQiw4QkFBbUIsY0FBbkIsRUFBbUNDLGVBQW5DLEVBQW9ELElBQXBELENBQXhCO0FBQ0EsUUFBTUMsY0FBY0MsS0FBS0MsS0FBTCxDQUFXQyxhQUFHQyxZQUFILENBQWdCTixlQUFoQixDQUFYLENBQXBCOztBQUVBLFdBQU87QUFDTE8sWUFBTUwsWUFBWUssSUFEYjtBQUVMQyxlQUFTTixZQUFZTSxPQUZoQjtBQUdMQyxtQkFBYVAsWUFBWU8sV0FBWixJQUEyQixrQkFIbkM7QUFJTEMsY0FBUVIsWUFBWVEsTUFBWixJQUFzQixhQUp6QjtBQUtMQyxlQUFTVCxZQUFZUyxPQUFaLElBQXVCO0FBTDNCLEtBQVA7QUFPRCxHQVhEOztBQWFBLFNBQU8sRUFBRVosb0NBQUYsRUFBUDtBQUNELENBZkQiLCJmaWxlIjoiLi9zcmMvYWJvdXQuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgeyByZXNvbHZlUHJvamVjdEZpbGUgfSBmcm9tICcuL3V0aWwnXG5cbm1vZHVsZS5leHBvcnRzID0gcHJvamVjdExvY2F0aW9uID0+IHtcbiAgY29uc3QgZ2V0Qm90SW5mb3JtYXRpb24gPSAoKSA9PiB7XG4gICAgY29uc3QgcGFja2FnZUpzb25QYXRoID0gcmVzb2x2ZVByb2plY3RGaWxlKCdwYWNrYWdlLmpzb24nLCBwcm9qZWN0TG9jYXRpb24sIHRydWUpXG4gICAgY29uc3QgcGFja2FnZUpzb24gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYWNrYWdlSnNvblBhdGgpKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHBhY2thZ2VKc29uLm5hbWUsXG4gICAgICB2ZXJzaW9uOiBwYWNrYWdlSnNvbi52ZXJzaW9uLFxuICAgICAgZGVzY3JpcHRpb246IHBhY2thZ2VKc29uLmRlc2NyaXB0aW9uIHx8ICc8bm8gZGVzY3JpcHRpb24+JyxcbiAgICAgIGF1dGhvcjogcGFja2FnZUpzb24uYXV0aG9yIHx8ICc8bm8gYXV0aG9yPicsXG4gICAgICBsaWNlbnNlOiBwYWNrYWdlSnNvbi5saWNlbnNlIHx8ICdBR1BMLXYzLjAnXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgZ2V0Qm90SW5mb3JtYXRpb24gfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/about.js\n");

/***/ }),

/***/ "./src/botpress.js":
/*!*************************!*\
  !*** ./src/botpress.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * The global instance of Botpress, which is the main object\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * your bot will use to interact with Botpress.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @var {Botpress} bp\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * // File: index.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * // All bots are passed an instance of `bp` upon start\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * // This is an example of an empty bot\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * module.exports = (bp) => { ... }\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\n/**\n * @namespace Botpress\n * @property {DialogEngine}  dialogEngine APIs to create and manipulate conversation flows\n * @property {KVS}  kvs Convenient, high-level storage mechanism\n * @property {ContentManager}  contentManager APIs to manage the content programmatically\n * @property {ContentRenderer}  renderers Change the look and feel of the\n * Content Elements (messages) on the different channels\n * @property {Database}  db (Advanced) Access to the internal Botpress Database\n * @property {Users}  users Store and manipulate data about users\n * @property {DialogStateManager}  dialogEngine.stateManager APIs to manipulate conversation states\n * @property {Logger}  logger Logging utility\n * @property {Botfile}  botfile The current botfile of the running bot\n */\n\n__webpack_require__(/*! source-map-support/register */ \"source-map-support/register\");\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _cluster = __webpack_require__(/*! cluster */ \"cluster\");\n\nvar _cluster2 = _interopRequireDefault(_cluster);\n\nvar _dotenv = __webpack_require__(/*! dotenv */ \"dotenv\");\n\nvar _dotenv2 = _interopRequireDefault(_dotenv);\n\nvar _ms = __webpack_require__(/*! ms */ \"ms\");\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _middlewares = __webpack_require__(/*! ./middlewares */ \"./src/middlewares.js\");\n\nvar _middlewares2 = _interopRequireDefault(_middlewares);\n\nvar _logger = __webpack_require__(/*! ./logger */ \"./src/logger.js\");\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _security = __webpack_require__(/*! ./security */ \"./src/security/index.js\");\n\nvar _security2 = _interopRequireDefault(_security);\n\nvar _notifications = __webpack_require__(/*! ./notifications */ \"./src/notifications.js\");\n\nvar _notifications2 = _interopRequireDefault(_notifications);\n\nvar _hear = __webpack_require__(/*! ./hear */ \"./src/hear.js\");\n\nvar _hear2 = _interopRequireDefault(_hear);\n\nvar _fallback = __webpack_require__(/*! ./fallback */ \"./src/fallback.js\");\n\nvar _fallback2 = _interopRequireDefault(_fallback);\n\nvar _database = __webpack_require__(/*! ./database */ \"./src/database/index.js\");\n\nvar _database2 = _interopRequireDefault(_database);\n\nvar _ghostContent = __webpack_require__(/*! ./ghost-content */ \"./src/ghost-content/index.js\");\n\nvar _ghostContent2 = _interopRequireDefault(_ghostContent);\n\nvar _mediaManager = __webpack_require__(/*! ./media-manager */ \"./src/media-manager/index.js\");\n\nvar _mediaManager2 = _interopRequireDefault(_mediaManager);\n\nvar _licensing = __webpack_require__(/*! ./licensing */ \"./src/licensing.js\");\n\nvar _licensing2 = _interopRequireDefault(_licensing);\n\nvar _about = __webpack_require__(/*! ./about */ \"./src/about.js\");\n\nvar _about2 = _interopRequireDefault(_about);\n\nvar _modules = __webpack_require__(/*! ./modules */ \"./src/modules.js\");\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nvar _cloud = __webpack_require__(/*! ./cloud */ \"./src/cloud/index.js\");\n\nvar _cloud2 = _interopRequireDefault(_cloud);\n\nvar _renderers = __webpack_require__(/*! ./renderers */ \"./src/renderers/index.js\");\n\nvar _renderers2 = _interopRequireDefault(_renderers);\n\nvar _users = __webpack_require__(/*! ./users */ \"./src/users.js\");\n\nvar _users2 = _interopRequireDefault(_users);\n\nvar _service = __webpack_require__(/*! ./content/service */ \"./src/content/service.js\");\n\nvar _service2 = _interopRequireDefault(_service);\n\nvar _getItemProviders = __webpack_require__(/*! ./content/getItemProviders */ \"./src/content/getItemProviders.js\");\n\nvar _getItemProviders2 = _interopRequireDefault(_getItemProviders);\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _stats = __webpack_require__(/*! ./stats */ \"./src/stats.js\");\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nvar _bus = __webpack_require__(/*! ./bus */ \"./src/bus.js\");\n\nvar _bus2 = _interopRequireDefault(_bus);\n\nvar _configManager = __webpack_require__(/*! ./config-manager */ \"./src/config-manager/index.js\");\n\nvar _configManager2 = _interopRequireDefault(_configManager);\n\nvar _provider = __webpack_require__(/*! ./dialog/provider */ \"./src/dialog/provider.js\");\n\nvar _provider2 = _interopRequireDefault(_provider);\n\nvar _state = __webpack_require__(/*! ./dialog/state */ \"./src/dialog/state.js\");\n\nvar _state2 = _interopRequireDefault(_state);\n\nvar _engine = __webpack_require__(/*! ./dialog/engine */ \"./src/dialog/engine.js\");\n\nvar _engine2 = _interopRequireDefault(_engine);\n\nvar _processors = __webpack_require__(/*! ./dialog/processors */ \"./src/dialog/processors.js\");\n\nvar _processors2 = _interopRequireDefault(_processors);\n\nvar _janitor = __webpack_require__(/*! ./dialog/janitor */ \"./src/dialog/janitor.js\");\n\nvar _janitor2 = _interopRequireDefault(_janitor);\n\nvar _skills = __webpack_require__(/*! ./skills */ \"./src/skills/index.js\");\n\nvar _skills2 = _interopRequireDefault(_skills);\n\nvar _memory = __webpack_require__(/*! ./queues/memory */ \"./src/queues/memory.js\");\n\nvar _memory2 = _interopRequireDefault(_memory);\n\nvar _package = __webpack_require__(/*! ../package.json */ \"./package.json\");\n\nvar _package2 = _interopRequireDefault(_package);\n\nvar _server = __webpack_require__(/*! ./server */ \"./src/server/index.js\");\n\nvar _server2 = _interopRequireDefault(_server);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RESTART_EXIT_CODE = 107;\n\nvar mkdirIfNeeded = function mkdirIfNeeded(path, logger) {\n  if (!_fs2.default.existsSync(path)) {\n    logger.info('Creating data directory: ' + path);\n\n    try {\n      _fs2.default.mkdirSync(path);\n    } catch (err) {\n      logger.error('[FATAL] Error creating directory: ' + err.message);\n      process.exit(1);\n    }\n  }\n};\n\nvar REQUIRED_PROPS = ['botUrl'];\n\nvar botpress = function () {\n  function botpress(_ref) {\n    var _this = this;\n\n    var botfile = _ref.botfile;\n\n    _classCallCheck(this, botpress);\n\n    this.start = function () {\n      if (_cluster2.default.isMaster) {\n        var firstWorkerHasStartedAlready = false;\n\n        var quit = function quit() {\n          var code = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n          if (_this.stopServer) {\n            _this.stopServer();\n          }\n\n          process.exit(code);\n        };\n\n        var receiveMessageFromWorker = function receiveMessageFromWorker(message) {\n          if (message && message.workerStatus === 'starting') {\n            if (!firstWorkerHasStartedAlready) {\n              firstWorkerHasStartedAlready = true;\n            } else {\n              (0, _util.print)('info', '*** restarted worker process ***');\n              _this.stats.track('bot', 'restarted');\n            }\n          } else if (message.type === 'exit') {\n            quit();\n          }\n        };\n\n        _cluster2.default.on('exit', function (worker, code /* , signal */) {\n          if (code === RESTART_EXIT_CODE) {\n            _cluster2.default.fork().on('message', receiveMessageFromWorker);\n          } else {\n            quit(code);\n          }\n        });\n\n        _cluster2.default.fork().on('message', receiveMessageFromWorker);\n      }\n\n      if (_cluster2.default.isWorker) {\n        process.send({ workerStatus: 'starting' });\n        _this._start().catch(function (err) {\n          (0, _util.print)('error', 'Error starting botpress: ', err.message, err.stack);\n        });\n      }\n    };\n\n    this.version = (0, _util.getBotpressVersion)();\n    /**\n     * The project location, which is the folder where botfile.js located\n     */\n    this.projectLocation = _path2.default.dirname(botfile);\n\n    /**\n     * Setup env with dotenv *before* requiring the botfile config\n     */\n    this._setupEnv();\n\n    /**\n     * The botfile config object\n     */\n    // eslint-disable-next-line no-eval\n    this.botfile = eval('require')(botfile);\n\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = REQUIRED_PROPS[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var prop = _step.value;\n\n        if (!(prop in this.botfile)) {\n          throw new Error('Missing required botpress setting: ' + prop);\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    this.stats = (0, _stats2.default)(this.botfile);\n\n    this.interval = null;\n  }\n\n  /**\n   * Start the bot instance\n   *\n   * It will do the following initiation steps:\n   *\n   * 1. setup logger\n   * 2. resolve paths (dataLocation)\n   * 3. inject security functions\n   * 4. load modules\n   * @private\n   */\n\n\n  _createClass(botpress, [{\n    key: '_start',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var projectLocation, botfile, isFirstRun, dataLocation, configLocation, dbLocation, version, logger, db, kvs, cloud, configManager, security, modules, moduleDefinitions, events, notifications, about, licensing, middlewares, _createHearMiddleware, hear, hearMiddleware, _createFallbackMiddle, fallbackMiddleware, users, ghostManager, contentManager, mediaManager, renderers, stateManager, flowProvider, dialogJanitor, dialogEngine, skillsManager, incomingQueue, outgoingQueue, messages, loadedModules, server, middlewareAutoLoading, projectEntry;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.stats.track('bot', 'started');\n\n                if (!this.interval) {\n                  this.interval = setInterval(function () {\n                    _this2.stats.track('bot', 'running');\n                  }, 30 * 1000);\n                }\n\n                this.botpressPath = _path2.default.join(__dirname, '../');\n\n                projectLocation = this.projectLocation, botfile = this.botfile;\n                isFirstRun = _fs2.default.existsSync(_path2.default.join(projectLocation, '.welcome'));\n                dataLocation = (0, _util.getDataLocation)(botfile.dataDir, projectLocation);\n                configLocation = (0, _util.getDataLocation)(botfile.modulesConfigDir, projectLocation);\n                dbLocation = _path2.default.join(dataLocation, 'db.sqlite');\n                version = _package2.default.version;\n                logger = (0, _logger2.default)(dataLocation, botfile.log);\n\n                mkdirIfNeeded(dataLocation, logger);\n                mkdirIfNeeded(configLocation, logger);\n\n                logger.info('Starting botpress version ' + version);\n\n                db = (0, _database2.default)({\n                  sqlite: { location: dbLocation },\n                  postgres: botfile.postgres,\n                  logger: logger,\n                  botpressPath: this.botpressPath\n                });\n                kvs = db._kvs;\n                _context.next = 17;\n                return (0, _cloud2.default)({ projectLocation: projectLocation, botfile: botfile, logger: logger });\n\n              case 17:\n                cloud = _context.sent;\n                _context.t0 = !!botfile.login.useCloud;\n\n                if (!_context.t0) {\n                  _context.next = 23;\n                  break;\n                }\n\n                _context.next = 22;\n                return cloud.isPaired();\n\n              case 22:\n                _context.t0 = _context.sent;\n\n              case 23:\n                if (!_context.t0) {\n                  _context.next = 26;\n                  break;\n                }\n\n                setInterval(function () {\n                  return cloud.updateRemoteEnv();\n                }, (0, _ms2.default)('10m'));\n                cloud.updateRemoteEnv(); // async on purpose\n\n              case 26:\n                configManager = new _configManager2.default({ configLocation: configLocation, botfile: botfile, logger: logger });\n                _context.next = 29;\n                return (0, _security2.default)({\n                  dataLocation: dataLocation,\n                  securityConfig: botfile.login,\n                  projectLocation: projectLocation,\n                  db: db,\n                  cloud: cloud,\n                  logger: logger\n                });\n\n              case 29:\n                security = _context.sent;\n                modules = (0, _modules2.default)(logger, projectLocation, dataLocation, configManager);\n                moduleDefinitions = modules._scan();\n                events = new _bus2.default();\n                _context.t1 = _notifications2.default;\n                _context.next = 36;\n                return db.get();\n\n              case 36:\n                _context.t2 = _context.sent;\n                _context.t3 = moduleDefinitions;\n                _context.t4 = logger;\n                _context.t5 = events;\n                _context.t6 = {\n                  knex: _context.t2,\n                  modules: _context.t3,\n                  logger: _context.t4,\n                  events: _context.t5\n                };\n                notifications = (0, _context.t1)(_context.t6);\n                about = (0, _about2.default)(projectLocation);\n                licensing = (0, _licensing2.default)({\n                  logger: logger,\n                  projectLocation: projectLocation,\n                  version: version,\n                  db: db,\n                  botfile: botfile,\n                  bp: this\n                });\n                middlewares = (0, _middlewares2.default)(this, dataLocation, projectLocation, logger);\n                _createHearMiddleware = (0, _hear2.default)(), hear = _createHearMiddleware.hear, hearMiddleware = _createHearMiddleware.middleware;\n                _createFallbackMiddle = (0, _fallback2.default)(this), fallbackMiddleware = _createFallbackMiddle.middleware;\n                users = (0, _users2.default)({ db: db });\n                ghostManager = (0, _ghostContent2.default)({\n                  projectLocation: projectLocation,\n                  logger: logger,\n                  db: db,\n                  enabled: !!_lodash2.default.get(botfile, 'ghostContent.enabled')\n                });\n                _context.next = 51;\n                return (0, _service2.default)({\n                  logger: logger,\n                  projectLocation: projectLocation,\n                  botfile: botfile,\n                  ghostManager: ghostManager\n                });\n\n              case 51:\n                contentManager = _context.sent;\n                _context.next = 54;\n                return (0, _mediaManager2.default)({\n                  botfile: botfile,\n                  logger: logger,\n                  ghostManager: ghostManager,\n                  projectLocation: projectLocation\n                });\n\n              case 54:\n                mediaManager = _context.sent;\n\n\n                // Register the built-in item providers such as \"-random()\"\n                Object.keys(_getItemProviders2.default).forEach(function (provider) {\n                  contentManager.registerGetItemProvider(provider, _getItemProviders2.default[provider]);\n                });\n\n                renderers = (0, _renderers2.default)({\n                  logger: logger,\n                  middlewares: middlewares,\n                  db: db,\n                  contentManager: contentManager,\n                  botfile: botfile\n                });\n                stateManager = (0, _state2.default)({ db: db });\n                flowProvider = new _provider2.default({ logger: logger, projectLocation: projectLocation, botfile: botfile, ghostManager: ghostManager });\n                dialogJanitor = new _janitor2.default({ db: db, middlewares: middlewares, botfile: botfile });\n                dialogEngine = new _engine2.default({ flowProvider: flowProvider, stateManager: stateManager, logger: logger });\n                skillsManager = new _skills2.default({ logger: logger });\n\n\n                dialogEngine.onError(function (_ref3) {\n                  var message = _ref3.message;\n                  return notifications.create({ message: 'DialogEngine: ' + message, level: 'error', redirectUrl: '/logs' });\n                });\n\n                // Registers the default output processor, which sends messages to the user\n                dialogEngine.registerOutputProcessor(_processors2.default['default']);\n                dialogJanitor.install();\n\n                incomingQueue = new _memory2.default('Incoming', logger, {\n                  redis: botfile.redis\n                });\n\n                incomingQueue.subscribe(function (job) {\n                  return middlewares.sendIncomingImmediately(job.event);\n                });\n\n                outgoingQueue = new _memory2.default('Outgoing', logger, {\n                  redis: botfile.redis\n                });\n\n                outgoingQueue.subscribe(function (job) {\n                  return middlewares.sendOutgoingImmediately(job.event);\n                });\n\n                messages = {\n                  in: {\n                    enqueue: function enqueue(event) {\n                      return incomingQueue.enqueue({ event: event });\n                    },\n                    cancelAll: function cancelAll(event) {\n                      return incomingQueue.cancelAll({ event: event });\n                    },\n                    peek: function peek(event) {\n                      return incomingQueue.peek({ event: event });\n                    }\n                  },\n                  out: {\n                    enqueue: function enqueue(event) {\n                      return outgoingQueue.enqueue({ event: event });\n                    },\n                    cancelAll: function cancelAll(event) {\n                      return outgoingQueue.cancelAll({ event: event });\n                    },\n                    peek: function peek(event) {\n                      return outgoingQueue.peek({ event: event });\n                    }\n                  }\n                };\n\n\n                middlewares.register(renderers.incomingMiddleware);\n                middlewares.register(hearMiddleware);\n                middlewares.register(fallbackMiddleware);\n\n                _lodash2.default.assign(this, {\n                  dataLocation: dataLocation,\n                  isFirstRun: isFirstRun,\n                  version: version,\n                  logger: logger,\n                  security: security, // login, authenticate, getSecret\n                  events: events,\n                  notifications: notifications, // load, save, send\n                  about: about,\n                  middlewares: middlewares,\n                  hear: hear,\n                  licensing: licensing,\n                  modules: modules,\n                  db: db,\n                  kvs: kvs,\n                  configManager: configManager,\n                  cloud: cloud,\n                  renderers: renderers,\n                  users: users,\n                  ghostManager: ghostManager,\n                  contentManager: contentManager,\n                  mediaManager: mediaManager,\n                  dialogEngine: dialogEngine,\n                  dialogJanitor: dialogJanitor,\n                  messages: messages,\n                  skills: skillsManager\n                });\n\n                Object.defineProperty(this, 'umm', {\n                  get: function get() {\n                    logger.warn('DEPRECATION NOTICE – bp.umm is deprecated and will be removed – Please see bp.renderers instead.');\n                    return renderers;\n                  }\n                });\n\n                _context.next = 77;\n                return modules._load(moduleDefinitions, this);\n\n              case 77:\n                loadedModules = _context.sent;\n\n\n                this.stats.track('bot', 'modules', 'loaded', loadedModules.length);\n\n                _lodash2.default.assign(this, {\n                  _loadedModules: loadedModules\n                });\n\n                skillsManager.registerSkillsFromModules(_lodash2.default.values(loadedModules));\n                _context.next = 83;\n                return contentManager.init();\n\n              case 83:\n\n                notifications._bindEvents();\n\n                server = (0, _server2.default)(this);\n\n                server.start().then(function (srv) {\n                  _this2.stopServer = srv && srv.stop;\n                  events.emit('ready');\n                  var _iteratorNormalCompletion2 = true;\n                  var _didIteratorError2 = false;\n                  var _iteratorError2 = undefined;\n\n                  try {\n                    for (var _iterator2 = _lodash2.default.values(loadedModules)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                      var mod = _step2.value;\n\n                      mod.handlers.ready && mod.handlers.ready(_this2, mod.configuration, _helpers2.default);\n                    }\n                  } catch (err) {\n                    _didIteratorError2 = true;\n                    _iteratorError2 = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                      }\n                    } finally {\n                      if (_didIteratorError2) {\n                        throw _iteratorError2;\n                      }\n                    }\n                  }\n\n                  var botUrl = botfile.botUrl;\n\n                  logger.info(_chalk2.default.green.bold('Bot launched. Visit: ' + botUrl));\n                });\n\n                middlewareAutoLoading = _lodash2.default.get(botfile, 'middleware.autoLoading');\n\n                if (!_lodash2.default.isNil(middlewareAutoLoading) && middlewareAutoLoading === false) {\n                  logger.debug('Middleware Auto Loading was disabled. Call bp.middlewares.load() manually.');\n                } else {\n                  middlewares.load();\n                }\n\n                // eslint-disable-next-line no-eval\n                projectEntry = eval('require')(projectLocation);\n\n                if (typeof projectEntry === 'function') {\n                  projectEntry.call(projectEntry, this);\n                } else {\n                  logger.error('[FATAL] The bot entry point must be a function that takes an instance of bp');\n                  process.exit(1);\n                }\n\n                process.on('uncaughtException', function (err) {\n                  logger.error('[FATAL] An unhandled exception occurred in your bot', err);\n                  if (_util.isDeveloping) {\n                    logger.error(err.stack);\n                  }\n\n                  _this2.stats.trackException(err.message);\n                  process.exit(1);\n                });\n\n                process.on('unhandledRejection', function (reason, p) {\n                  logger.error('Unhandled Rejection in Promise: ', p, 'Reason:', reason);\n\n                  _this2.stats.trackException(reason);\n                  if (_util.isDeveloping && reason && reason.stack) {\n                    logger.error(reason.stack);\n                  }\n                });\n\n              case 92:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _start() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return _start;\n    }()\n  }, {\n    key: 'restart',\n    value: function restart() {\n      var interval = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      setTimeout(function () {\n        process.exit(RESTART_EXIT_CODE);\n      }, interval);\n    }\n  }, {\n    key: '_setupEnv',\n    value: function _setupEnv() {\n      var envPath = _path2.default.resolve(this.projectLocation, '.env');\n      if (_fs2.default.existsSync(envPath)) {\n        var envConfig = _dotenv2.default.parse(_fs2.default.readFileSync(envPath));\n        for (var k in envConfig) {\n          if (_lodash2.default.isNil(process.env[k]) || process.env.ENV_OVERLOAD) {\n            process.env[k] = envConfig[k];\n          }\n        }\n      }\n    }\n  }]);\n\n  return botpress;\n}();\n\nmodule.exports = botpress;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYm90cHJlc3MuanM/Y2VlNSJdLCJuYW1lcyI6WyJSRVNUQVJUX0VYSVRfQ09ERSIsIm1rZGlySWZOZWVkZWQiLCJwYXRoIiwibG9nZ2VyIiwiZnMiLCJleGlzdHNTeW5jIiwiaW5mbyIsIm1rZGlyU3luYyIsImVyciIsImVycm9yIiwibWVzc2FnZSIsInByb2Nlc3MiLCJleGl0IiwiUkVRVUlSRURfUFJPUFMiLCJib3RwcmVzcyIsImJvdGZpbGUiLCJzdGFydCIsImNsdXN0ZXIiLCJpc01hc3RlciIsImZpcnN0V29ya2VySGFzU3RhcnRlZEFscmVhZHkiLCJxdWl0IiwiY29kZSIsInN0b3BTZXJ2ZXIiLCJyZWNlaXZlTWVzc2FnZUZyb21Xb3JrZXIiLCJ3b3JrZXJTdGF0dXMiLCJzdGF0cyIsInRyYWNrIiwidHlwZSIsIm9uIiwid29ya2VyIiwiZm9yayIsImlzV29ya2VyIiwic2VuZCIsIl9zdGFydCIsImNhdGNoIiwic3RhY2siLCJ2ZXJzaW9uIiwicHJvamVjdExvY2F0aW9uIiwiZGlybmFtZSIsIl9zZXR1cEVudiIsImV2YWwiLCJwcm9wIiwiRXJyb3IiLCJpbnRlcnZhbCIsInNldEludGVydmFsIiwiYm90cHJlc3NQYXRoIiwiam9pbiIsIl9fZGlybmFtZSIsImlzRmlyc3RSdW4iLCJkYXRhTG9jYXRpb24iLCJkYXRhRGlyIiwiY29uZmlnTG9jYXRpb24iLCJtb2R1bGVzQ29uZmlnRGlyIiwiZGJMb2NhdGlvbiIsInBhY2thZ2VKc29uIiwibG9nIiwiZGIiLCJzcWxpdGUiLCJsb2NhdGlvbiIsInBvc3RncmVzIiwia3ZzIiwiX2t2cyIsImNsb3VkIiwibG9naW4iLCJ1c2VDbG91ZCIsImlzUGFpcmVkIiwidXBkYXRlUmVtb3RlRW52IiwiY29uZmlnTWFuYWdlciIsIkNvbmZpZ3VyYXRpb25NYW5hZ2VyIiwic2VjdXJpdHlDb25maWciLCJzZWN1cml0eSIsIm1vZHVsZXMiLCJtb2R1bGVEZWZpbml0aW9ucyIsIl9zY2FuIiwiZXZlbnRzIiwiRXZlbnRCdXMiLCJjcmVhdGVOb3RpZmljYXRpb25zIiwiZ2V0Iiwia25leCIsIm5vdGlmaWNhdGlvbnMiLCJhYm91dCIsImxpY2Vuc2luZyIsImJwIiwibWlkZGxld2FyZXMiLCJoZWFyIiwiaGVhck1pZGRsZXdhcmUiLCJtaWRkbGV3YXJlIiwiZmFsbGJhY2tNaWRkbGV3YXJlIiwidXNlcnMiLCJnaG9zdE1hbmFnZXIiLCJlbmFibGVkIiwiXyIsImNvbnRlbnRNYW5hZ2VyIiwibWVkaWFNYW5hZ2VyIiwiT2JqZWN0Iiwia2V5cyIsImRlZmF1bHRHZXRJdGVtUHJvdmlkZXJzIiwiZm9yRWFjaCIsInJlZ2lzdGVyR2V0SXRlbVByb3ZpZGVyIiwicHJvdmlkZXIiLCJyZW5kZXJlcnMiLCJzdGF0ZU1hbmFnZXIiLCJmbG93UHJvdmlkZXIiLCJGbG93UHJvdmlkZXIiLCJkaWFsb2dKYW5pdG9yIiwiRGlhbG9nSmFuaXRvciIsImRpYWxvZ0VuZ2luZSIsIkRpYWxvZ0VuZ2luZSIsInNraWxsc01hbmFnZXIiLCJTa2lsbHNNYW5hZ2VyIiwib25FcnJvciIsImNyZWF0ZSIsImxldmVsIiwicmVkaXJlY3RVcmwiLCJyZWdpc3Rlck91dHB1dFByb2Nlc3NvciIsIkRpYWxvZ1Byb2Nlc3NvcnMiLCJpbnN0YWxsIiwiaW5jb21pbmdRdWV1ZSIsIlF1ZXVlIiwicmVkaXMiLCJzdWJzY3JpYmUiLCJzZW5kSW5jb21pbmdJbW1lZGlhdGVseSIsImpvYiIsImV2ZW50Iiwib3V0Z29pbmdRdWV1ZSIsInNlbmRPdXRnb2luZ0ltbWVkaWF0ZWx5IiwibWVzc2FnZXMiLCJpbiIsImVucXVldWUiLCJjYW5jZWxBbGwiLCJwZWVrIiwib3V0IiwicmVnaXN0ZXIiLCJpbmNvbWluZ01pZGRsZXdhcmUiLCJhc3NpZ24iLCJza2lsbHMiLCJkZWZpbmVQcm9wZXJ0eSIsIndhcm4iLCJfbG9hZCIsImxvYWRlZE1vZHVsZXMiLCJsZW5ndGgiLCJfbG9hZGVkTW9kdWxlcyIsInJlZ2lzdGVyU2tpbGxzRnJvbU1vZHVsZXMiLCJ2YWx1ZXMiLCJpbml0IiwiX2JpbmRFdmVudHMiLCJzZXJ2ZXIiLCJ0aGVuIiwic3J2Iiwic3RvcCIsImVtaXQiLCJtb2QiLCJoYW5kbGVycyIsInJlYWR5IiwiY29uZmlndXJhdGlvbiIsImNyZWF0ZUhlbHBlcnMiLCJib3RVcmwiLCJjaGFsayIsImdyZWVuIiwiYm9sZCIsIm1pZGRsZXdhcmVBdXRvTG9hZGluZyIsImlzTmlsIiwiZGVidWciLCJsb2FkIiwicHJvamVjdEVudHJ5IiwiY2FsbCIsImlzRGV2ZWxvcGluZyIsInRyYWNrRXhjZXB0aW9uIiwicmVhc29uIiwicCIsInNldFRpbWVvdXQiLCJlbnZQYXRoIiwicmVzb2x2ZSIsImVudkNvbmZpZyIsImRvdGVudiIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwiayIsImVudiIsIkVOVl9PVkVSTE9BRCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O3FqQkFBQTs7Ozs7Ozs7Ozs7QUFXQTs7Ozs7Ozs7Ozs7Ozs7QUFjQTs7QUFFQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFFQTs7OztBQUVBOzs7Ozs7OztBQUlBLElBQU1BLG9CQUFvQixHQUExQjs7QUFFQSxJQUFNQyxnQkFBZ0IsU0FBaEJBLGFBQWdCLENBQUNDLElBQUQsRUFBT0MsTUFBUCxFQUFrQjtBQUN0QyxNQUFJLENBQUNDLGFBQUdDLFVBQUgsQ0FBY0gsSUFBZCxDQUFMLEVBQTBCO0FBQ3hCQyxX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RGdLLENBQWpELEVBQW9ELFNBQXBELEVBQStERCxNQUEvRDs7QUFFQSx5QkFBSy9JLEtBQUwsQ0FBVzhJLGNBQVgsQ0FBMEJDLE1BQTFCO0FBQ0Esc0JBQUlGLHNCQUFnQkUsTUFBaEIsSUFBMEJBLE9BQU9ySSxLQUFyQyxFQUE0QztBQUMxQ2hDLDJCQUFPTSxLQUFQLENBQWErSixPQUFPckksS0FBcEI7QUFDRDtBQUNGLGlCQVBEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OEJBc0RvQjtBQUFBLFVBQWRRLFFBQWMsdUVBQUgsQ0FBRzs7QUFDcEIrSCxpQkFBVyxZQUFNO0FBQ2YvSixnQkFBUUMsSUFBUixDQUFhWixpQkFBYjtBQUNELE9BRkQsRUFFRzJDLFFBRkg7QUFHRDs7O2dDQUVXO0FBQ1YsVUFBTWdJLFVBQVV6SyxlQUFLMEssT0FBTCxDQUFhLEtBQUt2SSxlQUFsQixFQUFtQyxNQUFuQyxDQUFoQjtBQUNBLFVBQUlqQyxhQUFHQyxVQUFILENBQWNzSyxPQUFkLENBQUosRUFBNEI7QUFDMUIsWUFBTUUsWUFBWUMsaUJBQU9DLEtBQVAsQ0FBYTNLLGFBQUc0SyxZQUFILENBQWdCTCxPQUFoQixDQUFiLENBQWxCO0FBQ0EsYUFBSyxJQUFNTSxDQUFYLElBQWdCSixTQUFoQixFQUEyQjtBQUN6QixjQUFJbEYsaUJBQUVzRSxLQUFGLENBQVF0SixRQUFRdUssR0FBUixDQUFZRCxDQUFaLENBQVIsS0FBMkJ0SyxRQUFRdUssR0FBUixDQUFZQyxZQUEzQyxFQUF5RDtBQUN2RHhLLG9CQUFRdUssR0FBUixDQUFZRCxDQUFaLElBQWlCSixVQUFVSSxDQUFWLENBQWpCO0FBQ0Q7QUFDRjtBQUNGO0FBQ0Y7Ozs7OztBQUdIRyxPQUFPQyxPQUFQLEdBQWlCdkssUUFBakIiLCJmaWxlIjoiLi9zcmMvYm90cHJlc3MuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRoZSBnbG9iYWwgaW5zdGFuY2Ugb2YgQm90cHJlc3MsIHdoaWNoIGlzIHRoZSBtYWluIG9iamVjdFxuICogeW91ciBib3Qgd2lsbCB1c2UgdG8gaW50ZXJhY3Qgd2l0aCBCb3RwcmVzcy5cbiAqIEB2YXIge0JvdHByZXNzfSBicFxuICogQGV4YW1wbGVcbiAqIC8vIEZpbGU6IGluZGV4LmpzXG4gKiAvLyBBbGwgYm90cyBhcmUgcGFzc2VkIGFuIGluc3RhbmNlIG9mIGBicGAgdXBvbiBzdGFydFxuICogLy8gVGhpcyBpcyBhbiBleGFtcGxlIG9mIGFuIGVtcHR5IGJvdFxuICogbW9kdWxlLmV4cG9ydHMgPSAoYnApID0+IHsgLi4uIH1cbiAqL1xuXG4vKipcbiAqIEBuYW1lc3BhY2UgQm90cHJlc3NcbiAqIEBwcm9wZXJ0eSB7RGlhbG9nRW5naW5lfSAgZGlhbG9nRW5naW5lIEFQSXMgdG8gY3JlYXRlIGFuZCBtYW5pcHVsYXRlIGNvbnZlcnNhdGlvbiBmbG93c1xuICogQHByb3BlcnR5IHtLVlN9ICBrdnMgQ29udmVuaWVudCwgaGlnaC1sZXZlbCBzdG9yYWdlIG1lY2hhbmlzbVxuICogQHByb3BlcnR5IHtDb250ZW50TWFuYWdlcn0gIGNvbnRlbnRNYW5hZ2VyIEFQSXMgdG8gbWFuYWdlIHRoZSBjb250ZW50IHByb2dyYW1tYXRpY2FsbHlcbiAqIEBwcm9wZXJ0eSB7Q29udGVudFJlbmRlcmVyfSAgcmVuZGVyZXJzIENoYW5nZSB0aGUgbG9vayBhbmQgZmVlbCBvZiB0aGVcbiAqIENvbnRlbnQgRWxlbWVudHMgKG1lc3NhZ2VzKSBvbiB0aGUgZGlmZmVyZW50IGNoYW5uZWxzXG4gKiBAcHJvcGVydHkge0RhdGFiYXNlfSAgZGIgKEFkdmFuY2VkKSBBY2Nlc3MgdG8gdGhlIGludGVybmFsIEJvdHByZXNzIERhdGFiYXNlXG4gKiBAcHJvcGVydHkge1VzZXJzfSAgdXNlcnMgU3RvcmUgYW5kIG1hbmlwdWxhdGUgZGF0YSBhYm91dCB1c2Vyc1xuICogQHByb3BlcnR5IHtEaWFsb2dTdGF0ZU1hbmFnZXJ9ICBkaWFsb2dFbmdpbmUuc3RhdGVNYW5hZ2VyIEFQSXMgdG8gbWFuaXB1bGF0ZSBjb252ZXJzYXRpb24gc3RhdGVzXG4gKiBAcHJvcGVydHkge0xvZ2dlcn0gIGxvZ2dlciBMb2dnaW5nIHV0aWxpdHlcbiAqIEBwcm9wZXJ0eSB7Qm90ZmlsZX0gIGJvdGZpbGUgVGhlIGN1cnJlbnQgYm90ZmlsZSBvZiB0aGUgcnVubmluZyBib3RcbiAqL1xuXG5pbXBvcnQgJ3NvdXJjZS1tYXAtc3VwcG9ydC9yZWdpc3RlcidcblxuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBjbHVzdGVyIGZyb20gJ2NsdXN0ZXInXG5pbXBvcnQgZG90ZW52IGZyb20gJ2RvdGVudidcbmltcG9ydCBtcyBmcm9tICdtcydcblxuaW1wb3J0IGNyZWF0ZU1pZGRsZXdhcmVzIGZyb20gJy4vbWlkZGxld2FyZXMnXG5pbXBvcnQgY3JlYXRlTG9nZ2VyIGZyb20gJy4vbG9nZ2VyJ1xuaW1wb3J0IGNyZWF0ZVNlY3VyaXR5IGZyb20gJy4vc2VjdXJpdHknXG5pbXBvcnQgY3JlYXRlTm90aWZpY2F0aW9ucyBmcm9tICcuL25vdGlmaWNhdGlvbnMnXG5pbXBvcnQgY3JlYXRlSGVhck1pZGRsZXdhcmUgZnJvbSAnLi9oZWFyJ1xuaW1wb3J0IGNyZWF0ZUZhbGxiYWNrTWlkZGxld2FyZSBmcm9tICcuL2ZhbGxiYWNrJ1xuaW1wb3J0IGNyZWF0ZURhdGFiYXNlIGZyb20gJy4vZGF0YWJhc2UnXG5pbXBvcnQgY3JlYXRlR2hvc3RNYW5hZ2VyIGZyb20gJy4vZ2hvc3QtY29udGVudCdcbmltcG9ydCBjcmVhdGVNZWRpYU1hbmFnZXIgZnJvbSAnLi9tZWRpYS1tYW5hZ2VyJ1xuaW1wb3J0IGNyZWF0ZUxpY2Vuc2luZyBmcm9tICcuL2xpY2Vuc2luZydcbmltcG9ydCBjcmVhdGVBYm91dCBmcm9tICcuL2Fib3V0J1xuaW1wb3J0IGNyZWF0ZU1vZHVsZXMgZnJvbSAnLi9tb2R1bGVzJ1xuaW1wb3J0IGNyZWF0ZUNsb3VkIGZyb20gJy4vY2xvdWQnXG5pbXBvcnQgY3JlYXRlUmVuZGVyZXJzIGZyb20gJy4vcmVuZGVyZXJzJ1xuaW1wb3J0IGNyZWF0ZVVzZXJzIGZyb20gJy4vdXNlcnMnXG5pbXBvcnQgY3JlYXRlQ29udGVudE1hbmFnZXIgZnJvbSAnLi9jb250ZW50L3NlcnZpY2UnXG5pbXBvcnQgZGVmYXVsdEdldEl0ZW1Qcm92aWRlcnMgZnJvbSAnLi9jb250ZW50L2dldEl0ZW1Qcm92aWRlcnMnXG5pbXBvcnQgY3JlYXRlSGVscGVycyBmcm9tICcuL2hlbHBlcnMnXG5pbXBvcnQgc3RhdHMgZnJvbSAnLi9zdGF0cydcblxuaW1wb3J0IEV2ZW50QnVzIGZyb20gJy4vYnVzJ1xuaW1wb3J0IENvbmZpZ3VyYXRpb25NYW5hZ2VyIGZyb20gJy4vY29uZmlnLW1hbmFnZXInXG5pbXBvcnQgRmxvd1Byb3ZpZGVyIGZyb20gJy4vZGlhbG9nL3Byb3ZpZGVyJ1xuaW1wb3J0IFN0YXRlTWFuYWdlciBmcm9tICcuL2RpYWxvZy9zdGF0ZSdcbmltcG9ydCBEaWFsb2dFbmdpbmUgZnJvbSAnLi9kaWFsb2cvZW5naW5lJ1xuaW1wb3J0IERpYWxvZ1Byb2Nlc3NvcnMgZnJvbSAnLi9kaWFsb2cvcHJvY2Vzc29ycydcbmltcG9ydCBEaWFsb2dKYW5pdG9yIGZyb20gJy4vZGlhbG9nL2phbml0b3InXG5pbXBvcnQgU2tpbGxzTWFuYWdlciBmcm9tICcuL3NraWxscydcbmltcG9ydCBRdWV1ZSBmcm9tICcuL3F1ZXVlcy9tZW1vcnknXG5cbmltcG9ydCBwYWNrYWdlSnNvbiBmcm9tICcuLi9wYWNrYWdlLmpzb24nXG5cbmltcG9ydCBjcmVhdGVTZXJ2ZXIgZnJvbSAnLi9zZXJ2ZXInXG5cbmltcG9ydCB7IGdldERhdGFMb2NhdGlvbiwgZ2V0Qm90cHJlc3NWZXJzaW9uIH0gZnJvbSAnLi91dGlsJ1xuXG5pbXBvcnQgeyBpc0RldmVsb3BpbmcsIHByaW50IH0gZnJvbSAnLi91dGlsJ1xuXG5jb25zdCBSRVNUQVJUX0VYSVRfQ09ERSA9IDEwN1xuXG5jb25zdCBta2RpcklmTmVlZGVkID0gKHBhdGgsIGxvZ2dlcikgPT4ge1xuICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aCkpIHtcbiAgICBsb2dnZXIuaW5mbyhgQ3JlYXRpbmcgZGF0YSBkaXJlY3Rvcnk6ICR7cGF0aH1gKVxuXG4gICAgdHJ5IHtcbiAgICAgIGZzLm1rZGlyU3luYyhwYXRoKVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nZ2VyLmVycm9yKGBbRkFUQUxdIEVycm9yIGNyZWF0aW5nIGRpcmVjdG9yeTogJHtlcnIubWVzc2FnZX1gKVxuICAgICAgcHJvY2Vzcy5leGl0KDEpXG4gICAgfVxuICB9XG59XG5cbmNvbnN0IFJFUVVJUkVEX1BST1BTID0gWydib3RVcmwnXVxuXG5jbGFzcyBib3RwcmVzcyB7XG4gIGNvbnN0cnVjdG9yKHsgYm90ZmlsZSB9KSB7XG4gICAgdGhpcy52ZXJzaW9uID0gZ2V0Qm90cHJlc3NWZXJzaW9uKClcbiAgICAvKipcbiAgICAgKiBUaGUgcHJvamVjdCBsb2NhdGlvbiwgd2hpY2ggaXMgdGhlIGZvbGRlciB3aGVyZSBib3RmaWxlLmpzIGxvY2F0ZWRcbiAgICAgKi9cbiAgICB0aGlzLnByb2plY3RMb2NhdGlvbiA9IHBhdGguZGlybmFtZShib3RmaWxlKVxuXG4gICAgLyoqXG4gICAgICogU2V0dXAgZW52IHdpdGggZG90ZW52ICpiZWZvcmUqIHJlcXVpcmluZyB0aGUgYm90ZmlsZSBjb25maWdcbiAgICAgKi9cbiAgICB0aGlzLl9zZXR1cEVudigpXG5cbiAgICAvKipcbiAgICAgKiBUaGUgYm90ZmlsZSBjb25maWcgb2JqZWN0XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICB0aGlzLmJvdGZpbGUgPSBldmFsKCdyZXF1aXJlJykoYm90ZmlsZSlcblxuICAgIGZvciAoY29uc3QgcHJvcCBvZiBSRVFVSVJFRF9QUk9QUykge1xuICAgICAgaWYgKCEocHJvcCBpbiB0aGlzLmJvdGZpbGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBib3RwcmVzcyBzZXR0aW5nOiAke3Byb3B9YClcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnN0YXRzID0gc3RhdHModGhpcy5ib3RmaWxlKVxuXG4gICAgdGhpcy5pbnRlcnZhbCA9IG51bGxcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCB0aGUgYm90IGluc3RhbmNlXG4gICAqXG4gICAqIEl0IHdpbGwgZG8gdGhlIGZvbGxvd2luZyBpbml0aWF0aW9uIHN0ZXBzOlxuICAgKlxuICAgKiAxLiBzZXR1cCBsb2dnZXJcbiAgICogMi4gcmVzb2x2ZSBwYXRocyAoZGF0YUxvY2F0aW9uKVxuICAgKiAzLiBpbmplY3Qgc2VjdXJpdHkgZnVuY3Rpb25zXG4gICAqIDQuIGxvYWQgbW9kdWxlc1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYXN5bmMgX3N0YXJ0KCkge1xuICAgIHRoaXMuc3RhdHMudHJhY2soJ2JvdCcsICdzdGFydGVkJylcblxuICAgIGlmICghdGhpcy5pbnRlcnZhbCkge1xuICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgdGhpcy5zdGF0cy50cmFjaygnYm90JywgJ3J1bm5pbmcnKVxuICAgICAgfSwgMzAgKiAxMDAwKVxuICAgIH1cblxuICAgIHRoaXMuYm90cHJlc3NQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLycpXG5cbiAgICBjb25zdCB7IHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZSB9ID0gdGhpc1xuXG4gICAgY29uc3QgaXNGaXJzdFJ1biA9IGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKHByb2plY3RMb2NhdGlvbiwgJy53ZWxjb21lJykpXG4gICAgY29uc3QgZGF0YUxvY2F0aW9uID0gZ2V0RGF0YUxvY2F0aW9uKGJvdGZpbGUuZGF0YURpciwgcHJvamVjdExvY2F0aW9uKVxuICAgIGNvbnN0IGNvbmZpZ0xvY2F0aW9uID0gZ2V0RGF0YUxvY2F0aW9uKGJvdGZpbGUubW9kdWxlc0NvbmZpZ0RpciwgcHJvamVjdExvY2F0aW9uKVxuICAgIGNvbnN0IGRiTG9jYXRpb24gPSBwYXRoLmpvaW4oZGF0YUxvY2F0aW9uLCAnZGIuc3FsaXRlJylcbiAgICBjb25zdCB2ZXJzaW9uID0gcGFja2FnZUpzb24udmVyc2lvblxuXG4gICAgY29uc3QgbG9nZ2VyID0gY3JlYXRlTG9nZ2VyKGRhdGFMb2NhdGlvbiwgYm90ZmlsZS5sb2cpXG4gICAgbWtkaXJJZk5lZWRlZChkYXRhTG9jYXRpb24sIGxvZ2dlcilcbiAgICBta2RpcklmTmVlZGVkKGNvbmZpZ0xvY2F0aW9uLCBsb2dnZXIpXG5cbiAgICBsb2dnZXIuaW5mbyhgU3RhcnRpbmcgYm90cHJlc3MgdmVyc2lvbiAke3ZlcnNpb259YClcblxuICAgIGNvbnN0IGRiID0gY3JlYXRlRGF0YWJhc2Uoe1xuICAgICAgc3FsaXRlOiB7IGxvY2F0aW9uOiBkYkxvY2F0aW9uIH0sXG4gICAgICBwb3N0Z3JlczogYm90ZmlsZS5wb3N0Z3JlcyxcbiAgICAgIGxvZ2dlcixcbiAgICAgIGJvdHByZXNzUGF0aDogdGhpcy5ib3RwcmVzc1BhdGhcbiAgICB9KVxuXG4gICAgY29uc3Qga3ZzID0gZGIuX2t2c1xuXG4gICAgY29uc3QgY2xvdWQgPSBhd2FpdCBjcmVhdGVDbG91ZCh7IHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZSwgbG9nZ2VyIH0pXG5cbiAgICBpZiAoISFib3RmaWxlLmxvZ2luLnVzZUNsb3VkICYmIChhd2FpdCBjbG91ZC5pc1BhaXJlZCgpKSkge1xuICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4gY2xvdWQudXBkYXRlUmVtb3RlRW52KCksIG1zKCcxMG0nKSlcbiAgICAgIGNsb3VkLnVwZGF0ZVJlbW90ZUVudigpIC8vIGFzeW5jIG9uIHB1cnBvc2VcbiAgICB9XG5cbiAgICBjb25zdCBjb25maWdNYW5hZ2VyID0gbmV3IENvbmZpZ3VyYXRpb25NYW5hZ2VyKHsgY29uZmlnTG9jYXRpb24sIGJvdGZpbGUsIGxvZ2dlciB9KVxuXG4gICAgY29uc3Qgc2VjdXJpdHkgPSBhd2FpdCBjcmVhdGVTZWN1cml0eSh7XG4gICAgICBkYXRhTG9jYXRpb24sXG4gICAgICBzZWN1cml0eUNvbmZpZzogYm90ZmlsZS5sb2dpbixcbiAgICAgIHByb2plY3RMb2NhdGlvbixcbiAgICAgIGRiLFxuICAgICAgY2xvdWQsXG4gICAgICBsb2dnZXJcbiAgICB9KVxuXG4gICAgY29uc3QgbW9kdWxlcyA9IGNyZWF0ZU1vZHVsZXMobG9nZ2VyLCBwcm9qZWN0TG9jYXRpb24sIGRhdGFMb2NhdGlvbiwgY29uZmlnTWFuYWdlcilcblxuICAgIGNvbnN0IG1vZHVsZURlZmluaXRpb25zID0gbW9kdWxlcy5fc2NhbigpXG5cbiAgICBjb25zdCBldmVudHMgPSBuZXcgRXZlbnRCdXMoKVxuXG4gICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IGNyZWF0ZU5vdGlmaWNhdGlvbnMoe1xuICAgICAga25leDogYXdhaXQgZGIuZ2V0KCksXG4gICAgICBtb2R1bGVzOiBtb2R1bGVEZWZpbml0aW9ucyxcbiAgICAgIGxvZ2dlcixcbiAgICAgIGV2ZW50c1xuICAgIH0pXG4gICAgY29uc3QgYWJvdXQgPSBjcmVhdGVBYm91dChwcm9qZWN0TG9jYXRpb24pXG4gICAgY29uc3QgbGljZW5zaW5nID0gY3JlYXRlTGljZW5zaW5nKHtcbiAgICAgIGxvZ2dlcixcbiAgICAgIHByb2plY3RMb2NhdGlvbixcbiAgICAgIHZlcnNpb24sXG4gICAgICBkYixcbiAgICAgIGJvdGZpbGUsXG4gICAgICBicDogdGhpc1xuICAgIH0pXG4gICAgY29uc3QgbWlkZGxld2FyZXMgPSBjcmVhdGVNaWRkbGV3YXJlcyh0aGlzLCBkYXRhTG9jYXRpb24sIHByb2plY3RMb2NhdGlvbiwgbG9nZ2VyKVxuICAgIGNvbnN0IHsgaGVhciwgbWlkZGxld2FyZTogaGVhck1pZGRsZXdhcmUgfSA9IGNyZWF0ZUhlYXJNaWRkbGV3YXJlKClcbiAgICBjb25zdCB7IG1pZGRsZXdhcmU6IGZhbGxiYWNrTWlkZGxld2FyZSB9ID0gY3JlYXRlRmFsbGJhY2tNaWRkbGV3YXJlKHRoaXMpXG5cbiAgICBjb25zdCB1c2VycyA9IGNyZWF0ZVVzZXJzKHsgZGIgfSlcbiAgICBjb25zdCBnaG9zdE1hbmFnZXIgPSBjcmVhdGVHaG9zdE1hbmFnZXIoe1xuICAgICAgcHJvamVjdExvY2F0aW9uLFxuICAgICAgbG9nZ2VyLFxuICAgICAgZGIsXG4gICAgICBlbmFibGVkOiAhIV8uZ2V0KGJvdGZpbGUsICdnaG9zdENvbnRlbnQuZW5hYmxlZCcpXG4gICAgfSlcbiAgICBjb25zdCBjb250ZW50TWFuYWdlciA9IGF3YWl0IGNyZWF0ZUNvbnRlbnRNYW5hZ2VyKHtcbiAgICAgIGxvZ2dlcixcbiAgICAgIHByb2plY3RMb2NhdGlvbixcbiAgICAgIGJvdGZpbGUsXG4gICAgICBnaG9zdE1hbmFnZXJcbiAgICB9KVxuICAgIGNvbnN0IG1lZGlhTWFuYWdlciA9IGF3YWl0IGNyZWF0ZU1lZGlhTWFuYWdlcih7XG4gICAgICBib3RmaWxlLFxuICAgICAgbG9nZ2VyLFxuICAgICAgZ2hvc3RNYW5hZ2VyLFxuICAgICAgcHJvamVjdExvY2F0aW9uXG4gICAgfSlcblxuICAgIC8vIFJlZ2lzdGVyIHRoZSBidWlsdC1pbiBpdGVtIHByb3ZpZGVycyBzdWNoIGFzIFwiLXJhbmRvbSgpXCJcbiAgICBPYmplY3Qua2V5cyhkZWZhdWx0R2V0SXRlbVByb3ZpZGVycykuZm9yRWFjaChwcm92aWRlciA9PiB7XG4gICAgICBjb250ZW50TWFuYWdlci5yZWdpc3RlckdldEl0ZW1Qcm92aWRlcihwcm92aWRlciwgZGVmYXVsdEdldEl0ZW1Qcm92aWRlcnNbcHJvdmlkZXJdKVxuICAgIH0pXG5cbiAgICBjb25zdCByZW5kZXJlcnMgPSBjcmVhdGVSZW5kZXJlcnMoe1xuICAgICAgbG9nZ2VyLFxuICAgICAgbWlkZGxld2FyZXMsXG4gICAgICBkYixcbiAgICAgIGNvbnRlbnRNYW5hZ2VyLFxuICAgICAgYm90ZmlsZVxuICAgIH0pXG5cbiAgICBjb25zdCBzdGF0ZU1hbmFnZXIgPSBTdGF0ZU1hbmFnZXIoeyBkYiB9KVxuICAgIGNvbnN0IGZsb3dQcm92aWRlciA9IG5ldyBGbG93UHJvdmlkZXIoeyBsb2dnZXIsIHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZSwgZ2hvc3RNYW5hZ2VyIH0pXG4gICAgY29uc3QgZGlhbG9nSmFuaXRvciA9IG5ldyBEaWFsb2dKYW5pdG9yKHsgZGIsIG1pZGRsZXdhcmVzLCBib3RmaWxlIH0pXG4gICAgY29uc3QgZGlhbG9nRW5naW5lID0gbmV3IERpYWxvZ0VuZ2luZSh7IGZsb3dQcm92aWRlciwgc3RhdGVNYW5hZ2VyLCBsb2dnZXIgfSlcblxuICAgIGNvbnN0IHNraWxsc01hbmFnZXIgPSBuZXcgU2tpbGxzTWFuYWdlcih7IGxvZ2dlciB9KVxuXG4gICAgZGlhbG9nRW5naW5lLm9uRXJyb3IoKHsgbWVzc2FnZSB9KSA9PlxuICAgICAgbm90aWZpY2F0aW9ucy5jcmVhdGUoeyBtZXNzYWdlOiBgRGlhbG9nRW5naW5lOiAke21lc3NhZ2V9YCwgbGV2ZWw6ICdlcnJvcicsIHJlZGlyZWN0VXJsOiAnL2xvZ3MnIH0pXG4gICAgKVxuXG4gICAgLy8gUmVnaXN0ZXJzIHRoZSBkZWZhdWx0IG91dHB1dCBwcm9jZXNzb3IsIHdoaWNoIHNlbmRzIG1lc3NhZ2VzIHRvIHRoZSB1c2VyXG4gICAgZGlhbG9nRW5naW5lLnJlZ2lzdGVyT3V0cHV0UHJvY2Vzc29yKERpYWxvZ1Byb2Nlc3NvcnNbJ2RlZmF1bHQnXSlcbiAgICBkaWFsb2dKYW5pdG9yLmluc3RhbGwoKVxuXG4gICAgY29uc3QgaW5jb21pbmdRdWV1ZSA9IG5ldyBRdWV1ZSgnSW5jb21pbmcnLCBsb2dnZXIsIHtcbiAgICAgIHJlZGlzOiBib3RmaWxlLnJlZGlzXG4gICAgfSlcbiAgICBpbmNvbWluZ1F1ZXVlLnN1YnNjcmliZShqb2IgPT4gbWlkZGxld2FyZXMuc2VuZEluY29taW5nSW1tZWRpYXRlbHkoam9iLmV2ZW50KSlcblxuICAgIGNvbnN0IG91dGdvaW5nUXVldWUgPSBuZXcgUXVldWUoJ091dGdvaW5nJywgbG9nZ2VyLCB7XG4gICAgICByZWRpczogYm90ZmlsZS5yZWRpc1xuICAgIH0pXG4gICAgb3V0Z29pbmdRdWV1ZS5zdWJzY3JpYmUoam9iID0+IG1pZGRsZXdhcmVzLnNlbmRPdXRnb2luZ0ltbWVkaWF0ZWx5KGpvYi5ldmVudCkpXG5cbiAgICBjb25zdCBtZXNzYWdlcyA9IHtcbiAgICAgIGluOiB7XG4gICAgICAgIGVucXVldWU6IGV2ZW50ID0+IGluY29taW5nUXVldWUuZW5xdWV1ZSh7IGV2ZW50IH0pLFxuICAgICAgICBjYW5jZWxBbGw6IGV2ZW50ID0+IGluY29taW5nUXVldWUuY2FuY2VsQWxsKHsgZXZlbnQgfSksXG4gICAgICAgIHBlZWs6IGV2ZW50ID0+IGluY29taW5nUXVldWUucGVlayh7IGV2ZW50IH0pXG4gICAgICB9LFxuICAgICAgb3V0OiB7XG4gICAgICAgIGVucXVldWU6IGV2ZW50ID0+IG91dGdvaW5nUXVldWUuZW5xdWV1ZSh7IGV2ZW50IH0pLFxuICAgICAgICBjYW5jZWxBbGw6IGV2ZW50ID0+IG91dGdvaW5nUXVldWUuY2FuY2VsQWxsKHsgZXZlbnQgfSksXG4gICAgICAgIHBlZWs6IGV2ZW50ID0+IG91dGdvaW5nUXVldWUucGVlayh7IGV2ZW50IH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgbWlkZGxld2FyZXMucmVnaXN0ZXIocmVuZGVyZXJzLmluY29taW5nTWlkZGxld2FyZSlcbiAgICBtaWRkbGV3YXJlcy5yZWdpc3RlcihoZWFyTWlkZGxld2FyZSlcbiAgICBtaWRkbGV3YXJlcy5yZWdpc3RlcihmYWxsYmFja01pZGRsZXdhcmUpXG5cbiAgICBfLmFzc2lnbih0aGlzLCB7XG4gICAgICBkYXRhTG9jYXRpb24sXG4gICAgICBpc0ZpcnN0UnVuLFxuICAgICAgdmVyc2lvbixcbiAgICAgIGxvZ2dlcixcbiAgICAgIHNlY3VyaXR5LCAvLyBsb2dpbiwgYXV0aGVudGljYXRlLCBnZXRTZWNyZXRcbiAgICAgIGV2ZW50cyxcbiAgICAgIG5vdGlmaWNhdGlvbnMsIC8vIGxvYWQsIHNhdmUsIHNlbmRcbiAgICAgIGFib3V0LFxuICAgICAgbWlkZGxld2FyZXMsXG4gICAgICBoZWFyLFxuICAgICAgbGljZW5zaW5nLFxuICAgICAgbW9kdWxlcyxcbiAgICAgIGRiLFxuICAgICAga3ZzLFxuICAgICAgY29uZmlnTWFuYWdlcixcbiAgICAgIGNsb3VkLFxuICAgICAgcmVuZGVyZXJzLFxuICAgICAgdXNlcnMsXG4gICAgICBnaG9zdE1hbmFnZXIsXG4gICAgICBjb250ZW50TWFuYWdlcixcbiAgICAgIG1lZGlhTWFuYWdlcixcbiAgICAgIGRpYWxvZ0VuZ2luZSxcbiAgICAgIGRpYWxvZ0phbml0b3IsXG4gICAgICBtZXNzYWdlcyxcbiAgICAgIHNraWxsczogc2tpbGxzTWFuYWdlclxuICAgIH0pXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3VtbScsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ0RFUFJFQ0FUSU9OIE5PVElDRSDigJMgYnAudW1tIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCDigJMgUGxlYXNlIHNlZSBicC5yZW5kZXJlcnMgaW5zdGVhZC4nKVxuICAgICAgICByZXR1cm4gcmVuZGVyZXJzXG4gICAgICB9XG4gICAgfSlcblxuICAgIGNvbnN0IGxvYWRlZE1vZHVsZXMgPSBhd2FpdCBtb2R1bGVzLl9sb2FkKG1vZHVsZURlZmluaXRpb25zLCB0aGlzKVxuXG4gICAgdGhpcy5zdGF0cy50cmFjaygnYm90JywgJ21vZHVsZXMnLCAnbG9hZGVkJywgbG9hZGVkTW9kdWxlcy5sZW5ndGgpXG5cbiAgICBfLmFzc2lnbih0aGlzLCB7XG4gICAgICBfbG9hZGVkTW9kdWxlczogbG9hZGVkTW9kdWxlc1xuICAgIH0pXG5cbiAgICBza2lsbHNNYW5hZ2VyLnJlZ2lzdGVyU2tpbGxzRnJvbU1vZHVsZXMoXy52YWx1ZXMobG9hZGVkTW9kdWxlcykpXG4gICAgYXdhaXQgY29udGVudE1hbmFnZXIuaW5pdCgpXG5cbiAgICBub3RpZmljYXRpb25zLl9iaW5kRXZlbnRzKClcblxuICAgIGNvbnN0IHNlcnZlciA9IGNyZWF0ZVNlcnZlcih0aGlzKVxuICAgIHNlcnZlci5zdGFydCgpLnRoZW4oc3J2ID0+IHtcbiAgICAgIHRoaXMuc3RvcFNlcnZlciA9IHNydiAmJiBzcnYuc3RvcFxuICAgICAgZXZlbnRzLmVtaXQoJ3JlYWR5JylcbiAgICAgIGZvciAoY29uc3QgbW9kIG9mIF8udmFsdWVzKGxvYWRlZE1vZHVsZXMpKSB7XG4gICAgICAgIG1vZC5oYW5kbGVycy5yZWFkeSAmJiBtb2QuaGFuZGxlcnMucmVhZHkodGhpcywgbW9kLmNvbmZpZ3VyYXRpb24sIGNyZWF0ZUhlbHBlcnMpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgYm90VXJsIH0gPSBib3RmaWxlXG4gICAgICBsb2dnZXIuaW5mbyhjaGFsay5ncmVlbi5ib2xkKGBCb3QgbGF1bmNoZWQuIFZpc2l0OiAke2JvdFVybH1gKSlcbiAgICB9KVxuXG4gICAgY29uc3QgbWlkZGxld2FyZUF1dG9Mb2FkaW5nID0gXy5nZXQoYm90ZmlsZSwgJ21pZGRsZXdhcmUuYXV0b0xvYWRpbmcnKVxuICAgIGlmICghXy5pc05pbChtaWRkbGV3YXJlQXV0b0xvYWRpbmcpICYmIG1pZGRsZXdhcmVBdXRvTG9hZGluZyA9PT0gZmFsc2UpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnTWlkZGxld2FyZSBBdXRvIExvYWRpbmcgd2FzIGRpc2FibGVkLiBDYWxsIGJwLm1pZGRsZXdhcmVzLmxvYWQoKSBtYW51YWxseS4nKVxuICAgIH0gZWxzZSB7XG4gICAgICBtaWRkbGV3YXJlcy5sb2FkKClcbiAgICB9XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXZhbFxuICAgIGNvbnN0IHByb2plY3RFbnRyeSA9IGV2YWwoJ3JlcXVpcmUnKShwcm9qZWN0TG9jYXRpb24pXG4gICAgaWYgKHR5cGVvZiBwcm9qZWN0RW50cnkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHByb2plY3RFbnRyeS5jYWxsKHByb2plY3RFbnRyeSwgdGhpcylcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nZ2VyLmVycm9yKCdbRkFUQUxdIFRoZSBib3QgZW50cnkgcG9pbnQgbXVzdCBiZSBhIGZ1bmN0aW9uIHRoYXQgdGFrZXMgYW4gaW5zdGFuY2Ugb2YgYnAnKVxuICAgICAgcHJvY2Vzcy5leGl0KDEpXG4gICAgfVxuXG4gICAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb24nLCBlcnIgPT4ge1xuICAgICAgbG9nZ2VyLmVycm9yKCdbRkFUQUxdIEFuIHVuaGFuZGxlZCBleGNlcHRpb24gb2NjdXJyZWQgaW4geW91ciBib3QnLCBlcnIpXG4gICAgICBpZiAoaXNEZXZlbG9waW5nKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihlcnIuc3RhY2spXG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3RhdHMudHJhY2tFeGNlcHRpb24oZXJyLm1lc3NhZ2UpXG4gICAgICBwcm9jZXNzLmV4aXQoMSlcbiAgICB9KVxuXG4gICAgcHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKHJlYXNvbiwgcCkgPT4ge1xuICAgICAgbG9nZ2VyLmVycm9yKCdVbmhhbmRsZWQgUmVqZWN0aW9uIGluIFByb21pc2U6ICcsIHAsICdSZWFzb246JywgcmVhc29uKVxuXG4gICAgICB0aGlzLnN0YXRzLnRyYWNrRXhjZXB0aW9uKHJlYXNvbilcbiAgICAgIGlmIChpc0RldmVsb3BpbmcgJiYgcmVhc29uICYmIHJlYXNvbi5zdGFjaykge1xuICAgICAgICBsb2dnZXIuZXJyb3IocmVhc29uLnN0YWNrKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBzdGFydCA9ICgpID0+IHtcbiAgICBpZiAoY2x1c3Rlci5pc01hc3Rlcikge1xuICAgICAgbGV0IGZpcnN0V29ya2VySGFzU3RhcnRlZEFscmVhZHkgPSBmYWxzZVxuXG4gICAgICBjb25zdCBxdWl0ID0gKGNvZGUgPSAwKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnN0b3BTZXJ2ZXIpIHtcbiAgICAgICAgICB0aGlzLnN0b3BTZXJ2ZXIoKVxuICAgICAgICB9XG5cbiAgICAgICAgcHJvY2Vzcy5leGl0KGNvZGUpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlY2VpdmVNZXNzYWdlRnJvbVdvcmtlciA9IG1lc3NhZ2UgPT4ge1xuICAgICAgICBpZiAobWVzc2FnZSAmJiBtZXNzYWdlLndvcmtlclN0YXR1cyA9PT0gJ3N0YXJ0aW5nJykge1xuICAgICAgICAgIGlmICghZmlyc3RXb3JrZXJIYXNTdGFydGVkQWxyZWFkeSkge1xuICAgICAgICAgICAgZmlyc3RXb3JrZXJIYXNTdGFydGVkQWxyZWFkeSA9IHRydWVcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJpbnQoJ2luZm8nLCAnKioqIHJlc3RhcnRlZCB3b3JrZXIgcHJvY2VzcyAqKionKVxuICAgICAgICAgICAgdGhpcy5zdGF0cy50cmFjaygnYm90JywgJ3Jlc3RhcnRlZCcpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ2V4aXQnKSB7XG4gICAgICAgICAgcXVpdCgpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2x1c3Rlci5vbignZXhpdCcsICh3b3JrZXIsIGNvZGUgLyogLCBzaWduYWwgKi8pID0+IHtcbiAgICAgICAgaWYgKGNvZGUgPT09IFJFU1RBUlRfRVhJVF9DT0RFKSB7XG4gICAgICAgICAgY2x1c3Rlci5mb3JrKCkub24oJ21lc3NhZ2UnLCByZWNlaXZlTWVzc2FnZUZyb21Xb3JrZXIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcXVpdChjb2RlKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBjbHVzdGVyLmZvcmsoKS5vbignbWVzc2FnZScsIHJlY2VpdmVNZXNzYWdlRnJvbVdvcmtlcilcbiAgICB9XG5cbiAgICBpZiAoY2x1c3Rlci5pc1dvcmtlcikge1xuICAgICAgcHJvY2Vzcy5zZW5kKHsgd29ya2VyU3RhdHVzOiAnc3RhcnRpbmcnIH0pXG4gICAgICB0aGlzLl9zdGFydCgpLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIHByaW50KCdlcnJvcicsICdFcnJvciBzdGFydGluZyBib3RwcmVzczogJywgZXJyLm1lc3NhZ2UsIGVyci5zdGFjaylcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgcmVzdGFydChpbnRlcnZhbCA9IDApIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHByb2Nlc3MuZXhpdChSRVNUQVJUX0VYSVRfQ09ERSlcbiAgICB9LCBpbnRlcnZhbClcbiAgfVxuXG4gIF9zZXR1cEVudigpIHtcbiAgICBjb25zdCBlbnZQYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMucHJvamVjdExvY2F0aW9uLCAnLmVudicpXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoZW52UGF0aCkpIHtcbiAgICAgIGNvbnN0IGVudkNvbmZpZyA9IGRvdGVudi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoZW52UGF0aCkpXG4gICAgICBmb3IgKGNvbnN0IGsgaW4gZW52Q29uZmlnKSB7XG4gICAgICAgIGlmIChfLmlzTmlsKHByb2Nlc3MuZW52W2tdKSB8fCBwcm9jZXNzLmVudi5FTlZfT1ZFUkxPQUQpIHtcbiAgICAgICAgICBwcm9jZXNzLmVudltrXSA9IGVudkNvbmZpZ1trXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYm90cHJlc3NcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/botpress.js\n");

/***/ }),

/***/ "./src/bus.js":
/*!********************!*\
  !*** ./src/bus.js ***!
  \********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _eventemitter = __webpack_require__(/*! eventemitter2 */ \"eventemitter2\");\n\nvar _eventemitter2 = _interopRequireDefault(_eventemitter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar EventBus = function (_EventEmitter) {\n  _inherits(EventBus, _EventEmitter);\n\n  function EventBus() {\n    _classCallCheck(this, EventBus);\n\n    return _possibleConstructorReturn(this, (EventBus.__proto__ || Object.getPrototypeOf(EventBus)).call(this, {\n      wildcard: true,\n      maxListeners: 100\n    }));\n  }\n\n  return EventBus;\n}(_eventemitter2.default);\n\nmodule.exports = EventBus;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnVzLmpzP2Y1ZWYiXSwibmFtZXMiOlsiRXZlbnRCdXMiLCJ3aWxkY2FyZCIsIm1heExpc3RlbmVycyIsIkV2ZW50RW1pdHRlcjIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7Ozs7Ozs7SUFFTUEsUTs7O0FBQ0osc0JBQWM7QUFBQTs7QUFBQSwrR0FDTjtBQUNKQyxnQkFBVSxJQUROO0FBRUpDLG9CQUFjO0FBRlYsS0FETTtBQUtiOzs7RUFOb0JDLHNCOztBQVN2QkMsT0FBT0MsT0FBUCxHQUFpQkwsUUFBakIiLCJmaWxlIjoiLi9zcmMvYnVzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEV2ZW50RW1pdHRlcjIgZnJvbSAnZXZlbnRlbWl0dGVyMidcblxuY2xhc3MgRXZlbnRCdXMgZXh0ZW5kcyBFdmVudEVtaXR0ZXIyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoe1xuICAgICAgd2lsZGNhcmQ6IHRydWUsXG4gICAgICBtYXhMaXN0ZW5lcnM6IDEwMFxuICAgIH0pXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEJ1c1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/bus.js\n");

/***/ }),

/***/ "./src/cli/auth.js":
/*!*************************!*\
  !*** ./src/cli/auth.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _prompt = __webpack_require__(/*! prompt */ \"prompt\");\n\nvar _prompt2 = _interopRequireDefault(_prompt);\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _validUrl = __webpack_require__(/*! valid-url */ \"valid-url\");\n\nvar _validUrl2 = _interopRequireDefault(_validUrl);\n\nvar _axios = __webpack_require__(/*! axios */ \"axios\");\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _promptConfirm = __webpack_require__(/*! prompt-confirm */ \"prompt-confirm\");\n\nvar _promptConfirm2 = _interopRequireDefault(_promptConfirm);\n\nvar _mkdirp = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n\nvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\nvar _os = __webpack_require__(/*! os */ \"os\");\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _get = __webpack_require__(/*! lodash/get */ \"lodash/get\");\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar AUTH_FILE = '.auth.json';\n\n// TODO: this part replicates `start.js`, refactor later\nvar getDataDir = function getDataDir() {\n  var projectPath = _path2.default.resolve('.');\n\n  var botfile = _path2.default.join(projectPath, 'botfile.js');\n  if (!_fs2.default.existsSync(botfile)) {\n    _util2.default.print.error('(fatal) No ' + _chalk2.default.bold('botfile.js') + ' file found at: ' + botfile);\n    process.exit(1);\n  }\n\n  // eslint-disable-next-line no-eval\n  var bf = eval('require')(botfile);\n  return _util2.default.getDataLocation(bf.dataDir, projectPath);\n};\n\nvar getCloudAuthFile = function getCloudAuthFile() {\n  return _path2.default.join(_os2.default.homedir(), '.botpress', AUTH_FILE);\n};\nvar getAuthFile = function getAuthFile() {\n  return _path2.default.join(getDataDir(), AUTH_FILE);\n};\n\nvar readJsonFile = function readJsonFile(file) {\n  try {\n    var json = _fs2.default.readFileSync(file, 'utf-8');\n    return JSON.parse(json);\n  } catch (err) {\n    if (err.code !== 'ENOENT') {\n      _util2.default.print.warn(err.message || 'Unknown error', 'while reading ' + file + '.');\n    }\n  }\n  return {};\n};\n\nvar writeJsonFile = function writeJsonFile(file, content) {\n  _mkdirp2.default.sync(_path2.default.dirname(file));\n  _fs2.default.writeFileSync(file, JSON.stringify(content, null, 2));\n};\n\nvar readBotAuth = function readBotAuth() {\n  return readJsonFile(getAuthFile());\n};\nvar readCloudAuth = function readCloudAuth() {\n  return readJsonFile(getCloudAuthFile());\n};\nvar writeBotAuth = function writeBotAuth(auth) {\n  return writeJsonFile(getAuthFile(), auth);\n};\nvar writeCloudAuth = function writeCloudAuth(auth) {\n  return writeJsonFile(getCloudAuthFile(), auth);\n};\n\nvar AUTH_DISABLED = '[AUTH DISABLED]';\n\nvar refreshToken = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(botUrl) {\n    var auth, token, response;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            auth = readBotAuth();\n            token = auth[botUrl];\n\n            // this method is only called if the auth is enabled\n            // in which case it doesn't make sense even to try refreshing the fake token\n            // we might have saved before when the auth was disabled on this server\n\n            if (!(!token || token === AUTH_DISABLED)) {\n              _context.next = 4;\n              break;\n            }\n\n            return _context.abrupt('return');\n\n          case 4:\n            _context.prev = 4;\n            _context.next = 7;\n            return _axios2.default.request({\n              url: botUrl + '/api/auth/refresh_token',\n              method: 'POST',\n              headers: {\n                Authorization: 'Bearer ' + token\n              }\n            });\n\n          case 7:\n            response = _context.sent;\n            return _context.abrupt('return', response.data);\n\n          case 11:\n            _context.prev = 11;\n            _context.t0 = _context['catch'](4);\n            return _context.abrupt('return', null);\n\n          case 14:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined, [[4, 11]]);\n  }));\n\n  return function refreshToken(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar doRootLogin = function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(botUrl) {\n    var token, schema, _ref3, user, password, result;\n\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return refreshToken(botUrl);\n\n          case 2:\n            token = _context2.sent;\n\n            if (!token) {\n              _context2.next = 5;\n              break;\n            }\n\n            return _context2.abrupt('return', { token: token, kind: 'refresh' });\n\n          case 5:\n            schema = {\n              properties: {\n                user: {\n                  description: _chalk2.default.white('User:'),\n                  required: true\n                },\n                password: {\n                  description: _chalk2.default.white('Password:'),\n                  hidden: true,\n                  required: true\n                }\n              }\n            };\n\n\n            _prompt2.default.message = '';\n            _prompt2.default.delimiter = '';\n            _prompt2.default.start();\n\n            _context2.next = 11;\n            return _bluebird2.default.fromCallback(function (cb) {\n              return _prompt2.default.get(schema, cb);\n            });\n\n          case 11:\n            _ref3 = _context2.sent;\n            user = _ref3.user;\n            password = _ref3.password;\n            _context2.next = 16;\n            return _axios2.default.post(botUrl + '/api/login', { user: user, password: password });\n\n          case 16:\n            result = _context2.sent;\n\n            if (!result.data.success) {\n              _context2.next = 19;\n              break;\n            }\n\n            return _context2.abrupt('return', { token: result.data.token, kind: 'login' });\n\n          case 19:\n            throw new Error(result.data.reason);\n\n          case 20:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, undefined);\n  }));\n\n  return function doRootLogin(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar doCloudLogin = function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(botUrl, botInfo) {\n    var userAuthUrl, loginUrl, cloudAuth, schema, _ref5, apiToken, authorization, _ref6, data, msg;\n\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            userAuthUrl = botInfo.endpoint + '/me/cli';\n            loginUrl = botInfo.endpoint + '/api/login/bot/' + botInfo.botId + '/' + botInfo.botEnv;\n            cloudAuth = readCloudAuth();\n\n            if (cloudAuth[botInfo.endpoint]) {\n              _context3.next = 16;\n              break;\n            }\n\n            schema = {\n              properties: {\n                token: {\n                  description: _chalk2.default.white('API Token:'),\n                  required: true\n                }\n              }\n            };\n\n\n            _prompt2.default.message = 'You need to authenticate using Botpress Cloud for this bot.\\r\\nPlease visit ' + userAuthUrl + ' and copy/paste your API token here.\\r\\n';\n            _prompt2.default.delimiter = '';\n            _prompt2.default.start();\n            _context3.next = 10;\n            return _bluebird2.default.fromCallback(function (cb) {\n              return _prompt2.default.get(schema, cb);\n            });\n\n          case 10:\n            _ref5 = _context3.sent;\n            apiToken = _ref5.token;\n\n            if (apiToken.startsWith('cli__')) {\n              _context3.next = 14;\n              break;\n            }\n\n            throw new Error('Invalid API Token, expected token starting with \"cli__\"');\n\n          case 14:\n\n            cloudAuth[botInfo.endpoint] = apiToken;\n            writeCloudAuth(cloudAuth);\n\n          case 16:\n            _context3.prev = 16;\n            authorization = 'Bearer ' + cloudAuth[botInfo.endpoint];\n            _context3.next = 20;\n            return _axios2.default.get(loginUrl, { headers: { authorization: authorization } });\n\n          case 20:\n            _ref6 = _context3.sent;\n            data = _ref6.data;\n            return _context3.abrupt('return', { token: (0, _get2.default)(data, 'payload.token'), kind: 'refresh' });\n\n          case 25:\n            _context3.prev = 25;\n            _context3.t0 = _context3['catch'](16);\n\n            delete cloudAuth[botInfo.endpoint];\n            writeCloudAuth(cloudAuth);\n            msg = (0, _get2.default)(_context3.t0, 'response.data.message') || _context3.t0.message;\n            throw new Error('Could not authenticate to bot using Botpress Cloud, please try again. (' + msg + ')');\n\n          case 31:\n          case 'end':\n            return _context3.stop();\n        }\n      }\n    }, _callee3, undefined, [[16, 25]]);\n  }));\n\n  return function doCloudLogin(_x3, _x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nvar doLogin = function () {\n  var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(botUrl) {\n    var res, data;\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _axios2.default.get(botUrl + '/api/auth/info');\n\n          case 2:\n            res = _context4.sent;\n            data = res.data || {};\n\n            if (!(!data.type === 'none')) {\n              _context4.next = 8;\n              break;\n            }\n\n            return _context4.abrupt('return', { token: AUTH_DISABLED, kind: 'no-auth' });\n\n          case 8:\n            if (!(data.type === 'cloud')) {\n              _context4.next = 12;\n              break;\n            }\n\n            return _context4.abrupt('return', doCloudLogin(botUrl, data));\n\n          case 12:\n            if (!(data.type === 'root')) {\n              _context4.next = 16;\n              break;\n            }\n\n            return _context4.abrupt('return', doRootLogin(botUrl));\n\n          case 16:\n            throw new Error('Unknown login type: ' + data.type);\n\n          case 17:\n          case 'end':\n            return _context4.stop();\n        }\n      }\n    }, _callee4, undefined);\n  }));\n\n  return function doLogin(_x5) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nexports.login = function () {\n  var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(botUrl) {\n    var _ref9, token, kind, auth;\n\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            botUrl = botUrl.replace(/\\/+$/, '');\n\n            if (_validUrl2.default.isUri(botUrl)) {\n              _context5.next = 4;\n              break;\n            }\n\n            _util2.default.print.error('Doesn\\'t look like valid URL: ' + botUrl);\n            return _context5.abrupt('return');\n\n          case 4:\n            _context5.prev = 4;\n            _context5.next = 7;\n            return doLogin(botUrl);\n\n          case 7:\n            _ref9 = _context5.sent;\n            token = _ref9.token;\n            kind = _ref9.kind;\n            auth = readBotAuth();\n\n            auth[botUrl] = token;\n            writeBotAuth(auth);\n            if (kind === 'login') {\n              _util2.default.print.success('Logged in successfully. Auth token saved in ' + getAuthFile() + '.');\n            } else if (kind === 'refresh') {\n              _util2.default.print.success('Auth token refreshed and saved in ' + getAuthFile() + '.');\n            } else if (kind === 'no-auth') {\n              _util2.default.print.info('Auth is disabled at ' + botUrl + ', no need to login.');\n            }\n            return _context5.abrupt('return', token);\n\n          case 17:\n            _context5.prev = 17;\n            _context5.t0 = _context5['catch'](4);\n\n            _util2.default.print.error(_context5.t0.message || 'Unknown');\n            return _context5.abrupt('return');\n\n          case 21:\n          case 'end':\n            return _context5.stop();\n        }\n      }\n    }, _callee5, undefined, [[4, 17]]);\n  }));\n\n  return function (_x6) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n\nexports.logout = function (botUrl) {\n  if (!botUrl) {\n    new _promptConfirm2.default(\"You're about to delete all saved auth tokens in the current folder. Are you sure?\").run().then(function (answer) {\n      if (!answer) {\n        return;\n      }\n      writeBotAuth({});\n      writeCloudAuth({});\n    });\n\n    return;\n  }\n\n  botUrl = botUrl.replace(/\\/+$/, '');\n  var auth = readBotAuth();\n  if (!auth[botUrl]) {\n    _util2.default.print.warn('No saved token for ' + botUrl + ', nothing to do.');\n    return;\n  }\n\n  delete auth[botUrl];\n  writeBotAuth(auth);\n  _util2.default.print.success('Logged out successfully.');\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2F1dGguanM/Y2QwYiJdLCJuYW1lcyI6WyJBVVRIX0ZJTEUiLCJnZXREYXRhRGlyIiwicHJvamVjdFBhdGgiLCJwYXRoIiwicmVzb2x2ZSIsImJvdGZpbGUiLCJqb2luIiwiZnMiLCJleGlzdHNTeW5jIiwidXRpbCIsInByaW50IiwiZXJyb3IiLCJjaGFsayIsImJvbGQiLCJwcm9jZXNzIiwiZXhpdCIsImJmIiwiZXZhbCIsImdldERhdGFMb2NhdGlvbiIsImRhdGFEaXIiLCJnZXRDbG91ZEF1dGhGaWxlIiwib3MiLCJob21lZGlyIiwiZ2V0QXV0aEZpbGUiLCJyZWFkSnNvbkZpbGUiLCJqc29uIiwicmVhZEZpbGVTeW5jIiwiZmlsZSIsIkpTT04iLCJwYXJzZSIsImVyciIsImNvZGUiLCJ3YXJuIiwibWVzc2FnZSIsIndyaXRlSnNvbkZpbGUiLCJjb250ZW50IiwibWtkaXJwIiwic3luYyIsImRpcm5hbWUiLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5IiwicmVhZEJvdEF1dGgiLCJyZWFkQ2xvdWRBdXRoIiwid3JpdGVCb3RBdXRoIiwiYXV0aCIsIndyaXRlQ2xvdWRBdXRoIiwiQVVUSF9ESVNBQkxFRCIsInJlZnJlc2hUb2tlbiIsImJvdFVybCIsInRva2VuIiwiYXhpb3MiLCJyZXF1ZXN0IiwidXJsIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJyZXNwb25zZSIsImRhdGEiLCJkb1Jvb3RMb2dpbiIsImtpbmQiLCJzY2hlbWEiLCJwcm9wZXJ0aWVzIiwidXNlciIsImRlc2NyaXB0aW9uIiwid2hpdGUiLCJyZXF1aXJlZCIsInBhc3N3b3JkIiwiaGlkZGVuIiwicHJvbXB0IiwiZGVsaW1pdGVyIiwic3RhcnQiLCJQcm9taXNlIiwiZnJvbUNhbGxiYWNrIiwiZ2V0IiwiY2IiLCJwb3N0IiwicmVzdWx0Iiwic3VjY2VzcyIsIkVycm9yIiwicmVhc29uIiwiZG9DbG91ZExvZ2luIiwiYm90SW5mbyIsInVzZXJBdXRoVXJsIiwiZW5kcG9pbnQiLCJsb2dpblVybCIsImJvdElkIiwiYm90RW52IiwiY2xvdWRBdXRoIiwiYXBpVG9rZW4iLCJzdGFydHNXaXRoIiwiYXV0aG9yaXphdGlvbiIsIm1zZyIsImRvTG9naW4iLCJyZXMiLCJ0eXBlIiwiZXhwb3J0cyIsImxvZ2luIiwicmVwbGFjZSIsInZhbGlkVXJsIiwiaXNVcmkiLCJpbmZvIiwibG9nb3V0IiwiQ29uZmlybSIsInJ1biIsInRoZW4iLCJhbnN3ZXIiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOzs7Ozs7OztBQUVBLElBQU1BLFlBQVksWUFBbEI7O0FBRUE7QUFDQSxJQUFNQyxhQUFhLFNBQWJBLFVBQWEsR0FBTTtBQUN2QixNQUFNQyxjQUFjQyxlQUFLQyxPQUFMLENBQWEsR0FBYixDQUFwQjs7QUFFQSxNQUFNQyxVQUFVRixlQUFLRyxJQUFMLENBQVVKLFdBQVYsRUFBdUIsWUFBdkIsQ0FBaEI7QUFDQSxNQUFJLENBQUNLLGFBQUdDLFVBQUgsQ0FBY0gsT0FBZCxDQUFMLEVBQTZCO0FBQzNCSSxtQkFBS0MsS0FBTCxDQUFXQyxLQUFYLENBQWlCLGdCQUFjQyxnQkFBTUMsSUFBTixDQUFXLFlBQVgsQ0FBZCx3QkFBMkRSLE9BQTVFO0FBQ0FTLFlBQVFDLElBQVIsQ0FBYSxDQUFiO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFNQyxLQUFLQyxLQUFLLFNBQUwsRUFBZ0JaLE9BQWhCLENBQVg7QUFDQSxTQUFPSSxlQUFLUyxlQUFMLENBQXFCRixHQUFHRyxPQUF4QixFQUFpQ2pCLFdBQWpDLENBQVA7QUFDRCxDQVpEOztBQWNBLElBQU1rQixtQkFBbUIsU0FBbkJBLGdCQUFtQjtBQUFBLFNBQU1qQixlQUFLRyxJQUFMLENBQVVlLGFBQUdDLE9BQUgsRUFBVixFQUF3QixXQUF4QixFQUFxQ3RCLFNBQXJDLENBQU47QUFBQSxDQUF6QjtBQUNBLElBQU11QixjQUFjLFNBQWRBLFdBQWM7QUFBQSxTQUFNcEIsZUFBS0csSUFBTCxDQUFVTCxZQUFWLEVBQXdCRCxTQUF4QixDQUFOO0FBQUEsQ0FBcEI7O0FBRUEsSUFBTXdCLGVBQWUsU0FBZkEsWUFBZSxPQUFRO0FBQzNCLE1BQUk7QUFDRixRQUFNQyxPQUFPbEIsYUFBR21CLFlBQUgsQ0FBZ0JDLElBQWhCLEVBQXNCLE9BQXRCLENBQWI7QUFDQSxXQUFPQyxLQUFLQyxLQUFMLENBQVdKLElBQVgsQ0FBUDtBQUNELEdBSEQsQ0FHRSxPQUFPSyxHQUFQLEVBQVk7QUFDWixRQUFJQSxJQUFJQyxJQUFKLEtBQWEsUUFBakIsRUFBMkI7QUFDekJ0QixxQkFBS0MsS0FBTCxDQUFXc0IsSUFBWCxDQUFnQkYsSUFBSUcsT0FBSixJQUFlLGVBQS9CLHFCQUFpRU4sSUFBakU7QUFDRDtBQUNGO0FBQ0QsU0FBTyxFQUFQO0FBQ0QsQ0FWRDs7QUFZQSxJQUFNTyxnQkFBZ0IsU0FBaEJBLGFBQWdCLENBQUNQLElBQUQsRUFBT1EsT0FBUCxFQUFtQjtBQUN2Q0MsbUJBQU9DLElBQVAsQ0FBWWxDLGVBQUttQyxPQUFMLENBQWFYLElBQWIsQ0FBWjtBQUNBcEIsZUFBR2dDLGFBQUgsQ0FBaUJaLElBQWpCLEVBQXVCQyxLQUFLWSxTQUFMLENBQWVMLE9BQWYsRUFBd0IsSUFBeEIsRUFBOEIsQ0FBOUIsQ0FBdkI7QUFDRCxDQUhEOztBQUtBLElBQU1NLGNBQWMsU0FBZEEsV0FBYztBQUFBLFNBQU1qQixhQUFhRCxhQUFiLENBQU47QUFBQSxDQUFwQjtBQUNBLElBQU1tQixnQkFBZ0IsU0FBaEJBLGFBQWdCO0FBQUEsU0FBTWxCLGFBQWFKLGtCQUFiLENBQU47QUFBQSxDQUF0QjtBQUNBLElBQU11QixlQUFlLFNBQWZBLFlBQWU7QUFBQSxTQUFRVCxjQUFjWCxhQUFkLEVBQTZCcUIsSUFBN0IsQ0FBUjtBQUFBLENBQXJCO0FBQ0EsSUFBTUMsaUJBQWlCLFNBQWpCQSxjQUFpQjtBQUFBLFNBQVFYLGNBQWNkLGtCQUFkLEVBQWtDd0IsSUFBbEMsQ0FBUjtBQUFBLENBQXZCOztBQUVBLElBQU1FLGdCQUFnQixpQkFBdEI7O0FBRUEsSUFBTUM7QUFBQSxxRUFBZSxpQkFBTUMsTUFBTjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDYkosZ0JBRGEsR0FDTkgsYUFETTtBQUViUSxpQkFGYSxHQUVMTCxLQUFLSSxNQUFMLENBRks7O0FBSW5CO0FBQ0E7QUFDQTs7QUFObUIsa0JBT2YsQ0FBQ0MsS0FBRCxJQUFVQSxVQUFVSCxhQVBMO0FBQUE7QUFBQTtBQUFBOztBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQVlNSSxnQkFBTUMsT0FBTixDQUFjO0FBQ25DQyxtQkFBUUosTUFBUiw0QkFEbUM7QUFFbkNLLHNCQUFRLE1BRjJCO0FBR25DQyx1QkFBUztBQUNQQywyQ0FBeUJOO0FBRGxCO0FBSDBCLGFBQWQsQ0FaTjs7QUFBQTtBQVlYTyxvQkFaVztBQUFBLDZDQW1CVkEsU0FBU0MsSUFuQkM7O0FBQUE7QUFBQTtBQUFBO0FBQUEsNkNBcUJWLElBckJVOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWY7O0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBTjs7QUF5QkEsSUFBTUM7QUFBQSxzRUFBYyxrQkFBTVYsTUFBTjtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxtQkFFRUQsYUFBYUMsTUFBYixDQUZGOztBQUFBO0FBRVpDLGlCQUZZOztBQUFBLGlCQUdkQSxLQUhjO0FBQUE7QUFBQTtBQUFBOztBQUFBLDhDQUlULEVBQUVBLFlBQUYsRUFBU1UsTUFBTSxTQUFmLEVBSlM7O0FBQUE7QUFPWkMsa0JBUFksR0FPSDtBQUNiQywwQkFBWTtBQUNWQyxzQkFBTTtBQUNKQywrQkFBYW5ELGdCQUFNb0QsS0FBTixDQUFZLE9BQVosQ0FEVDtBQUVKQyw0QkFBVTtBQUZOLGlCQURJO0FBS1ZDLDBCQUFVO0FBQ1JILCtCQUFhbkQsZ0JBQU1vRCxLQUFOLENBQVksV0FBWixDQURMO0FBRVJHLDBCQUFRLElBRkE7QUFHUkYsNEJBQVU7QUFIRjtBQUxBO0FBREMsYUFQRzs7O0FBcUJsQkcsNkJBQU9uQyxPQUFQLEdBQWlCLEVBQWpCO0FBQ0FtQyw2QkFBT0MsU0FBUCxHQUFtQixFQUFuQjtBQUNBRCw2QkFBT0UsS0FBUDs7QUF2QmtCO0FBQUEsbUJBeUJlQyxtQkFBUUMsWUFBUixDQUFxQjtBQUFBLHFCQUFNSixpQkFBT0ssR0FBUCxDQUFXYixNQUFYLEVBQW1CYyxFQUFuQixDQUFOO0FBQUEsYUFBckIsQ0F6QmY7O0FBQUE7QUFBQTtBQXlCVlosZ0JBekJVLFNBeUJWQSxJQXpCVTtBQXlCSkksb0JBekJJLFNBeUJKQSxRQXpCSTtBQUFBO0FBQUEsbUJBMEJHaEIsZ0JBQU15QixJQUFOLENBQWMzQixNQUFkLGlCQUFrQyxFQUFFYyxVQUFGLEVBQVFJLGtCQUFSLEVBQWxDLENBMUJIOztBQUFBO0FBMEJaVSxrQkExQlk7O0FBQUEsaUJBNEJkQSxPQUFPbkIsSUFBUCxDQUFZb0IsT0E1QkU7QUFBQTtBQUFBO0FBQUE7O0FBQUEsOENBNkJULEVBQUU1QixPQUFPMkIsT0FBT25CLElBQVAsQ0FBWVIsS0FBckIsRUFBNEJVLE1BQU0sT0FBbEMsRUE3QlM7O0FBQUE7QUFBQSxrQkErQlosSUFBSW1CLEtBQUosQ0FBVUYsT0FBT25CLElBQVAsQ0FBWXNCLE1BQXRCLENBL0JZOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWQ7O0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBTjs7QUFrQ0EsSUFBTUM7QUFBQSxzRUFBZSxrQkFBT2hDLE1BQVAsRUFBZWlDLE9BQWY7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNiQyx1QkFEYSxHQUNJRCxRQUFRRSxRQURaO0FBRWJDLG9CQUZhLEdBRUNILFFBQVFFLFFBRlQsdUJBRW1DRixRQUFRSSxLQUYzQyxTQUVvREosUUFBUUssTUFGNUQ7QUFJYkMscUJBSmEsR0FJRDdDLGVBSkM7O0FBQUEsZ0JBTWQ2QyxVQUFVTixRQUFRRSxRQUFsQixDQU5jO0FBQUE7QUFBQTtBQUFBOztBQU9YdkIsa0JBUFcsR0FPRjtBQUNiQywwQkFBWTtBQUNWWix1QkFBTztBQUNMYywrQkFBYW5ELGdCQUFNb0QsS0FBTixDQUFZLFlBQVosQ0FEUjtBQUVMQyw0QkFBVTtBQUZMO0FBREc7QUFEQyxhQVBFOzs7QUFnQmpCRyw2QkFBT25DLE9BQVAsb0ZBQWdHaUQsV0FBaEc7QUFDQWQsNkJBQU9DLFNBQVAsR0FBbUIsRUFBbkI7QUFDQUQsNkJBQU9FLEtBQVA7QUFsQmlCO0FBQUEsbUJBbUJpQkMsbUJBQVFDLFlBQVIsQ0FBcUI7QUFBQSxxQkFBTUosaUJBQU9LLEdBQVAsQ0FBV2IsTUFBWCxFQUFtQmMsRUFBbkIsQ0FBTjtBQUFBLGFBQXJCLENBbkJqQjs7QUFBQTtBQUFBO0FBbUJGYyxvQkFuQkUsU0FtQlR2QyxLQW5CUzs7QUFBQSxnQkFxQlp1QyxTQUFTQyxVQUFULENBQW9CLE9BQXBCLENBckJZO0FBQUE7QUFBQTtBQUFBOztBQUFBLGtCQXNCVCxJQUFJWCxLQUFKLENBQVUseURBQVYsQ0F0QlM7O0FBQUE7O0FBeUJqQlMsc0JBQVVOLFFBQVFFLFFBQWxCLElBQThCSyxRQUE5QjtBQUNBM0MsMkJBQWUwQyxTQUFmOztBQTFCaUI7QUFBQTtBQThCWEcseUJBOUJXLGVBOEJlSCxVQUFVTixRQUFRRSxRQUFsQixDQTlCZjtBQUFBO0FBQUEsbUJBK0JNakMsZ0JBQU11QixHQUFOLENBQVVXLFFBQVYsRUFBb0IsRUFBRTlCLFNBQVMsRUFBRW9DLDRCQUFGLEVBQVgsRUFBcEIsQ0EvQk47O0FBQUE7QUFBQTtBQStCVGpDLGdCQS9CUyxTQStCVEEsSUEvQlM7QUFBQSw4Q0FnQ1YsRUFBRVIsT0FBTyxtQkFBSVEsSUFBSixFQUFVLGVBQVYsQ0FBVCxFQUFxQ0UsTUFBTSxTQUEzQyxFQWhDVTs7QUFBQTtBQUFBO0FBQUE7O0FBa0NqQixtQkFBTzRCLFVBQVVOLFFBQVFFLFFBQWxCLENBQVA7QUFDQXRDLDJCQUFlMEMsU0FBZjtBQUNNSSxlQXBDVyxHQW9DTCxpQ0FBUyx1QkFBVCxLQUFxQyxhQUFJMUQsT0FwQ3BDO0FBQUEsa0JBcUNYLElBQUk2QyxLQUFKLENBQVUsNEVBQTRFYSxHQUE1RSxHQUFrRixHQUE1RixDQXJDVzs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUFmOztBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQU47O0FBeUNBLElBQU1DO0FBQUEsc0VBQVUsa0JBQU01QyxNQUFOO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsbUJBQ0lFLGdCQUFNdUIsR0FBTixDQUFhekIsTUFBYixvQkFESjs7QUFBQTtBQUNSNkMsZUFEUTtBQUdScEMsZ0JBSFEsR0FHRG9DLElBQUlwQyxJQUFKLElBQVksRUFIWDs7QUFBQSxrQkFLVixDQUFDQSxLQUFLcUMsSUFBTixLQUFlLE1BTEw7QUFBQTtBQUFBO0FBQUE7O0FBQUEsOENBTUwsRUFBRTdDLE9BQU9ILGFBQVQsRUFBd0JhLE1BQU0sU0FBOUIsRUFOSzs7QUFBQTtBQUFBLGtCQU9IRixLQUFLcUMsSUFBTCxLQUFjLE9BUFg7QUFBQTtBQUFBO0FBQUE7O0FBQUEsOENBUUxkLGFBQWFoQyxNQUFiLEVBQXFCUyxJQUFyQixDQVJLOztBQUFBO0FBQUEsa0JBU0hBLEtBQUtxQyxJQUFMLEtBQWMsTUFUWDtBQUFBO0FBQUE7QUFBQTs7QUFBQSw4Q0FVTHBDLFlBQVlWLE1BQVosQ0FWSzs7QUFBQTtBQUFBLGtCQVlOLElBQUk4QixLQUFKLENBQVUseUJBQXlCckIsS0FBS3FDLElBQXhDLENBWk07O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBVjs7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUFOOztBQWdCQUMsUUFBUUMsS0FBUjtBQUFBLHNFQUFnQixrQkFBTWhELE1BQU47QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNkQSxxQkFBU0EsT0FBT2lELE9BQVAsQ0FBZSxNQUFmLEVBQXVCLEVBQXZCLENBQVQ7O0FBRGMsZ0JBR1RDLG1CQUFTQyxLQUFULENBQWVuRCxNQUFmLENBSFM7QUFBQTtBQUFBO0FBQUE7O0FBSVp2QywyQkFBS0MsS0FBTCxDQUFXQyxLQUFYLG9DQUFpRHFDLE1BQWpEO0FBSlk7O0FBQUE7QUFBQTtBQUFBO0FBQUEsbUJBU2tCNEMsUUFBUTVDLE1BQVIsQ0FUbEI7O0FBQUE7QUFBQTtBQVNKQyxpQkFUSSxTQVNKQSxLQVRJO0FBU0dVLGdCQVRILFNBU0dBLElBVEg7QUFVTmYsZ0JBVk0sR0FVQ0gsYUFWRDs7QUFXWkcsaUJBQUtJLE1BQUwsSUFBZUMsS0FBZjtBQUNBTix5QkFBYUMsSUFBYjtBQUNBLGdCQUFJZSxTQUFTLE9BQWIsRUFBc0I7QUFDcEJsRCw2QkFBS0MsS0FBTCxDQUFXbUUsT0FBWCxrREFBa0V0RCxhQUFsRTtBQUNELGFBRkQsTUFFTyxJQUFJb0MsU0FBUyxTQUFiLEVBQXdCO0FBQzdCbEQsNkJBQUtDLEtBQUwsQ0FBV21FLE9BQVgsd0NBQXdEdEQsYUFBeEQ7QUFDRCxhQUZNLE1BRUEsSUFBSW9DLFNBQVMsU0FBYixFQUF3QjtBQUM3QmxELDZCQUFLQyxLQUFMLENBQVcwRixJQUFYLDBCQUF1Q3BELE1BQXZDO0FBQ0Q7QUFuQlcsOENBb0JMQyxLQXBCSzs7QUFBQTtBQUFBO0FBQUE7O0FBc0JaeEMsMkJBQUtDLEtBQUwsQ0FBV0MsS0FBWCxDQUFpQixhQUFJc0IsT0FBSixJQUFlLFNBQWhDO0FBdEJZOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWhCOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQTJCQThELFFBQVFNLE1BQVIsR0FBaUIsa0JBQVU7QUFDekIsTUFBSSxDQUFDckQsTUFBTCxFQUFhO0FBQ1gsUUFBSXNELHVCQUFKLENBQVksbUZBQVosRUFDR0MsR0FESCxHQUVHQyxJQUZILENBRVEsa0JBQVU7QUFDZCxVQUFJLENBQUNDLE1BQUwsRUFBYTtBQUNYO0FBQ0Q7QUFDRDlELG1CQUFhLEVBQWI7QUFDQUUscUJBQWUsRUFBZjtBQUNELEtBUkg7O0FBVUE7QUFDRDs7QUFFREcsV0FBU0EsT0FBT2lELE9BQVAsQ0FBZSxNQUFmLEVBQXVCLEVBQXZCLENBQVQ7QUFDQSxNQUFNckQsT0FBT0gsYUFBYjtBQUNBLE1BQUksQ0FBQ0csS0FBS0ksTUFBTCxDQUFMLEVBQW1CO0FBQ2pCdkMsbUJBQUtDLEtBQUwsQ0FBV3NCLElBQVgseUJBQXNDZ0IsTUFBdEM7QUFDQTtBQUNEOztBQUVELFNBQU9KLEtBQUtJLE1BQUwsQ0FBUDtBQUNBTCxlQUFhQyxJQUFiO0FBQ0FuQyxpQkFBS0MsS0FBTCxDQUFXbUUsT0FBWCxDQUFtQiwwQkFBbkI7QUFDRCxDQXpCRCIsImZpbGUiOiIuL3NyYy9jbGkvYXV0aC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCBwcm9tcHQgZnJvbSAncHJvbXB0J1xuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJ1xuaW1wb3J0IHZhbGlkVXJsIGZyb20gJ3ZhbGlkLXVybCdcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcydcbmltcG9ydCBDb25maXJtIGZyb20gJ3Byb21wdC1jb25maXJtJ1xuaW1wb3J0IG1rZGlycCBmcm9tICdta2RpcnAnXG5pbXBvcnQgb3MgZnJvbSAnb3MnXG5pbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC9nZXQnXG5cbmltcG9ydCB1dGlsIGZyb20gJy4uL3V0aWwnXG5cbmNvbnN0IEFVVEhfRklMRSA9ICcuYXV0aC5qc29uJ1xuXG4vLyBUT0RPOiB0aGlzIHBhcnQgcmVwbGljYXRlcyBgc3RhcnQuanNgLCByZWZhY3RvciBsYXRlclxuY29uc3QgZ2V0RGF0YURpciA9ICgpID0+IHtcbiAgY29uc3QgcHJvamVjdFBhdGggPSBwYXRoLnJlc29sdmUoJy4nKVxuXG4gIGNvbnN0IGJvdGZpbGUgPSBwYXRoLmpvaW4ocHJvamVjdFBhdGgsICdib3RmaWxlLmpzJylcbiAgaWYgKCFmcy5leGlzdHNTeW5jKGJvdGZpbGUpKSB7XG4gICAgdXRpbC5wcmludC5lcnJvcihgKGZhdGFsKSBObyAke2NoYWxrLmJvbGQoJ2JvdGZpbGUuanMnKX0gZmlsZSBmb3VuZCBhdDogYCArIGJvdGZpbGUpXG4gICAgcHJvY2Vzcy5leGl0KDEpXG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXZhbFxuICBjb25zdCBiZiA9IGV2YWwoJ3JlcXVpcmUnKShib3RmaWxlKVxuICByZXR1cm4gdXRpbC5nZXREYXRhTG9jYXRpb24oYmYuZGF0YURpciwgcHJvamVjdFBhdGgpXG59XG5cbmNvbnN0IGdldENsb3VkQXV0aEZpbGUgPSAoKSA9PiBwYXRoLmpvaW4ob3MuaG9tZWRpcigpLCAnLmJvdHByZXNzJywgQVVUSF9GSUxFKVxuY29uc3QgZ2V0QXV0aEZpbGUgPSAoKSA9PiBwYXRoLmpvaW4oZ2V0RGF0YURpcigpLCBBVVRIX0ZJTEUpXG5cbmNvbnN0IHJlYWRKc29uRmlsZSA9IGZpbGUgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGpzb24gPSBmcy5yZWFkRmlsZVN5bmMoZmlsZSwgJ3V0Zi04JylcbiAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoZXJyLmNvZGUgIT09ICdFTk9FTlQnKSB7XG4gICAgICB1dGlsLnByaW50Lndhcm4oZXJyLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InLCBgd2hpbGUgcmVhZGluZyAke2ZpbGV9LmApXG4gICAgfVxuICB9XG4gIHJldHVybiB7fVxufVxuXG5jb25zdCB3cml0ZUpzb25GaWxlID0gKGZpbGUsIGNvbnRlbnQpID0+IHtcbiAgbWtkaXJwLnN5bmMocGF0aC5kaXJuYW1lKGZpbGUpKVxuICBmcy53cml0ZUZpbGVTeW5jKGZpbGUsIEpTT04uc3RyaW5naWZ5KGNvbnRlbnQsIG51bGwsIDIpKVxufVxuXG5jb25zdCByZWFkQm90QXV0aCA9ICgpID0+IHJlYWRKc29uRmlsZShnZXRBdXRoRmlsZSgpKVxuY29uc3QgcmVhZENsb3VkQXV0aCA9ICgpID0+IHJlYWRKc29uRmlsZShnZXRDbG91ZEF1dGhGaWxlKCkpXG5jb25zdCB3cml0ZUJvdEF1dGggPSBhdXRoID0+IHdyaXRlSnNvbkZpbGUoZ2V0QXV0aEZpbGUoKSwgYXV0aClcbmNvbnN0IHdyaXRlQ2xvdWRBdXRoID0gYXV0aCA9PiB3cml0ZUpzb25GaWxlKGdldENsb3VkQXV0aEZpbGUoKSwgYXV0aClcblxuY29uc3QgQVVUSF9ESVNBQkxFRCA9ICdbQVVUSCBESVNBQkxFRF0nXG5cbmNvbnN0IHJlZnJlc2hUb2tlbiA9IGFzeW5jIGJvdFVybCA9PiB7XG4gIGNvbnN0IGF1dGggPSByZWFkQm90QXV0aCgpXG4gIGNvbnN0IHRva2VuID0gYXV0aFtib3RVcmxdXG5cbiAgLy8gdGhpcyBtZXRob2QgaXMgb25seSBjYWxsZWQgaWYgdGhlIGF1dGggaXMgZW5hYmxlZFxuICAvLyBpbiB3aGljaCBjYXNlIGl0IGRvZXNuJ3QgbWFrZSBzZW5zZSBldmVuIHRvIHRyeSByZWZyZXNoaW5nIHRoZSBmYWtlIHRva2VuXG4gIC8vIHdlIG1pZ2h0IGhhdmUgc2F2ZWQgYmVmb3JlIHdoZW4gdGhlIGF1dGggd2FzIGRpc2FibGVkIG9uIHRoaXMgc2VydmVyXG4gIGlmICghdG9rZW4gfHwgdG9rZW4gPT09IEFVVEhfRElTQUJMRUQpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5yZXF1ZXN0KHtcbiAgICAgIHVybDogYCR7Ym90VXJsfS9hcGkvYXV0aC9yZWZyZXNoX3Rva2VuYCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW59YFxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG5jb25zdCBkb1Jvb3RMb2dpbiA9IGFzeW5jIGJvdFVybCA9PiB7XG4gIC8vIHRyeSByZWZyZXNoaW5nIHRva2VuIGJlZm9yZSBhdHRlbXB0aW5nIHRoZSBuZXcgbG9naW5cbiAgY29uc3QgdG9rZW4gPSBhd2FpdCByZWZyZXNoVG9rZW4oYm90VXJsKVxuICBpZiAodG9rZW4pIHtcbiAgICByZXR1cm4geyB0b2tlbiwga2luZDogJ3JlZnJlc2gnIH1cbiAgfVxuXG4gIGNvbnN0IHNjaGVtYSA9IHtcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBjaGFsay53aGl0ZSgnVXNlcjonKSxcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgIH0sXG4gICAgICBwYXNzd29yZDoge1xuICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ1Bhc3N3b3JkOicpLFxuICAgICAgICBoaWRkZW46IHRydWUsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJvbXB0Lm1lc3NhZ2UgPSAnJ1xuICBwcm9tcHQuZGVsaW1pdGVyID0gJydcbiAgcHJvbXB0LnN0YXJ0KClcblxuICBjb25zdCB7IHVzZXIsIHBhc3N3b3JkIH0gPSBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYiA9PiBwcm9tcHQuZ2V0KHNjaGVtYSwgY2IpKVxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBheGlvcy5wb3N0KGAke2JvdFVybH0vYXBpL2xvZ2luYCwgeyB1c2VyLCBwYXNzd29yZCB9KVxuXG4gIGlmIChyZXN1bHQuZGF0YS5zdWNjZXNzKSB7XG4gICAgcmV0dXJuIHsgdG9rZW46IHJlc3VsdC5kYXRhLnRva2VuLCBraW5kOiAnbG9naW4nIH1cbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IocmVzdWx0LmRhdGEucmVhc29uKVxufVxuXG5jb25zdCBkb0Nsb3VkTG9naW4gPSBhc3luYyAoYm90VXJsLCBib3RJbmZvKSA9PiB7XG4gIGNvbnN0IHVzZXJBdXRoVXJsID0gYCR7Ym90SW5mby5lbmRwb2ludH0vbWUvY2xpYFxuICBjb25zdCBsb2dpblVybCA9IGAke2JvdEluZm8uZW5kcG9pbnR9L2FwaS9sb2dpbi9ib3QvJHtib3RJbmZvLmJvdElkfS8ke2JvdEluZm8uYm90RW52fWBcblxuICBjb25zdCBjbG91ZEF1dGggPSByZWFkQ2xvdWRBdXRoKClcblxuICBpZiAoIWNsb3VkQXV0aFtib3RJbmZvLmVuZHBvaW50XSkge1xuICAgIGNvbnN0IHNjaGVtYSA9IHtcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ0FQSSBUb2tlbjonKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcHJvbXB0Lm1lc3NhZ2UgPSBgWW91IG5lZWQgdG8gYXV0aGVudGljYXRlIHVzaW5nIEJvdHByZXNzIENsb3VkIGZvciB0aGlzIGJvdC5cXHJcXG5QbGVhc2UgdmlzaXQgJHt1c2VyQXV0aFVybH0gYW5kIGNvcHkvcGFzdGUgeW91ciBBUEkgdG9rZW4gaGVyZS5cXHJcXG5gXG4gICAgcHJvbXB0LmRlbGltaXRlciA9ICcnXG4gICAgcHJvbXB0LnN0YXJ0KClcbiAgICBjb25zdCB7IHRva2VuOiBhcGlUb2tlbiB9ID0gYXdhaXQgUHJvbWlzZS5mcm9tQ2FsbGJhY2soY2IgPT4gcHJvbXB0LmdldChzY2hlbWEsIGNiKSlcblxuICAgIGlmICghYXBpVG9rZW4uc3RhcnRzV2l0aCgnY2xpX18nKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEFQSSBUb2tlbiwgZXhwZWN0ZWQgdG9rZW4gc3RhcnRpbmcgd2l0aCBcImNsaV9fXCInKVxuICAgIH1cblxuICAgIGNsb3VkQXV0aFtib3RJbmZvLmVuZHBvaW50XSA9IGFwaVRva2VuXG4gICAgd3JpdGVDbG91ZEF1dGgoY2xvdWRBdXRoKVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBhdXRob3JpemF0aW9uID0gYEJlYXJlciAke2Nsb3VkQXV0aFtib3RJbmZvLmVuZHBvaW50XX1gXG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBheGlvcy5nZXQobG9naW5VcmwsIHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uIH0gfSlcbiAgICByZXR1cm4geyB0b2tlbjogZ2V0KGRhdGEsICdwYXlsb2FkLnRva2VuJyksIGtpbmQ6ICdyZWZyZXNoJyB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGRlbGV0ZSBjbG91ZEF1dGhbYm90SW5mby5lbmRwb2ludF1cbiAgICB3cml0ZUNsb3VkQXV0aChjbG91ZEF1dGgpXG4gICAgY29uc3QgbXNnID0gZ2V0KGVyciwgJ3Jlc3BvbnNlLmRhdGEubWVzc2FnZScpIHx8IGVyci5tZXNzYWdlXG4gICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgYXV0aGVudGljYXRlIHRvIGJvdCB1c2luZyBCb3RwcmVzcyBDbG91ZCwgcGxlYXNlIHRyeSBhZ2Fpbi4gKCcgKyBtc2cgKyAnKScpXG4gIH1cbn1cblxuY29uc3QgZG9Mb2dpbiA9IGFzeW5jIGJvdFVybCA9PiB7XG4gIGNvbnN0IHJlcyA9IGF3YWl0IGF4aW9zLmdldChgJHtib3RVcmx9L2FwaS9hdXRoL2luZm9gKVxuXG4gIGNvbnN0IGRhdGEgPSByZXMuZGF0YSB8fCB7fVxuXG4gIGlmICghZGF0YS50eXBlID09PSAnbm9uZScpIHtcbiAgICByZXR1cm4geyB0b2tlbjogQVVUSF9ESVNBQkxFRCwga2luZDogJ25vLWF1dGgnIH1cbiAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICdjbG91ZCcpIHtcbiAgICByZXR1cm4gZG9DbG91ZExvZ2luKGJvdFVybCwgZGF0YSlcbiAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICdyb290Jykge1xuICAgIHJldHVybiBkb1Jvb3RMb2dpbihib3RVcmwpXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGxvZ2luIHR5cGU6ICcgKyBkYXRhLnR5cGUpXG4gIH1cbn1cblxuZXhwb3J0cy5sb2dpbiA9IGFzeW5jIGJvdFVybCA9PiB7XG4gIGJvdFVybCA9IGJvdFVybC5yZXBsYWNlKC9cXC8rJC8sICcnKVxuXG4gIGlmICghdmFsaWRVcmwuaXNVcmkoYm90VXJsKSkge1xuICAgIHV0aWwucHJpbnQuZXJyb3IoYERvZXNuJ3QgbG9vayBsaWtlIHZhbGlkIFVSTDogJHtib3RVcmx9YClcbiAgICByZXR1cm5cbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyB0b2tlbiwga2luZCB9ID0gYXdhaXQgZG9Mb2dpbihib3RVcmwpXG4gICAgY29uc3QgYXV0aCA9IHJlYWRCb3RBdXRoKClcbiAgICBhdXRoW2JvdFVybF0gPSB0b2tlblxuICAgIHdyaXRlQm90QXV0aChhdXRoKVxuICAgIGlmIChraW5kID09PSAnbG9naW4nKSB7XG4gICAgICB1dGlsLnByaW50LnN1Y2Nlc3MoYExvZ2dlZCBpbiBzdWNjZXNzZnVsbHkuIEF1dGggdG9rZW4gc2F2ZWQgaW4gJHtnZXRBdXRoRmlsZSgpfS5gKVxuICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3JlZnJlc2gnKSB7XG4gICAgICB1dGlsLnByaW50LnN1Y2Nlc3MoYEF1dGggdG9rZW4gcmVmcmVzaGVkIGFuZCBzYXZlZCBpbiAke2dldEF1dGhGaWxlKCl9LmApXG4gICAgfSBlbHNlIGlmIChraW5kID09PSAnbm8tYXV0aCcpIHtcbiAgICAgIHV0aWwucHJpbnQuaW5mbyhgQXV0aCBpcyBkaXNhYmxlZCBhdCAke2JvdFVybH0sIG5vIG5lZWQgdG8gbG9naW4uYClcbiAgICB9XG4gICAgcmV0dXJuIHRva2VuXG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHV0aWwucHJpbnQuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgJ1Vua25vd24nKVxuICAgIHJldHVyblxuICB9XG59XG5cbmV4cG9ydHMubG9nb3V0ID0gYm90VXJsID0+IHtcbiAgaWYgKCFib3RVcmwpIHtcbiAgICBuZXcgQ29uZmlybShcIllvdSdyZSBhYm91dCB0byBkZWxldGUgYWxsIHNhdmVkIGF1dGggdG9rZW5zIGluIHRoZSBjdXJyZW50IGZvbGRlci4gQXJlIHlvdSBzdXJlP1wiKVxuICAgICAgLnJ1bigpXG4gICAgICAudGhlbihhbnN3ZXIgPT4ge1xuICAgICAgICBpZiAoIWFuc3dlcikge1xuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIHdyaXRlQm90QXV0aCh7fSlcbiAgICAgICAgd3JpdGVDbG91ZEF1dGgoe30pXG4gICAgICB9KVxuXG4gICAgcmV0dXJuXG4gIH1cblxuICBib3RVcmwgPSBib3RVcmwucmVwbGFjZSgvXFwvKyQvLCAnJylcbiAgY29uc3QgYXV0aCA9IHJlYWRCb3RBdXRoKClcbiAgaWYgKCFhdXRoW2JvdFVybF0pIHtcbiAgICB1dGlsLnByaW50Lndhcm4oYE5vIHNhdmVkIHRva2VuIGZvciAke2JvdFVybH0sIG5vdGhpbmcgdG8gZG8uYClcbiAgICByZXR1cm5cbiAgfVxuXG4gIGRlbGV0ZSBhdXRoW2JvdFVybF1cbiAgd3JpdGVCb3RBdXRoKGF1dGgpXG4gIHV0aWwucHJpbnQuc3VjY2VzcygnTG9nZ2VkIG91dCBzdWNjZXNzZnVsbHkuJylcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/cli/auth.js\n");

/***/ }),

/***/ "./src/cli/cloudPair.js":
/*!******************************!*\
  !*** ./src/cli/cloudPair.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _axios = __webpack_require__(/*! axios */ \"axios\");\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar hostnameRegex = /^(http|https):\\/\\/(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]).)*([A-Za-z]|[A-Za-z][A-Za-z0-9-]*[A-Za-z0-9])(:\\d+)?$/gi;\n\nmodule.exports = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(token, options) {\n    var opts, projectPath, endpoint, filePath, packagePath, _eval, name, description, pairUrl, _ref2, data, _data$payload, botId, teamId, content, message;\n\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            opts = options.opts();\n            projectPath = _path2.default.resolve('.');\n            endpoint = opts.endpoint;\n\n            if (!(!token || !token.length)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt('return', _util.print.error('Please provide a valid token. e.g. \"botpress cloud-pair your-secret-token\"'));\n\n          case 5:\n            if (hostnameRegex.test(endpoint)) {\n              _context.next = 7;\n              break;\n            }\n\n            return _context.abrupt('return', _util.print.error('Invalid endpoint: \"' + endpoint + '\". Endpoint must start with \\'http\\' or \\'https\\' and must not contain a trailing slash.'));\n\n          case 7:\n            filePath = _path2.default.resolve(projectPath, 'bp-cloud.json');\n\n            if (!_fs2.default.existsSync(filePath)) {\n              _context.next = 10;\n              break;\n            }\n\n            return _context.abrupt('return', _util.print.error('This bot is already paired with Botpress Cloud. If you believe this is an error, delete this file and try again: \"' + filePath + '\"'));\n\n          case 10:\n            packagePath = _path2.default.resolve(projectPath, 'package.json');\n\n            if (_fs2.default.existsSync(packagePath)) {\n              _context.next = 13;\n              break;\n            }\n\n            return _context.abrupt('return', _util.print.error('This does not look like a valid project root. Please run this command at the root of your bot.'));\n\n          case 13:\n            _eval = eval('require')(packagePath), name = _eval.name, description = _eval.description; // eslint-disable-line\n\n            pairUrl = endpoint + '/api/pairing';\n            _context.prev = 15;\n            _context.next = 18;\n            return _axios2.default.post(pairUrl, { token: token, name: name, description: description });\n\n          case 18:\n            _ref2 = _context.sent;\n            data = _ref2.data;\n            _data$payload = data.payload, botId = _data$payload.botId, teamId = _data$payload.teamId;\n            content = {\n              botId: botId,\n              teamId: teamId,\n              token: token,\n              endpoint: endpoint\n            };\n\n\n            _fs2.default.writeFileSync(filePath, JSON.stringify(content, null, 2), 'utf8');\n            _context.next = 29;\n            break;\n\n          case 25:\n            _context.prev = 25;\n            _context.t0 = _context['catch'](15);\n            message = _lodash2.default.get(_context.t0, 'response.data.message') || _context.t0.message || 'Unknown error';\n            return _context.abrupt('return', _util.print.error('Failed to pair the bot: \"' + message + '\"'));\n\n          case 29:\n\n            _util.print.success('Bot paired successfully');\n\n          case 30:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined, [[15, 25]]);\n  }));\n\n  return function (_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2Nsb3VkUGFpci5qcz8yZjljIl0sIm5hbWVzIjpbImhvc3RuYW1lUmVnZXgiLCJtb2R1bGUiLCJleHBvcnRzIiwidG9rZW4iLCJvcHRpb25zIiwib3B0cyIsInByb2plY3RQYXRoIiwicGF0aCIsInJlc29sdmUiLCJlbmRwb2ludCIsImxlbmd0aCIsInByaW50IiwiZXJyb3IiLCJ0ZXN0IiwiZmlsZVBhdGgiLCJmcyIsImV4aXN0c1N5bmMiLCJwYWNrYWdlUGF0aCIsImV2YWwiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJwYWlyVXJsIiwiYXhpb3MiLCJwb3N0IiwiZGF0YSIsInBheWxvYWQiLCJib3RJZCIsInRlYW1JZCIsImNvbnRlbnQiLCJ3cml0ZUZpbGVTeW5jIiwiSlNPTiIsInN0cmluZ2lmeSIsIm1lc3NhZ2UiLCJfIiwiZ2V0Iiwic3VjY2VzcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFFQSxJQUFNQSxnQkFBZ0Isd0hBQXRCOztBQUVBQyxPQUFPQyxPQUFQO0FBQUEscUVBQWlCLGlCQUFPQyxLQUFQLEVBQWNDLE9BQWQ7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNUQyxnQkFEUyxHQUNGRCxRQUFRQyxJQUFSLEVBREU7QUFFVEMsdUJBRlMsR0FFS0MsZUFBS0MsT0FBTCxDQUFhLEdBQWIsQ0FGTDtBQUdUQyxvQkFIUyxHQUdFSixLQUFLSSxRQUhQOztBQUFBLGtCQUtYLENBQUNOLEtBQUQsSUFBVSxDQUFDQSxNQUFNTyxNQUxOO0FBQUE7QUFBQTtBQUFBOztBQUFBLDZDQU1OQyxZQUFNQyxLQUFOLENBQVksNEVBQVosQ0FOTTs7QUFBQTtBQUFBLGdCQVNWWixjQUFjYSxJQUFkLENBQW1CSixRQUFuQixDQVRVO0FBQUE7QUFBQTtBQUFBOztBQUFBLDZDQVVORSxZQUFNQyxLQUFOLHlCQUNpQkgsUUFEakIsOEZBVk07O0FBQUE7QUFlVEssb0JBZlMsR0FlRVAsZUFBS0MsT0FBTCxDQUFhRixXQUFiLEVBQTBCLGVBQTFCLENBZkY7O0FBQUEsaUJBaUJYUyxhQUFHQyxVQUFILENBQWNGLFFBQWQsQ0FqQlc7QUFBQTtBQUFBO0FBQUE7O0FBQUEsNkNBa0JOSCxZQUFNQyxLQUFOLHdIQUNnSEUsUUFEaEgsT0FsQk07O0FBQUE7QUF1QlRHLHVCQXZCUyxHQXVCS1YsZUFBS0MsT0FBTCxDQUFhRixXQUFiLEVBQTBCLGNBQTFCLENBdkJMOztBQUFBLGdCQXlCVlMsYUFBR0MsVUFBSCxDQUFjQyxXQUFkLENBekJVO0FBQUE7QUFBQTtBQUFBOztBQUFBLDZDQTBCTk4sWUFBTUMsS0FBTixrR0ExQk07O0FBQUE7QUFBQSxvQkE2QmVNLEtBQUssU0FBTCxFQUFnQkQsV0FBaEIsQ0E3QmYsRUE2QlBFLElBN0JPLFNBNkJQQSxJQTdCTyxFQTZCREMsV0E3QkMsU0E2QkRBLFdBN0JDLEVBNkI0Qzs7QUFFckRDLG1CQS9CUyxHQStCSVosUUEvQko7QUFBQTtBQUFBO0FBQUEsbUJBa0NVYSxnQkFBTUMsSUFBTixDQUFXRixPQUFYLEVBQW9CLEVBQUVsQixZQUFGLEVBQVNnQixVQUFULEVBQWVDLHdCQUFmLEVBQXBCLENBbENWOztBQUFBO0FBQUE7QUFrQ0xJLGdCQWxDSyxTQWtDTEEsSUFsQ0s7QUFBQSw0QkFvQ2FBLEtBQUtDLE9BcENsQixFQW9DTEMsS0FwQ0ssaUJBb0NMQSxLQXBDSyxFQW9DRUMsTUFwQ0YsaUJBb0NFQSxNQXBDRjtBQXNDUEMsbUJBdENPLEdBc0NHO0FBQ2RGLDBCQURjO0FBRWRDLDRCQUZjO0FBR2R4QiwwQkFIYztBQUlkTTtBQUpjLGFBdENIOzs7QUE2Q2JNLHlCQUFHYyxhQUFILENBQWlCZixRQUFqQixFQUEyQmdCLEtBQUtDLFNBQUwsQ0FBZUgsT0FBZixFQUF3QixJQUF4QixFQUE4QixDQUE5QixDQUEzQixFQUE2RCxNQUE3RDtBQTdDYTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQStDUEksbUJBL0NPLEdBK0NHQyxpQkFBRUMsR0FBRixjQUFXLHVCQUFYLEtBQXVDLFlBQUlGLE9BQTNDLElBQXNELGVBL0N6RDtBQUFBLDZDQWdETnJCLFlBQU1DLEtBQU4sK0JBQXdDb0IsT0FBeEMsT0FoRE07O0FBQUE7O0FBbURmckIsd0JBQU13QixPQUFOLENBQWMseUJBQWQ7O0FBbkRlO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWpCOztBQUFBO0FBQUE7QUFBQTtBQUFBIiwiZmlsZSI6Ii4vc3JjL2NsaS9jbG91ZFBhaXIuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJ1xuaW1wb3J0IHsgcHJpbnQgfSBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5jb25zdCBob3N0bmFtZVJlZ2V4ID0gL14oaHR0cHxodHRwcyk6XFwvXFwvKChbYS16QS1aXXxbYS16QS1aXVthLXpBLVowLTktXSpbYS16QS1aMC05XSkuKSooW0EtWmEtel18W0EtWmEtel1bQS1aYS16MC05LV0qW0EtWmEtejAtOV0pKDpcXGQrKT8kL2dpXG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKHRva2VuLCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdHMgPSBvcHRpb25zLm9wdHMoKVxuICBjb25zdCBwcm9qZWN0UGF0aCA9IHBhdGgucmVzb2x2ZSgnLicpXG4gIGNvbnN0IGVuZHBvaW50ID0gb3B0cy5lbmRwb2ludFxuXG4gIGlmICghdG9rZW4gfHwgIXRva2VuLmxlbmd0aCkge1xuICAgIHJldHVybiBwcmludC5lcnJvcignUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCB0b2tlbi4gZS5nLiBcImJvdHByZXNzIGNsb3VkLXBhaXIgeW91ci1zZWNyZXQtdG9rZW5cIicpXG4gIH1cblxuICBpZiAoIWhvc3RuYW1lUmVnZXgudGVzdChlbmRwb2ludCkpIHtcbiAgICByZXR1cm4gcHJpbnQuZXJyb3IoXG4gICAgICBgSW52YWxpZCBlbmRwb2ludDogXCIke2VuZHBvaW50fVwiLiBFbmRwb2ludCBtdXN0IHN0YXJ0IHdpdGggJ2h0dHAnIG9yICdodHRwcycgYW5kIG11c3Qgbm90IGNvbnRhaW4gYSB0cmFpbGluZyBzbGFzaC5gXG4gICAgKVxuICB9XG5cbiAgY29uc3QgZmlsZVBhdGggPSBwYXRoLnJlc29sdmUocHJvamVjdFBhdGgsICdicC1jbG91ZC5qc29uJylcblxuICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICByZXR1cm4gcHJpbnQuZXJyb3IoXG4gICAgICBgVGhpcyBib3QgaXMgYWxyZWFkeSBwYWlyZWQgd2l0aCBCb3RwcmVzcyBDbG91ZC4gSWYgeW91IGJlbGlldmUgdGhpcyBpcyBhbiBlcnJvciwgZGVsZXRlIHRoaXMgZmlsZSBhbmQgdHJ5IGFnYWluOiBcIiR7ZmlsZVBhdGh9XCJgXG4gICAgKVxuICB9XG5cbiAgY29uc3QgcGFja2FnZVBhdGggPSBwYXRoLnJlc29sdmUocHJvamVjdFBhdGgsICdwYWNrYWdlLmpzb24nKVxuXG4gIGlmICghZnMuZXhpc3RzU3luYyhwYWNrYWdlUGF0aCkpIHtcbiAgICByZXR1cm4gcHJpbnQuZXJyb3IoYFRoaXMgZG9lcyBub3QgbG9vayBsaWtlIGEgdmFsaWQgcHJvamVjdCByb290LiBQbGVhc2UgcnVuIHRoaXMgY29tbWFuZCBhdCB0aGUgcm9vdCBvZiB5b3VyIGJvdC5gKVxuICB9XG5cbiAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiB9ID0gZXZhbCgncmVxdWlyZScpKHBhY2thZ2VQYXRoKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgY29uc3QgcGFpclVybCA9IGAke2VuZHBvaW50fS9hcGkvcGFpcmluZ2BcblxuICB0cnkge1xuICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYXhpb3MucG9zdChwYWlyVXJsLCB7IHRva2VuLCBuYW1lLCBkZXNjcmlwdGlvbiB9KVxuXG4gICAgY29uc3QgeyBib3RJZCwgdGVhbUlkIH0gPSBkYXRhLnBheWxvYWRcblxuICAgIGNvbnN0IGNvbnRlbnQgPSB7XG4gICAgICBib3RJZCxcbiAgICAgIHRlYW1JZCxcbiAgICAgIHRva2VuLFxuICAgICAgZW5kcG9pbnRcbiAgICB9XG5cbiAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShjb250ZW50LCBudWxsLCAyKSwgJ3V0ZjgnKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gXy5nZXQoZXJyLCAncmVzcG9uc2UuZGF0YS5tZXNzYWdlJykgfHwgZXJyLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InXG4gICAgcmV0dXJuIHByaW50LmVycm9yKGBGYWlsZWQgdG8gcGFpciB0aGUgYm90OiBcIiR7bWVzc2FnZX1cImApXG4gIH1cblxuICBwcmludC5zdWNjZXNzKCdCb3QgcGFpcmVkIHN1Y2Nlc3NmdWxseScpXG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/cli/cloudPair.js\n");

/***/ }),

/***/ "./src/cli/create.js":
/*!***************************!*\
  !*** ./src/cli/create.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _templateObject = _taggedTemplateLiteral(['\\n{dim ---------------}\\nThis tool will bootstrap a new {bold Botpress} module for you.\\nFor more information or help, please visit {underline https://botpress.io/docs}\\n{dim ---------------}'], ['\\n{dim ---------------}\\nThis tool will bootstrap a new {bold Botpress} module for you.\\nFor more information or help, please visit {underline https://botpress.io/docs}\\n{dim ---------------}']),\n    _templateObject2 = _taggedTemplateLiteral(['\\n{green \\uD83C\\uDF89  Your module was successfully bootstraped!}\\n\\n{yellow Next steps:}\\n  {yellow 1)} Install the dependencies by running {bold npm install} (or {bold yarn install})\\n  {yellow 2)} Compile the module using {bold npm run compile} (or {bold yarn run compile})\\n  {yellow 3)} Link the module to ease development and testing using {bold npm link}\\n  {yellow 4)} Install the module in your testing bot using {bold npm install --save path/to/the/module}\\n  {yellow 5)} Link the module using {bold npm link MODULE-NAME}\\n\\n{bold Enjoy Botpress!}\\n'], ['\\n{green \\uD83C\\uDF89  Your module was successfully bootstraped!}\\n\\n{yellow Next steps:}\\n  {yellow 1)} Install the dependencies by running {bold npm install} (or {bold yarn install})\\n  {yellow 2)} Compile the module using {bold npm run compile} (or {bold yarn run compile})\\n  {yellow 3)} Link the module to ease development and testing using {bold npm link}\\n  {yellow 4)} Install the module in your testing bot using {bold npm install --save path/to/the/module}\\n  {yellow 5)} Link the module using {bold npm link MODULE-NAME}\\n\\n{bold Enjoy Botpress!}\\n']),\n    _templateObject3 = _taggedTemplateLiteral(['\\n{red Fatal Error} You need to run this command in an empty directory.\\n'], ['\\n{red Fatal Error} You need to run this command in an empty directory.\\n']),\n    _templateObject4 = _taggedTemplateLiteral(['\\n{red Fatal Error} Template {bold ', '} not found.\\n'], ['\\n{red Fatal Error} Template {bold ', '} not found.\\n']),\n    _templateObject5 = _taggedTemplateLiteral(['{dim -> Copying ', '}'], ['{dim -> Copying ', '}']);\n\nvar _child_process = __webpack_require__(/*! child_process */ \"child_process\");\n\nvar _prompt = __webpack_require__(/*! prompt */ \"prompt\");\n\nvar _prompt2 = _interopRequireDefault(_prompt);\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _mkdirp = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n\nvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _glob = __webpack_require__(/*! glob */ \"glob\");\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _stats = __webpack_require__(/*! ../stats */ \"./src/stats.js\");\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nvar introductionText = (0, _chalk2.default)(_templateObject);\n\nvar nextStepText = (0, _chalk2.default)(_templateObject2);\n\nvar invalidDirectoryError = (0, _chalk2.default)(_templateObject3);\n\nvar templateNotFoundError = function templateNotFoundError(template) {\n  return (0, _chalk2.default)(_templateObject4, template);\n};\n\nvar copyingFile = function copyingFile(name) {\n  return (0, _chalk2.default)(_templateObject5, name);\n};\n\nvar assertDoesntExist = function assertDoesntExist(file) {\n  if (_fs2.default.existsSync(file)) {\n    console.log(invalidDirectoryError);\n    process.exit(1);\n  }\n};\n\n/**\n * Loads a template a returns a map of files and content\n * @param  {string} name The name of the template to load\n * @return {object} A map of files `{ path: content }``\n * @private\n */\nvar loadTemplate = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(name) {\n    var templatePath, infoFile, files;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            templatePath = _path2.default.join(__dirname, 'cli/templates/' + name);\n            infoFile = _path2.default.join(templatePath, 'info.json');\n\n\n            if (!_fs2.default.existsSync) {\n              console.log(templateNotFoundError(name));\n              process.exit(1);\n            }\n\n            _context.next = 5;\n            return _bluebird2.default.fromCallback(function (cb) {\n              return (0, _glob2.default)('**/*.*', { cwd: templatePath, dot: true }, cb);\n            });\n\n          case 5:\n            files = _context.sent;\n            return _context.abrupt('return', _lodash2.default.reduce(files, function (obj, file) {\n              var filePath = _path2.default.join(templatePath, file);\n              obj[file] = _fs2.default.readFileSync(filePath).toString();\n              return obj;\n            }, {}));\n\n          case 7:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function loadTemplate(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar generate = function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(result) {\n    var files, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _ref3, _ref4, name, content, compiled, directory;\n\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return loadTemplate('create-default');\n\n          case 2:\n            files = _context2.sent;\n            _iteratorNormalCompletion = true;\n            _didIteratorError = false;\n            _iteratorError = undefined;\n            _context2.prev = 6;\n\n\n            for (_iterator = Object.entries(files)[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              _ref3 = _step.value;\n              _ref4 = _slicedToArray(_ref3, 2);\n              name = _ref4[0];\n              content = _ref4[1];\n\n              console.log(copyingFile(name));\n              compiled = _lodash2.default.template(content, { interpolate: /<%=([\\s\\S]+?)%>/g });\n              directory = _path2.default.dirname(name);\n\n              if (directory.length) {\n                _mkdirp2.default.sync(directory);\n              }\n\n              _fs2.default.writeFileSync(name, compiled(result));\n            }\n\n            _context2.next = 14;\n            break;\n\n          case 10:\n            _context2.prev = 10;\n            _context2.t0 = _context2['catch'](6);\n            _didIteratorError = true;\n            _iteratorError = _context2.t0;\n\n          case 14:\n            _context2.prev = 14;\n            _context2.prev = 15;\n\n            if (!_iteratorNormalCompletion && _iterator.return) {\n              _iterator.return();\n            }\n\n          case 17:\n            _context2.prev = 17;\n\n            if (!_didIteratorError) {\n              _context2.next = 20;\n              break;\n            }\n\n            throw _iteratorError;\n\n          case 20:\n            return _context2.finish(17);\n\n          case 21:\n            return _context2.finish(14);\n\n          case 22:\n            console.log(nextStepText);\n\n          case 23:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, undefined, [[6, 10, 14, 22], [15,, 17, 21]]);\n  }));\n\n  return function generate(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nmodule.exports = function () {\n  console.log(introductionText);\n\n  var moduleDirectory = _path2.default.resolve('.');\n  var dirname = _path2.default.basename(moduleDirectory);\n\n  (0, _stats2.default)({}).track('cli', 'modules', 'create');\n\n  _lodash2.default.each(['package.json', 'botfile.js', 'index.js'], assertDoesntExist);\n\n  var schema = {\n    properties: {\n      name: {\n        description: _chalk2.default.white('module name:'),\n        pattern: /^(\\@botpress\\/|botpress-)[a-z0-9][a-z0-9-_\\.]+$/,\n        message: 'Name must be only lowercase letters, digits, dashes, underscores and dots.\\nIt must also start with \"@botpress/\" or \"botpress-\"',\n        required: true,\n        default: dirname\n      },\n      description: {\n        required: false,\n        description: _chalk2.default.white('description:')\n      },\n      author: {\n        required: false,\n        description: _chalk2.default.white('author:')\n      }\n    }\n  };\n\n  _prompt2.default.message = '';\n  _prompt2.default.delimiter = '';\n  _prompt2.default.start();\n\n  _prompt2.default.get(schema, function (err, result) {\n    generate(result);\n  });\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2NyZWF0ZS5qcz8zYzRhIl0sIm5hbWVzIjpbImludHJvZHVjdGlvblRleHQiLCJjaGFsayIsIm5leHRTdGVwVGV4dCIsImludmFsaWREaXJlY3RvcnlFcnJvciIsInRlbXBsYXRlTm90Rm91bmRFcnJvciIsInRlbXBsYXRlIiwiY29weWluZ0ZpbGUiLCJuYW1lIiwiYXNzZXJ0RG9lc250RXhpc3QiLCJmcyIsImV4aXN0c1N5bmMiLCJmaWxlIiwiY29uc29sZSIsImxvZyIsInByb2Nlc3MiLCJleGl0IiwibG9hZFRlbXBsYXRlIiwidGVtcGxhdGVQYXRoIiwicGF0aCIsImpvaW4iLCJfX2Rpcm5hbWUiLCJpbmZvRmlsZSIsIlByb21pc2UiLCJmcm9tQ2FsbGJhY2siLCJjd2QiLCJkb3QiLCJjYiIsImZpbGVzIiwiXyIsInJlZHVjZSIsIm9iaiIsImZpbGVQYXRoIiwicmVhZEZpbGVTeW5jIiwidG9TdHJpbmciLCJnZW5lcmF0ZSIsInJlc3VsdCIsIk9iamVjdCIsImVudHJpZXMiLCJjb250ZW50IiwiY29tcGlsZWQiLCJpbnRlcnBvbGF0ZSIsImRpcmVjdG9yeSIsImRpcm5hbWUiLCJsZW5ndGgiLCJta2RpcnAiLCJzeW5jIiwid3JpdGVGaWxlU3luYyIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGVEaXJlY3RvcnkiLCJyZXNvbHZlIiwiYmFzZW5hbWUiLCJ0cmFjayIsImVhY2giLCJzY2hlbWEiLCJwcm9wZXJ0aWVzIiwiZGVzY3JpcHRpb24iLCJ3aGl0ZSIsInBhdHRlcm4iLCJtZXNzYWdlIiwicmVxdWlyZWQiLCJkZWZhdWx0IiwiYXV0aG9yIiwicHJvbXB0IiwiZGVsaW1pdGVyIiwic3RhcnQiLCJnZXQiLCJlcnIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSx1QkFBbUJDLGVBQW5CLGtCQUFOOztBQU1BLElBQU1DLG1CQUFlRCxlQUFmLG1CQUFOOztBQWFBLElBQU1FLDRCQUF3QkYsZUFBeEIsbUJBQU47O0FBSUEsSUFBTUcsd0JBQXdCLFNBQXhCQSxxQkFBd0I7QUFBQSxhQUFZSCxlQUFaLG9CQUNLSSxRQURMO0FBQUEsQ0FBOUI7O0FBSUEsSUFBTUMsY0FBYyxTQUFkQSxXQUFjO0FBQUEsYUFBUUwsZUFBUixvQkFBZ0NNLElBQWhDO0FBQUEsQ0FBcEI7O0FBRUEsSUFBTUMsb0JBQW9CLFNBQXBCQSxpQkFBb0IsT0FBUTtBQUNoQyxNQUFJQyxhQUFHQyxVQUFILENBQWNDLElBQWQsQ0FBSixFQUF5QjtBQUN2QkMsWUFBUUMsR0FBUixDQUFZVixxQkFBWjtBQUNBVyxZQUFRQyxJQUFSLENBQWEsQ0FBYjtBQUNEO0FBQ0YsQ0FMRDs7QUFPQTs7Ozs7O0FBTUEsSUFBTUM7QUFBQSxxRUFBZSxpQkFBTVQsSUFBTjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDYlUsd0JBRGEsR0FDRUMsZUFBS0MsSUFBTCxDQUFVQyxTQUFWLEVBQXFCLG1CQUFtQmIsSUFBeEMsQ0FERjtBQUViYyxvQkFGYSxHQUVGSCxlQUFLQyxJQUFMLENBQVVGLFlBQVYsRUFBd0IsV0FBeEIsQ0FGRTs7O0FBSW5CLGdCQUFJLENBQUNSLGFBQUdDLFVBQVIsRUFBb0I7QUFDbEJFLHNCQUFRQyxHQUFSLENBQVlULHNCQUFzQkcsSUFBdEIsQ0FBWjtBQUNBTyxzQkFBUUMsSUFBUixDQUFhLENBQWI7QUFDRDs7QUFQa0I7QUFBQSxtQkFTQ08sbUJBQVFDLFlBQVIsQ0FBcUI7QUFBQSxxQkFBTSxvQkFBSyxRQUFMLEVBQWUsRUFBRUMsS0FBS1AsWUFBUCxFQUFxQlEsS0FBSyxJQUExQixFQUFmLEVBQWlEQyxFQUFqRCxDQUFOO0FBQUEsYUFBckIsQ0FURDs7QUFBQTtBQVNiQyxpQkFUYTtBQUFBLDZDQVdaQyxpQkFBRUMsTUFBRixDQUNMRixLQURLLEVBRUwsVUFBQ0csR0FBRCxFQUFNbkIsSUFBTixFQUFlO0FBQ2Isa0JBQU1vQixXQUFXYixlQUFLQyxJQUFMLENBQVVGLFlBQVYsRUFBd0JOLElBQXhCLENBQWpCO0FBQ0FtQixrQkFBSW5CLElBQUosSUFBWUYsYUFBR3VCLFlBQUgsQ0FBZ0JELFFBQWhCLEVBQTBCRSxRQUExQixFQUFaO0FBQ0EscUJBQU9ILEdBQVA7QUFDRCxhQU5JLEVBT0wsRUFQSyxDQVhZOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWY7O0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBTjs7QUFzQkEsSUFBTUk7QUFBQSxzRUFBVyxrQkFBTUMsTUFBTjtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxtQkFDS25CLGFBQWEsZ0JBQWIsQ0FETDs7QUFBQTtBQUNUVyxpQkFEUztBQUFBO0FBQUE7QUFBQTtBQUFBOzs7QUFHZiw2QkFBOEJTLE9BQU9DLE9BQVAsQ0FBZVYsS0FBZixDQUE5Qix1SEFBcUQ7QUFBQTtBQUFBO0FBQXpDcEIsa0JBQXlDO0FBQW5DK0IscUJBQW1DOztBQUNuRDFCLHNCQUFRQyxHQUFSLENBQVlQLFlBQVlDLElBQVosQ0FBWjtBQUNNZ0Msc0JBRjZDLEdBRWxDWCxpQkFBRXZCLFFBQUYsQ0FBV2lDLE9BQVgsRUFBb0IsRUFBRUUsYUFBYSxrQkFBZixFQUFwQixDQUZrQztBQUc3Q0MsdUJBSDZDLEdBR2pDdkIsZUFBS3dCLE9BQUwsQ0FBYW5DLElBQWIsQ0FIaUM7O0FBSW5ELGtCQUFJa0MsVUFBVUUsTUFBZCxFQUFzQjtBQUNwQkMsaUNBQU9DLElBQVAsQ0FBWUosU0FBWjtBQUNEOztBQUVEaEMsMkJBQUdxQyxhQUFILENBQWlCdkMsSUFBakIsRUFBdUJnQyxTQUFTSixNQUFULENBQXZCO0FBQ0Q7O0FBWmM7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFjZnZCLG9CQUFRQyxHQUFSLENBQVlYLFlBQVo7O0FBZGU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBWDs7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUFOOztBQWlCQTZDLE9BQU9DLE9BQVAsR0FBaUIsWUFBTTtBQUNyQnBDLFVBQVFDLEdBQVIsQ0FBWWIsZ0JBQVo7O0FBRUEsTUFBTWlELGtCQUFrQi9CLGVBQUtnQyxPQUFMLENBQWEsR0FBYixDQUF4QjtBQUNBLE1BQU1SLFVBQVV4QixlQUFLaUMsUUFBTCxDQUFjRixlQUFkLENBQWhCOztBQUVBLHVCQUFNLEVBQU4sRUFBVUcsS0FBVixDQUFnQixLQUFoQixFQUF1QixTQUF2QixFQUFrQyxRQUFsQzs7QUFFQXhCLG1CQUFFeUIsSUFBRixDQUFPLENBQUMsY0FBRCxFQUFpQixZQUFqQixFQUErQixVQUEvQixDQUFQLEVBQW1EN0MsaUJBQW5EOztBQUVBLE1BQU04QyxTQUFTO0FBQ2JDLGdCQUFZO0FBQ1ZoRCxZQUFNO0FBQ0ppRCxxQkFBYXZELGdCQUFNd0QsS0FBTixDQUFZLGNBQVosQ0FEVDtBQUVKQyxpQkFBUyxpREFGTDtBQUdKQyxrSkFISTtBQUtKQyxrQkFBVSxJQUxOO0FBTUpDLGlCQUFTbkI7QUFOTCxPQURJO0FBU1ZjLG1CQUFhO0FBQ1hJLGtCQUFVLEtBREM7QUFFWEoscUJBQWF2RCxnQkFBTXdELEtBQU4sQ0FBWSxjQUFaO0FBRkYsT0FUSDtBQWFWSyxjQUFRO0FBQ05GLGtCQUFVLEtBREo7QUFFTkoscUJBQWF2RCxnQkFBTXdELEtBQU4sQ0FBWSxTQUFaO0FBRlA7QUFiRTtBQURDLEdBQWY7O0FBcUJBTSxtQkFBT0osT0FBUCxHQUFpQixFQUFqQjtBQUNBSSxtQkFBT0MsU0FBUCxHQUFtQixFQUFuQjtBQUNBRCxtQkFBT0UsS0FBUDs7QUFFQUYsbUJBQU9HLEdBQVAsQ0FBV1osTUFBWCxFQUFtQixVQUFDYSxHQUFELEVBQU1oQyxNQUFOLEVBQWlCO0FBQ2xDRCxhQUFTQyxNQUFUO0FBQ0QsR0FGRDtBQUdELENBdENEIiwiZmlsZSI6Ii4vc3JjL2NsaS9jcmVhdGUuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcGF3biB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnXG5pbXBvcnQgcHJvbXB0IGZyb20gJ3Byb21wdCdcbmltcG9ydCBjaGFsayBmcm9tICdjaGFsaydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgbWtkaXJwIGZyb20gJ21rZGlycCdcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBnbG9iIGZyb20gJ2dsb2InXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxuaW1wb3J0IHN0YXRzIGZyb20gJy4uL3N0YXRzJ1xuXG5jb25zdCBpbnRyb2R1Y3Rpb25UZXh0ID0gY2hhbGtgXG57ZGltIC0tLS0tLS0tLS0tLS0tLX1cblRoaXMgdG9vbCB3aWxsIGJvb3RzdHJhcCBhIG5ldyB7Ym9sZCBCb3RwcmVzc30gbW9kdWxlIGZvciB5b3UuXG5Gb3IgbW9yZSBpbmZvcm1hdGlvbiBvciBoZWxwLCBwbGVhc2UgdmlzaXQge3VuZGVybGluZSBodHRwczovL2JvdHByZXNzLmlvL2RvY3N9XG57ZGltIC0tLS0tLS0tLS0tLS0tLX1gXG5cbmNvbnN0IG5leHRTdGVwVGV4dCA9IGNoYWxrYFxue2dyZWVuIPCfjokgIFlvdXIgbW9kdWxlIHdhcyBzdWNjZXNzZnVsbHkgYm9vdHN0cmFwZWQhfVxuXG57eWVsbG93IE5leHQgc3RlcHM6fVxuICB7eWVsbG93IDEpfSBJbnN0YWxsIHRoZSBkZXBlbmRlbmNpZXMgYnkgcnVubmluZyB7Ym9sZCBucG0gaW5zdGFsbH0gKG9yIHtib2xkIHlhcm4gaW5zdGFsbH0pXG4gIHt5ZWxsb3cgMil9IENvbXBpbGUgdGhlIG1vZHVsZSB1c2luZyB7Ym9sZCBucG0gcnVuIGNvbXBpbGV9IChvciB7Ym9sZCB5YXJuIHJ1biBjb21waWxlfSlcbiAge3llbGxvdyAzKX0gTGluayB0aGUgbW9kdWxlIHRvIGVhc2UgZGV2ZWxvcG1lbnQgYW5kIHRlc3RpbmcgdXNpbmcge2JvbGQgbnBtIGxpbmt9XG4gIHt5ZWxsb3cgNCl9IEluc3RhbGwgdGhlIG1vZHVsZSBpbiB5b3VyIHRlc3RpbmcgYm90IHVzaW5nIHtib2xkIG5wbSBpbnN0YWxsIC0tc2F2ZSBwYXRoL3RvL3RoZS9tb2R1bGV9XG4gIHt5ZWxsb3cgNSl9IExpbmsgdGhlIG1vZHVsZSB1c2luZyB7Ym9sZCBucG0gbGluayBNT0RVTEUtTkFNRX1cblxue2JvbGQgRW5qb3kgQm90cHJlc3MhfVxuYFxuXG5jb25zdCBpbnZhbGlkRGlyZWN0b3J5RXJyb3IgPSBjaGFsa2BcbntyZWQgRmF0YWwgRXJyb3J9IFlvdSBuZWVkIHRvIHJ1biB0aGlzIGNvbW1hbmQgaW4gYW4gZW1wdHkgZGlyZWN0b3J5LlxuYFxuXG5jb25zdCB0ZW1wbGF0ZU5vdEZvdW5kRXJyb3IgPSB0ZW1wbGF0ZSA9PiBjaGFsa2BcbntyZWQgRmF0YWwgRXJyb3J9IFRlbXBsYXRlIHtib2xkICR7dGVtcGxhdGV9fSBub3QgZm91bmQuXG5gXG5cbmNvbnN0IGNvcHlpbmdGaWxlID0gbmFtZSA9PiBjaGFsa2B7ZGltIC0+IENvcHlpbmcgJHtuYW1lfX1gXG5cbmNvbnN0IGFzc2VydERvZXNudEV4aXN0ID0gZmlsZSA9PiB7XG4gIGlmIChmcy5leGlzdHNTeW5jKGZpbGUpKSB7XG4gICAgY29uc29sZS5sb2coaW52YWxpZERpcmVjdG9yeUVycm9yKVxuICAgIHByb2Nlc3MuZXhpdCgxKVxuICB9XG59XG5cbi8qKlxuICogTG9hZHMgYSB0ZW1wbGF0ZSBhIHJldHVybnMgYSBtYXAgb2YgZmlsZXMgYW5kIGNvbnRlbnRcbiAqIEBwYXJhbSAge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUgdG8gbG9hZFxuICogQHJldHVybiB7b2JqZWN0fSBBIG1hcCBvZiBmaWxlcyBgeyBwYXRoOiBjb250ZW50IH1gYFxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgbG9hZFRlbXBsYXRlID0gYXN5bmMgbmFtZSA9PiB7XG4gIGNvbnN0IHRlbXBsYXRlUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICdjbGkvdGVtcGxhdGVzLycgKyBuYW1lKVxuICBjb25zdCBpbmZvRmlsZSA9IHBhdGguam9pbih0ZW1wbGF0ZVBhdGgsICdpbmZvLmpzb24nKVxuXG4gIGlmICghZnMuZXhpc3RzU3luYykge1xuICAgIGNvbnNvbGUubG9nKHRlbXBsYXRlTm90Rm91bmRFcnJvcihuYW1lKSlcbiAgICBwcm9jZXNzLmV4aXQoMSlcbiAgfVxuXG4gIGNvbnN0IGZpbGVzID0gYXdhaXQgUHJvbWlzZS5mcm9tQ2FsbGJhY2soY2IgPT4gZ2xvYignKiovKi4qJywgeyBjd2Q6IHRlbXBsYXRlUGF0aCwgZG90OiB0cnVlIH0sIGNiKSlcblxuICByZXR1cm4gXy5yZWR1Y2UoXG4gICAgZmlsZXMsXG4gICAgKG9iaiwgZmlsZSkgPT4ge1xuICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4odGVtcGxhdGVQYXRoLCBmaWxlKVxuICAgICAgb2JqW2ZpbGVdID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoKS50b1N0cmluZygpXG4gICAgICByZXR1cm4gb2JqXG4gICAgfSxcbiAgICB7fVxuICApXG59XG5cbmNvbnN0IGdlbmVyYXRlID0gYXN5bmMgcmVzdWx0ID0+IHtcbiAgY29uc3QgZmlsZXMgPSBhd2FpdCBsb2FkVGVtcGxhdGUoJ2NyZWF0ZS1kZWZhdWx0JylcblxuICBmb3IgKGNvbnN0IFtuYW1lLCBjb250ZW50XSBvZiBPYmplY3QuZW50cmllcyhmaWxlcykpIHtcbiAgICBjb25zb2xlLmxvZyhjb3B5aW5nRmlsZShuYW1lKSlcbiAgICBjb25zdCBjb21waWxlZCA9IF8udGVtcGxhdGUoY29udGVudCwgeyBpbnRlcnBvbGF0ZTogLzwlPShbXFxzXFxTXSs/KSU+L2cgfSlcbiAgICBjb25zdCBkaXJlY3RvcnkgPSBwYXRoLmRpcm5hbWUobmFtZSlcbiAgICBpZiAoZGlyZWN0b3J5Lmxlbmd0aCkge1xuICAgICAgbWtkaXJwLnN5bmMoZGlyZWN0b3J5KVxuICAgIH1cblxuICAgIGZzLndyaXRlRmlsZVN5bmMobmFtZSwgY29tcGlsZWQocmVzdWx0KSlcbiAgfVxuXG4gIGNvbnNvbGUubG9nKG5leHRTdGVwVGV4dClcbn1cblxubW9kdWxlLmV4cG9ydHMgPSAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKGludHJvZHVjdGlvblRleHQpXG5cbiAgY29uc3QgbW9kdWxlRGlyZWN0b3J5ID0gcGF0aC5yZXNvbHZlKCcuJylcbiAgY29uc3QgZGlybmFtZSA9IHBhdGguYmFzZW5hbWUobW9kdWxlRGlyZWN0b3J5KVxuXG4gIHN0YXRzKHt9KS50cmFjaygnY2xpJywgJ21vZHVsZXMnLCAnY3JlYXRlJylcblxuICBfLmVhY2goWydwYWNrYWdlLmpzb24nLCAnYm90ZmlsZS5qcycsICdpbmRleC5qcyddLCBhc3NlcnREb2VzbnRFeGlzdClcblxuICBjb25zdCBzY2hlbWEgPSB7XG4gICAgcHJvcGVydGllczoge1xuICAgICAgbmFtZToge1xuICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ21vZHVsZSBuYW1lOicpLFxuICAgICAgICBwYXR0ZXJuOiAvXihcXEBib3RwcmVzc1xcL3xib3RwcmVzcy0pW2EtejAtOV1bYS16MC05LV9cXC5dKyQvLFxuICAgICAgICBtZXNzYWdlOiBgTmFtZSBtdXN0IGJlIG9ubHkgbG93ZXJjYXNlIGxldHRlcnMsIGRpZ2l0cywgZGFzaGVzLCB1bmRlcnNjb3JlcyBhbmQgZG90cy5cbkl0IG11c3QgYWxzbyBzdGFydCB3aXRoIFwiQGJvdHByZXNzL1wiIG9yIFwiYm90cHJlc3MtXCJgLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgZGVmYXVsdDogZGlybmFtZVxuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiB7XG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNoYWxrLndoaXRlKCdkZXNjcmlwdGlvbjonKVxuICAgICAgfSxcbiAgICAgIGF1dGhvcjoge1xuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBjaGFsay53aGl0ZSgnYXV0aG9yOicpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJvbXB0Lm1lc3NhZ2UgPSAnJ1xuICBwcm9tcHQuZGVsaW1pdGVyID0gJydcbiAgcHJvbXB0LnN0YXJ0KClcblxuICBwcm9tcHQuZ2V0KHNjaGVtYSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgZ2VuZXJhdGUocmVzdWx0KVxuICB9KVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/cli/create.js\n");

/***/ }),

/***/ "./src/cli/ghost-sync.js":
/*!*******************************!*\
  !*** ./src/cli/ghost-sync.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _os = __webpack_require__(/*! os */ \"os\");\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _axios = __webpack_require__(/*! axios */ \"axios\");\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _promptConfirm = __webpack_require__(/*! prompt-confirm */ \"prompt-confirm\");\n\nvar _promptConfirm2 = _interopRequireDefault(_promptConfirm);\n\nvar _username = __webpack_require__(/*! username */ \"username\");\n\nvar _username2 = _interopRequireDefault(_username);\n\nvar _prependFile = __webpack_require__(/*! prepend-file */ \"prepend-file\");\n\nvar _prependFile2 = _interopRequireDefault(_prependFile);\n\nvar _mapValues = __webpack_require__(/*! lodash/mapValues */ \"lodash/mapValues\");\n\nvar _mapValues2 = _interopRequireDefault(_mapValues);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _ghostContent = __webpack_require__(/*! ../ghost-content */ \"./src/ghost-content/index.js\");\n\nvar _auth = __webpack_require__(/*! ./auth */ \"./src/cli/auth.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\n_bluebird2.default.promisifyAll(_fs2.default);\n\nvar writeRevisions = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(revisionsFile, revisions) {\n    var user, host, fullUser, preamble;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return (0, _username2.default)();\n\n          case 2:\n            user = _context.sent;\n            host = _os2.default.hostname();\n            fullUser = [user, host].filter(Boolean).join('@');\n\n            if (fullUser) {\n              fullUser = ' by ' + fullUser;\n            }\n            preamble = '# Synced ' + new Date().toISOString() + fullUser;\n            return _context.abrupt('return', _bluebird2.default.fromCallback(function (cb) {\n              (0, _prependFile2.default)(revisionsFile, [preamble].concat(_toConsumableArray(revisions), ['']).join('\\n'), cb);\n            }));\n\n          case 8:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function writeRevisions(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar writeFile = function writeFile(folderPath) {\n  return function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(_ref3) {\n      var file = _ref3.file,\n          content = _ref3.content,\n          deleted = _ref3.deleted;\n      var filePath;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              filePath = _path2.default.join(folderPath, file);\n              return _context2.abrupt('return', deleted ? _fs2.default.unlinkAsync(filePath) : _fs2.default.writeFileAsync(filePath, content));\n\n            case 2:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function (_x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\n\nvar updateFolder = function updateFolder(projectLocation) {\n  return function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref5, folder) {\n      var files = _ref5.files,\n          revisions = _ref5.revisions,\n          binary = _ref5.binary;\n      var folderPath, revisionsFile;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              folderPath = _path2.default.join(projectLocation, folder);\n              revisionsFile = _path2.default.join(folderPath, _ghostContent.REVISIONS_FILE_NAME);\n              _context3.next = 4;\n              return writeRevisions(revisionsFile, revisions);\n\n            case 4:\n\n              if (binary) {\n                files.forEach(function (data) {\n                  data.content = Buffer.from(data.content, 'base64');\n                });\n              }\n\n              return _context3.abrupt('return', _bluebird2.default.each(files, writeFile(folderPath)));\n\n            case 6:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function (_x4, _x5) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\n\nmodule.exports = function () {\n  var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(botUrl) {\n    var token, config, _ref7, data, confirm;\n\n    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            botUrl = botUrl.replace(/\\/+$/, '');\n\n            // This also implicitly ensures we're inside of the bot project directory, and validates the bot URL\n            _util.print.info('Checking your login status with ' + botUrl + '...');\n            _context4.next = 4;\n            return (0, _auth.login)(botUrl);\n\n          case 4:\n            token = _context4.sent;\n\n            if (token) {\n              _context4.next = 8;\n              break;\n            }\n\n            _util.print.warn('Login is required for this operation, exiting now.');\n            return _context4.abrupt('return');\n\n          case 8:\n            config = void 0;\n            _context4.prev = 9;\n            _context4.next = 12;\n            return _axios2.default.get(botUrl + '/api/ghost_content/export', {\n              headers: {\n                authorization: 'Bearer ' + token\n              }\n            });\n\n          case 12:\n            _ref7 = _context4.sent;\n            data = _ref7.data;\n\n            config = data;\n            _context4.next = 21;\n            break;\n\n          case 17:\n            _context4.prev = 17;\n            _context4.t0 = _context4['catch'](9);\n\n            _util.print.error(_context4.t0.message || 'Unknown error', 'while fetching ghost content.');\n            return _context4.abrupt('return');\n\n          case 21:\n            if (!(!config || !Object.keys(config).length)) {\n              _context4.next = 24;\n              break;\n            }\n\n            _util.print.info('No pending ghost revisions, nothing to be done here.');\n            return _context4.abrupt('return');\n\n          case 24:\n            _context4.next = 26;\n            return new _promptConfirm2.default('\\n  Running this command will override any untracked / uncommitted changes to the corresponding content files.\\n  It is recommended that you use version control system (like git) and commit any changes before proceeding.\\n  Are you sure you want to continue?\\n  ').run();\n\n          case 26:\n            confirm = _context4.sent;\n\n            if (confirm) {\n              _context4.next = 29;\n              break;\n            }\n\n            return _context4.abrupt('return');\n\n          case 29:\n            _context4.prev = 29;\n            _context4.next = 32;\n            return _bluebird2.default.props((0, _mapValues2.default)(config, updateFolder(_path2.default.resolve('.'))));\n\n          case 32:\n            _util.print.success('\\n    All content synced successfully. You now need to redeploy your bot with the updated content to finish the sync procedure.\\n    If you\\'re using version control system (like git) you should review the changes before committing.\\n    Please don\\'t forget to include (commit, deploy) ' + _ghostContent.REVISIONS_FILE_NAME + ' file(s).\\n    ');\n            _context4.next = 40;\n            break;\n\n          case 35:\n            _context4.prev = 35;\n            _context4.t1 = _context4['catch'](29);\n\n            _util.print.error(_context4.t1.message || 'Unknown error', 'while applying ghost content.');\n            _util.print.error('Your content files may be in inconsistent state.');\n            _util.print.error('It is recommended to reset the changes (like git reset) and try again.');\n\n          case 40:\n          case 'end':\n            return _context4.stop();\n        }\n      }\n    }, _callee4, undefined, [[9, 17], [29, 35]]);\n  }));\n\n  return function (_x6) {\n    return _ref6.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2dob3N0LXN5bmMuanM/ZDVlNCJdLCJuYW1lcyI6WyJQcm9taXNlIiwicHJvbWlzaWZ5QWxsIiwiZnMiLCJ3cml0ZVJldmlzaW9ucyIsInJldmlzaW9uc0ZpbGUiLCJyZXZpc2lvbnMiLCJ1c2VyIiwiaG9zdCIsIm9zIiwiaG9zdG5hbWUiLCJmdWxsVXNlciIsImZpbHRlciIsIkJvb2xlYW4iLCJqb2luIiwicHJlYW1ibGUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJmcm9tQ2FsbGJhY2siLCJjYiIsIndyaXRlRmlsZSIsImZpbGUiLCJjb250ZW50IiwiZGVsZXRlZCIsImZpbGVQYXRoIiwicGF0aCIsImZvbGRlclBhdGgiLCJ1bmxpbmtBc3luYyIsIndyaXRlRmlsZUFzeW5jIiwidXBkYXRlRm9sZGVyIiwiZm9sZGVyIiwiZmlsZXMiLCJiaW5hcnkiLCJwcm9qZWN0TG9jYXRpb24iLCJSRVZJU0lPTlNfRklMRV9OQU1FIiwiZm9yRWFjaCIsImRhdGEiLCJCdWZmZXIiLCJmcm9tIiwiZWFjaCIsIm1vZHVsZSIsImV4cG9ydHMiLCJib3RVcmwiLCJyZXBsYWNlIiwicHJpbnQiLCJpbmZvIiwidG9rZW4iLCJ3YXJuIiwiY29uZmlnIiwiYXhpb3MiLCJnZXQiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImVycm9yIiwibWVzc2FnZSIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJDb25maXJtIiwicnVuIiwiY29uZmlybSIsInByb3BzIiwicmVzb2x2ZSIsInN1Y2Nlc3MiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7O0FBQ0E7O0FBRUE7Ozs7Ozs7O0FBRUFBLG1CQUFRQyxZQUFSLENBQXFCQyxZQUFyQjs7QUFFQSxJQUFNQztBQUFBLHFFQUFpQixpQkFBT0MsYUFBUCxFQUFzQkMsU0FBdEI7QUFB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QUFBQTtBQUFBIiwiZmlsZSI6Ii4vc3JjL2NsaS9naG9zdC1zeW5jLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBvcyBmcm9tICdvcydcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJ1xuaW1wb3J0IENvbmZpcm0gZnJvbSAncHJvbXB0LWNvbmZpcm0nXG5pbXBvcnQgdXNlcm5hbWUgZnJvbSAndXNlcm5hbWUnXG5pbXBvcnQgcHJlcGVuZEZpbGUgZnJvbSAncHJlcGVuZC1maWxlJ1xuaW1wb3J0IG1hcFZhbHVlcyBmcm9tICdsb2Rhc2gvbWFwVmFsdWVzJ1xuXG5pbXBvcnQgeyBwcmludCB9IGZyb20gJy4uL3V0aWwnXG5pbXBvcnQgeyBSRVZJU0lPTlNfRklMRV9OQU1FIH0gZnJvbSAnLi4vZ2hvc3QtY29udGVudCdcblxuaW1wb3J0IHsgbG9naW4gfSBmcm9tICcuL2F1dGgnXG5cblByb21pc2UucHJvbWlzaWZ5QWxsKGZzKVxuXG5jb25zdCB3cml0ZVJldmlzaW9ucyA9IGFzeW5jIChyZXZpc2lvbnNGaWxlLCByZXZpc2lvbnMpID0+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IHVzZXJuYW1lKClcbiAgY29uc3QgaG9zdCA9IG9zLmhvc3RuYW1lKClcbiAgbGV0IGZ1bGxVc2VyID0gW3VzZXIsIGhvc3RdLmZpbHRlcihCb29sZWFuKS5qb2luKCdAJylcbiAgaWYgKGZ1bGxVc2VyKSB7XG4gICAgZnVsbFVzZXIgPSAnIGJ5ICcgKyBmdWxsVXNlclxuICB9XG4gIGNvbnN0IHByZWFtYmxlID0gYCMgU3luY2VkICR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpfSR7ZnVsbFVzZXJ9YFxuXG4gIHJldHVybiBQcm9taXNlLmZyb21DYWxsYmFjayhjYiA9PiB7XG4gICAgcHJlcGVuZEZpbGUocmV2aXNpb25zRmlsZSwgW3ByZWFtYmxlLCAuLi5yZXZpc2lvbnMsICcnXS5qb2luKCdcXG4nKSwgY2IpXG4gIH0pXG59XG5cbmNvbnN0IHdyaXRlRmlsZSA9IGZvbGRlclBhdGggPT4gYXN5bmMgKHsgZmlsZSwgY29udGVudCwgZGVsZXRlZCB9KSA9PiB7XG4gIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGZvbGRlclBhdGgsIGZpbGUpXG4gIHJldHVybiBkZWxldGVkID8gZnMudW5saW5rQXN5bmMoZmlsZVBhdGgpIDogZnMud3JpdGVGaWxlQXN5bmMoZmlsZVBhdGgsIGNvbnRlbnQpXG59XG5cbmNvbnN0IHVwZGF0ZUZvbGRlciA9IHByb2plY3RMb2NhdGlvbiA9PiBhc3luYyAoeyBmaWxlcywgcmV2aXNpb25zLCBiaW5hcnkgfSwgZm9sZGVyKSA9PiB7XG4gIGNvbnN0IGZvbGRlclBhdGggPSBwYXRoLmpvaW4ocHJvamVjdExvY2F0aW9uLCBmb2xkZXIpXG4gIGNvbnN0IHJldmlzaW9uc0ZpbGUgPSBwYXRoLmpvaW4oZm9sZGVyUGF0aCwgUkVWSVNJT05TX0ZJTEVfTkFNRSlcbiAgYXdhaXQgd3JpdGVSZXZpc2lvbnMocmV2aXNpb25zRmlsZSwgcmV2aXNpb25zKVxuXG4gIGlmIChiaW5hcnkpIHtcbiAgICBmaWxlcy5mb3JFYWNoKGRhdGEgPT4ge1xuICAgICAgZGF0YS5jb250ZW50ID0gQnVmZmVyLmZyb20oZGF0YS5jb250ZW50LCAnYmFzZTY0JylcbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIFByb21pc2UuZWFjaChmaWxlcywgd3JpdGVGaWxlKGZvbGRlclBhdGgpKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIGJvdFVybCA9PiB7XG4gIGJvdFVybCA9IGJvdFVybC5yZXBsYWNlKC9cXC8rJC8sICcnKVxuXG4gIC8vIFRoaXMgYWxzbyBpbXBsaWNpdGx5IGVuc3VyZXMgd2UncmUgaW5zaWRlIG9mIHRoZSBib3QgcHJvamVjdCBkaXJlY3RvcnksIGFuZCB2YWxpZGF0ZXMgdGhlIGJvdCBVUkxcbiAgcHJpbnQuaW5mbyhgQ2hlY2tpbmcgeW91ciBsb2dpbiBzdGF0dXMgd2l0aCAke2JvdFVybH0uLi5gKVxuICBjb25zdCB0b2tlbiA9IGF3YWl0IGxvZ2luKGJvdFVybClcbiAgaWYgKCF0b2tlbikge1xuICAgIHByaW50Lndhcm4oJ0xvZ2luIGlzIHJlcXVpcmVkIGZvciB0aGlzIG9wZXJhdGlvbiwgZXhpdGluZyBub3cuJylcbiAgICByZXR1cm5cbiAgfVxuXG4gIGxldCBjb25maWdcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGF4aW9zLmdldChgJHtib3RVcmx9L2FwaS9naG9zdF9jb250ZW50L2V4cG9ydGAsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWBcbiAgICAgIH1cbiAgICB9KVxuICAgIGNvbmZpZyA9IGRhdGFcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcHJpbnQuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InLCAnd2hpbGUgZmV0Y2hpbmcgZ2hvc3QgY29udGVudC4nKVxuICAgIHJldHVyblxuICB9XG5cbiAgaWYgKCFjb25maWcgfHwgIU9iamVjdC5rZXlzKGNvbmZpZykubGVuZ3RoKSB7XG4gICAgcHJpbnQuaW5mbygnTm8gcGVuZGluZyBnaG9zdCByZXZpc2lvbnMsIG5vdGhpbmcgdG8gYmUgZG9uZSBoZXJlLicpXG4gICAgcmV0dXJuXG4gIH1cblxuICBjb25zdCBjb25maXJtID0gYXdhaXQgbmV3IENvbmZpcm0oYFxuICBSdW5uaW5nIHRoaXMgY29tbWFuZCB3aWxsIG92ZXJyaWRlIGFueSB1bnRyYWNrZWQgLyB1bmNvbW1pdHRlZCBjaGFuZ2VzIHRvIHRoZSBjb3JyZXNwb25kaW5nIGNvbnRlbnQgZmlsZXMuXG4gIEl0IGlzIHJlY29tbWVuZGVkIHRoYXQgeW91IHVzZSB2ZXJzaW9uIGNvbnRyb2wgc3lzdGVtIChsaWtlIGdpdCkgYW5kIGNvbW1pdCBhbnkgY2hhbmdlcyBiZWZvcmUgcHJvY2VlZGluZy5cbiAgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNvbnRpbnVlP1xuICBgKS5ydW4oKVxuXG4gIGlmICghY29uZmlybSkge1xuICAgIHJldHVyblxuICB9XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCBQcm9taXNlLnByb3BzKG1hcFZhbHVlcyhjb25maWcsIHVwZGF0ZUZvbGRlcihwYXRoLnJlc29sdmUoJy4nKSkpKVxuICAgIHByaW50LnN1Y2Nlc3MoYFxuICAgIEFsbCBjb250ZW50IHN5bmNlZCBzdWNjZXNzZnVsbHkuIFlvdSBub3cgbmVlZCB0byByZWRlcGxveSB5b3VyIGJvdCB3aXRoIHRoZSB1cGRhdGVkIGNvbnRlbnQgdG8gZmluaXNoIHRoZSBzeW5jIHByb2NlZHVyZS5cbiAgICBJZiB5b3UncmUgdXNpbmcgdmVyc2lvbiBjb250cm9sIHN5c3RlbSAobGlrZSBnaXQpIHlvdSBzaG91bGQgcmV2aWV3IHRoZSBjaGFuZ2VzIGJlZm9yZSBjb21taXR0aW5nLlxuICAgIFBsZWFzZSBkb24ndCBmb3JnZXQgdG8gaW5jbHVkZSAoY29tbWl0LCBkZXBsb3kpICR7UkVWSVNJT05TX0ZJTEVfTkFNRX0gZmlsZShzKS5cbiAgICBgKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBwcmludC5lcnJvcihlcnIubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcicsICd3aGlsZSBhcHBseWluZyBnaG9zdCBjb250ZW50LicpXG4gICAgcHJpbnQuZXJyb3IoJ1lvdXIgY29udGVudCBmaWxlcyBtYXkgYmUgaW4gaW5jb25zaXN0ZW50IHN0YXRlLicpXG4gICAgcHJpbnQuZXJyb3IoJ0l0IGlzIHJlY29tbWVuZGVkIHRvIHJlc2V0IHRoZSBjaGFuZ2VzIChsaWtlIGdpdCByZXNldCkgYW5kIHRyeSBhZ2Fpbi4nKVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/cli/ghost-sync.js\n");

/***/ }),

/***/ "./src/cli/index.js":
/*!**************************!*\
  !*** ./src/cli/index.js ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _commander = __webpack_require__(/*! commander */ \"commander\");\n\nvar _commander2 = _interopRequireDefault(_commander);\n\nvar _init = __webpack_require__(/*! ./init */ \"./src/cli/init.js\");\n\nvar _init2 = _interopRequireDefault(_init);\n\nvar _start = __webpack_require__(/*! ./start */ \"./src/cli/start.js\");\n\nvar _start2 = _interopRequireDefault(_start);\n\nvar _create = __webpack_require__(/*! ./create */ \"./src/cli/create.js\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _update = __webpack_require__(/*! ./update */ \"./src/cli/update.js\");\n\nvar _update2 = _interopRequireDefault(_update);\n\nvar _migrate = __webpack_require__(/*! ./migrate */ \"./src/cli/migrate.js\");\n\nvar _migrate2 = _interopRequireDefault(_migrate);\n\nvar _list = __webpack_require__(/*! ./list */ \"./src/cli/list.js\");\n\nvar _list2 = _interopRequireDefault(_list);\n\nvar _auth = __webpack_require__(/*! ./auth */ \"./src/cli/auth.js\");\n\nvar _ghostSync = __webpack_require__(/*! ./ghost-sync */ \"./src/cli/ghost-sync.js\");\n\nvar _ghostSync2 = _interopRequireDefault(_ghostSync);\n\nvar _cloudPair = __webpack_require__(/*! ./cloudPair */ \"./src/cli/cloudPair.js\");\n\nvar _cloudPair2 = _interopRequireDefault(_cloudPair);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_commander2.default.command('init').description('Create a new bot in current directory').option('-y, --yes', 'Say yes to every prompt and use default values').action(_init2.default);\n\nvar defaultWatchExt = '.js,.jsx,.json,.yml';\nvar defaultBotpressCloudEndpoint = 'https://botpress.cloud';\n\n_commander2.default.command('start [path]').alias('s').description('Starts running a bot').option('-w, --watch', 'Watch bot for changes, and restart automatically').option('--watchExt <extensions>', 'When watching, which file extensions to watch. Default: \"' + defaultWatchExt + '\"', defaultWatchExt).option('--watchDir <dir>', 'When watching, what to watch. Can be repeated. Default: Directory of botfile.js', _util.collectArgs, []).option('--watchIgnore <file|dir>', 'When watching, what to ignore. Can be repeated. Default: dataDir, watchExt from botfile.js, and node_modules', _util.collectArgs, []).action(_start2.default);\n\n_commander2.default.command('list').alias('ls').description('List installed modules').action(_list2.default);\n\n_commander2.default.command('create').alias('c').description('Create a new module for development or distribution').action(_create2.default);\n\n_commander2.default.command('update [version]').alias('up').description('Updates your bot and all the modules to a specific version').action(_update2.default);\n\n_commander2.default.command('migrate <fromVersion>').description('Migrates the current bot from version X').action(_migrate2.default);\n\n_commander2.default.command('login <bot-server-url>').description('Login to the given bot instance. Provide the full base URL for the bot, like https://mybot.herokuapp.com.').action(_auth.login);\n\n_commander2.default.command('logout [bot-server-url]').description('Forget saved auth for the given bot instance, or all recorded auth tokens (if bot URL is not specified)').action(_auth.logout);\n\n_commander2.default.command('ghost-sync <bot-server-url>').description('Pull the ghost content from the remote bot instance and apply it locally.').action(_ghostSync2.default);\n\n_commander2.default.command('cloud-pair <api-token>').description('Pairs your local bot with the Botpress Cloud (supercharges your bot)').option('--endpoint <endpoint-url>', 'Change the Botpress Cloud server endpoint. Default: \"' + defaultBotpressCloudEndpoint + '\"', defaultBotpressCloudEndpoint).action(_cloudPair2.default);\n\n_commander2.default.version((0, _util.getBotpressVersion)()).description('Easily create, manage and extend chatbots.').parse(process.argv);\n\nif (!_commander2.default.args.length) {\n  _commander2.default.help();\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2luZGV4LmpzPzRhYzYiXSwibmFtZXMiOlsicHJvZ3JhbSIsImNvbW1hbmQiLCJkZXNjcmlwdGlvbiIsIm9wdGlvbiIsImFjdGlvbiIsImluaXQiLCJkZWZhdWx0V2F0Y2hFeHQiLCJkZWZhdWx0Qm90cHJlc3NDbG91ZEVuZHBvaW50IiwiYWxpYXMiLCJjb2xsZWN0QXJncyIsInN0YXJ0IiwibGlzdCIsImNyZWF0ZSIsInVwZGF0ZSIsIm1pZ3JhdGUiLCJsb2dpbiIsImxvZ291dCIsImdob3N0U3luYyIsImNsb3VkUGFpciIsInZlcnNpb24iLCJwYXJzZSIsInByb2Nlc3MiLCJhcmd2IiwiYXJncyIsImxlbmd0aCIsImhlbHAiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFFQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFFQUEsb0JBQ0dDLE9BREgsQ0FDVyxNQURYLEVBRUdDLFdBRkgsQ0FFZSx1Q0FGZixFQUdHQyxNQUhILENBR1UsV0FIVixFQUd1QixnREFIdkIsRUFJR0MsTUFKSCxDQUlVQyxjQUpWOztBQU1BLElBQU1DLGtCQUFrQixxQkFBeEI7QUFDQSxJQUFNQywrQkFBK0Isd0JBQXJDOztBQUVBUCxvQkFDR0MsT0FESCxDQUNXLGNBRFgsRUFFR08sS0FGSCxDQUVTLEdBRlQsRUFHR04sV0FISCxDQUdlLHNCQUhmLEVBSUdDLE1BSkgsQ0FJVSxhQUpWLEVBSXlCLGtEQUp6QixFQUtHQSxNQUxILENBTUkseUJBTkosZ0VBT2dFRyxlQVBoRSxRQVFJQSxlQVJKLEVBVUdILE1BVkgsQ0FXSSxrQkFYSixxRkFhSU0saUJBYkosRUFjSSxFQWRKLEVBZ0JHTixNQWhCSCxDQWlCSSwwQkFqQkosa0hBbUJJTSxpQkFuQkosRUFvQkksRUFwQkosRUFzQkdMLE1BdEJILENBc0JVTSxlQXRCVjs7QUF3QkFWLG9CQUNHQyxPQURILENBQ1csTUFEWCxFQUVHTyxLQUZILENBRVMsSUFGVCxFQUdHTixXQUhILENBR2Usd0JBSGYsRUFJR0UsTUFKSCxDQUlVTyxjQUpWOztBQU1BWCxvQkFDR0MsT0FESCxDQUNXLFFBRFgsRUFFR08sS0FGSCxDQUVTLEdBRlQsRUFHR04sV0FISCxDQUdlLHFEQUhmLEVBSUdFLE1BSkgsQ0FJVVEsZ0JBSlY7O0FBTUFaLG9CQUNHQyxPQURILENBQ1csa0JBRFgsRUFFR08sS0FGSCxDQUVTLElBRlQsRUFHR04sV0FISCxDQUdlLDREQUhmLEVBSUdFLE1BSkgsQ0FJVVMsZ0JBSlY7O0FBTUFiLG9CQUNHQyxPQURILENBQ1csdUJBRFgsRUFFR0MsV0FGSCxDQUVlLHlDQUZmLEVBR0dFLE1BSEgsQ0FHVVUsaUJBSFY7O0FBS0FkLG9CQUNHQyxPQURILENBQ1csd0JBRFgsRUFFR0MsV0FGSCxDQUdJLDJHQUhKLEVBS0dFLE1BTEgsQ0FLVVcsV0FMVjs7QUFPQWYsb0JBQ0dDLE9BREgsQ0FDVyx5QkFEWCxFQUVHQyxXQUZILENBR0kseUdBSEosRUFLR0UsTUFMSCxDQUtVWSxZQUxWOztBQU9BaEIsb0JBQ0dDLE9BREgsQ0FDVyw2QkFEWCxFQUVHQyxXQUZILENBRWUsMkVBRmYsRUFHR0UsTUFISCxDQUdVYSxtQkFIVjs7QUFLQWpCLG9CQUNHQyxPQURILENBQ1csd0JBRFgsRUFFR0MsV0FGSCxDQUVlLHNFQUZmLEVBR0dDLE1BSEgsQ0FJSSwyQkFKSiw0REFLNERJLDRCQUw1RCxRQU1JQSw0QkFOSixFQVFHSCxNQVJILENBUVVjLG1CQVJWOztBQVVBbEIsb0JBQ0dtQixPQURILENBQ1csK0JBRFgsRUFFR2pCLFdBRkgsQ0FFZSw0Q0FGZixFQUdHa0IsS0FISCxDQUdTQyxRQUFRQyxJQUhqQjs7QUFLQSxJQUFJLENBQUN0QixvQkFBUXVCLElBQVIsQ0FBYUMsTUFBbEIsRUFBMEI7QUFDeEJ4QixzQkFBUXlCLElBQVI7QUFDRCIsImZpbGUiOiIuL3NyYy9jbGkvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcHJvZ3JhbSBmcm9tICdjb21tYW5kZXInXG5cbmltcG9ydCBpbml0IGZyb20gJy4vaW5pdCdcbmltcG9ydCBzdGFydCBmcm9tICcuL3N0YXJ0J1xuaW1wb3J0IGNyZWF0ZSBmcm9tICcuL2NyZWF0ZSdcbmltcG9ydCB1cGRhdGUgZnJvbSAnLi91cGRhdGUnXG5pbXBvcnQgbWlncmF0ZSBmcm9tICcuL21pZ3JhdGUnXG5pbXBvcnQgbGlzdCBmcm9tICcuL2xpc3QnXG5pbXBvcnQgeyBsb2dpbiwgbG9nb3V0IH0gZnJvbSAnLi9hdXRoJ1xuaW1wb3J0IGdob3N0U3luYyBmcm9tICcuL2dob3N0LXN5bmMnXG5pbXBvcnQgY2xvdWRQYWlyIGZyb20gJy4vY2xvdWRQYWlyJ1xuXG5pbXBvcnQgeyBnZXRCb3RwcmVzc1ZlcnNpb24sIGNvbGxlY3RBcmdzIH0gZnJvbSAnLi4vdXRpbCdcblxucHJvZ3JhbVxuICAuY29tbWFuZCgnaW5pdCcpXG4gIC5kZXNjcmlwdGlvbignQ3JlYXRlIGEgbmV3IGJvdCBpbiBjdXJyZW50IGRpcmVjdG9yeScpXG4gIC5vcHRpb24oJy15LCAtLXllcycsICdTYXkgeWVzIHRvIGV2ZXJ5IHByb21wdCBhbmQgdXNlIGRlZmF1bHQgdmFsdWVzJylcbiAgLmFjdGlvbihpbml0KVxuXG5jb25zdCBkZWZhdWx0V2F0Y2hFeHQgPSAnLmpzLC5qc3gsLmpzb24sLnltbCdcbmNvbnN0IGRlZmF1bHRCb3RwcmVzc0Nsb3VkRW5kcG9pbnQgPSAnaHR0cHM6Ly9ib3RwcmVzcy5jbG91ZCdcblxucHJvZ3JhbVxuICAuY29tbWFuZCgnc3RhcnQgW3BhdGhdJylcbiAgLmFsaWFzKCdzJylcbiAgLmRlc2NyaXB0aW9uKCdTdGFydHMgcnVubmluZyBhIGJvdCcpXG4gIC5vcHRpb24oJy13LCAtLXdhdGNoJywgJ1dhdGNoIGJvdCBmb3IgY2hhbmdlcywgYW5kIHJlc3RhcnQgYXV0b21hdGljYWxseScpXG4gIC5vcHRpb24oXG4gICAgJy0td2F0Y2hFeHQgPGV4dGVuc2lvbnM+JyxcbiAgICBgV2hlbiB3YXRjaGluZywgd2hpY2ggZmlsZSBleHRlbnNpb25zIHRvIHdhdGNoLiBEZWZhdWx0OiBcIiR7ZGVmYXVsdFdhdGNoRXh0fVwiYCxcbiAgICBkZWZhdWx0V2F0Y2hFeHRcbiAgKVxuICAub3B0aW9uKFxuICAgICctLXdhdGNoRGlyIDxkaXI+JyxcbiAgICBgV2hlbiB3YXRjaGluZywgd2hhdCB0byB3YXRjaC4gQ2FuIGJlIHJlcGVhdGVkLiBEZWZhdWx0OiBEaXJlY3Rvcnkgb2YgYm90ZmlsZS5qc2AsXG4gICAgY29sbGVjdEFyZ3MsXG4gICAgW11cbiAgKVxuICAub3B0aW9uKFxuICAgICctLXdhdGNoSWdub3JlIDxmaWxlfGRpcj4nLFxuICAgIGBXaGVuIHdhdGNoaW5nLCB3aGF0IHRvIGlnbm9yZS4gQ2FuIGJlIHJlcGVhdGVkLiBEZWZhdWx0OiBkYXRhRGlyLCB3YXRjaEV4dCBmcm9tIGJvdGZpbGUuanMsIGFuZCBub2RlX21vZHVsZXNgLFxuICAgIGNvbGxlY3RBcmdzLFxuICAgIFtdXG4gIClcbiAgLmFjdGlvbihzdGFydClcblxucHJvZ3JhbVxuICAuY29tbWFuZCgnbGlzdCcpXG4gIC5hbGlhcygnbHMnKVxuICAuZGVzY3JpcHRpb24oJ0xpc3QgaW5zdGFsbGVkIG1vZHVsZXMnKVxuICAuYWN0aW9uKGxpc3QpXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ2NyZWF0ZScpXG4gIC5hbGlhcygnYycpXG4gIC5kZXNjcmlwdGlvbignQ3JlYXRlIGEgbmV3IG1vZHVsZSBmb3IgZGV2ZWxvcG1lbnQgb3IgZGlzdHJpYnV0aW9uJylcbiAgLmFjdGlvbihjcmVhdGUpXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ3VwZGF0ZSBbdmVyc2lvbl0nKVxuICAuYWxpYXMoJ3VwJylcbiAgLmRlc2NyaXB0aW9uKCdVcGRhdGVzIHlvdXIgYm90IGFuZCBhbGwgdGhlIG1vZHVsZXMgdG8gYSBzcGVjaWZpYyB2ZXJzaW9uJylcbiAgLmFjdGlvbih1cGRhdGUpXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ21pZ3JhdGUgPGZyb21WZXJzaW9uPicpXG4gIC5kZXNjcmlwdGlvbignTWlncmF0ZXMgdGhlIGN1cnJlbnQgYm90IGZyb20gdmVyc2lvbiBYJylcbiAgLmFjdGlvbihtaWdyYXRlKVxuXG5wcm9ncmFtXG4gIC5jb21tYW5kKCdsb2dpbiA8Ym90LXNlcnZlci11cmw+JylcbiAgLmRlc2NyaXB0aW9uKFxuICAgICdMb2dpbiB0byB0aGUgZ2l2ZW4gYm90IGluc3RhbmNlLiBQcm92aWRlIHRoZSBmdWxsIGJhc2UgVVJMIGZvciB0aGUgYm90LCBsaWtlIGh0dHBzOi8vbXlib3QuaGVyb2t1YXBwLmNvbS4nXG4gIClcbiAgLmFjdGlvbihsb2dpbilcblxucHJvZ3JhbVxuICAuY29tbWFuZCgnbG9nb3V0IFtib3Qtc2VydmVyLXVybF0nKVxuICAuZGVzY3JpcHRpb24oXG4gICAgJ0ZvcmdldCBzYXZlZCBhdXRoIGZvciB0aGUgZ2l2ZW4gYm90IGluc3RhbmNlLCBvciBhbGwgcmVjb3JkZWQgYXV0aCB0b2tlbnMgKGlmIGJvdCBVUkwgaXMgbm90IHNwZWNpZmllZCknXG4gIClcbiAgLmFjdGlvbihsb2dvdXQpXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ2dob3N0LXN5bmMgPGJvdC1zZXJ2ZXItdXJsPicpXG4gIC5kZXNjcmlwdGlvbignUHVsbCB0aGUgZ2hvc3QgY29udGVudCBmcm9tIHRoZSByZW1vdGUgYm90IGluc3RhbmNlIGFuZCBhcHBseSBpdCBsb2NhbGx5LicpXG4gIC5hY3Rpb24oZ2hvc3RTeW5jKVxuXG5wcm9ncmFtXG4gIC5jb21tYW5kKCdjbG91ZC1wYWlyIDxhcGktdG9rZW4+JylcbiAgLmRlc2NyaXB0aW9uKCdQYWlycyB5b3VyIGxvY2FsIGJvdCB3aXRoIHRoZSBCb3RwcmVzcyBDbG91ZCAoc3VwZXJjaGFyZ2VzIHlvdXIgYm90KScpXG4gIC5vcHRpb24oXG4gICAgJy0tZW5kcG9pbnQgPGVuZHBvaW50LXVybD4nLFxuICAgIGBDaGFuZ2UgdGhlIEJvdHByZXNzIENsb3VkIHNlcnZlciBlbmRwb2ludC4gRGVmYXVsdDogXCIke2RlZmF1bHRCb3RwcmVzc0Nsb3VkRW5kcG9pbnR9XCJgLFxuICAgIGRlZmF1bHRCb3RwcmVzc0Nsb3VkRW5kcG9pbnRcbiAgKVxuICAuYWN0aW9uKGNsb3VkUGFpcilcblxucHJvZ3JhbVxuICAudmVyc2lvbihnZXRCb3RwcmVzc1ZlcnNpb24oKSlcbiAgLmRlc2NyaXB0aW9uKCdFYXNpbHkgY3JlYXRlLCBtYW5hZ2UgYW5kIGV4dGVuZCBjaGF0Ym90cy4nKVxuICAucGFyc2UocHJvY2Vzcy5hcmd2KVxuXG5pZiAoIXByb2dyYW0uYXJncy5sZW5ndGgpIHtcbiAgcHJvZ3JhbS5oZWxwKClcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/cli/index.js\n");

/***/ }),

/***/ "./src/cli/init.js":
/*!*************************!*\
  !*** ./src/cli/init.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _templateObject = _taggedTemplateLiteral(['\\n{dim ---------------}\\nHey there \\uD83D\\uDC4B, thanks for using {bold Botpress}!\\nWe\\'ll walk you through the creation of your new bot.\\nFor more information or help, please visit {underline https://botpress.io/docs}\\n{dim ---------------}'], ['\\n{dim ---------------}\\nHey there \\uD83D\\uDC4B, thanks for using {bold Botpress}!\\nWe\\'ll walk you through the creation of your new bot.\\nFor more information or help, please visit {underline https://botpress.io/docs}\\n{dim ---------------}']),\n    _templateObject2 = _taggedTemplateLiteral(['\\n{green \\uD83C\\uDF89  Your bot was initialized succesfully!}\\n\\n{yellow Next steps:}\\n  {yellow 1)} Install bot dependencies by running {bold npm install} (or {bold yarn install})\\n  {yellow 2)} Start the bot by running {bold npm start} (or {bold yarn start})\\n\\n{bold Enjoy Botpress!}\\n'], ['\\n{green \\uD83C\\uDF89  Your bot was initialized succesfully!}\\n\\n{yellow Next steps:}\\n  {yellow 1)} Install bot dependencies by running {bold npm install} (or {bold yarn install})\\n  {yellow 2)} Start the bot by running {bold npm start} (or {bold yarn start})\\n\\n{bold Enjoy Botpress!}\\n']),\n    _templateObject3 = _taggedTemplateLiteral(['\\n{red Fatal Error} You need to run this command in an empty directory.\\n'], ['\\n{red Fatal Error} You need to run this command in an empty directory.\\n']),\n    _templateObject4 = _taggedTemplateLiteral(['\\n{red Fatal Error} Directory {bold ', '} already exists.\\n'], ['\\n{red Fatal Error} Directory {bold ', '} already exists.\\n']),\n    _templateObject5 = _taggedTemplateLiteral(['\\n{red Fatal Error} Template {bold ', '} not found.\\n'], ['\\n{red Fatal Error} Template {bold ', '} not found.\\n']),\n    _templateObject6 = _taggedTemplateLiteral(['\\n{dim =============================}\\nTemplate: {bold ', '}\\nAuthor: {dim ', '}\\nDescription: {dim ', '}\\nChannels: {yellow ', '}\\n{dim =============================}\\n'], ['\\n{dim =============================}\\nTemplate: {bold ', '}\\nAuthor: {dim ', '}\\nDescription: {dim ', '}\\nChannels: {yellow ', '}\\n{dim =============================}\\n']),\n    _templateObject7 = _taggedTemplateLiteral(['{dim -> Copying ', '}'], ['{dim -> Copying ', '}']);\n\nvar _child_process = __webpack_require__(/*! child_process */ \"child_process\");\n\nvar _prompt = __webpack_require__(/*! prompt */ \"prompt\");\n\nvar _prompt2 = _interopRequireDefault(_prompt);\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _mkdirp = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n\nvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _glob = __webpack_require__(/*! glob */ \"glob\");\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _stats = __webpack_require__(/*! ../stats */ \"./src/stats.js\");\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nvar introductionText = (0, _chalk2.default)(_templateObject);\n\nvar nextStepText = (0, _chalk2.default)(_templateObject2);\n\nvar invalidDirectoryError = (0, _chalk2.default)(_templateObject3);\n\nvar dirExistsError = function dirExistsError(dir) {\n  return (0, _chalk2.default)(_templateObject4, dir);\n};\n\nvar templateNotFoundError = function templateNotFoundError(template) {\n  return (0, _chalk2.default)(_templateObject5, template);\n};\n\nvar showTemplateInfo = function showTemplateInfo(info) {\n  return (0, _chalk2.default)(_templateObject6, info.name, info.author, info.description, info.channels.join(', '));\n};\n\nvar copyingFile = function copyingFile(name) {\n  return (0, _chalk2.default)(_templateObject7, name);\n};\n\nvar assertDoesntExist = function assertDoesntExist(file) {\n  if (_fs2.default.existsSync(file)) {\n    console.log(invalidDirectoryError);\n    process.exit(1);\n  }\n};\n\n// Show template description\n// Say more templates coming up\n// Ask questions\n// Copy files, replacing variables\n// Show \"success, now run `yarn install`\"\n\n/**\n * Loads a template a returns a map of files and content\n * @param  {string} name The name of the template to load\n * @return {object} A map of files `{ path: content }``\n * @private\n */\nvar loadTemplate = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(name) {\n    var templatePath, infoFile, files;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            templatePath = _path2.default.join(__dirname, 'cli/templates/' + name);\n            infoFile = _path2.default.join(templatePath, 'info.json');\n\n\n            if (!_fs2.default.existsSync) {\n              console.log(templateNotFoundError(name));\n              process.exit(1);\n            }\n\n            _context.next = 5;\n            return _bluebird2.default.fromCallback(function (cb) {\n              return (0, _glob2.default)('**/*.*', { cwd: templatePath, dot: true }, cb);\n            });\n\n          case 5:\n            files = _context.sent;\n            return _context.abrupt('return', _lodash2.default.reduce(files, function (obj, file) {\n              var filePath = _path2.default.join(templatePath, file);\n              obj[file] = _fs2.default.readFileSync(filePath).toString();\n              return obj;\n            }, {}));\n\n          case 7:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function loadTemplate(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar generate = function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(result) {\n    var files, info, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _ref3, _ref4, name, content, compiled, directory;\n\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return loadTemplate('init-default');\n\n          case 2:\n            files = _context2.sent;\n            info = JSON.parse(files['info.json']);\n\n            delete files['info.json'];\n\n            console.log(showTemplateInfo(info));\n\n            _iteratorNormalCompletion = true;\n            _didIteratorError = false;\n            _iteratorError = undefined;\n            _context2.prev = 9;\n            for (_iterator = Object.entries(files)[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              _ref3 = _step.value;\n              _ref4 = _slicedToArray(_ref3, 2);\n              name = _ref4[0];\n              content = _ref4[1];\n\n              console.log(copyingFile(name));\n              compiled = _lodash2.default.template(content, { interpolate: /<%=([\\s\\S]+?)%>/g });\n              directory = _path2.default.dirname(name);\n\n              if (directory.length) {\n                _mkdirp2.default.sync(directory);\n              }\n\n              _fs2.default.writeFileSync(name, compiled(result));\n            }\n\n            _context2.next = 17;\n            break;\n\n          case 13:\n            _context2.prev = 13;\n            _context2.t0 = _context2['catch'](9);\n            _didIteratorError = true;\n            _iteratorError = _context2.t0;\n\n          case 17:\n            _context2.prev = 17;\n            _context2.prev = 18;\n\n            if (!_iteratorNormalCompletion && _iterator.return) {\n              _iterator.return();\n            }\n\n          case 20:\n            _context2.prev = 20;\n\n            if (!_didIteratorError) {\n              _context2.next = 23;\n              break;\n            }\n\n            throw _iteratorError;\n\n          case 23:\n            return _context2.finish(20);\n\n          case 24:\n            return _context2.finish(17);\n\n          case 25:\n            console.log(nextStepText);\n\n          case 26:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, undefined, [[9, 13, 17, 25], [18,, 20, 24]]);\n  }));\n\n  return function generate(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nmodule.exports = function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(program) {\n    var dirName, botpressVersion, defaultBotName, schema;\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            console.log(introductionText);\n\n            // People can optionally provide the directory of the bot\n            // Like \"bp init my-bot\"\n            dirName = process.argv[3];\n\n            if (!dirName) {\n              _context3.next = 10;\n              break;\n            }\n\n            if (_fs2.default.existsSync(dirName)) {\n              _context3.next = 8;\n              break;\n            }\n\n            _fs2.default.mkdirSync(dirName);\n            process.chdir(dirName);\n            _context3.next = 10;\n            break;\n\n          case 8:\n            console.log(dirExistsError(dirName));\n            return _context3.abrupt('return', process.exit(1));\n\n          case 10:\n\n            // Loaded by Webpack at bundle time\n            botpressVersion = __webpack_require__(/*! ../../package.json */ \"./package.json\").version;\n\n\n            (0, _stats2.default)({}).track('cli', 'bot', 'init');\n\n            _lodash2.default.each(['package.json', 'botfile.js', 'index.js'], assertDoesntExist);\n\n            // The name of the current directory\n            defaultBotName = _path2.default.basename(_path2.default.resolve('./'));\n            schema = {\n              properties: {\n                name: {\n                  description: _chalk2.default.white('name:'),\n                  pattern: /^[a-z0-9][a-z0-9-_\\.]+$/,\n                  message: 'name must be only lowercase letters, ' + 'digits, dashes, underscores and dots.',\n                  required: true,\n                  default: defaultBotName\n                },\n                version: {\n                  required: true,\n                  description: _chalk2.default.white('botpress version:'),\n                  default: botpressVersion\n                },\n                description: {\n                  required: false,\n                  description: _chalk2.default.white('description:')\n                },\n                author: {\n                  required: false,\n                  description: _chalk2.default.white('author:')\n                }\n              }\n            };\n\n\n            if (program.yes) {\n              generate({\n                name: defaultBotName,\n                version: botpressVersion,\n                description: '',\n                author: ''\n              });\n            } else {\n              _prompt2.default.message = '';\n              _prompt2.default.delimiter = '';\n              _prompt2.default.start();\n\n              _prompt2.default.get(schema, function (err, result) {\n                if (err) {\n                  if (err.message !== 'canceled') {\n                    console.error(err);\n                  }\n\n                  process.exit(1);\n                }\n\n                generate(result);\n              });\n            }\n\n          case 16:\n          case 'end':\n            return _context3.stop();\n        }\n      }\n    }, _callee3, undefined);\n  }));\n\n  return function (_x3) {\n    return _ref5.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2luaXQuanM/NzFlNyJdLCJuYW1lcyI6WyJpbnRyb2R1Y3Rpb25UZXh0IiwiY2hhbGsiLCJuZXh0U3RlcFRleHQiLCJpbnZhbGlkRGlyZWN0b3J5RXJyb3IiLCJkaXJFeGlzdHNFcnJvciIsImRpciIsInRlbXBsYXRlTm90Rm91bmRFcnJvciIsInRlbXBsYXRlIiwic2hvd1RlbXBsYXRlSW5mbyIsImluZm8iLCJuYW1lIiwiYXV0aG9yIiwiZGVzY3JpcHRpb24iLCJjaGFubmVscyIsImpvaW4iLCJjb3B5aW5nRmlsZSIsImFzc2VydERvZXNudEV4aXN0IiwiZnMiLCJleGlzdHNTeW5jIiwiZmlsZSIsImNvbnNvbGUiLCJsb2ciLCJwcm9jZXNzIiwiZXhpdCIsImxvYWRUZW1wbGF0ZSIsInRlbXBsYXRlUGF0aCIsInBhdGgiLCJfX2Rpcm5hbWUiLCJpbmZvRmlsZSIsIlByb21pc2UiLCJmcm9tQ2FsbGJhY2siLCJjd2QiLCJkb3QiLCJjYiIsImZpbGVzIiwiXyIsInJlZHVjZSIsIm9iaiIsImZpbGVQYXRoIiwicmVhZEZpbGVTeW5jIiwidG9TdHJpbmciLCJnZW5lcmF0ZSIsInJlc3VsdCIsIkpTT04iLCJwYXJzZSIsIk9iamVjdCIsImVudHJpZXMiLCJjb250ZW50IiwiY29tcGlsZWQiLCJpbnRlcnBvbGF0ZSIsImRpcmVjdG9yeSIsImRpcm5hbWUiLCJsZW5ndGgiLCJta2RpcnAiLCJzeW5jIiwid3JpdGVGaWxlU3luYyIsIm1vZHVsZSIsImV4cG9ydHMiLCJwcm9ncmFtIiwiZGlyTmFtZSIsImFyZ3YiLCJta2RpclN5bmMiLCJjaGRpciIsImJvdHByZXNzVmVyc2lvbiIsInJlcXVpcmUiLCJ2ZXJzaW9uIiwidHJhY2siLCJlYWNoIiwiZGVmYXVsdEJvdE5hbWUiLCJiYXNlbmFtZSIsInJlc29sdmUiLCJzY2hlbWEiLCJwcm9wZXJ0aWVzIiwid2hpdGUiLCJwYXR0ZXJuIiwibWVzc2FnZSIsInJlcXVpcmVkIiwiZGVm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UDtBQWpCRTtBQURDLGFBMUJBOzs7QUFtRGYsZ0JBQUlmLFFBQVFvQixHQUFaLEVBQWlCO0FBQ2ZyQyx1QkFBUztBQUNQL0Isc0JBQU0wRCxjQURDO0FBRVBILHlCQUFTRixlQUZGO0FBR1BuRCw2QkFBYSxFQUhOO0FBSVBELHdCQUFRO0FBSkQsZUFBVDtBQU1ELGFBUEQsTUFPTztBQUNMb0UsK0JBQU9KLE9BQVAsR0FBaUIsRUFBakI7QUFDQUksK0JBQU9DLFNBQVAsR0FBbUIsRUFBbkI7QUFDQUQsK0JBQU9FLEtBQVA7O0FBRUFGLCtCQUFPRyxHQUFQLENBQVdYLE1BQVgsRUFBbUIsVUFBQ1ksR0FBRCxFQUFNekMsTUFBTixFQUFpQjtBQUNsQyxvQkFBSXlDLEdBQUosRUFBUztBQUNQLHNCQUFJQSxJQUFJUixPQUFKLEtBQWdCLFVBQXBCLEVBQWdDO0FBQzlCdkQsNEJBQVFnRSxLQUFSLENBQWNELEdBQWQ7QUFDRDs7QUFFRDdELDBCQUFRQyxJQUFSLENBQWEsQ0FBYjtBQUNEOztBQUVEa0IseUJBQVNDLE1BQVQ7QUFDRCxlQVZEO0FBV0Q7O0FBMUVjO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWpCOztBQUFBO0FBQUE7QUFBQTtBQUFBIiwiZmlsZSI6Ii4vc3JjL2NsaS9pbml0LmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJ1xuaW1wb3J0IHByb21wdCBmcm9tICdwcm9tcHQnXG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IG1rZGlycCBmcm9tICdta2RpcnAnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgZ2xvYiBmcm9tICdnbG9iJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmltcG9ydCBzdGF0cyBmcm9tICcuLi9zdGF0cydcblxuY29uc3QgaW50cm9kdWN0aW9uVGV4dCA9IGNoYWxrYFxue2RpbSAtLS0tLS0tLS0tLS0tLS19XG5IZXkgdGhlcmUg8J+RiywgdGhhbmtzIGZvciB1c2luZyB7Ym9sZCBCb3RwcmVzc30hXG5XZSdsbCB3YWxrIHlvdSB0aHJvdWdoIHRoZSBjcmVhdGlvbiBvZiB5b3VyIG5ldyBib3QuXG5Gb3IgbW9yZSBpbmZvcm1hdGlvbiBvciBoZWxwLCBwbGVhc2UgdmlzaXQge3VuZGVybGluZSBodHRwczovL2JvdHByZXNzLmlvL2RvY3N9XG57ZGltIC0tLS0tLS0tLS0tLS0tLX1gXG5cbmNvbnN0IG5leHRTdGVwVGV4dCA9IGNoYWxrYFxue2dyZWVuIPCfjokgIFlvdXIgYm90IHdhcyBpbml0aWFsaXplZCBzdWNjZXNmdWxseSF9XG5cbnt5ZWxsb3cgTmV4dCBzdGVwczp9XG4gIHt5ZWxsb3cgMSl9IEluc3RhbGwgYm90IGRlcGVuZGVuY2llcyBieSBydW5uaW5nIHtib2xkIG5wbSBpbnN0YWxsfSAob3Ige2JvbGQgeWFybiBpbnN0YWxsfSlcbiAge3llbGxvdyAyKX0gU3RhcnQgdGhlIGJvdCBieSBydW5uaW5nIHtib2xkIG5wbSBzdGFydH0gKG9yIHtib2xkIHlhcm4gc3RhcnR9KVxuXG57Ym9sZCBFbmpveSBCb3RwcmVzcyF9XG5gXG5cbmNvbnN0IGludmFsaWREaXJlY3RvcnlFcnJvciA9IGNoYWxrYFxue3JlZCBGYXRhbCBFcnJvcn0gWW91IG5lZWQgdG8gcnVuIHRoaXMgY29tbWFuZCBpbiBhbiBlbXB0eSBkaXJlY3RvcnkuXG5gXG5cbmNvbnN0IGRpckV4aXN0c0Vycm9yID0gZGlyID0+IGNoYWxrYFxue3JlZCBGYXRhbCBFcnJvcn0gRGlyZWN0b3J5IHtib2xkICR7ZGlyfX0gYWxyZWFkeSBleGlzdHMuXG5gXG5cbmNvbnN0IHRlbXBsYXRlTm90Rm91bmRFcnJvciA9IHRlbXBsYXRlID0+IGNoYWxrYFxue3JlZCBGYXRhbCBFcnJvcn0gVGVtcGxhdGUge2JvbGQgJHt0ZW1wbGF0ZX19IG5vdCBmb3VuZC5cbmBcblxuY29uc3Qgc2hvd1RlbXBsYXRlSW5mbyA9IGluZm8gPT4gY2hhbGtgXG57ZGltID09PT09PT09PT09PT09PT09PT09PT09PT09PT09fVxuVGVtcGxhdGU6IHtib2xkICR7aW5mby5uYW1lfX1cbkF1dGhvcjoge2RpbSAke2luZm8uYXV0aG9yfX1cbkRlc2NyaXB0aW9uOiB7ZGltICR7aW5mby5kZXNjcmlwdGlvbn19XG5DaGFubmVsczoge3llbGxvdyAke2luZm8uY2hhbm5lbHMuam9pbignLCAnKX19XG57ZGltID09PT09PT09PT09PT09PT09PT09PT09PT09PT09fVxuYFxuXG5jb25zdCBjb3B5aW5nRmlsZSA9IG5hbWUgPT4gY2hhbGtge2RpbSAtPiBDb3B5aW5nICR7bmFtZX19YFxuXG5jb25zdCBhc3NlcnREb2VzbnRFeGlzdCA9IGZpbGUgPT4ge1xuICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlKSkge1xuICAgIGNvbnNvbGUubG9nKGludmFsaWREaXJlY3RvcnlFcnJvcilcbiAgICBwcm9jZXNzLmV4aXQoMSlcbiAgfVxufVxuXG4vLyBTaG93IHRlbXBsYXRlIGRlc2NyaXB0aW9uXG4vLyBTYXkgbW9yZSB0ZW1wbGF0ZXMgY29taW5nIHVwXG4vLyBBc2sgcXVlc3Rpb25zXG4vLyBDb3B5IGZpbGVzLCByZXBsYWNpbmcgdmFyaWFibGVzXG4vLyBTaG93IFwic3VjY2Vzcywgbm93IHJ1biBgeWFybiBpbnN0YWxsYFwiXG5cbi8qKlxuICogTG9hZHMgYSB0ZW1wbGF0ZSBhIHJldHVybnMgYSBtYXAgb2YgZmlsZXMgYW5kIGNvbnRlbnRcbiAqIEBwYXJhbSAge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUgdG8gbG9hZFxuICogQHJldHVybiB7b2JqZWN0fSBBIG1hcCBvZiBmaWxlcyBgeyBwYXRoOiBjb250ZW50IH1gYFxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgbG9hZFRlbXBsYXRlID0gYXN5bmMgbmFtZSA9PiB7XG4gIGNvbnN0IHRlbXBsYXRlUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICdjbGkvdGVtcGxhdGVzLycgKyBuYW1lKVxuICBjb25zdCBpbmZvRmlsZSA9IHBhdGguam9pbih0ZW1wbGF0ZVBhdGgsICdpbmZvLmpzb24nKVxuXG4gIGlmICghZnMuZXhpc3RzU3luYykge1xuICAgIGNvbnNvbGUubG9nKHRlbXBsYXRlTm90Rm91bmRFcnJvcihuYW1lKSlcbiAgICBwcm9jZXNzLmV4aXQoMSlcbiAgfVxuXG4gIGNvbnN0IGZpbGVzID0gYXdhaXQgUHJvbWlzZS5mcm9tQ2FsbGJhY2soY2IgPT4gZ2xvYignKiovKi4qJywgeyBjd2Q6IHRlbXBsYXRlUGF0aCwgZG90OiB0cnVlIH0sIGNiKSlcblxuICByZXR1cm4gXy5yZWR1Y2UoXG4gICAgZmlsZXMsXG4gICAgKG9iaiwgZmlsZSkgPT4ge1xuICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4odGVtcGxhdGVQYXRoLCBmaWxlKVxuICAgICAgb2JqW2ZpbGVdID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoKS50b1N0cmluZygpXG4gICAgICByZXR1cm4gb2JqXG4gICAgfSxcbiAgICB7fVxuICApXG59XG5cbmNvbnN0IGdlbmVyYXRlID0gYXN5bmMgcmVzdWx0ID0+IHtcbiAgY29uc3QgZmlsZXMgPSBhd2FpdCBsb2FkVGVtcGxhdGUoJ2luaXQtZGVmYXVsdCcpXG5cbiAgY29uc3QgaW5mbyA9IEpTT04ucGFyc2UoZmlsZXNbJ2luZm8uanNvbiddKVxuICBkZWxldGUgZmlsZXNbJ2luZm8uanNvbiddXG5cbiAgY29uc29sZS5sb2coc2hvd1RlbXBsYXRlSW5mbyhpbmZvKSlcblxuICBmb3IgKGNvbnN0IFtuYW1lLCBjb250ZW50XSBvZiBPYmplY3QuZW50cmllcyhmaWxlcykpIHtcbiAgICBjb25zb2xlLmxvZyhjb3B5aW5nRmlsZShuYW1lKSlcbiAgICBjb25zdCBjb21waWxlZCA9IF8udGVtcGxhdGUoY29udGVudCwgeyBpbnRlcnBvbGF0ZTogLzwlPShbXFxzXFxTXSs/KSU+L2cgfSlcbiAgICBjb25zdCBkaXJlY3RvcnkgPSBwYXRoLmRpcm5hbWUobmFtZSlcbiAgICBpZiAoZGlyZWN0b3J5Lmxlbmd0aCkge1xuICAgICAgbWtkaXJwLnN5bmMoZGlyZWN0b3J5KVxuICAgIH1cblxuICAgIGZzLndyaXRlRmlsZVN5bmMobmFtZSwgY29tcGlsZWQocmVzdWx0KSlcbiAgfVxuXG4gIGNvbnNvbGUubG9nKG5leHRTdGVwVGV4dClcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyBwcm9ncmFtID0+IHtcbiAgY29uc29sZS5sb2coaW50cm9kdWN0aW9uVGV4dClcblxuICAvLyBQZW9wbGUgY2FuIG9wdGlvbmFsbHkgcHJvdmlkZSB0aGUgZGlyZWN0b3J5IG9mIHRoZSBib3RcbiAgLy8gTGlrZSBcImJwIGluaXQgbXktYm90XCJcbiAgY29uc3QgZGlyTmFtZSA9IHByb2Nlc3MuYXJndlszXVxuICBpZiAoZGlyTmFtZSkge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXJOYW1lKSkge1xuICAgICAgZnMubWtkaXJTeW5jKGRpck5hbWUpXG4gICAgICBwcm9jZXNzLmNoZGlyKGRpck5hbWUpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKGRpckV4aXN0c0Vycm9yKGRpck5hbWUpKVxuICAgICAgcmV0dXJuIHByb2Nlc3MuZXhpdCgxKVxuICAgIH1cbiAgfVxuXG4gIC8vIExvYWRlZCBieSBXZWJwYWNrIGF0IGJ1bmRsZSB0aW1lXG4gIGNvbnN0IGJvdHByZXNzVmVyc2lvbiA9IHJlcXVpcmUoJy4uLy4uL3BhY2thZ2UuanNvbicpLnZlcnNpb25cblxuICBzdGF0cyh7fSkudHJhY2soJ2NsaScsICdib3QnLCAnaW5pdCcpXG5cbiAgXy5lYWNoKFsncGFja2FnZS5qc29uJywgJ2JvdGZpbGUuanMnLCAnaW5kZXguanMnXSwgYXNzZXJ0RG9lc250RXhpc3QpXG5cbiAgLy8gVGhlIG5hbWUgb2YgdGhlIGN1cnJlbnQgZGlyZWN0b3J5XG4gIGNvbnN0IGRlZmF1bHRCb3ROYW1lID0gcGF0aC5iYXNlbmFtZShwYXRoLnJlc29sdmUoJy4vJykpXG5cbiAgY29uc3Qgc2NoZW1hID0ge1xuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIG5hbWU6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IGNoYWxrLndoaXRlKCduYW1lOicpLFxuICAgICAgICBwYXR0ZXJuOiAvXlthLXowLTldW2EtejAtOS1fXFwuXSskLyxcbiAgICAgICAgbWVzc2FnZTogJ25hbWUgbXVzdCBiZSBvbmx5IGxvd2VyY2FzZSBsZXR0ZXJzLCAnICsgJ2RpZ2l0cywgZGFzaGVzLCB1bmRlcnNjb3JlcyBhbmQgZG90cy4nLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgZGVmYXVsdDogZGVmYXVsdEJvdE5hbWVcbiAgICAgIH0sXG4gICAgICB2ZXJzaW9uOiB7XG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ2JvdHByZXNzIHZlcnNpb246JyksXG4gICAgICAgIGRlZmF1bHQ6IGJvdHByZXNzVmVyc2lvblxuICAgICAgfSxcbiAgICAgIGRlc2NyaXB0aW9uOiB7XG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNoYWxrLndoaXRlKCdkZXNjcmlwdGlvbjonKVxuICAgICAgfSxcbiAgICAgIGF1dGhvcjoge1xuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBjaGFsay53aGl0ZSgnYXV0aG9yOicpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb2dyYW0ueWVzKSB7XG4gICAgZ2VuZXJhdGUoe1xuICAgICAgbmFtZTogZGVmYXVsdEJvdE5hbWUsXG4gICAgICB2ZXJzaW9uOiBib3RwcmVzc1ZlcnNpb24sXG4gICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICBhdXRob3I6ICcnXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICBwcm9tcHQubWVzc2FnZSA9ICcnXG4gICAgcHJvbXB0LmRlbGltaXRlciA9ICcnXG4gICAgcHJvbXB0LnN0YXJ0KClcblxuICAgIHByb21wdC5nZXQoc2NoZW1hLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgaWYgKGVyci5tZXNzYWdlICE9PSAnY2FuY2VsZWQnKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzLmV4aXQoMSlcbiAgICAgIH1cblxuICAgICAgZ2VuZXJhdGUocmVzdWx0KVxuICAgIH0pXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/cli/init.js\n");

/***/ }),

/***/ "./src/cli/list.js":
/*!*************************!*\
  !*** ./src/cli/list.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _modules = __webpack_require__(/*! ../modules */ \"./src/modules.js\");\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function () {\n  var modulesManager = (0, _modules2.default)(null, './', null);\n  var modules = modulesManager.listInstalled();\n\n  if (!modules || modules.length === 0) {\n    (0, _util.print)('info', 'There are no module installed.');\n    (0, _util.print)('------------------');\n    (0, _util.print)('info', 'To install modules, use `npm install --save <module-name>`');\n    (0, _util.print)('info', 'You can discover modules in the Modules section of your bot UI' + '. You can also search npm with the botpress keyword.');\n  } else {\n    (0, _util.print)('info', 'There are ' + modules.length + ' modules installed:');\n    modules.forEach(function (mod) {\n      return (0, _util.print)('>> ' + mod);\n    });\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL2xpc3QuanM/ZjdmMCJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlc01hbmFnZXIiLCJtb2R1bGVzIiwibGlzdEluc3RhbGxlZCIsImxlbmd0aCIsImZvckVhY2giLCJtb2QiXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBRUE7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLFlBQU07QUFDckIsTUFBTUMsaUJBQWlCLHVCQUFjLElBQWQsRUFBb0IsSUFBcEIsRUFBMEIsSUFBMUIsQ0FBdkI7QUFDQSxNQUFNQyxVQUFVRCxlQUFlRSxhQUFmLEVBQWhCOztBQUVBLE1BQUksQ0FBQ0QsT0FBRCxJQUFZQSxRQUFRRSxNQUFSLEtBQW1CLENBQW5DLEVBQXNDO0FBQ3BDLHFCQUFNLE1BQU4sRUFBYyxnQ0FBZDtBQUNBLHFCQUFNLG9CQUFOO0FBQ0EscUJBQU0sTUFBTixFQUFjLDREQUFkO0FBQ0EscUJBQ0UsTUFERixFQUVFLG1FQUNFLHNEQUhKO0FBS0QsR0FURCxNQVNPO0FBQ0wscUJBQU0sTUFBTixFQUFjLGVBQWVGLFFBQVFFLE1BQXZCLEdBQWdDLHFCQUE5QztBQUNBRixZQUFRRyxPQUFSLENBQWdCO0FBQUEsYUFBTyxpQkFBTSxRQUFRQyxHQUFkLENBQVA7QUFBQSxLQUFoQjtBQUNEO0FBQ0YsQ0FqQkQiLCJmaWxlIjoiLi9zcmMvY2xpL2xpc3QuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmludCB9IGZyb20gJy4uL3V0aWwnXG5cbmltcG9ydCBjcmVhdGVNb2R1bGVzIGZyb20gJy4uL21vZHVsZXMnXG5cbm1vZHVsZS5leHBvcnRzID0gKCkgPT4ge1xuICBjb25zdCBtb2R1bGVzTWFuYWdlciA9IGNyZWF0ZU1vZHVsZXMobnVsbCwgJy4vJywgbnVsbClcbiAgY29uc3QgbW9kdWxlcyA9IG1vZHVsZXNNYW5hZ2VyLmxpc3RJbnN0YWxsZWQoKVxuXG4gIGlmICghbW9kdWxlcyB8fCBtb2R1bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHByaW50KCdpbmZvJywgJ1RoZXJlIGFyZSBubyBtb2R1bGUgaW5zdGFsbGVkLicpXG4gICAgcHJpbnQoJy0tLS0tLS0tLS0tLS0tLS0tLScpXG4gICAgcHJpbnQoJ2luZm8nLCAnVG8gaW5zdGFsbCBtb2R1bGVzLCB1c2UgYG5wbSBpbnN0YWxsIC0tc2F2ZSA8bW9kdWxlLW5hbWU+YCcpXG4gICAgcHJpbnQoXG4gICAgICAnaW5mbycsXG4gICAgICAnWW91IGNhbiBkaXNjb3ZlciBtb2R1bGVzIGluIHRoZSBNb2R1bGVzIHNlY3Rpb24gb2YgeW91ciBib3QgVUknICtcbiAgICAgICAgJy4gWW91IGNhbiBhbHNvIHNlYXJjaCBucG0gd2l0aCB0aGUgYm90cHJlc3Mga2V5d29yZC4nXG4gICAgKVxuICB9IGVsc2Uge1xuICAgIHByaW50KCdpbmZvJywgJ1RoZXJlIGFyZSAnICsgbW9kdWxlcy5sZW5ndGggKyAnIG1vZHVsZXMgaW5zdGFsbGVkOicpXG4gICAgbW9kdWxlcy5mb3JFYWNoKG1vZCA9PiBwcmludCgnPj4gJyArIG1vZCkpXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/cli/list.js\n");

/***/ }),

/***/ "./src/cli/migrate.js":
/*!****************************!*\
  !*** ./src/cli/migrate.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _stats = __webpack_require__(/*! ../stats */ \"./src/stats.js\");\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (fromVersion) {\n  (0, _stats2.default)({}).track('cli', 'migration', fromVersion);\n\n  if (!_fs2.default.existsSync('./botfile.js')) {\n    throw new Error('You must be inside a bot directory to run a migration');\n  }\n\n  var files = _lodash2.default.sortBy(__webpack_require__(\"./src/cli/migrations sync recursive ^\\\\.\\\\/.*$\").keys(), function (x) {\n    return x;\n  });\n\n  var toApply = _lodash2.default.filter(files, function (f) {\n    if (!/.js$/i.test(f)) {\n      return false;\n    }\n\n    return parseFloat(fromVersion) < parseFloat(f.replace(/\\.js/i, ''));\n  });\n\n  return _bluebird2.default.mapSeries(toApply, function (file) {\n    var migration = __webpack_require__(\"./src/cli/migrations sync recursive ^\\\\.\\\\/.*$\")(\"./\" + file);\n    return migration(_path2.default.resolve('.')).then(function () {\n      _util2.default.print('success', 'Migration ' + file.replace('.js', '') + ' applied successfully');\n    });\n  }).finally(function () {\n    _util2.default.print('success', 'Migration completed.');\n    process.exit(0);\n  });\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL21pZ3JhdGUuanM/ODYxZSJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwidHJhY2siLCJmcm9tVmVyc2lvbiIsImZzIiwiZXhpc3RzU3luYyIsIkVycm9yIiwiZmlsZXMiLCJfIiwic29ydEJ5Iiwia2V5cyIsIngiLCJ0b0FwcGx5IiwiZmlsdGVyIiwidGVzdCIsImYiLCJwYXJzZUZsb2F0IiwicmVwbGFjZSIsIlByb21pc2UiLCJtYXBTZXJpZXMiLCJtaWdyYXRpb24iLCJmaWxlIiwicGF0aCIsInJlc29sdmUiLCJ0aGVuIiwidXRpbCIsInByaW50IiwiZmluYWxseSIsInByb2Nlc3MiLCJleGl0Il0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUFBLE9BQU9DLE9BQVAsR0FBaUIsdUJBQWU7QUFDOUIsdUJBQU0sRUFBTixFQUFVQyxLQUFWLENBQWdCLEtBQWhCLEVBQXVCLFdBQXZCLEVBQW9DQyxXQUFwQzs7QUFFQSxNQUFJLENBQUNDLGFBQUdDLFVBQUgsQ0FBYyxjQUFkLENBQUwsRUFBb0M7QUFDbEMsVUFBTSxJQUFJQyxLQUFKLENBQVUsdURBQVYsQ0FBTjtBQUNEOztBQUVELE1BQU1DLFFBQVFDLGlCQUFFQyxNQUFGLENBQVMsc0VBQWlDQyxJQUFqQyxFQUFULEVBQWtEO0FBQUEsV0FBS0MsQ0FBTDtBQUFBLEdBQWxELENBQWQ7O0FBRUEsTUFBTUMsVUFBVUosaUJBQUVLLE1BQUYsQ0FBU04sS0FBVCxFQUFnQixhQUFLO0FBQ25DLFFBQUksQ0FBQyxRQUFRTyxJQUFSLENBQWFDLENBQWIsQ0FBTCxFQUFzQjtBQUNwQixhQUFPLEtBQVA7QUFDRDs7QUFFRCxXQUFPQyxXQUFXYixXQUFYLElBQTBCYSxXQUFXRCxFQUFFRSxPQUFGLENBQVUsT0FBVixFQUFtQixFQUFuQixDQUFYLENBQWpDO0FBQ0QsR0FOZSxDQUFoQjs7QUFRQSxTQUFPQyxtQkFBUUMsU0FBUixDQUFrQlAsT0FBbEIsRUFBMkIsZ0JBQVE7QUFDeEMsUUFBTVEsWUFBWSwwRUFBUSxHQUFrQkMsSUFBMUIsQ0FBbEI7QUFDQSxXQUFPRCxVQUFVRSxlQUFLQyxPQUFMLENBQWEsR0FBYixDQUFWLEVBQTZCQyxJQUE3QixDQUFrQyxZQUFNO0FBQzdDQyxxQkFBS0MsS0FBTCxDQUFXLFNBQVgsaUJBQW1DTCxLQUFLSixPQUFMLENBQWEsS0FBYixFQUFvQixFQUFwQixDQUFuQztBQUNELEtBRk0sQ0FBUDtBQUdELEdBTE0sRUFLSlUsT0FMSSxDQUtJLFlBQU07QUFDZkYsbUJBQUtDLEtBQUwsQ0FBVyxTQUFYLEVBQXNCLHNCQUF0QjtBQUNBRSxZQUFRQyxJQUFSLENBQWEsQ0FBYjtBQUNELEdBUk0sQ0FBUDtBQVNELENBMUJEIiwiZmlsZSI6Ii4vc3JjL2NsaS9taWdyYXRlLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcbmltcG9ydCBzdGF0cyBmcm9tICcuLi9zdGF0cydcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxubW9kdWxlLmV4cG9ydHMgPSBmcm9tVmVyc2lvbiA9PiB7XG4gIHN0YXRzKHt9KS50cmFjaygnY2xpJywgJ21pZ3JhdGlvbicsIGZyb21WZXJzaW9uKVxuXG4gIGlmICghZnMuZXhpc3RzU3luYygnLi9ib3RmaWxlLmpzJykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGJlIGluc2lkZSBhIGJvdCBkaXJlY3RvcnkgdG8gcnVuIGEgbWlncmF0aW9uJylcbiAgfVxuXG4gIGNvbnN0IGZpbGVzID0gXy5zb3J0QnkocmVxdWlyZS5jb250ZXh0KCcuL21pZ3JhdGlvbnMvJykua2V5cygpLCB4ID0+IHgpXG5cbiAgY29uc3QgdG9BcHBseSA9IF8uZmlsdGVyKGZpbGVzLCBmID0+IHtcbiAgICBpZiAoIS8uanMkL2kudGVzdChmKSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcnNlRmxvYXQoZnJvbVZlcnNpb24pIDwgcGFyc2VGbG9hdChmLnJlcGxhY2UoL1xcLmpzL2ksICcnKSlcbiAgfSlcblxuICByZXR1cm4gUHJvbWlzZS5tYXBTZXJpZXModG9BcHBseSwgZmlsZSA9PiB7XG4gICAgY29uc3QgbWlncmF0aW9uID0gcmVxdWlyZSgnLi9taWdyYXRpb25zLycgKyBmaWxlKVxuICAgIHJldHVybiBtaWdyYXRpb24ocGF0aC5yZXNvbHZlKCcuJykpLnRoZW4oKCkgPT4ge1xuICAgICAgdXRpbC5wcmludCgnc3VjY2VzcycsIGBNaWdyYXRpb24gJHtmaWxlLnJlcGxhY2UoJy5qcycsICcnKX0gYXBwbGllZCBzdWNjZXNzZnVsbHlgKVxuICAgIH0pXG4gIH0pLmZpbmFsbHkoKCkgPT4ge1xuICAgIHV0aWwucHJpbnQoJ3N1Y2Nlc3MnLCAnTWlncmF0aW9uIGNvbXBsZXRlZC4nKVxuICAgIHByb2Nlc3MuZXhpdCgwKVxuICB9KVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/cli/migrate.js\n");

/***/ }),

/***/ "./src/cli/migrations sync recursive ^\\.\\/.*$":
/*!******************************************!*\
  !*** ./src/cli/migrations sync ^\.\/.*$ ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var map = {\n\t\"./0.1\": \"./src/cli/migrations/0.1.js\",\n\t\"./0.1.js\": \"./src/cli/migrations/0.1.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./src/cli/migrations sync recursive ^\\\\.\\\\/.*$\";//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL21pZ3JhdGlvbnMgc3luYyBeXFwuXFwvLiokPzQ5YmMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiLi9zcmMvY2xpL21pZ3JhdGlvbnMgc3luYyByZWN1cnNpdmUgXlxcLlxcLy4qJC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBtYXAgPSB7XG5cdFwiLi8wLjFcIjogXCIuL3NyYy9jbGkvbWlncmF0aW9ucy8wLjEuanNcIixcblx0XCIuLzAuMS5qc1wiOiBcIi4vc3JjL2NsaS9taWdyYXRpb25zLzAuMS5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHR2YXIgaWQgPSBtYXBbcmVxXTtcblx0aWYoIShpZCArIDEpKSB7IC8vIGNoZWNrIGZvciBudW1iZXIgb3Igc3RyaW5nXG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBpZDtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSBcIi4vc3JjL2NsaS9taWdyYXRpb25zIHN5bmMgcmVjdXJzaXZlIF5cXFxcLlxcXFwvLiokXCI7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/cli/migrations sync recursive ^\\.\\/.*$\n");

/***/ }),

/***/ "./src/cli/migrations/0.1.js":
/*!***********************************!*\
  !*** ./src/cli/migrations/0.1.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _knex = __webpack_require__(/*! knex */ \"knex\");\n\nvar _knex2 = _interopRequireDefault(_knex);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _kvs = __webpack_require__(/*! ../../database/kvs */ \"./src/database/kvs.js\");\n\nvar _kvs2 = _interopRequireDefault(_kvs);\n\nvar _util = __webpack_require__(/*! ../../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction dropTableIfExists(knex, tableName) {\n  return knex.schema.hasTable(tableName).then(function (has) {\n    if (has) {\n      return knex.schema.dropTable(tableName);\n    }\n  });\n}\n\nfunction migrate_database_schema(dbLocation) {\n  var updateUsers = 'strftime(\\'%Y-%m-%dT%H:%M:%fZ\\', created_on/1000, \\'unixepoch\\')';\n\n  var knex = (0, _knex2.default)({\n    client: 'sqlite3',\n    connection: { filename: dbLocation },\n    useNullAsDefault: true\n  });\n\n  return knex.schema.table('users', function (table) {\n    table.string('picture_url');\n    table.string('first_name');\n    table.string('last_name');\n  }).then(function () {\n    return knex('users').update({ created_on: knex.raw(updateUsers) });\n  }).then(function (rows) {\n    _util2.default.print('info', 'Updated ' + rows + ' users');\n    _util2.default.print('warn', 'Users table was migrated to new schema but existing ' + 'users will miss the following fields: `picture_url`, `first_name`, ' + '`last_name`. They have been left to `null`.');\n  }).catch(function () {\n    _util2.default.print('warn', 'Did not migrate table `users` as schema was already up to date');\n  }).then(function () {\n    return (0, _kvs2.default)(knex).bootstrap();\n  }).catch(function () {\n    _util2.default.print('warn', 'Did not create table `kvs` as schema was already up to date');\n  }).then(function () {\n    if (!process.env.DELETE_TABLES) {\n      _util2.default.print('warn', 'This migration must delete the tables of ' + 'the following modules: `botpress-scheduler`, `botpress-analytics`, ' + '`botpress-hitl` and `botpress-subscription`.');\n\n      _util2.default.print('warn', \"This step has been skipped because you didn't provide \" + 'the DELETE_TABLES=true environement variable.');\n\n      _util2.default.print('warn', 'Please backup your data if necessary then re-run with DELETE_TABLES=true');\n      return false;\n    }\n\n    return dropTableIfExists(knex, 'analytics_interactions').then(function () {\n      return dropTableIfExists(knex, 'analytics_runs');\n    }).then(function () {\n      return dropTableIfExists(knex, 'broadcast_outbox');\n    }).then(function () {\n      return dropTableIfExists(knex, 'broadcast_schedules');\n    }).then(function () {\n      return dropTableIfExists(knex, 'hitl_messages');\n    }).then(function () {\n      return dropTableIfExists(knex, 'hitl_sessions');\n    }).then(function () {\n      return dropTableIfExists(knex, 'subscription_users');\n    }).then(function () {\n      return dropTableIfExists(knex, 'subscriptions');\n    }).then(function () {\n      return dropTableIfExists(knex, 'scheduler_schedules');\n    }).then(function () {\n      return dropTableIfExists(knex, 'scheduler_tasks');\n    }).then(function () {\n      return _util2.default.print('info', 'Dropped module tables');\n    });\n  });\n}\n\nfunction migrate_botfile(botfilePath) {\n  var before = _fs2.default.readFileSync(botfilePath).toString();\n\n  if (before.indexOf('postgres:') >= 0) {\n    _util2.default.print('warn', 'Did not migrate botfile as it seemed like `postgres`' + ' was already present. Please migrate manually if this is a mistake.');\n    return false;\n  }\n\n  var after = before.replace(/module\\.exports.*?=.*?{/i, 'module.exports = {\\n\\n  /**\\n  * Postgres configuration\\n  */\\n  postgres: {\\n    enabled: process.env.DATABASE === \\'postgres\\',\\n    host: process.env.PG_HOST || \\'127.0.0.1\\',\\n    port: process.env.PG_PORT || 5432,\\n    user: process.env.PG_USER || \\'\\',\\n    password: process.env.PG_PASSWORD || \\'\\',\\n    database: process.env.PG_DB || \\'\\'\\n  },');\n\n  _fs2.default.writeFileSync(botfilePath, after);\n\n  _util2.default.print('info', 'Updated botfile');\n}\n\nmodule.exports = function (bot_path) {\n  var botfilePath = _path2.default.join(bot_path, 'botfile.js');\n  // eslint-disable-next-line no-eval\n  var botfile = eval('require')(botfilePath);\n  var dbLocation = _path2.default.resolve(_path2.default.join(bot_path, botfile.dataDir, 'db.sqlite'));\n\n  return migrate_database_schema(dbLocation).then(function () {\n    return migrate_botfile(botfilePath);\n  });\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL21pZ3JhdGlvbnMvMC4xLmpzPzg0YTUiXSwibmFtZXMiOlsiZHJvcFRhYmxlSWZFeGlzdHMiLCJrbmV4IiwidGFibGVOYW1lIiwic2NoZW1hIiwiaGFzVGFibGUiLCJ0aGVuIiwiaGFzIiwiZHJvcFRhYmxlIiwibWlncmF0ZV9kYXRhYmFzZV9zY2hlbWEiLCJkYkxvY2F0aW9uIiwidXBkYXRlVXNlcnMiLCJjbGllbnQiLCJjb25uZWN0aW9uIiwiZmlsZW5hbWUiLCJ1c2VOdWxsQXNEZWZhdWx0IiwidGFibGUiLCJzdHJpbmciLCJ1cGRhdGUiLCJjcmVhdGVkX29uIiwicmF3IiwidXRpbCIsInByaW50Iiwicm93cyIsImNhdGNoIiwiYm9vdHN0cmFwIiwicHJvY2VzcyIsImVudiIsIkRFTEVURV9UQUJMRVMiLCJtaWdyYXRlX2JvdGZpbGUiLCJib3RmaWxlUGF0aCIsImJlZm9yZSIsImZzIiwicmVhZEZpbGVTeW5jIiwidG9TdHJpbmciLCJpbmRleE9mIiwiYWZ0ZXIiLCJyZXBsYWNlIiwid3JpdGVGaWxlU3luYyIsIm1vZHVsZSIsImV4cG9ydHMiLCJwYXRoIiwiam9pbiIsImJvdF9wYXRoIiwiYm90ZmlsZSIsImV2YWwiLCJyZXNvbHZlIiwiZGF0YURpciJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFFQTs7OztBQUNBOzs7Ozs7QUFFQSxTQUFTQSxpQkFBVCxDQUEyQkMsSUFBM0IsRUFBaUNDLFNBQWpDLEVBQTRDO0FBQzFDLFNBQU9ELEtBQUtFLE1BQUwsQ0FBWUMsUUFBWixDQUFxQkYsU0FBckIsRUFBZ0NHLElBQWhDLENBQXFDLGVBQU87QUFDakQsUUFBSUMsR0FBSixFQUFTO0FBQ1AsYUFBT0wsS0FBS0UsTUFBTCxDQUFZSSxTQUFaLENBQXNCTCxTQUF0QixDQUFQO0FBQ0Q7QUFDRixHQUpNLENBQVA7QUFLRDs7QUFFRCxTQUFTTSx1QkFBVCxDQUFpQ0MsVUFBakMsRUFBNkM7QUFD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QyxNQUFNQyxTQUFTQyxhQUFHQyxZQUFILENBQWdCSCxXQUFoQixFQUE2QkksUUFBN0IsRUFBZjs7QUFFQSxNQUFJSCxPQUFPSSxPQUFQLENBQWUsV0FBZixLQUErQixDQUFuQyxFQUFzQztBQUNwQ2QsbUJBQUtDLEtBQUwsQ0FDRSxNQURGLEVBRUUseURBQ0UscUVBSEo7QUFLQSxXQUFPLEtBQVA7QUFDRDs7QUFFRCxNQUFNYyxRQUFRTCxPQUFPTSxPQUFQLENBQ1osMEJBRFksc1dBQWQ7O0FBaUJBTCxlQUFHTSxhQUFILENBQWlCUixXQUFqQixFQUE4Qk0sS0FBOUI7O0FBRUFmLGlCQUFLQyxLQUFMLENBQVcsTUFBWCxFQUFtQixpQkFBbkI7QUFDRDs7QUFFRGlCLE9BQU9DLE9BQVAsR0FBaUIsb0JBQVk7QUFDM0IsTUFBTVYsY0FBY1csZUFBS0MsSUFBTCxDQUFVQyxRQUFWLEVBQW9CLFlBQXBCLENBQXBCO0FBQ0E7QUFDQSxNQUFNQyxVQUFVQyxLQUFLLFNBQUwsRUFBZ0JmLFdBQWhCLENBQWhCO0FBQ0EsTUFBTXBCLGFBQWErQixlQUFLSyxPQUFMLENBQWFMLGVBQUtDLElBQUwsQ0FBVUMsUUFBVixFQUFvQkMsUUFBUUcsT0FBNUIsRUFBcUMsV0FBckMsQ0FBYixDQUFuQjs7QUFFQSxTQUFPdEMsd0JBQXdCQyxVQUF4QixFQUFvQ0osSUFBcEMsQ0FBeUM7QUFBQSxXQUFNdUIsZ0JBQWdCQyxXQUFoQixDQUFOO0FBQUEsR0FBekMsQ0FBUDtBQUNELENBUEQiLCJmaWxlIjoiLi9zcmMvY2xpL21pZ3JhdGlvbnMvMC4xLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEtuZXggZnJvbSAna25leCdcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5cbmltcG9ydCBrdnMgZnJvbSAnLi4vLi4vZGF0YWJhc2Uva3ZzJ1xuaW1wb3J0IHV0aWwgZnJvbSAnLi4vLi4vdXRpbCdcblxuZnVuY3Rpb24gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgdGFibGVOYW1lKSB7XG4gIHJldHVybiBrbmV4LnNjaGVtYS5oYXNUYWJsZSh0YWJsZU5hbWUpLnRoZW4oaGFzID0+IHtcbiAgICBpZiAoaGFzKSB7XG4gICAgICByZXR1cm4ga25leC5zY2hlbWEuZHJvcFRhYmxlKHRhYmxlTmFtZSlcbiAgICB9XG4gIH0pXG59XG5cbmZ1bmN0aW9uIG1pZ3JhdGVfZGF0YWJhc2Vfc2NoZW1hKGRiTG9jYXRpb24pIHtcbiAgY29uc3QgdXBkYXRlVXNlcnMgPSBgc3RyZnRpbWUoJyVZLSVtLSVkVCVIOiVNOiVmWicsIGNyZWF0ZWRfb24vMTAwMCwgJ3VuaXhlcG9jaCcpYFxuXG4gIGNvbnN0IGtuZXggPSBLbmV4KHtcbiAgICBjbGllbnQ6ICdzcWxpdGUzJyxcbiAgICBjb25uZWN0aW9uOiB7IGZpbGVuYW1lOiBkYkxvY2F0aW9uIH0sXG4gICAgdXNlTnVsbEFzRGVmYXVsdDogdHJ1ZVxuICB9KVxuXG4gIHJldHVybiBrbmV4LnNjaGVtYVxuICAgIC50YWJsZSgndXNlcnMnLCBmdW5jdGlvbih0YWJsZSkge1xuICAgICAgdGFibGUuc3RyaW5nKCdwaWN0dXJlX3VybCcpXG4gICAgICB0YWJsZS5zdHJpbmcoJ2ZpcnN0X25hbWUnKVxuICAgICAgdGFibGUuc3RyaW5nKCdsYXN0X25hbWUnKVxuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ga25leCgndXNlcnMnKS51cGRhdGUoeyBjcmVhdGVkX29uOiBrbmV4LnJhdyh1cGRhdGVVc2VycykgfSkpXG4gICAgLnRoZW4ocm93cyA9PiB7XG4gICAgICB1dGlsLnByaW50KCdpbmZvJywgJ1VwZGF0ZWQgJyArIHJvd3MgKyAnIHVzZXJzJylcbiAgICAgIHV0aWwucHJpbnQoXG4gICAgICAgICd3YXJuJyxcbiAgICAgICAgJ1VzZXJzIHRhYmxlIHdhcyBtaWdyYXRlZCB0byBuZXcgc2NoZW1hIGJ1dCBleGlzdGluZyAnICtcbiAgICAgICAgICAndXNlcnMgd2lsbCBtaXNzIHRoZSBmb2xsb3dpbmcgZmllbGRzOiBgcGljdHVyZV91cmxgLCBgZmlyc3RfbmFtZWAsICcgK1xuICAgICAgICAgICdgbGFzdF9uYW1lYC4gVGhleSBoYXZlIGJlZW4gbGVmdCB0byBgbnVsbGAuJ1xuICAgICAgKVxuICAgIH0pXG4gICAgLmNhdGNoKCgpID0+IHtcbiAgICAgIHV0aWwucHJpbnQoJ3dhcm4nLCAnRGlkIG5vdCBtaWdyYXRlIHRhYmxlIGB1c2Vyc2AgYXMgc2NoZW1hIHdhcyBhbHJlYWR5IHVwIHRvIGRhdGUnKVxuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ga3ZzKGtuZXgpLmJvb3RzdHJhcCgpKVxuICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICB1dGlsLnByaW50KCd3YXJuJywgJ0RpZCBub3QgY3JlYXRlIHRhYmxlIGBrdnNgIGFzIHNjaGVtYSB3YXMgYWxyZWFkeSB1cCB0byBkYXRlJylcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGlmICghcHJvY2Vzcy5lbnYuREVMRVRFX1RBQkxFUykge1xuICAgICAgICB1dGlsLnByaW50KFxuICAgICAgICAgICd3YXJuJyxcbiAgICAgICAgICAnVGhpcyBtaWdyYXRpb24gbXVzdCBkZWxldGUgdGhlIHRhYmxlcyBvZiAnICtcbiAgICAgICAgICAgICd0aGUgZm9sbG93aW5nIG1vZHVsZXM6IGBib3RwcmVzcy1zY2hlZHVsZXJgLCBgYm90cHJlc3MtYW5hbHl0aWNzYCwgJyArXG4gICAgICAgICAgICAnYGJvdHByZXNzLWhpdGxgIGFuZCBgYm90cHJlc3Mtc3Vic2NyaXB0aW9uYC4nXG4gICAgICAgIClcblxuICAgICAgICB1dGlsLnByaW50KFxuICAgICAgICAgICd3YXJuJyxcbiAgICAgICAgICBcIlRoaXMgc3RlcCBoYXMgYmVlbiBza2lwcGVkIGJlY2F1c2UgeW91IGRpZG4ndCBwcm92aWRlIFwiICsgJ3RoZSBERUxFVEVfVEFCTEVTPXRydWUgZW52aXJvbmVtZW50IHZhcmlhYmxlLidcbiAgICAgICAgKVxuXG4gICAgICAgIHV0aWwucHJpbnQoJ3dhcm4nLCAnUGxlYXNlIGJhY2t1cCB5b3VyIGRhdGEgaWYgbmVjZXNzYXJ5IHRoZW4gcmUtcnVuIHdpdGggREVMRVRFX1RBQkxFUz10cnVlJylcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnYW5hbHl0aWNzX2ludGVyYWN0aW9ucycpXG4gICAgICAgIC50aGVuKCgpID0+IGRyb3BUYWJsZUlmRXhpc3RzKGtuZXgsICdhbmFseXRpY3NfcnVucycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnYnJvYWRjYXN0X291dGJveCcpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnYnJvYWRjYXN0X3NjaGVkdWxlcycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnaGl0bF9tZXNzYWdlcycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnaGl0bF9zZXNzaW9ucycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnc3Vic2NyaXB0aW9uX3VzZXJzJykpXG4gICAgICAgIC50aGVuKCgpID0+IGRyb3BUYWJsZUlmRXhpc3RzKGtuZXgsICdzdWJzY3JpcHRpb25zJykpXG4gICAgICAgIC50aGVuKCgpID0+IGRyb3BUYWJsZUlmRXhpc3RzKGtuZXgsICdzY2hlZHVsZXJfc2NoZWR1bGVzJykpXG4gICAgICAgIC50aGVuKCgpID0+IGRyb3BUYWJsZUlmRXhpc3RzKGtuZXgsICdzY2hlZHVsZXJfdGFza3MnKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gdXRpbC5wcmludCgnaW5mbycsICdEcm9wcGVkIG1vZHVsZSB0YWJsZXMnKSlcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBtaWdyYXRlX2JvdGZpbGUoYm90ZmlsZVBhdGgpIHtcbiAgY29uc3QgYmVmb3JlID0gZnMucmVhZEZpbGVTeW5jKGJvdGZpbGVQYXRoKS50b1N0cmluZygpXG5cbiAgaWYgKGJlZm9yZS5pbmRleE9mKCdwb3N0Z3JlczonKSA+PSAwKSB7XG4gICAgdXRpbC5wcmludChcbiAgICAgICd3YXJuJyxcbiAgICAgICdEaWQgbm90IG1pZ3JhdGUgYm90ZmlsZSBhcyBpdCBzZWVtZWQgbGlrZSBgcG9zdGdyZXNgJyArXG4gICAgICAgICcgd2FzIGFscmVhZHkgcHJlc2VudC4gUGxlYXNlIG1pZ3JhdGUgbWFudWFsbHkgaWYgdGhpcyBpcyBhIG1pc3Rha2UuJ1xuICAgIClcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIGNvbnN0IGFmdGVyID0gYmVmb3JlLnJlcGxhY2UoXG4gICAgL21vZHVsZVxcLmV4cG9ydHMuKj89Lio/ey9pLFxuICAgIGBtb2R1bGUuZXhwb3J0cyA9IHtcblxuICAvKipcbiAgKiBQb3N0Z3JlcyBjb25maWd1cmF0aW9uXG4gICovXG4gIHBvc3RncmVzOiB7XG4gICAgZW5hYmxlZDogcHJvY2Vzcy5lbnYuREFUQUJBU0UgPT09ICdwb3N0Z3JlcycsXG4gICAgaG9zdDogcHJvY2Vzcy5lbnYuUEdfSE9TVCB8fCAnMTI3LjAuMC4xJyxcbiAgICBwb3J0OiBwcm9jZXNzLmVudi5QR19QT1JUIHx8IDU0MzIsXG4gICAgdXNlcjogcHJvY2Vzcy5lbnYuUEdfVVNFUiB8fCAnJyxcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUEdfUEFTU1dPUkQgfHwgJycsXG4gICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LlBHX0RCIHx8ICcnXG4gIH0sYFxuICApXG5cbiAgZnMud3JpdGVGaWxlU3luYyhib3RmaWxlUGF0aCwgYWZ0ZXIpXG5cbiAgdXRpbC5wcmludCgnaW5mbycsICdVcGRhdGVkIGJvdGZpbGUnKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJvdF9wYXRoID0+IHtcbiAgY29uc3QgYm90ZmlsZVBhdGggPSBwYXRoLmpvaW4oYm90X3BhdGgsICdib3RmaWxlLmpzJylcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgY29uc3QgYm90ZmlsZSA9IGV2YWwoJ3JlcXVpcmUnKShib3RmaWxlUGF0aClcbiAgY29uc3QgZGJMb2NhdGlvbiA9IHBhdGgucmVzb2x2ZShwYXRoLmpvaW4oYm90X3BhdGgsIGJvdGZpbGUuZGF0YURpciwgJ2RiLnNxbGl0ZScpKVxuXG4gIHJldHVybiBtaWdyYXRlX2RhdGFiYXNlX3NjaGVtYShkYkxvY2F0aW9uKS50aGVuKCgpID0+IG1pZ3JhdGVfYm90ZmlsZShib3RmaWxlUGF0aCkpXG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/cli/migrations/0.1.js\n");

/***/ }),

/***/ "./src/cli/start.js":
/*!**************************!*\
  !*** ./src/cli/start.js ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _os = __webpack_require__(/*! os */ \"os\");\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _nodemon = __webpack_require__(/*! nodemon */ \"nodemon\");\n\nvar _nodemon2 = _interopRequireDefault(_nodemon);\n\nvar _monitorctrlc = __webpack_require__(/*! monitorctrlc */ \"monitorctrlc\");\n\nvar _child_process = __webpack_require__(/*! child_process */ \"child_process\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar getPath = function getPath(path) {\n  if (_os2.default.platform() === 'win32') {\n    var shortPath = (0, _child_process.execSync)('@echo off && for %I in (\"' + path + '\") do echo %~sI');\n    return shortPath.toString('utf8').replace(/(\\n|\\r)+$/, '');\n  } else {\n    return path;\n  }\n};\n\n/**\n * Entry point of botpress\n *\n * It will do the following things:\n *\n * 1. Find botpress instance creator in `node_modules` folder in current project.\n * 2. Find the `botfile.js` which will be injected into the creator to create the instance.\n * 3. Start the botpress instance.\n */\nmodule.exports = function (projectPath, options) {\n  var Botpress = null;\n\n  if (!projectPath || typeof projectPath !== 'string') {\n    projectPath = '.';\n  }\n\n  projectPath = _path2.default.resolve(projectPath);\n\n  try {\n    // eslint-disable-next-line no-eval\n    Botpress = eval('require')(_path2.default.join(projectPath, 'node_modules', 'botpress')).Botpress();\n  } catch (err) {\n    _util2.default.print('error', err.message);\n    _util2.default.print('error', err.stack);\n    _util2.default.print('error', '(fatal) Could not load the local version of botpress');\n    _util2.default.print('Hint: 1) have you used `botpress init` to create a new bot the proper way?');\n    _util2.default.print('Hint: 2) Do you have read and write permissions on the current directory?');\n    _util2.default.print('-------------');\n    _util2.default.print('If none of the above works, this might be a bug in botpress. ' + 'Please contact the Botpress Team on gitter and provide the printed error above.');\n    process.exit(1);\n  }\n\n  var botfile = _path2.default.join(projectPath, 'botfile.js');\n  if (!_fs2.default.existsSync(botfile)) {\n    _util2.default.print('error', '(fatal) No ' + _chalk2.default.bold('botfile.js') + ' file found at: ' + botfile);\n    process.exit(1);\n  }\n\n  var getDefaultWatchIgnore = function getDefaultWatchIgnore() {\n    // eslint-disable-next-line no-eval\n    var bf = eval('require')(botfile);\n    var dataDir = _util2.default.getDataLocation(bf.dataDir, projectPath);\n    var modulesConfigDir = _util2.default.getDataLocation(bf.modulesConfigDir, projectPath);\n    return [dataDir, modulesConfigDir, 'node_modules'];\n  };\n\n  var opts = options.opts();\n  if (opts.watch || opts.w) {\n    _util2.default.print('info', '*** watching files for changes ***');\n\n    var argvWithoutWatch = process.argv.filter(function (arg) {\n      return !/^(--watch|-w)$/.test(arg);\n    });\n    argvWithoutWatch[0] = getPath(argvWithoutWatch[0]);\n\n    var nodemonOptions = {\n      cwd: process.cwd(),\n      exec: argvWithoutWatch.join(' '),\n      ext: opts.watchExt,\n      watch: opts.watchDir && opts.watchDir.length ? opts.watchDir : undefined,\n      ignore: opts.watchIgnore && opts.watchIgnore.length ? opts.watchIgnore : getDefaultWatchIgnore(),\n      stdin: false,\n      restartable: false\n    };\n\n    var mon = (0, _nodemon2.default)(nodemonOptions);\n    mon.on('restart', function (changedFile, two) {\n      return _util2.default.print('info', '*** restarting botpress because of file change: ', changedFile);\n    });\n\n    (0, _monitorctrlc.monitorCtrlC)(function () {\n      mon.emit('quit');\n      setTimeout(function () {\n        return process.exit();\n      }, 100);\n    });\n  } else {\n    var bot = new Botpress({ botfile: botfile });\n    bot.start();\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL3N0YXJ0LmpzPzk3MjUiXSwibmFtZXMiOlsiZ2V0UGF0aCIsIm9zIiwicGxhdGZvcm0iLCJzaG9ydFBhdGgiLCJwYXRoIiwidG9TdHJpbmciLCJyZXBsYWNlIiwibW9kdWxlIiwiZXhwb3J0cyIsInByb2plY3RQYXRoIiwib3B0aW9ucyIsIkJvdHByZXNzIiwicmVzb2x2ZSIsImV2YWwiLCJqb2luIiwiZXJyIiwidXRpbCIsInByaW50IiwibWVzc2FnZSIsInN0YWNrIiwicHJvY2VzcyIsImV4aXQiLCJib3RmaWxlIiwiZnMiLCJleGlzdHNTeW5jIiwiY2hhbGsiLCJib2xkIiwiZ2V0RGVmYXVsdFdhdGNoSWdub3JlIiwiYmYiLCJkYXRhRGlyIiwiZ2V0RGF0YUxvY2F0aW9uIiwibW9kdWxlc0NvbmZpZ0RpciIsIm9wdHMiLCJ3YXRjaCIsInciLCJhcmd2V2l0aG91dFdhdGNoIiwiYXJndiIsImZpbHRlciIsInRlc3QiLCJhcmciLCJub2RlbW9uT3B0aW9ucyIsImN3ZCIsImV4ZWMiLCJleHQiLCJ3YXRjaEV4dCIsIndhdGNoRGlyIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiaWdub3JlIiwid2F0Y2hJZ25vcmUiLCJzdGRpbiIsInJlc3RhcnRhYmxlIiwibW9uIiwib24iLCJjaGFuZ2VkRmlsZSIsInR3byIsImVtaXQiLCJzZXRUaW1lb3V0IiwiYm90Iiwic3RhcnQiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7O0FBQ0E7Ozs7QUFFQSxJQUFNQSxVQUFVLFNBQVZBLE9BQVUsT0FBUTtBQUN0QixNQUFJQyxhQUFHQyxRQUFILE9BQWtCLE9BQXRCLEVBQStCO0FBQzdCLFFBQU1DLFlBQVksMkRBQXFDQyxJQUFyQyxxQkFBbEI7QUFDQSxXQUFPRCxVQUFVRSxRQUFWLENBQW1CLE1BQW5CLEVBQTJCQyxPQUEzQixDQUFtQyxXQUFuQyxFQUFnRCxF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dUJBTHBEO0FBTXJCdUIsYUFBTyxLQU5jO0FBT3JCQyxtQkFBYTtBQVBRLEtBQXZCOztBQVVBLFFBQU1DLE1BQU0sdUJBQVFaLGNBQVIsQ0FBWjtBQUNBWSxRQUFJQyxFQUFKLENBQU8sU0FBUCxFQUFrQixVQUFDQyxXQUFELEVBQWNDLEdBQWQ7QUFBQSxhQUNoQnZDLGVBQUtDLEtBQUwsQ0FBVyxNQUFYLEVBQW1CLGtEQUFuQixFQUF1RXFDLFdBQXZFLENBRGdCO0FBQUEsS0FBbEI7O0FBSUEsb0NBQWEsWUFBTTtBQUNqQkYsVUFBSUksSUFBSixDQUFTLE1BQVQ7QUFDQUMsaUJBQVc7QUFBQSxlQUFNckMsUUFBUUMsSUFBUixFQUFOO0FBQUEsT0FBWCxFQUFpQyxHQUFqQztBQUNELEtBSEQ7QUFJRCxHQXpCRCxNQXlCTztBQUNMLFFBQU1xQyxNQUFNLElBQUkvQyxRQUFKLENBQWEsRUFBRVcsZ0JBQUYsRUFBYixDQUFaO0FBQ0FvQyxRQUFJQyxLQUFKO0FBQ0Q7QUFDRixDQXRFRCIsImZpbGUiOiIuL3NyYy9jbGkvc3RhcnQuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgb3MgZnJvbSAnb3MnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcbmltcG9ydCBjaGFsayBmcm9tICdjaGFsaydcbmltcG9ydCBub2RlbW9uIGZyb20gJ25vZGVtb24nXG5pbXBvcnQgeyBtb25pdG9yQ3RybEMgfSBmcm9tICdtb25pdG9yY3RybGMnXG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnXG5cbmNvbnN0IGdldFBhdGggPSBwYXRoID0+IHtcbiAgaWYgKG9zLnBsYXRmb3JtKCkgPT09ICd3aW4zMicpIHtcbiAgICBjb25zdCBzaG9ydFBhdGggPSBleGVjU3luYyhgQGVjaG8gb2ZmICYmIGZvciAlSSBpbiAoXCIke3BhdGh9XCIpIGRvIGVjaG8gJX5zSWApXG4gICAgcmV0dXJuIHNob3J0UGF0aC50b1N0cmluZygndXRmOCcpLnJlcGxhY2UoLyhcXG58XFxyKSskLywgJycpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHBhdGhcbiAgfVxufVxuXG4vKipcbiAqIEVudHJ5IHBvaW50IG9mIGJvdHByZXNzXG4gKlxuICogSXQgd2lsbCBkbyB0aGUgZm9sbG93aW5nIHRoaW5nczpcbiAqXG4gKiAxLiBGaW5kIGJvdHByZXNzIGluc3RhbmNlIGNyZWF0b3IgaW4gYG5vZGVfbW9kdWxlc2AgZm9sZGVyIGluIGN1cnJlbnQgcHJvamVjdC5cbiAqIDIuIEZpbmQgdGhlIGBib3RmaWxlLmpzYCB3aGljaCB3aWxsIGJlIGluamVjdGVkIGludG8gdGhlIGNyZWF0b3IgdG8gY3JlYXRlIHRoZSBpbnN0YW5jZS5cbiAqIDMuIFN0YXJ0IHRoZSBib3RwcmVzcyBpbnN0YW5jZS5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSAocHJvamVjdFBhdGgsIG9wdGlvbnMpID0+IHtcbiAgbGV0IEJvdHByZXNzID0gbnVsbFxuXG4gIGlmICghcHJvamVjdFBhdGggfHwgdHlwZW9mIHByb2plY3RQYXRoICE9PSAnc3RyaW5nJykge1xuICAgIHByb2plY3RQYXRoID0gJy4nXG4gIH1cblxuICBwcm9qZWN0UGF0aCA9IHBhdGgucmVzb2x2ZShwcm9qZWN0UGF0aClcblxuICB0cnkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1ldmFsXG4gICAgQm90cHJlc3MgPSBldmFsKCdyZXF1aXJlJykocGF0aC5qb2luKHByb2plY3RQYXRoLCAnbm9kZV9tb2R1bGVzJywgJ2JvdHByZXNzJykpLkJvdHByZXNzKClcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgdXRpbC5wcmludCgnZXJyb3InLCBlcnIubWVzc2FnZSlcbiAgICB1dGlsLnByaW50KCdlcnJvcicsIGVyci5zdGFjaylcbiAgICB1dGlsLnByaW50KCdlcnJvcicsICcoZmF0YWwpIENvdWxkIG5vdCBsb2FkIHRoZSBsb2NhbCB2ZXJzaW9uIG9mIGJvdHByZXNzJylcbiAgICB1dGlsLnByaW50KCdIaW50OiAxKSBoYXZlIHlvdSB1c2VkIGBib3RwcmVzcyBpbml0YCB0byBjcmVhdGUgYSBuZXcgYm90IHRoZSBwcm9wZXIgd2F5PycpXG4gICAgdXRpbC5wcmludCgnSGludDogMikgRG8geW91IGhhdmUgcmVhZCBhbmQgd3JpdGUgcGVybWlzc2lvbnMgb24gdGhlIGN1cnJlbnQgZGlyZWN0b3J5PycpXG4gICAgdXRpbC5wcmludCgnLS0tLS0tLS0tLS0tLScpXG4gICAgdXRpbC5wcmludChcbiAgICAgICdJZiBub25lIG9mIHRoZSBhYm92ZSB3b3JrcywgdGhpcyBtaWdodCBiZSBhIGJ1ZyBpbiBib3RwcmVzcy4gJyArXG4gICAgICAgICdQbGVhc2UgY29udGFjdCB0aGUgQm90cHJlc3MgVGVhbSBvbiBnaXR0ZXIgYW5kIHByb3ZpZGUgdGhlIHByaW50ZWQgZXJyb3IgYWJvdmUuJ1xuICAgIClcbiAgICBwcm9jZXNzLmV4aXQoMSlcbiAgfVxuXG4gIGNvbnN0IGJvdGZpbGUgPSBwYXRoLmpvaW4ocHJvamVjdFBhdGgsICdib3RmaWxlLmpzJylcbiAgaWYgKCFmcy5leGlzdHNTeW5jKGJvdGZpbGUpKSB7XG4gICAgdXRpbC5wcmludCgnZXJyb3InLCBgKGZhdGFsKSBObyAke2NoYWxrLmJvbGQoJ2JvdGZpbGUuanMnKX0gZmlsZSBmb3VuZCBhdDogYCArIGJvdGZpbGUpXG4gICAgcHJvY2Vzcy5leGl0KDEpXG4gIH1cblxuICBjb25zdCBnZXREZWZhdWx0V2F0Y2hJZ25vcmUgPSAoKSA9PiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICBjb25zdCBiZiA9IGV2YWwoJ3JlcXVpcmUnKShib3RmaWxlKVxuICAgIGNvbnN0IGRhdGFEaXIgPSB1dGlsLmdldERhdGFMb2NhdGlvbihiZi5kYXRhRGlyLCBwcm9qZWN0UGF0aClcbiAgICBjb25zdCBtb2R1bGVzQ29uZmlnRGlyID0gdXRpbC5nZXREYXRhTG9jYXRpb24oYmYubW9kdWxlc0NvbmZpZ0RpciwgcHJvamVjdFBhdGgpXG4gICAgcmV0dXJuIFtkYXRhRGlyLCBtb2R1bGVzQ29uZmlnRGlyLCAnbm9kZV9tb2R1bGVzJ11cbiAgfVxuXG4gIGNvbnN0IG9wdHMgPSBvcHRpb25zLm9wdHMoKVxuICBpZiAob3B0cy53YXRjaCB8fCBvcHRzLncpIHtcbiAgICB1dGlsLnByaW50KCdpbmZvJywgJyoqKiB3YXRjaGluZyBmaWxlcyBmb3IgY2hhbmdlcyAqKionKVxuXG4gICAgY29uc3QgYXJndldpdGhvdXRXYXRjaCA9IHByb2Nlc3MuYXJndi5maWx0ZXIoYXJnID0+ICEvXigtLXdhdGNofC13KSQvLnRlc3QoYXJnKSlcbiAgICBhcmd2V2l0aG91dFdhdGNoWzBdID0gZ2V0UGF0aChhcmd2V2l0aG91dFdhdGNoWzBdKVxuXG4gICAgY29uc3Qgbm9kZW1vbk9wdGlvbnMgPSB7XG4gICAgICBjd2Q6IHByb2Nlc3MuY3dkKCksXG4gICAgICBleGVjOiBhcmd2V2l0aG91dFdhdGNoLmpvaW4oJyAnKSxcbiAgICAgIGV4dDogb3B0cy53YXRjaEV4dCxcbiAgICAgIHdhdGNoOiBvcHRzLndhdGNoRGlyICYmIG9wdHMud2F0Y2hEaXIubGVuZ3RoID8gb3B0cy53YXRjaERpciA6IHVuZGVmaW5lZCxcbiAgICAgIGlnbm9yZTogb3B0cy53YXRjaElnbm9yZSAmJiBvcHRzLndhdGNoSWdub3JlLmxlbmd0aCA/IG9wdHMud2F0Y2hJZ25vcmUgOiBnZXREZWZhdWx0V2F0Y2hJZ25vcmUoKSxcbiAgICAgIHN0ZGluOiBmYWxzZSxcbiAgICAgIHJlc3RhcnRhYmxlOiBmYWxzZVxuICAgIH1cblxuICAgIGNvbnN0IG1vbiA9IG5vZGVtb24obm9kZW1vbk9wdGlvbnMpXG4gICAgbW9uLm9uKCdyZXN0YXJ0JywgKGNoYW5nZWRGaWxlLCB0d28pID0+XG4gICAgICB1dGlsLnByaW50KCdpbmZvJywgJyoqKiByZXN0YXJ0aW5nIGJvdHByZXNzIGJlY2F1c2Ugb2YgZmlsZSBjaGFuZ2U6ICcsIGNoYW5nZWRGaWxlKVxuICAgIClcblxuICAgIG1vbml0b3JDdHJsQygoKSA9PiB7XG4gICAgICBtb24uZW1pdCgncXVpdCcpXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHByb2Nlc3MuZXhpdCgpLCAxMDApXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBib3QgPSBuZXcgQm90cHJlc3MoeyBib3RmaWxlIH0pXG4gICAgYm90LnN0YXJ0KClcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/cli/start.js\n");

/***/ }),

/***/ "./src/cli/update.js":
/*!***************************!*\
  !*** ./src/cli/update.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _templateObject = _taggedTemplateLiteral(['===> {underline Installing dependencies, please wait...}'], ['===> {underline Installing dependencies, please wait...}']),\n    _templateObject2 = _taggedTemplateLiteral(['{green.bold Done!}'], ['{green.bold Done!}']),\n    _templateObject3 = _taggedTemplateLiteral(['\\nDo you want to update {yellow \"', '\"} to version {underline ', '}?'], ['\\nDo you want to update {yellow \"', '\"} to version {underline ', '}?']);\n\nvar _promptConfirm = __webpack_require__(/*! prompt-confirm */ \"prompt-confirm\");\n\nvar _promptConfirm2 = _interopRequireDefault(_promptConfirm);\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _child_process = __webpack_require__(/*! child_process */ \"child_process\");\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _modules = __webpack_require__(/*! ../modules */ \"./src/modules.js\");\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(version) {\n    var modulesManager, packages, cmdRest, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, pkg, confirm;\n\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            version = version || 'latest';\n\n            modulesManager = (0, _modules2.default)(null, './', null);\n            packages = ['botpress'].concat(_toConsumableArray(modulesManager.listInstalled()));\n            cmdRest = '';\n            _iteratorNormalCompletion = true;\n            _didIteratorError = false;\n            _iteratorError = undefined;\n            _context.prev = 7;\n            _iterator = packages[Symbol.iterator]();\n\n          case 9:\n            if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n              _context.next = 18;\n              break;\n            }\n\n            pkg = _step.value;\n            _context.next = 13;\n            return new _promptConfirm2.default((0, _chalk2.default)(_templateObject3, pkg, version)).run();\n\n          case 13:\n            confirm = _context.sent;\n\n            if (confirm) {\n              cmdRest += pkg + '@' + version + ' ';\n            }\n\n          case 15:\n            _iteratorNormalCompletion = true;\n            _context.next = 9;\n            break;\n\n          case 18:\n            _context.next = 24;\n            break;\n\n          case 20:\n            _context.prev = 20;\n            _context.t0 = _context['catch'](7);\n            _didIteratorError = true;\n            _iteratorError = _context.t0;\n\n          case 24:\n            _context.prev = 24;\n            _context.prev = 25;\n\n            if (!_iteratorNormalCompletion && _iterator.return) {\n              _iterator.return();\n            }\n\n          case 27:\n            _context.prev = 27;\n\n            if (!_didIteratorError) {\n              _context.next = 30;\n              break;\n            }\n\n            throw _iteratorError;\n\n          case 30:\n            return _context.finish(27);\n\n          case 31:\n            return _context.finish(24);\n\n          case 32:\n\n            if (cmdRest.length) {\n              console.log((0, _chalk2.default)(_templateObject));\n\n              if (_fs2.default.existsSync(_path2.default.resolve('./yarn.lock'))) {\n                (0, _child_process.execSync)('yarn add ' + cmdRest);\n              } else {\n                (0, _child_process.execSync)('npm install --save ' + cmdRest);\n              }\n\n              console.log((0, _chalk2.default)(_templateObject2));\n            }\n\n          case 33:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined, [[7, 20, 24, 32], [25,, 27, 31]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL3VwZGF0ZS5qcz9lM2EyIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJ2ZXJzaW9uIiwibW9kdWxlc01hbmFnZXIiLCJwYWNrYWdlcyIsImxpc3RJbnN0YWxsZWQiLCJjbWRSZXN0IiwicGtnIiwiQ29uZmlybSIsImNoYWxrIiwicnVuIiwiY29uZmlybSIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJmcyIsImV4aXN0c1N5bmMiLCJwYXRoIiwicmVzb2x2ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7QUFFQTs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUFBLE9BQU9DLE9BQVA7QUFBQSxxRUFBaUIsaUJBQU1DLE9BQU47QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNmQSxzQkFBVUEsV0FBVyxRQUFyQjs7QUFFTUMsMEJBSFMsR0FHUSx1QkFBYyxJQUFkLEVBQW9CLElBQXBCLEVBQTBCLElBQTFCLENBSFI7QUFJVEMsb0JBSlMsSUFJRyxVQUpILDRCQUlrQkQsZUFBZUUsYUFBZixFQUpsQjtBQU1YQyxtQkFOVyxHQU1ELEVBTkM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdCQVFHRixRQVJIOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBUUpHLGVBUkk7QUFBQTtBQUFBLG1CQVNTLElBQUlDLHVCQUFKLEtBQVlDLGVBQVosb0JBQ09GLEdBRFAsRUFDc0NMLE9BRHRDLEdBQ21EUSxHQURuRCxFQVRUOztBQUFBO0FBU1BDLG1CQVRPOztBQVdiLGdCQUFJQSxPQUFKLEVBQWE7QUFDWEwseUJBQWNDLEdBQWQsU0FBcUJMLE9BQXJCO0FBQ0Q7O0FBYlk7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTs7QUFnQmYsZ0JBQUlJLFFBQVFNLE1BQVosRUFBb0I7QUFDbEJDLHNCQUFRQyxHQUFSLEtBQVlMLGVBQVo7O0FBRUEsa0JBQUlNLGFBQUdDLFVBQUgsQ0FBY0MsZUFBS0MsT0FBTCxDQUFhLGFBQWIsQ0FBZCxDQUFKLEVBQWdEO0FBQzlDLDJEQUFxQlosT0FBckI7QUFDRCxlQUZELE1BRU87QUFDTCxxRUFBK0JBLE9BQS9CO0FBQ0Q7O0FBRURPLHNCQUFRQyxHQUFSLEtBQVlMLGVBQVo7QUFDRDs7QUExQmM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBakI7O0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJmaWxlIjoiLi9zcmMvY2xpL3VwZGF0ZS5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb25maXJtIGZyb20gJ3Byb21wdC1jb25maXJtJ1xuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2VzcydcblxuaW1wb3J0IHsgcHJpbnQgfSBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IGNyZWF0ZU1vZHVsZXMgZnJvbSAnLi4vbW9kdWxlcydcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyB2ZXJzaW9uID0+IHtcbiAgdmVyc2lvbiA9IHZlcnNpb24gfHwgJ2xhdGVzdCdcblxuICBjb25zdCBtb2R1bGVzTWFuYWdlciA9IGNyZWF0ZU1vZHVsZXMobnVsbCwgJy4vJywgbnVsbClcbiAgY29uc3QgcGFja2FnZXMgPSBbJ2JvdHByZXNzJywgLi4ubW9kdWxlc01hbmFnZXIubGlzdEluc3RhbGxlZCgpXVxuXG4gIGxldCBjbWRSZXN0ID0gJydcblxuICBmb3IgKGNvbnN0IHBrZyBvZiBwYWNrYWdlcykge1xuICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCBuZXcgQ29uZmlybShjaGFsa2BcbkRvIHlvdSB3YW50IHRvIHVwZGF0ZSB7eWVsbG93IFwiJHtwa2d9XCJ9IHRvIHZlcnNpb24ge3VuZGVybGluZSAke3ZlcnNpb259fT9gKS5ydW4oKVxuICAgIGlmIChjb25maXJtKSB7XG4gICAgICBjbWRSZXN0ICs9IGAke3BrZ31AJHt2ZXJzaW9ufSBgXG4gICAgfVxuICB9XG5cbiAgaWYgKGNtZFJlc3QubGVuZ3RoKSB7XG4gICAgY29uc29sZS5sb2coY2hhbGtgPT09PiB7dW5kZXJsaW5lIEluc3RhbGxpbmcgZGVwZW5kZW5jaWVzLCBwbGVhc2Ugd2FpdC4uLn1gKVxuXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKCcuL3lhcm4ubG9jaycpKSkge1xuICAgICAgZXhlY1N5bmMoYHlhcm4gYWRkICR7Y21kUmVzdH1gKVxuICAgIH0gZWxzZSB7XG4gICAgICBleGVjU3luYyhgbnBtIGluc3RhbGwgLS1zYXZlICR7Y21kUmVzdH1gKVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGNoYWxrYHtncmVlbi5ib2xkIERvbmUhfWApXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/cli/update.js\n");

/***/ }),

/***/ "./src/cloud/index.js":
/*!****************************!*\
  !*** ./src/cloud/index.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _axios = __webpack_require__(/*! axios */ \"axios\");\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _ms = __webpack_require__(/*! ms */ \"ms\");\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var _getWellKnownRSACert = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var endpoint, _ref3, data;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!certificate) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt('return', certificate);\n\n            case 2:\n              endpoint = getCloudEndpoint();\n              _context.next = 5;\n              return _axios2.default.get(endpoint + '/api/.well-known/public.key');\n\n            case 5:\n              _ref3 = _context.sent;\n              data = _ref3.data;\n\n\n              if (data && data.length) {\n                certificate = data;\n              }\n\n              logger.debug('[Cloud] Updated certificates');\n\n              return _context.abrupt('return', data);\n\n            case 10:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function _getWellKnownRSACert() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var updateRemoteEnv = function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      var _getPairingInfo, token, endpoint, env, botUrl;\n\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (isPaired()) {\n                _context2.next = 2;\n                break;\n              }\n\n              return _context2.abrupt('return');\n\n            case 2:\n              _getPairingInfo = getPairingInfo(), token = _getPairingInfo.token, endpoint = _getPairingInfo.endpoint;\n              env = botfile.env, botUrl = botfile.botUrl;\n              _context2.next = 6;\n              return _axios2.default.put(endpoint + '/api/pairing/env', {\n                botUrl: botUrl,\n                token: token,\n                env: env\n              }).then(function () {\n                logger.debug('[Cloud] Updated environment: ' + env);\n              }).catch(function (err) {\n                var message = _lodash2.default.get(err, 'response.data.message') || err.message || 'Unknown error';\n                logger.error('[Cloud] Could not update environment: ' + message);\n              });\n\n            case 6:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function updateRemoteEnv() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var _getRemoteRoles = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n      var _getPairingInfo2, endpoint, token, botId;\n\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (isPaired()) {\n                _context3.next = 2;\n                break;\n              }\n\n              return _context3.abrupt('return');\n\n            case 2:\n              if (!rolesPromise) {\n                _context3.next = 4;\n                break;\n              }\n\n              return _context3.abrupt('return', rolesPromise);\n\n            case 4:\n              _getPairingInfo2 = getPairingInfo(), endpoint = _getPairingInfo2.endpoint, token = _getPairingInfo2.token, botId = _getPairingInfo2.botId;\n\n\n              rolesPromise = _axios2.default.get(endpoint + '/api/bots/' + botId + '/roles', {\n                headers: {\n                  Authorization: 'Bearer bot__' + token\n                }\n              }).then(function (_ref6) {\n                var data = _ref6.data.payload;\n\n                logger.debug('[Cloud] Received roles: ', data);\n                return data;\n              }).catch(function (err) {\n                var message = _lodash2.default.get(err, 'response.data.message') || err.message || 'Unknown error';\n                logger.error('[Cloud] Error receiving roles: ' + message);\n                return null;\n              });\n\n              return _context3.abrupt('return', rolesPromise);\n\n            case 7:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function _getRemoteRoles() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var getUserRoles = function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(roleNames) {\n      var roles;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (isPaired()) {\n                _context4.next = 2;\n                break;\n              }\n\n              return _context4.abrupt('return', null);\n\n            case 2:\n              _context4.next = 4;\n              return _getRemoteRoles();\n\n            case 4:\n              roles = _context4.sent;\n              return _context4.abrupt('return', roleNames.reduce(function (acc, roleName) {\n                var role = _lodash2.default.find(roles, { name: roleName });\n                acc[roleName] = role && role.rules;\n                return acc;\n              }, {}));\n\n            case 6:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    return function getUserRoles(_x) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var projectLocation = _ref.projectLocation,\n      botfile = _ref.botfile,\n      logger = _ref.logger;\n\n  var certificate = null;\n  var rolesPromise = null;\n\n  setInterval(function () {\n    return certificate = null;\n  }, (0, _ms2.default)('5 minutes'));\n  setInterval(function () {\n    return rolesPromise = null;\n  }, (0, _ms2.default)('5 minutes'));\n\n  function _readCloudfile() {\n    var filePath = _path2.default.resolve(projectLocation, 'bp-cloud.json');\n    if (!_fs2.default.existsSync(filePath)) {\n      throw new Error('Could not find `bp-cloud.json` file at project root. Have you run \"botpress cloud-pair\" command?');\n    }\n\n    return JSON.parse(_fs2.default.readFileSync(filePath, 'utf8'));\n  }\n\n  function getCloudEndpoint() {\n    return _readCloudfile().endpoint;\n  }\n\n  function getPairingInfo() {\n    return _lodash2.default.pick(_readCloudfile(), ['botId', 'endpoint', 'token', 'teamId']);\n  }\n\n  function isPaired() {\n    var filePath = _path2.default.resolve(projectLocation, 'bp-cloud.json');\n    return _fs2.default.existsSync(filePath);\n  }\n\n  function getBotEnv() {\n    return botfile.env;\n  }\n\n  return {\n    getCloudEndpoint: getCloudEndpoint,\n    getBotEnv: getBotEnv,\n    getUserRoles: getUserRoles,\n    getCertificate: _getWellKnownRSACert,\n    isPaired: isPaired,\n    getPairingInfo: getPairingInfo,\n    updateRemoteEnv: updateRemoteEnv\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xvdWQvaW5kZXguanM/NzFjOCJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiY2VydGlmaWNhdGUiLCJlbmRwb2ludCIsImdldENsb3VkRW5kcG9pbnQiLCJheGlvcyIsImdldCIsImRhdGEiLCJsZW5ndGgiLCJsb2dnZXIiLCJkZWJ1ZyIsIl9nZXRXZWxsS25vd25SU0FDZXJ0IiwiaXNQYWlyZWQiLCJnZXRQYWlyaW5nSW5mbyIsInRva2VuIiwiZW52IiwiYm90ZmlsZSIsImJvdFVybCIsInB1dCIsInRoZW4iLCJjYXRjaCIsIm1lc3NhZ2UiLCJfIiwiZXJyIiwiZXJyb3IiLCJ1cGRhdGVSZW1vdGVFbnYiLCJyb2xlc1Byb21pc2UiLCJib3RJZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwicGF5bG9hZCIsIl9nZXRSZW1vdGVSb2xlcyIsInJvbGVOYW1lcyIsInJvbGVzIiwicmVkdWNlIiwiYWNjIiwicm9sZU5hbWUiLCJyb2xlIiwiZmluZCIsIm5hbWUiLCJydWxlcyIsImdldFVzZXJSb2xlcyIsInByb2plY3RMb2NhdGlvbiIsInNldEludGVydmFsIiwiX3JlYWRDbG91ZGZpbGUiLCJmaWxlUGF0aCIsInBhdGgiLCJyZXNvbHZlIiwiZnMiLCJleGlzdHNTeW5jIiwiRXJyb3IiLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJwaWNrIiwiZ2V0Qm90RW52IiwiZ2V0Q2VydGlmaWNhdGUiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixnQkFBMEM7QUFBQTtBQUFBLHdFQW1DekQ7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQUNNQyxXQUROO0FBQUE7QUFBQTtBQUFBOztBQUFBLCtDQUVXQSxXQUZYOztBQUFBO0FBS1FDLHNCQUxSLEdBS21CQyxrQkFMbkI7QUFBQTtBQUFBLHFCQU15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OztBQUVELFdBQVNVLGNBQVQsR0FBMEI7QUFDeEIsV0FBT1MsaUJBQUVnQyxJQUFGLENBQU9WLGdCQUFQLEVBQXlCLENBQUMsT0FBRCxFQUFVLFVBQVYsRUFBc0IsT0FBdEIsRUFBK0IsUUFBL0IsQ0FBekIsQ0FBUDtBQUNEOztBQUVELFdBQVNoQyxRQUFULEdBQW9CO0FBQ2xCLFFBQU1pQyxXQUFXQyxlQUFLQyxPQUFMLENBQWFMLGVBQWIsRUFBOEIsZUFBOUIsQ0FBakI7QUFDQSxXQUFPTSxhQUFHQyxVQUFILENBQWNKLFFBQWQsQ0FBUDtBQUNEOztBQUVELFdBQVNVLFNBQVQsR0FBcUI7QUFDbkIsV0FBT3ZDLFFBQVFELEdBQWY7QUFDRDs7QUFxRkQsU0FBTztBQUNMWCxzQ0FESztBQUVMbUQsd0JBRks7QUFHTGQsOEJBSEs7QUFJTGUsb0JBQWdCN0Msb0JBSlg7QUFLTEMsc0JBTEs7QUFNTEMsa0NBTks7QUFPTFk7QUFQSyxHQUFQO0FBU0QsQ0EvSEQiLCJmaWxlIjoiLi9zcmMvY2xvdWQvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJ1xuaW1wb3J0IG1zIGZyb20gJ21zJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZSwgbG9nZ2VyIH0pID0+IHtcbiAgbGV0IGNlcnRpZmljYXRlID0gbnVsbFxuICBsZXQgcm9sZXNQcm9taXNlID0gbnVsbFxuXG4gIHNldEludGVydmFsKCgpID0+IChjZXJ0aWZpY2F0ZSA9IG51bGwpLCBtcygnNSBtaW51dGVzJykpXG4gIHNldEludGVydmFsKCgpID0+IChyb2xlc1Byb21pc2UgPSBudWxsKSwgbXMoJzUgbWludXRlcycpKVxuXG4gIGZ1bmN0aW9uIF9yZWFkQ2xvdWRmaWxlKCkge1xuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKHByb2plY3RMb2NhdGlvbiwgJ2JwLWNsb3VkLmpzb24nKVxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0NvdWxkIG5vdCBmaW5kIGBicC1jbG91ZC5qc29uYCBmaWxlIGF0IHByb2plY3Qgcm9vdC4gSGF2ZSB5b3UgcnVuIFwiYm90cHJlc3MgY2xvdWQtcGFpclwiIGNvbW1hbmQ/J1xuICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldENsb3VkRW5kcG9pbnQoKSB7XG4gICAgcmV0dXJuIF9yZWFkQ2xvdWRmaWxlKCkuZW5kcG9pbnRcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFBhaXJpbmdJbmZvKCkge1xuICAgIHJldHVybiBfLnBpY2soX3JlYWRDbG91ZGZpbGUoKSwgWydib3RJZCcsICdlbmRwb2ludCcsICd0b2tlbicsICd0ZWFtSWQnXSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzUGFpcmVkKCkge1xuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKHByb2plY3RMb2NhdGlvbiwgJ2JwLWNsb3VkLmpzb24nKVxuICAgIHJldHVybiBmcy5leGlzdHNTeW5jKGZpbGVQYXRoKVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Qm90RW52KCkge1xuICAgIHJldHVybiBib3RmaWxlLmVudlxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gX2dldFdlbGxLbm93blJTQUNlcnQoKSB7XG4gICAgaWYgKGNlcnRpZmljYXRlKSB7XG4gICAgICByZXR1cm4gY2VydGlmaWNhdGVcbiAgICB9XG5cbiAgICBjb25zdCBlbmRwb2ludCA9IGdldENsb3VkRW5kcG9pbnQoKVxuICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYXhpb3MuZ2V0KGVuZHBvaW50ICsgJy9hcGkvLndlbGwta25vd24vcHVibGljLmtleScpXG5cbiAgICBpZiAoZGF0YSAmJiBkYXRhLmxlbmd0aCkge1xuICAgICAgY2VydGlmaWNhdGUgPSBkYXRhXG4gICAgfVxuXG4gICAgbG9nZ2VyLmRlYnVnKCdbQ2xvdWRdIFVwZGF0ZWQgY2VydGlmaWNhdGVzJylcblxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiB1cGRhdGVSZW1vdGVFbnYoKSB7XG4gICAgaWYgKCFpc1BhaXJlZCgpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCB7IHRva2VuLCBlbmRwb2ludCB9ID0gZ2V0UGFpcmluZ0luZm8oKVxuICAgIGNvbnN0IHsgZW52LCBib3RVcmwgfSA9IGJvdGZpbGVcblxuICAgIGF3YWl0IGF4aW9zXG4gICAgICAucHV0KGVuZHBvaW50ICsgJy9hcGkvcGFpcmluZy9lbnYnLCB7XG4gICAgICAgIGJvdFVybCxcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIGVudlxuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdbQ2xvdWRdIFVwZGF0ZWQgZW52aXJvbm1lbnQ6ICcgKyBlbnYpXG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBfLmdldChlcnIsICdyZXNwb25zZS5kYXRhLm1lc3NhZ2UnKSB8fCBlcnIubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcidcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdbQ2xvdWRdIENvdWxkIG5vdCB1cGRhdGUgZW52aXJvbm1lbnQ6ICcgKyBtZXNzYWdlKVxuICAgICAgfSlcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIF9nZXRSZW1vdGVSb2xlcygpIHtcbiAgICBpZiAoIWlzUGFpcmVkKCkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChyb2xlc1Byb21pc2UpIHtcbiAgICAgIHJldHVybiByb2xlc1Byb21pc2VcbiAgICB9XG5cbiAgICBjb25zdCB7IGVuZHBvaW50LCB0b2tlbiwgYm90SWQgfSA9IGdldFBhaXJpbmdJbmZvKClcblxuICAgIHJvbGVzUHJvbWlzZSA9IGF4aW9zXG4gICAgICAuZ2V0KGAke2VuZHBvaW50fS9hcGkvYm90cy8ke2JvdElkfS9yb2xlc2AsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgYm90X18ke3Rva2VufWBcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC50aGVuKCh7IGRhdGE6IHsgcGF5bG9hZDogZGF0YSB9IH0pID0+IHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdbQ2xvdWRdIFJlY2VpdmVkIHJvbGVzOiAnLCBkYXRhKVxuICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gXy5nZXQoZXJyLCAncmVzcG9uc2UuZGF0YS5tZXNzYWdlJykgfHwgZXJyLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InXG4gICAgICAgIGxvZ2dlci5lcnJvcignW0Nsb3VkXSBFcnJvciByZWNlaXZpbmcgcm9sZXM6ICcgKyBtZXNzYWdlKVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfSlcblxuICAgIHJldHVybiByb2xlc1Byb21pc2VcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJSb2xlcyhyb2xlTmFtZXMpIHtcbiAgICBpZiAoIWlzUGFpcmVkKCkpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgY29uc3Qgcm9sZXMgPSBhd2FpdCBfZ2V0UmVtb3RlUm9sZXMoKVxuICAgIHJldHVybiByb2xlTmFtZXMucmVkdWNlKChhY2MsIHJvbGVOYW1lKSA9PiB7XG4gICAgICBjb25zdCByb2xlID0gXy5maW5kKHJvbGVzLCB7IG5hbWU6IHJvbGVOYW1lIH0pXG4gICAgICBhY2Nbcm9sZU5hbWVdID0gcm9sZSAmJiByb2xlLnJ1bGVzXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSwge30pXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdldENsb3VkRW5kcG9pbnQsXG4gICAgZ2V0Qm90RW52LFxuICAgIGdldFVzZXJSb2xlcyxcbiAgICBnZXRDZXJ0aWZpY2F0ZTogX2dldFdlbGxLbm93blJTQUNlcnQsXG4gICAgaXNQYWlyZWQsXG4gICAgZ2V0UGFpcmluZ0luZm8sXG4gICAgdXBkYXRlUmVtb3RlRW52XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/cloud/index.js\n");

/***/ }),

/***/ "./src/config-manager/index.js":
/*!*************************************!*\
  !*** ./src/config-manager/index.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * The Configuration Manager is in charge of the configuration\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * for all the modules. It knows how to provision and load configuration\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * from the right places (env variables, files, botfile).\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @namespace ConfigurationManager\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @private\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _joi = __webpack_require__(/*! joi */ \"joi\");\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _yn = __webpack_require__(/*! yn */ \"yn\");\n\nvar _yn2 = _interopRequireDefault(_yn);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _json = __webpack_require__(/*! json5 */ \"json5\");\n\nvar _json2 = _interopRequireDefault(_json);\n\nvar _module = __webpack_require__(/*! ./module */ \"./src/config-manager/module.js\");\n\nvar _module2 = _interopRequireDefault(_module);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar validations = {\n  any: function any(value, validation) {\n    return validation(value);\n  },\n  string: function string(value, validation) {\n    return typeof value === 'string' && validation(value);\n  },\n  choice: function choice(value, validation) {\n    return _lodash2.default.includes(validation, value);\n  },\n  bool: function bool(value, validation) {\n    return ((0, _yn2.default)(value) === true || (0, _yn2.default)(value) === false) && validation(value);\n  }\n};\n\nvar transformers = {\n  bool: function bool(value) {\n    return (0, _yn2.default)(value);\n  }\n};\n\nvar defaultValues = {\n  any: null,\n  string: '',\n  bool: false\n};\n\nvar amendOption = function amendOption(option, name) {\n  var validTypes = _lodash2.default.keys(validations);\n  if (!option.type || !_lodash2.default.includes(validTypes, option.type)) {\n    throw new Error('Invalid type (' + (option.type || '') + ') for config key (' + name + ')');\n  }\n\n  var validation = option.validation || function () {\n    return true;\n  };\n\n  if (typeof option.default !== 'undefined' && !validations[option.type](option.default, validation)) {\n    throw new Error('Invalid default value (' + option.default + ') for (' + name + ')');\n  }\n\n  if (!option.default && !_lodash2.default.includes(_lodash2.default.keys(defaultValues), option.type)) {\n    throw new Error('Default value is mandatory for type ' + option.type + ' (' + name + ')');\n  }\n\n  return {\n    type: option.type,\n    required: option.required || false,\n    env: option.env || null,\n    default: option.default || defaultValues[option.type],\n    validation: validation\n  };\n};\n\nvar amendOptions = function amendOptions(options) {\n  return _lodash2.default.mapValues(options, amendOption);\n};\n\nvar ConfigurationManager = function () {\n  function ConfigurationManager(options) {\n    _classCallCheck(this, ConfigurationManager);\n\n    if (_util.isDeveloping) {\n      var schema = _joi2.default.object().keys({\n        configLocation: _joi2.default.string().min(1).required(),\n        botfile: _joi2.default.object().required(),\n        logger: _joi2.default.object().required()\n      });\n\n      _joi2.default.assert(options, schema, 'Invalid constructor elements for Configuration Manager');\n    }\n\n    this.configLocation = options.configLocation;\n    this.botfile = options.botfile;\n    this.logger = options.logger;\n    this._memoizedLoadAll = _lodash2.default.memoize(this._loadAll.bind(this));\n  }\n\n  _createClass(ConfigurationManager, [{\n    key: '_loadFromDefaultValues',\n    value: function _loadFromDefaultValues(options) {\n      return _lodash2.default.mapValues(options, function (value) {\n        return value.default;\n      });\n    }\n  }, {\n    key: '_loadFromConfigFile',\n    value: function _loadFromConfigFile(file, options) {\n      var filePath = _path2.default.resolve(this.configLocation, file);\n\n      if (_fs2.default.existsSync(filePath)) {\n        var content = _fs2.default.readFileSync(filePath, 'utf8');\n        return _json2.default.parse(content);\n      }\n\n      return {};\n    }\n  }, {\n    key: '_loadFromEnvVariables',\n    value: function _loadFromEnvVariables(options) {\n      var obj = {};\n\n      _lodash2.default.mapValues(process.env, function (value, key) {\n        if (_lodash2.default.isNil(value)) {\n          return;\n        }\n        var entry = _lodash2.default.findKey(options, { env: key });\n        if (entry) {\n          obj[entry] = value;\n        }\n      });\n\n      return obj;\n    }\n  }, {\n    key: '_loadAll',\n    value: function _loadAll(file) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      options = amendOptions(options);\n\n      var config = this._loadFromDefaultValues(options);\n      Object.assign(config, this._loadFromConfigFile(file, options));\n      Object.assign(config, this._loadFromEnvVariables(options));\n\n      // Transform the values if there's a transformer for this type of value\n      config = _lodash2.default.mapValues(config, function (value, key) {\n        var type = options[key].type;\n\n        if (transformers[type]) {\n          return transformers[type](value);\n        } else {\n          return value;\n        }\n      });\n\n      return config;\n    }\n\n    /**\n     * Returns a Configuration for a specific module\n     * @param  {Object} module A module object\n     * @private\n     * @return {ModuleConfiguration} A module-specific configuration\n     */\n\n  }, {\n    key: 'getModuleConfiguration',\n    value: function getModuleConfiguration(module) {\n      return new _module2.default({\n        manager: this,\n        module: module,\n        configLocation: this.configLocation,\n        logger: this.logger\n      });\n    }\n\n    /**\n     * Loads configuration from the right module\n     * @param  {String} file The name of the configuration file\n     * @param  {Object} options\n     * @private\n     * @return {Object} The full configuration object, assembled from various sources\n     */\n\n  }, {\n    key: 'loadAll',\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(file, options) {\n        var caching = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n        var getter;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                getter = caching ? this._memoizedLoadAll : this._loadAll;\n                return _context.abrupt('return', getter(file, options));\n\n              case 2:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function loadAll(_x2, _x3) {\n        return _ref.apply(this, arguments);\n      }\n\n      return loadAll;\n    }()\n  }, {\n    key: 'get',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(file, key, options) {\n        var caching = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n        var config;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.loadAll(file, options, caching);\n\n              case 2:\n                config = _context2.sent;\n                return _context2.abrupt('return', config[key]);\n\n              case 4:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function get(_x5, _x6, _x7) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return get;\n    }()\n  }]);\n\n  return ConfigurationManager;\n}();\n\nexports.default = ConfigurationManager;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29uZmlnLW1hbmFnZXIvaW5kZXguanM/Nzg4OCJdLCJuYW1lcyI6WyJ2YWxpZGF0aW9ucyIsImFueSIsInZhbHVlIiwidmFsaWRhdGlvbiIsInN0cmluZyIsImNob2ljZSIsIl8iLCJpbmNsdWRlcyIsImJvb2wiLCJ0cmFuc2Zvcm1lcnMiLCJkZWZhdWx0VmFsdWVzIiwiYW1lbmRPcHRpb24iLCJvcHRpb24iLCJuYW1lIiwidmFsaWRUeXBlcyIsImtleXMiLCJ0eXBlIiwiRXJyb3IiLCJkZWZhdWx0IiwicmVxdWlyZWQiLCJlbnYiLCJhbWVuZE9wdGlvbnMiLCJtYXBWYWx1ZXMiLCJvcHRpb25zIiwiQ29uZmlndXJhdGlvbk1hbmFnZXIiLCJpc0RldmVsb3BpbmciLCJzY2hlbWEiLCJKb2kiLCJvYmplY3QiLCJjb25maWdMb2NhdGlvbiIsIm1pbiIsImJvdGZpbGUiLCJsb2dnZXIiLCJhc3NlcnQiLCJfbWVtb2l6ZWRMb2FkQWxsIiwibWVtb2l6ZSIsIl9sb2FkQWxsIiwiYmluZCIsImZpbGUiLCJmaWxlUGF0aCIsInBhdGgiLCJyZXNvbHZlIiwiZnMiLCJleGlzdHNTeW5jIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsImpzb241IiwicGFyc2UiLCJvYmoiLCJwcm9jZXNzIiwia2V5IiwiaXNOaWwiLCJlbnRyeSIsImZpbmRLZXkiLCJjb25maWciLCJfbG9hZEZyb21EZWZhdWx0VmFsdWVzIiwiT2JqZWN0IiwiYXNzaWduIiwiX2xvYWRGcm9tQ29uZmlnRmlsZSIsIl9sb2FkRnJvbUVudlZhcmlhYmxlcyIsIm1vZHVsZSIsIk1vZHVsZUNvbmZpZ3VyYXRpb24iLCJtYW5hZ2VyIiwiY2FjaGluZyIsImdldHRlciIsImxvYWRBbGwiXSwibWFwcGluZ3MiOiI7Ozs7OztxakJBQUE7Ozs7Ozs7O0FBUUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7Ozs7Ozs7QUFFQSxJ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LEtBQUs3QixnQkFBZixHQUFrQyxLQUFLRSxRO2lEQUMvQzRCLE9BQU8xQixJQUFQLEVBQWFmLE9BQWIsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs0RkFHQ2UsSSxFQUFNWSxHLEVBQUszQixPO1lBQVN3QyxPLHVFQUFVLEk7Ozs7Ozs7dUJBQ2pCLEtBQUtFLE9BQUwsQ0FBYTNCLElBQWIsRUFBbUJmLE9BQW5CLEVBQTRCd0MsT0FBNUIsQzs7O0FBQWZULHNCO2tEQUNDQSxPQUFPSixHQUFQLEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrQkFwR1UxQixvQiIsImZpbGUiOiIuL3NyYy9jb25maWctbWFuYWdlci9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGhlIENvbmZpZ3VyYXRpb24gTWFuYWdlciBpcyBpbiBjaGFyZ2Ugb2YgdGhlIGNvbmZpZ3VyYXRpb25cbiAqIGZvciBhbGwgdGhlIG1vZHVsZXMuIEl0IGtub3dzIGhvdyB0byBwcm92aXNpb24gYW5kIGxvYWQgY29uZmlndXJhdGlvblxuICogZnJvbSB0aGUgcmlnaHQgcGxhY2VzIChlbnYgdmFyaWFibGVzLCBmaWxlcywgYm90ZmlsZSkuXG4gKiBAbmFtZXNwYWNlIENvbmZpZ3VyYXRpb25NYW5hZ2VyXG4gKiBAcHJpdmF0ZVxuICovXG5cbmltcG9ydCBKb2kgZnJvbSAnam9pJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IHluIGZyb20gJ3luJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBqc29uNSBmcm9tICdqc29uNSdcblxuaW1wb3J0IE1vZHVsZUNvbmZpZ3VyYXRpb24gZnJvbSAnLi9tb2R1bGUnXG5pbXBvcnQgeyBpc0RldmVsb3BpbmcgfSBmcm9tICcuLi91dGlsJ1xuXG5jb25zdCB2YWxpZGF0aW9ucyA9IHtcbiAgYW55OiAodmFsdWUsIHZhbGlkYXRpb24pID0+IHZhbGlkYXRpb24odmFsdWUpLFxuICBzdHJpbmc6ICh2YWx1ZSwgdmFsaWRhdGlvbikgPT4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWxpZGF0aW9uKHZhbHVlKSxcbiAgY2hvaWNlOiAodmFsdWUsIHZhbGlkYXRpb24pID0+IF8uaW5jbHVkZXModmFsaWRhdGlvbiwgdmFsdWUpLFxuICBib29sOiAodmFsdWUsIHZhbGlkYXRpb24pID0+ICh5bih2YWx1ZSkgPT09IHRydWUgfHwgeW4odmFsdWUpID09PSBmYWxzZSkgJiYgdmFsaWRhdGlvbih2YWx1ZSlcbn1cblxuY29uc3QgdHJhbnNmb3JtZXJzID0ge1xuICBib29sOiB2YWx1ZSA9PiB5bih2YWx1ZSlcbn1cblxuY29uc3QgZGVmYXVsdFZhbHVlcyA9IHtcbiAgYW55OiBudWxsLFxuICBzdHJpbmc6ICcnLFxuICBib29sOiBmYWxzZVxufVxuXG5jb25zdCBhbWVuZE9wdGlvbiA9IChvcHRpb24sIG5hbWUpID0+IHtcbiAgY29uc3QgdmFsaWRUeXBlcyA9IF8ua2V5cyh2YWxpZGF0aW9ucylcbiAgaWYgKCFvcHRpb24udHlwZSB8fCAhXy5pbmNsdWRlcyh2YWxpZFR5cGVzLCBvcHRpb24udHlwZSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdHlwZSAoJHtvcHRpb24udHlwZSB8fCAnJ30pIGZvciBjb25maWcga2V5ICgke25hbWV9KWApXG4gIH1cblxuICBjb25zdCB2YWxpZGF0aW9uID0gb3B0aW9uLnZhbGlkYXRpb24gfHwgKCgpID0+IHRydWUpXG5cbiAgaWYgKHR5cGVvZiBvcHRpb24uZGVmYXVsdCAhPT0gJ3VuZGVmaW5lZCcgJiYgIXZhbGlkYXRpb25zW29wdGlvbi50eXBlXShvcHRpb24uZGVmYXVsdCwgdmFsaWRhdGlvbikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZGVmYXVsdCB2YWx1ZSAoJHtvcHRpb24uZGVmYXVsdH0pIGZvciAoJHtuYW1lfSlgKVxuICB9XG5cbiAgaWYgKCFvcHRpb24uZGVmYXVsdCAmJiAhXy5pbmNsdWRlcyhfLmtleXMoZGVmYXVsdFZhbHVlcyksIG9wdGlvbi50eXBlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRGVmYXVsdCB2YWx1ZSBpcyBtYW5kYXRvcnkgZm9yIHR5cGUgJHtvcHRpb24udHlwZX0gKCR7bmFtZX0pYClcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogb3B0aW9uLnR5cGUsXG4gICAgcmVxdWlyZWQ6IG9wdGlvbi5yZXF1aXJlZCB8fCBmYWxzZSxcbiAgICBlbnY6IG9wdGlvbi5lbnYgfHwgbnVsbCxcbiAgICBkZWZhdWx0OiBvcHRpb24uZGVmYXVsdCB8fCBkZWZhdWx0VmFsdWVzW29wdGlvbi50eXBlXSxcbiAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uXG4gIH1cbn1cblxuY29uc3QgYW1lbmRPcHRpb25zID0gb3B0aW9ucyA9PiB7XG4gIHJldHVybiBfLm1hcFZhbHVlcyhvcHRpb25zLCBhbWVuZE9wdGlvbilcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uZmlndXJhdGlvbk1hbmFnZXIge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgaWYgKGlzRGV2ZWxvcGluZykge1xuICAgICAgY29uc3Qgc2NoZW1hID0gSm9pLm9iamVjdCgpLmtleXMoe1xuICAgICAgICBjb25maWdMb2NhdGlvbjogSm9pLnN0cmluZygpXG4gICAgICAgICAgLm1pbigxKVxuICAgICAgICAgIC5yZXF1aXJlZCgpLFxuICAgICAgICBib3RmaWxlOiBKb2kub2JqZWN0KCkucmVxdWlyZWQoKSxcbiAgICAgICAgbG9nZ2VyOiBKb2kub2JqZWN0KCkucmVxdWlyZWQoKVxuICAgICAgfSlcblxuICAgICAgSm9pLmFzc2VydChvcHRpb25zLCBzY2hlbWEsICdJbnZhbGlkIGNvbnN0cnVjdG9yIGVsZW1lbnRzIGZvciBDb25maWd1cmF0aW9uIE1hbmFnZXInKVxuICAgIH1cblxuICAgIHRoaXMuY29uZmlnTG9jYXRpb24gPSBvcHRpb25zLmNvbmZpZ0xvY2F0aW9uXG4gICAgdGhpcy5ib3RmaWxlID0gb3B0aW9ucy5ib3RmaWxlXG4gICAgdGhpcy5sb2dnZXIgPSBvcHRpb25zLmxvZ2dlclxuICAgIHRoaXMuX21lbW9pemVkTG9hZEFsbCA9IF8ubWVtb2l6ZSh0aGlzLl9sb2FkQWxsLmJpbmQodGhpcykpXG4gIH1cblxuICBfbG9hZEZyb21EZWZhdWx0VmFsdWVzKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gXy5tYXBWYWx1ZXMob3B0aW9ucywgdmFsdWUgPT4gdmFsdWUuZGVmYXVsdClcbiAgfVxuXG4gIF9sb2FkRnJvbUNvbmZpZ0ZpbGUoZmlsZSwgb3B0aW9ucykge1xuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMuY29uZmlnTG9jYXRpb24sIGZpbGUpXG5cbiAgICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgsICd1dGY4JylcbiAgICAgIHJldHVybiBqc29uNS5wYXJzZShjb250ZW50KVxuICAgIH1cblxuICAgIHJldHVybiB7fVxuICB9XG5cbiAgX2xvYWRGcm9tRW52VmFyaWFibGVzKG9wdGlvbnMpIHtcbiAgICBjb25zdCBvYmogPSB7fVxuXG4gICAgXy5tYXBWYWx1ZXMocHJvY2Vzcy5lbnYsICh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICBpZiAoXy5pc05pbCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBlbnRyeSA9IF8uZmluZEtleShvcHRpb25zLCB7IGVudjoga2V5IH0pXG4gICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgb2JqW2VudHJ5XSA9IHZhbHVlXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBvYmpcbiAgfVxuXG4gIF9sb2FkQWxsKGZpbGUsIG9wdGlvbnMgPSB7fSkge1xuICAgIG9wdGlvbnMgPSBhbWVuZE9wdGlvbnMob3B0aW9ucylcblxuICAgIGxldCBjb25maWcgPSB0aGlzLl9sb2FkRnJvbURlZmF1bHRWYWx1ZXMob3B0aW9ucylcbiAgICBPYmplY3QuYXNzaWduKGNvbmZpZywgdGhpcy5fbG9hZEZyb21Db25maWdGaWxlKGZpbGUsIG9wdGlvbnMpKVxuICAgIE9iamVjdC5hc3NpZ24oY29uZmlnLCB0aGlzLl9sb2FkRnJvbUVudlZhcmlhYmxlcyhvcHRpb25zKSlcblxuICAgIC8vIFRyYW5zZm9ybSB0aGUgdmFsdWVzIGlmIHRoZXJlJ3MgYSB0cmFuc2Zvcm1lciBmb3IgdGhpcyB0eXBlIG9mIHZhbHVlXG4gICAgY29uZmlnID0gXy5tYXBWYWx1ZXMoY29uZmlnLCAodmFsdWUsIGtleSkgPT4ge1xuICAgICAgY29uc3QgeyB0eXBlIH0gPSBvcHRpb25zW2tleV1cbiAgICAgIGlmICh0cmFuc2Zvcm1lcnNbdHlwZV0pIHtcbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybWVyc1t0eXBlXSh2YWx1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gY29uZmlnXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIENvbmZpZ3VyYXRpb24gZm9yIGEgc3BlY2lmaWMgbW9kdWxlXG4gICAqIEBwYXJhbSAge09iamVjdH0gbW9kdWxlIEEgbW9kdWxlIG9iamVjdFxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJuIHtNb2R1bGVDb25maWd1cmF0aW9ufSBBIG1vZHVsZS1zcGVjaWZpYyBjb25maWd1cmF0aW9uXG4gICAqL1xuICBnZXRNb2R1bGVDb25maWd1cmF0aW9uKG1vZHVsZSkge1xuICAgIHJldHVybiBuZXcgTW9kdWxlQ29uZmlndXJhdGlvbih7XG4gICAgICBtYW5hZ2VyOiB0aGlzLFxuICAgICAgbW9kdWxlOiBtb2R1bGUsXG4gICAgICBjb25maWdMb2NhdGlvbjogdGhpcy5jb25maWdMb2NhdGlvbixcbiAgICAgIGxvZ2dlcjogdGhpcy5sb2dnZXJcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIExvYWRzIGNvbmZpZ3VyYXRpb24gZnJvbSB0aGUgcmlnaHQgbW9kdWxlXG4gICAqIEBwYXJhbSAge1N0cmluZ30gZmlsZSBUaGUgbmFtZSBvZiB0aGUgY29uZmlndXJhdGlvbiBmaWxlXG4gICAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9uc1xuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBmdWxsIGNvbmZpZ3VyYXRpb24gb2JqZWN0LCBhc3NlbWJsZWQgZnJvbSB2YXJpb3VzIHNvdXJjZXNcbiAgICovXG4gIGFzeW5jIGxvYWRBbGwoZmlsZSwgb3B0aW9ucywgY2FjaGluZyA9IHRydWUpIHtcbiAgICBjb25zdCBnZXR0ZXIgPSBjYWNoaW5nID8gdGhpcy5fbWVtb2l6ZWRMb2FkQWxsIDogdGhpcy5fbG9hZEFsbFxuICAgIHJldHVybiBnZXR0ZXIoZmlsZSwgb3B0aW9ucylcbiAgfVxuXG4gIGFzeW5jIGdldChmaWxlLCBrZXksIG9wdGlvbnMsIGNhY2hpbmcgPSB0cnVlKSB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5sb2FkQWxsKGZpbGUsIG9wdGlvbnMsIGNhY2hpbmcpXG4gICAgcmV0dXJuIGNvbmZpZ1trZXldXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/config-manager/index.js\n");

/***/ }),

/***/ "./src/config-manager/module.js":
/*!**************************************!*\
  !*** ./src/config-manager/module.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ModuleConfiguration = function () {\n  function ModuleConfiguration(options) {\n    _classCallCheck(this, ModuleConfiguration);\n\n    this.manager = options.manager;\n    this.module = options.module;\n    this.logger = options.logger;\n    this.configLocation = options.configLocation;\n  }\n\n  _createClass(ModuleConfiguration, [{\n    key: '_getFileName',\n    value: function _getFileName() {\n      var sanitizedName = this.module.name.replace(/^@botpress(-)?\\//i, '').replace(/^botpress(-)?/i, '').replace(_path2.default.delimiter, '_');\n\n      return sanitizedName + '.json';\n    }\n  }, {\n    key: '_getOptions',\n    value: function _getOptions() {\n      return this.module.options;\n    }\n  }, {\n    key: '_hasDefaultConfig',\n    value: function _hasDefaultConfig() {\n      var filePath = _path2.default.resolve(this.module.path, 'config.json');\n      return _fs2.default.existsSync(filePath);\n    }\n  }, {\n    key: '_readDefaultConfig',\n    value: function _readDefaultConfig() {\n      var filePath = _path2.default.resolve(this.module.path, 'config.json');\n      return _fs2.default.readFileSync(filePath, 'utf8');\n    }\n  }, {\n    key: 'loadAll',\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var caching = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n        var config, file, filePath;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.manager.loadAll(this._getFileName(), this._getOptions(), caching);\n\n              case 2:\n                config = _context.sent;\n                file = this._getFileName();\n                filePath = _path2.default.resolve(this.configLocation, file);\n\n\n                _lodash2.default.mapValues(config, function (value, key) {\n                  if (value === '<<UPDATE_ME>>') {\n                    var message = '[' + _this.module.name + '] Missing mandatory configuration for \"' + key + '\". \\nYou can provide this value in \"' + filePath + '\"';\n                    _this.logger.error(message);\n                    throw new Error(message);\n                  }\n                });\n\n                return _context.abrupt('return', config);\n\n              case 7:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function loadAll() {\n        return _ref.apply(this, arguments);\n      }\n\n      return loadAll;\n    }()\n  }, {\n    key: 'get',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(key) {\n        var caching = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt('return', this.manager.get(this._getFileName(), key, this._getOptions(), caching));\n\n              case 1:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function get(_x2) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return get;\n    }()\n\n    /**\n     * Copy the module's default configuration file to the bot's config directory\n     * @private\n     */\n\n  }, {\n    key: 'bootstrap',\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var file, filePath, content;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this._hasDefaultConfig()) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt('return');\n\n              case 2:\n                file = this._getFileName();\n                filePath = _path2.default.resolve(this.configLocation, file);\n                content = this._readDefaultConfig();\n\n\n                _fs2.default.writeFileSync(filePath, content, 'utf8');\n                this.logger.info('Configuration for module \"' + this.module.name + '\" has been created at ' + filePath);\n\n              case 7:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function bootstrap() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return bootstrap;\n    }()\n\n    /**\n     * Checks whether the module has a configuration file\n     * and if the bot doesn't have the configuration file for it.\n     * @private\n     * @return {Boolean}\n     */\n\n  }, {\n    key: 'isConfigMissing',\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var file, filePath;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                file = this._getFileName();\n                filePath = _path2.default.resolve(this.configLocation, file);\n                return _context4.abrupt('return', this._hasDefaultConfig() && !_fs2.default.existsSync(filePath));\n\n              case 3:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function isConfigMissing() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return isConfigMissing;\n    }()\n  }]);\n\n  return ModuleConfiguration;\n}();\n\nexports.default = ModuleConfiguration;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29uZmlnLW1hbmFnZXIvbW9kdWxlLmpzP2VhNzciXSwibmFtZXMiOlsiTW9kdWxlQ29uZmlndXJhdGlvbiIsIm9wdGlvbnMiLCJtYW5hZ2VyIiwibW9kdWxlIiwibG9nZ2VyIiwiY29uZmlnTG9jYXRpb24iLCJzYW5pdGl6ZWROYW1lIiwibmFtZSIsInJlcGxhY2UiLCJwYXRoIiwiZGVsaW1pdGVyIiwiZmlsZVBhdGgiLCJyZXNvbHZlIiwiZnMiLCJleGlzdHNTeW5jIiwicmVhZEZpbGVTeW5jIiwiY2FjaGluZyIsImxvYWRBbGwiLCJfZ2V0RmlsZU5hbWUiLCJfZ2V0T3B0aW9ucyIsImNvbmZpZyIsImZpbGUiLCJfIiwibWFwVmFsdWVzIiwidmFsdWUiLCJrZXkiLCJtZXNzYWdlIiwiZXJyb3IiLCJFcnJvciIsImdldCIsIl9oYXNEZWZhdWx0Q29uZmlnIiwiY29udGVudCIsIl9yZWFkRGVmYXVsdENvbmZpZyIsIndyaXRlRmlsZVN5bmMiLCJpbmZvIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7OztJQUVxQkEsbUI7QUFDbkIsK0JBQVlDLE9BQVosRUFBcUI7QUFBQTs7QUFDbkIsU0FBS0MsT0FBTCxHQUFlRCxRQUFRQyxPQUF2QjtBQUNBLFNBQUtDLE1BQUwsR0FBY0YsUUFBUUUsTUFBdEI7QUFDQSxTQUFLQyxNQUFMLEdBQWNILFFBQVFHLE1BQXRCO0FBQ0EsU0FBS0MsY0FBTCxHQUFzQkosUUFBUUksY0FBOUI7QUFDRDs7OzttQ0FFYztBQUNiLFVBQU1DLGdCQUFnQixLQUFLSCxNQUFMLENBQVlJLElBQVosQ0FDbkJDLE9BRG1CLENBQ1gsbUJBRFcsRUFDVSxFQURWLEVBRW5CQSxPQUZtQixDQUVYLGdCQUZXLEVBRU8sRUFGUCxFQUduQkEsT0FIbUIsQ0FHWEMsZUFBS0MsU0FITSxFQUdLLEdBSEwsQ0FBdEI7O0FBS0EsYUFBVUosYUFBVjtBQUNEOzs7a0NBRWE7QUFDWixhQUFPLEtBQUtILE1BQUwsQ0FBWUYsT0FBbkI7QUFDRDs7O3dDQUVtQjtBQUNsQixVQUFNVSxXQUFXRixlQUFLRyxPQUFMLENBQWEsS0FBS1QsTUFBTCxDQUFZTSxJQUF6QixFQUErQixhQUEvQixDQUFqQjtBQUNBLGFBQU9JLGFBQUdDLFVBQUgsQ0FBY0gsUUFBZCxDQUFQO0FBQ0Q7Ozt5Q0FFb0I7QUFDbkIsVUFBTUEsV0FBV0YsZUFBS0csT0FBTCxDQUFhLEtBQUtULE1BQUwsQ0FBWU0sSUFBekIsRUFBK0IsYUFBL0IsQ0FBakI7QUFDQSxhQUFPSSxhQUFHRSxZQUFILENBQWdCSixRQUFoQixFQUEwQixNQUExQixDQUFQO0FBQ0Q7Ozs7Ozs7WUFFYUssTyx1RUFBVSxJOzs7Ozs7O3VCQUNELEtBQUtkLE9BQUwsQ0FBYWUsT0FBYixDQUFxQixLQUFLQyxZQUFMLEVBQXJCLEVBQTBDLEtBQUtDLFdBQUwsRUFBMUMsRUFBOERILE9BQTlELEM7OztBQUFmSSxzQjtBQUVBQyxvQixHQUFPLEtBQUtILFlBQUwsRTtBQUNQUCx3QixHQUFXRixlQUFLRyxPQUFMLENBQWEsS0FBS1AsY0FBbEIsRUFBa0NnQixJQUFsQyxDOzs7QUFFakJDLGlDQUFFQyxTQUFGLENBQVlILE1BQVosRUFBb0IsVUFBQ0ksS0FBRCxFQUFRQyxHQUFSLEVBQWdCO0FBQ2xDLHNCQUFJRCxVQUFVLGVBQWQsRUFBK0I7QUFDN0Isd0JBQU1FLGdCQUFjLE1BQUt2QixNQUFMLENBQVlJLElBQTFCLCtDQUF3RWtCLEdBQXhFLDRDQUNtQmQsUUFEbkIsTUFBTjtBQUVBLDBCQUFLUCxNQUFMLENBQVl1QixLQUFaLENBQWtCRCxPQUFsQjtBQUNBLDBCQUFNLElBQUlFLEtBQUosQ0FBVUYsT0FBVixDQUFOO0FBQ0Q7QUFDRixpQkFQRDs7aURBU09OLE07Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEZBR0NLLEc7WUFBS1QsTyx1RUFBVSxJOzs7OztrREFDaEIsS0FBS2QsT0FBTCxDQUFhMkIsR0FBYixDQUFpQixLQUFLWCxZQUFMLEVBQWpCLEVBQXNDTyxHQUF0QyxFQUEyQyxLQUFLTixXQUFMLEVBQTNDLEVBQStESCxPQUEvRCxDOzs7Ozs7Ozs7Ozs7Ozs7OztBQUdUOzs7Ozs7Ozs7Ozs7OztvQkFLTyxLQUFLYyxpQkFBTCxFOzs7Ozs7OztBQUlDVCxvQixHQUFPLEtBQUtILFlBQUwsRTtBQUNQUCx3QixHQUFXRixlQUFLRyxPQUFMLENBQWEsS0FBS1AsY0FBbEIsRUFBa0NnQixJQUFsQyxDO0FBQ1hVLHVCLEdBQVUsS0FBS0Msa0JBQUwsRTs7O0FBRWhCbkIsNkJBQUdvQixhQUFILENBQWlCdEIsUUFBakIsRUFBMkJvQixPQUEzQixFQUFvQyxNQUFwQztBQUNBLHFCQUFLM0IsTUFBTCxDQUFZOEIsSUFBWixnQ0FBOEMsS0FBSy9CLE1BQUwsQ0FBWUksSUFBMUQsOEJBQXVGSSxRQUF2Rjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHRjs7Ozs7Ozs7Ozs7Ozs7OztBQU9RVSxvQixHQUFPLEtBQUtILFlBQUwsRTtBQUNQUCx3QixHQUFXRixlQUFLRyxPQUFMLENBQWEsS0FBS1AsY0FBbEIsRUFBa0NnQixJQUFsQyxDO2tEQUNWLEtBQUtTLGlCQUFMLE1BQTRCLENBQUNqQixhQUFHQyxVQUFILENBQWNILFFBQWQsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2tCQS9FbkJYLG1CIiwiZmlsZSI6Ii4vc3JjL2NvbmZpZy1tYW5hZ2VyL21vZHVsZS5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZHVsZUNvbmZpZ3VyYXRpb24ge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5tYW5hZ2VyID0gb3B0aW9ucy5tYW5hZ2VyXG4gICAgdGhpcy5tb2R1bGUgPSBvcHRpb25zLm1vZHVsZVxuICAgIHRoaXMubG9nZ2VyID0gb3B0aW9ucy5sb2dnZXJcbiAgICB0aGlzLmNvbmZpZ0xvY2F0aW9uID0gb3B0aW9ucy5jb25maWdMb2NhdGlvblxuICB9XG5cbiAgX2dldEZpbGVOYW1lKCkge1xuICAgIGNvbnN0IHNhbml0aXplZE5hbWUgPSB0aGlzLm1vZHVsZS5uYW1lXG4gICAgICAucmVwbGFjZSgvXkBib3RwcmVzcygtKT9cXC8vaSwgJycpXG4gICAgICAucmVwbGFjZSgvXmJvdHByZXNzKC0pPy9pLCAnJylcbiAgICAgIC5yZXBsYWNlKHBhdGguZGVsaW1pdGVyLCAnXycpXG5cbiAgICByZXR1cm4gYCR7c2FuaXRpemVkTmFtZX0uanNvbmBcbiAgfVxuXG4gIF9nZXRPcHRpb25zKCkge1xuICAgIHJldHVybiB0aGlzLm1vZHVsZS5vcHRpb25zXG4gIH1cblxuICBfaGFzRGVmYXVsdENvbmZpZygpIHtcbiAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGgucmVzb2x2ZSh0aGlzLm1vZHVsZS5wYXRoLCAnY29uZmlnLmpzb24nKVxuICAgIHJldHVybiBmcy5leGlzdHNTeW5jKGZpbGVQYXRoKVxuICB9XG5cbiAgX3JlYWREZWZhdWx0Q29uZmlnKCkge1xuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMubW9kdWxlLnBhdGgsICdjb25maWcuanNvbicpXG4gICAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKVxuICB9XG5cbiAgYXN5bmMgbG9hZEFsbChjYWNoaW5nID0gdHJ1ZSkge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMubWFuYWdlci5sb2FkQWxsKHRoaXMuX2dldEZpbGVOYW1lKCksIHRoaXMuX2dldE9wdGlvbnMoKSwgY2FjaGluZylcblxuICAgIGNvbnN0IGZpbGUgPSB0aGlzLl9nZXRGaWxlTmFtZSgpXG4gICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLnJlc29sdmUodGhpcy5jb25maWdMb2NhdGlvbiwgZmlsZSlcblxuICAgIF8ubWFwVmFsdWVzKGNvbmZpZywgKHZhbHVlLCBrZXkpID0+IHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gJzw8VVBEQVRFX01FPj4nKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgWyR7dGhpcy5tb2R1bGUubmFtZX1dIE1pc3NpbmcgbWFuZGF0b3J5IGNvbmZpZ3VyYXRpb24gZm9yIFwiJHtrZXl9XCIuIFxuWW91IGNhbiBwcm92aWRlIHRoaXMgdmFsdWUgaW4gXCIke2ZpbGVQYXRofVwiYFxuICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihtZXNzYWdlKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIGNvbmZpZ1xuICB9XG5cbiAgYXN5bmMgZ2V0KGtleSwgY2FjaGluZyA9IHRydWUpIHtcbiAgICByZXR1cm4gdGhpcy5tYW5hZ2VyLmdldCh0aGlzLl9nZXRGaWxlTmFtZSgpLCBrZXksIHRoaXMuX2dldE9wdGlvbnMoKSwgY2FjaGluZylcbiAgfVxuXG4gIC8qKlxuICAgKiBDb3B5IHRoZSBtb2R1bGUncyBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gZmlsZSB0byB0aGUgYm90J3MgY29uZmlnIGRpcmVjdG9yeVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYXN5bmMgYm9vdHN0cmFwKCkge1xuICAgIGlmICghdGhpcy5faGFzRGVmYXVsdENvbmZpZygpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBmaWxlID0gdGhpcy5fZ2V0RmlsZU5hbWUoKVxuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMuY29uZmlnTG9jYXRpb24sIGZpbGUpXG4gICAgY29uc3QgY29udGVudCA9IHRoaXMuX3JlYWREZWZhdWx0Q29uZmlnKClcblxuICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGNvbnRlbnQsICd1dGY4JylcbiAgICB0aGlzLmxvZ2dlci5pbmZvKGBDb25maWd1cmF0aW9uIGZvciBtb2R1bGUgXCIke3RoaXMubW9kdWxlLm5hbWV9XCIgaGFzIGJlZW4gY3JlYXRlZCBhdCAke2ZpbGVQYXRofWApXG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIHdoZXRoZXIgdGhlIG1vZHVsZSBoYXMgYSBjb25maWd1cmF0aW9uIGZpbGVcbiAgICogYW5kIGlmIHRoZSBib3QgZG9lc24ndCBoYXZlIHRoZSBjb25maWd1cmF0aW9uIGZpbGUgZm9yIGl0LlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgKi9cbiAgYXN5bmMgaXNDb25maWdNaXNzaW5nKCkge1xuICAgIGNvbnN0IGZpbGUgPSB0aGlzLl9nZXRGaWxlTmFtZSgpXG4gICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLnJlc29sdmUodGhpcy5jb25maWdMb2NhdGlvbiwgZmlsZSlcbiAgICByZXR1cm4gdGhpcy5faGFzRGVmYXVsdENvbmZpZygpICYmICFmcy5leGlzdHNTeW5jKGZpbGVQYXRoKVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/config-manager/module.js\n");

/***/ }),

/***/ "./src/content/getItemProviders.js":
/*!*****************************************!*\
  !*** ./src/content/getItemProviders.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _helpers = __webpack_require__(/*! ../database/helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  random: function random(knex, category, args) {\n    return knex('content_items').where({ categoryId: category }).orderBy(knex.raw('random()')).limit(1).get(0);\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udGVudC9nZXRJdGVtUHJvdmlkZXJzLmpzP2YzYjAiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsInJhbmRvbSIsImtuZXgiLCJjYXRlZ29yeSIsImFyZ3MiLCJ3aGVyZSIsImNhdGVnb3J5SWQiLCJvcmRlckJ5IiwicmF3IiwibGltaXQiLCJnZXQiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUVBOzs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQjtBQUNmQyxVQUFRLGdCQUFDQyxJQUFELEVBQU9DLFFBQVAsRUFBaUJDLElBQWpCLEVBQTBCO0FBQ2hDLFdBQU9GLEtBQUssZUFBTCxFQUNKRyxLQURJLENBQ0UsRUFBRUMsWUFBWUgsUUFBZCxFQURGLEVBRUpJLE9BRkksQ0FFSUwsS0FBS00sR0FBTCxDQUFTLFVBQVQsQ0FGSixFQUdKQyxLQUhJLENBR0UsQ0FIRixFQUlKQyxHQUpJLENBSUEsQ0FKQSxDQUFQO0FBS0Q7QUFQYyxDQUFqQiIsImZpbGUiOiIuL3NyYy9jb250ZW50L2dldEl0ZW1Qcm92aWRlcnMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxuaW1wb3J0IGhlbHBlcnMgZnJvbSAnLi4vZGF0YWJhc2UvaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHJhbmRvbTogKGtuZXgsIGNhdGVnb3J5LCBhcmdzKSA9PiB7XG4gICAgcmV0dXJuIGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgLndoZXJlKHsgY2F0ZWdvcnlJZDogY2F0ZWdvcnkgfSlcbiAgICAgIC5vcmRlckJ5KGtuZXgucmF3KCdyYW5kb20oKScpKVxuICAgICAgLmxpbWl0KDEpXG4gICAgICAuZ2V0KDApXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/content/getItemProviders.js\n");

/***/ }),

/***/ "./src/content/service.js":
/*!********************************!*\
  !*** ./src/content/service.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _verror = __webpack_require__(/*! verror */ \"verror\");\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _glob = __webpack_require__(/*! glob */ \"glob\");\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _mkdirp = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n\nvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\nvar _nanoid = __webpack_require__(/*! nanoid */ \"nanoid\");\n\nvar _nanoid2 = _interopRequireDefault(_nanoid);\n\nvar _json = __webpack_require__(/*! json5 */ \"json5\");\n\nvar _json2 = _interopRequireDefault(_json);\n\nvar _helpers = __webpack_require__(/*! ../database/helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * The Content Manager is mainly in charge of storing and retrieving\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * all the content that is stored and known by the bot. The content includes (but is not limited to)\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * the messages that the bot sends to users.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @see {@link https://botpress.io/docs/10.0/getting_started/trivia_content/}\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @namespace  ContentManager\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * bp.contentManager\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */\n\nvar getNewItemId = function getNewItemId(category) {\n  var prefix = (category.renderer || category.id).replace(/^#/, '');\n  return prefix + '-' + (0, _nanoid2.default)(6);\n};\n\nvar prepareDb = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n    var knex;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            knex = (0, _util.getInMemoryDb)();\n\n            // NB! This is in-memory temprorary database\n            // It is freshly created so we know there are no tables\n            // We also use camelCased columns for convenience\n\n            _context.next = 3;\n            return knex.schema.createTable('content_items', function (table) {\n              table.string('id').primary();\n              table.text('data');\n              table.text('formData');\n              table.text('metadata');\n              table.string('categoryId');\n              table.text('previewText');\n              table.string('createdBy');\n              table.timestamp('createdOn');\n            });\n\n          case 3:\n            return _context.abrupt('return', knex);\n\n          case 4:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function prepareDb() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar defaults = {\n  contentDir: './content',\n  contentDataDir: './content_data'\n};\n\nmodule.exports = function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee23(_ref3) {\n    var botfile = _ref3.botfile,\n        projectLocation = _ref3.projectLocation,\n        logger = _ref3.logger,\n        ghostManager = _ref3.ghostManager;\n    var categories, categoryById, fileById, getItemProviders, contentDir, contentDataDir, knex, transformItemDbToApi, transformItemApiToDb, listCategoryItems, dumpDataToFile, dumpAllDataToFiles, getCategorySchema, listAvailableCategories, resolveRefs, computeData, computeMetadata, computePreviewText, fillComputedProps, createOrUpdateCategoryItem, categoryItemsCount, deleteCategoryItems, getItemDefault, getItem, getItems, getItemsByMetadata, recomputeCategoriesMetadata, loadData, loadCategoryFromSchema, loadCategoriesFromPath, readDataForFile, init, registerGetItemProvider;\n    return regeneratorRuntime.wrap(function _callee23$(_context24) {\n      while (1) {\n        switch (_context24.prev = _context24.next) {\n          case 0:\n            categories = [];\n            categoryById = {};\n            fileById = {};\n            getItemProviders = {};\n            contentDir = _path2.default.resolve(projectLocation, botfile.contentDir || defaults.contentDir);\n            contentDataDir = _path2.default.resolve(projectLocation, botfile.contentDataDir || defaults.contentDataDir);\n            _context24.next = 8;\n            return prepareDb();\n\n          case 8:\n            knex = _context24.sent;\n\n            transformItemDbToApi = function transformItemDbToApi(item) {\n              if (!item) {\n                return item;\n              }\n\n              return _extends({}, item, {\n                data: JSON.parse(item.data),\n                formData: JSON.parse(item.formData),\n                metadata: (item.metadata || '').split('|').filter(function (i) {\n                  return i.length > 0;\n                })\n              });\n            };\n\n            transformItemApiToDb = function transformItemApiToDb(item) {\n              if (!item) {\n                return item;\n              }\n\n              var result = _extends({}, item);\n\n              if ('formData' in item) {\n                result.formData = JSON.stringify(item.formData);\n              }\n              if ('data' in item) {\n                result.data = JSON.stringify(item.data);\n              }\n              if ('metadata' in item) {\n                result.metadata = '|' + (item.metadata || []).filter(function (i) {\n                  return !!i;\n                }).join('|') + '|';\n              }\n\n              return result;\n            };\n\n            /**\n             * @typedef {Object} ContentManager~Element\n             * @memberOf ContentManager\n             */\n\n            /**\n             * @typedef {Object} ContentManager~CategorySchema\n             * @memberOf ContentManager\n             * @prop {Object} json The JSONSchema\n             * @prop {String} ui The UI JSONSchema\n             * @property {String} description\n             * @property {String} renderer The name of the Content Renderer\n             */\n\n            /**\n             * @typedef {Object} ContentManager~Category\n             * @memberOf ContentManager\n             * @prop {String} id\n             * @prop {String} title\n             * @property {String} description\n             * @property {Number} count The number of elements in that category\n             * @property {ContentManager~CategorySchema} schema\n             */\n\n            /**\n             * Returns the elements of a given category\n             * @param  {String} categoryId The category, for example `text` or `trivia`.\n             * @param  {Number} [options.from=0] Pagination parameter (where to start)\n             * @param  {Number} [options.count=50] Pagination parameter (how many elements to return)\n             * @param  {String} [options.searchTerm=] Only return the elements containing this term\n             * @param  {Array.<String>}  [options.orderBy=['createdOn']]    A list of properties to order the elements by.\n             * @return {ContentManager~Element[]}\n             * @public\n             * @memberOf! ContentManager\n             */\n\n\n            listCategoryItems = function () {\n              var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(categoryId) {\n                var _query;\n\n                var _ref5 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n                    _ref5$from = _ref5.from,\n                    from = _ref5$from === undefined ? 0 : _ref5$from,\n                    _ref5$count = _ref5.count,\n                    count = _ref5$count === undefined ? 50 : _ref5$count,\n                    searchTerm = _ref5.searchTerm,\n                    _ref5$orderBy = _ref5.orderBy,\n                    orderBy = _ref5$orderBy === undefined ? ['createdOn'] : _ref5$orderBy;\n\n                var query, items;\n                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        query = knex('content_items');\n\n\n                        if (categoryId) {\n                          query = query.where({ categoryId: categoryId });\n                        }\n\n                        if (searchTerm) {\n                          query = query.where(function () {\n                            this.where('metadata', 'like', '%' + searchTerm + '%').orWhere('formData', 'like', '%' + searchTerm + '%').orWhere('id', 'like', '%' + searchTerm + '%');\n                          });\n                        }\n\n                        _context2.next = 5;\n                        return (_query = query).orderBy.apply(_query, _toConsumableArray(orderBy)).offset(from).limit(count).then();\n\n                      case 5:\n                        items = _context2.sent;\n                        return _context2.abrupt('return', items.map(transformItemDbToApi));\n\n                      case 7:\n                      case 'end':\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2, undefined);\n              }));\n\n              return function listCategoryItems(_x2) {\n                return _ref4.apply(this, arguments);\n              };\n            }();\n\n            dumpDataToFile = function () {\n              var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(categoryId) {\n                var items;\n                return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        _context3.next = 2;\n                        return listCategoryItems(categoryId, { count: 10000 });\n\n                      case 2:\n                        _context3.t0 = function (item) {\n                          return _lodash2.default.pick(item, 'id', 'formData', 'createdBy', 'createdOn');\n                        };\n\n                        items = _context3.sent.map(_context3.t0);\n                        _context3.next = 6;\n                        return ghostManager.upsertFile(contentDataDir, fileById[categoryId], JSON.stringify(items, null, 2));\n\n                      case 6:\n                      case 'end':\n                        return _context3.stop();\n                    }\n                  }\n                }, _callee3, undefined);\n              }));\n\n              return function dumpDataToFile(_x4) {\n                return _ref6.apply(this, arguments);\n              };\n            }();\n\n            dumpAllDataToFiles = function dumpAllDataToFiles() {\n              return _bluebird2.default.map(categories, function (_ref7) {\n                var id = _ref7.id;\n                return dumpDataToFile(id);\n              });\n            };\n\n            /**\n             * Get the schema for a given category\n             * @param  {String} categoryId [description]\n             * @return {ContentManager~CategorySchema}\n             */\n\n\n            getCategorySchema = function getCategorySchema(categoryId) {\n              var category = _lodash2.default.find(categories, { id: categoryId });\n              if (category == null) {\n                return null;\n              }\n\n              return {\n                json: category.jsonSchema,\n                ui: category.uiSchema,\n                title: category.title,\n                description: category.description,\n                renderer: category.renderer\n              };\n            };\n\n            /**\n             * Returns all the categories\n             * @public\n             * @return {ContentManager~Category[]}\n             * @memberOf! ContentManager\n             */\n\n\n            listAvailableCategories = function listAvailableCategories() {\n              return _bluebird2.default.map(categories, function () {\n                var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(category) {\n                  var count;\n                  return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                      switch (_context4.prev = _context4.next) {\n                        case 0:\n                          _context4.next = 2;\n                          return knex('content_items').where({ categoryId: category.id }).count('* as count').get(0).then(function (row) {\n                            return row && Number(row.count) || 0;\n                          });\n\n                        case 2:\n                          count = _context4.sent;\n                          return _context4.abrupt('return', {\n                            id: category.id,\n                            title: category.title,\n                            description: category.description,\n                            count: count,\n                            schema: getCategorySchema(category.id)\n                          });\n\n                        case 4:\n                        case 'end':\n                          return _context4.stop();\n                      }\n                    }\n                  }, _callee4, undefined);\n                }));\n\n                return function (_x5) {\n                  return _ref8.apply(this, arguments);\n                };\n              }());\n            };\n\n            resolveRefs = function () {\n              var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(data) {\n                var m;\n                return regeneratorRuntime.wrap(function _callee5$(_context5) {\n                  while (1) {\n                    switch (_context5.prev = _context5.next) {\n                      case 0:\n                        if (data) {\n                          _context5.next = 2;\n                          break;\n                        }\n\n                        return _context5.abrupt('return', data);\n\n                      case 2:\n                        if (!Array.isArray(data)) {\n                          _context5.next = 4;\n                          break;\n                        }\n\n                        return _context5.abrupt('return', _bluebird2.default.map(data, resolveRefs));\n\n                      case 4:\n                        if (!_lodash2.default.isObject(data)) {\n                          _context5.next = 6;\n                          break;\n                        }\n\n                        return _context5.abrupt('return', _bluebird2.default.props(_lodash2.default.mapValues(data, resolveRefs)));\n\n                      case 6:\n                        if (!_lodash2.default.isString(data)) {\n                          _context5.next = 11;\n                          break;\n                        }\n\n                        m = data.match(/^##ref\\((.*)\\)$/);\n\n                        if (m) {\n                          _context5.next = 10;\n                          break;\n                        }\n\n                        return _context5.abrupt('return', data);\n\n                      case 10:\n                        return _context5.abrupt('return', knex('content_items').select('formData').where('id', m[1]).then(function (result) {\n                          if (!result || !result.length) {\n                            throw new Error('Error resolving reference: ID ' + m[1] + ' not found.');\n                          }\n                          return JSON.parse(result[0].formData);\n                        }).then(resolveRefs));\n\n                      case 11:\n                        return _context5.abrupt('return', data);\n\n                      case 12:\n                      case 'end':\n                        return _context5.stop();\n                    }\n                  }\n                }, _callee5, undefined);\n              }));\n\n              return function resolveRefs(_x6) {\n                return _ref9.apply(this, arguments);\n              };\n            }();\n\n            computeData = function () {\n              var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(categoryId, formData) {\n                var category;\n                return regeneratorRuntime.wrap(function _callee6$(_context6) {\n                  while (1) {\n                    switch (_context6.prev = _context6.next) {\n                      case 0:\n                        category = categoryById[categoryId];\n\n                        if (category) {\n                          _context6.next = 3;\n                          break;\n                        }\n\n                        throw new Error('Unknown category ' + categoryId);\n\n                      case 3:\n                        return _context6.abrupt('return', !category.computeData ? formData : category.computeData(formData, computeData));\n\n                      case 4:\n                      case 'end':\n                        return _context6.stop();\n                    }\n                  }\n                }, _callee6, undefined);\n              }));\n\n              return function computeData(_x7, _x8) {\n                return _ref10.apply(this, arguments);\n              };\n            }();\n\n            computeMetadata = function () {\n              var _ref11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(categoryId, formData) {\n                var category;\n                return regeneratorRuntime.wrap(function _callee7$(_context7) {\n                  while (1) {\n                    switch (_context7.prev = _context7.next) {\n                      case 0:\n                        category = categoryById[categoryId];\n\n                        if (category) {\n                          _context7.next = 3;\n                          break;\n                        }\n\n                        throw new Error('Unknown category ' + categoryId);\n\n                      case 3:\n                        return _context7.abrupt('return', !category.computeMetadata ? [] : category.computeMetadata(formData, computeMetadata));\n\n                      case 4:\n                      case 'end':\n                        return _context7.stop();\n                    }\n                  }\n                }, _callee7, undefined);\n              }));\n\n              return function computeMetadata(_x9, _x10) {\n                return _ref11.apply(this, arguments);\n              };\n            }();\n\n            computePreviewText = function () {\n              var _ref12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(categoryId, formData) {\n                var category;\n                return regeneratorRuntime.wrap(function _callee8$(_context8) {\n                  while (1) {\n                    switch (_context8.prev = _context8.next) {\n                      case 0:\n                        category = categoryById[categoryId];\n\n                        if (category) {\n                          _context8.next = 3;\n                          break;\n                        }\n\n                        throw new Error('Unknown category ' + categoryId);\n\n                      case 3:\n                        return _context8.abrupt('return', !category.computePreviewText ? 'No preview' : category.computePreviewText(formData, computePreviewText));\n\n                      case 4:\n                      case 'end':\n                        return _context8.stop();\n                    }\n                  }\n                }, _callee8, undefined);\n              }));\n\n              return function computePreviewText(_x11, _x12) {\n                return _ref12.apply(this, arguments);\n              };\n            }();\n\n            fillComputedProps = function () {\n              var _ref13 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(category, formData) {\n                var expandedFormData, data, metadata, previewText;\n                return regeneratorRuntime.wrap(function _callee9$(_context9) {\n                  while (1) {\n                    switch (_context9.prev = _context9.next) {\n                      case 0:\n                        if (!(formData == null)) {\n                          _context9.next = 2;\n                          break;\n                        }\n\n                        throw new Error('\"formData\" must be a valid object');\n\n                      case 2:\n                        _context9.next = 4;\n                        return resolveRefs(formData);\n\n                      case 4:\n                        expandedFormData = _context9.sent;\n                        _context9.next = 7;\n                        return computeData(category.id, expandedFormData);\n\n                      case 7:\n                        data = _context9.sent;\n                        _context9.next = 10;\n                        return computeMetadata(category.id, expandedFormData);\n\n                      case 10:\n                        metadata = _context9.sent;\n                        _context9.next = 13;\n                        return computePreviewText(category.id, expandedFormData);\n\n                      case 13:\n                        previewText = _context9.sent;\n\n                        if (_lodash2.default.isArray(metadata)) {\n                          _context9.next = 16;\n                          break;\n                        }\n\n                        throw new Error('computeMetadata must return an array of strings');\n\n                      case 16:\n                        if (_lodash2.default.isString(previewText)) {\n                          _context9.next = 18;\n                          break;\n                        }\n\n                        throw new Error('computePreviewText must return a string');\n\n                      case 18:\n                        if (!(data == null)) {\n                          _context9.next = 20;\n                          break;\n                        }\n\n                        throw new Error('computeData must return a valid object');\n\n                      case 20:\n                        return _context9.abrupt('return', {\n                          data: data,\n                          metadata: metadata,\n                          previewText: previewText\n                        });\n\n                      case 21:\n                      case 'end':\n                        return _context9.stop();\n                    }\n                  }\n                }, _callee9, undefined);\n              }));\n\n              return function fillComputedProps(_x13, _x14) {\n                return _ref13.apply(this, arguments);\n              };\n            }();\n\n            /**\n             * Creates or updates an [Element]{@link ContentManager~Element}\n             * @param  {String} [options.itemId=] The id of the element to add\n             * @param  {String} options.categoryId The category of the element\n             * @param  {Object} options.formData The content of the element\n             * @async\n             * @public\n             * @memberOf! ContentManager\n             */\n\n\n            createOrUpdateCategoryItem = function () {\n              var _ref14 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(_ref15) {\n                var itemId = _ref15.itemId,\n                    categoryId = _ref15.categoryId,\n                    formData = _ref15.formData;\n                var category, item, body, isNewItemCreation;\n                return regeneratorRuntime.wrap(function _callee10$(_context10) {\n                  while (1) {\n                    switch (_context10.prev = _context10.next) {\n                      case 0:\n                        categoryId = categoryId && categoryId.toLowerCase();\n                        category = _lodash2.default.find(categories, { id: categoryId });\n\n                        if (!(category == null)) {\n                          _context10.next = 4;\n                          break;\n                        }\n\n                        throw new Error('Category \"' + categoryId + '\" is not a valid registered categoryId');\n\n                      case 4:\n                        _context10.t0 = _extends;\n                        _context10.t1 = { formData: formData };\n                        _context10.next = 8;\n                        return fillComputedProps(category, formData);\n\n                      case 8:\n                        _context10.t2 = _context10.sent;\n                        item = (0, _context10.t0)(_context10.t1, _context10.t2);\n                        body = transformItemApiToDb(item);\n                        isNewItemCreation = !itemId;\n\n                        if (isNewItemCreation) {\n                          itemId = getNewItemId(category);\n                        }\n\n                        if (isNewItemCreation) {\n                          _context10.next = 18;\n                          break;\n                        }\n\n                        _context10.next = 16;\n                        return knex('content_items').update(body).where({ id: itemId }).then();\n\n                      case 16:\n                        _context10.next = 20;\n                        break;\n\n                      case 18:\n                        _context10.next = 20;\n                        return knex('content_items').insert(_extends({}, body, {\n                          createdBy: 'admin',\n                          createdOn: (0, _helpers2.default)(knex).date.now(),\n                          id: itemId,\n                          categoryId: categoryId\n                        }));\n\n                      case 20:\n                        _context10.next = 22;\n                        return dumpDataToFile(categoryId);\n\n                      case 22:\n                        return _context10.abrupt('return', itemId);\n\n                      case 23:\n                      case 'end':\n                        return _context10.stop();\n                    }\n                  }\n                }, _callee10, undefined);\n              }));\n\n              return function createOrUpdateCategoryItem(_x15) {\n                return _ref14.apply(this, arguments);\n              };\n            }();\n\n            categoryItemsCount = function categoryItemsCount(categoryId) {\n              var q = knex('content_items');\n              if (categoryId && categoryId !== 'all') {\n                q = q.where({ categoryId: categoryId });\n              }\n              return q.count('id as count').then(function (_ref16) {\n                var _ref17 = _slicedToArray(_ref16, 1),\n                    res = _ref17[0];\n\n                return Number(res.count);\n              });\n            };\n\n            deleteCategoryItems = function () {\n              var _ref18 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(ids) {\n                return regeneratorRuntime.wrap(function _callee11$(_context11) {\n                  while (1) {\n                    switch (_context11.prev = _context11.next) {\n                      case 0:\n                        if (!(!_lodash2.default.isArray(ids) || _lodash2.default.some(ids, function (id) {\n                          return !_lodash2.default.isString(id);\n                        }))) {\n                          _context11.next = 2;\n                          break;\n                        }\n\n                        throw new Error('Expected an array of Ids to delete');\n\n                      case 2:\n                        _context11.next = 4;\n                        return knex('content_items').whereIn('id', ids).del().then();\n\n                      case 4:\n                        return _context11.abrupt('return', dumpAllDataToFiles());\n\n                      case 5:\n                      case 'end':\n                        return _context11.stop();\n                    }\n                  }\n                }, _callee11, undefined);\n              }));\n\n              return function deleteCategoryItems(_x16) {\n                return _ref18.apply(this, arguments);\n              };\n            }();\n\n            getItemDefault = function () {\n              var _ref19 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(id) {\n                return regeneratorRuntime.wrap(function _callee12$(_context12) {\n                  while (1) {\n                    switch (_context12.prev = _context12.next) {\n                      case 0:\n                        return _context12.abrupt('return', knex('content_items').where({ id: id }).get(0));\n\n                      case 1:\n                      case 'end':\n                        return _context12.stop();\n                    }\n                  }\n                }, _callee12, undefined);\n              }));\n\n              return function getItemDefault(_x17) {\n                return _ref19.apply(this, arguments);\n              };\n            }();\n\n            /**\n             * Retrieves one item\n             * @param  {String} query Usually the id of the {@link ContentManager.Element},\n             * but can also be a call to a {@link ContentManager.ElementProvider}.\n             * @return {ContentManager.ElementProvider}\n             * @memberof! ContentManager\n             * @example\n             * await bp.contentManager.getItem('#!trivia-12345')\n             * await bp.contentManager.getItem('#trivia-random()')\n             */\n\n\n            getItem = function () {\n              var _ref20 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(query) {\n                var providerRegex, pMatch, item, provider, args, categoryName, fn, category;\n                return regeneratorRuntime.wrap(function _callee13$(_context13) {\n                  while (1) {\n                    switch (_context13.prev = _context13.next) {\n                      case 0:\n                        providerRegex = /-(.+)\\((.*)\\)$/i;\n                        pMatch = query.match(providerRegex);\n                        item = void 0;\n\n                        if (!pMatch) {\n                          _context13.next = 17;\n                          break;\n                        }\n\n                        provider = pMatch[1].toLowerCase();\n                        args = pMatch[2];\n                        categoryName = query.substr(0, query.length - pMatch[0].length);\n                        fn = getItemProviders[provider];\n\n                        if (fn) {\n                          _context13.next = 10;\n                          break;\n                        }\n\n                        throw new Error('Invalid content expression \"' + query + '\", did you forget to register the \"' + provider + '\" provider?');\n\n                      case 10:\n                        _context13.next = 12;\n                        return fn(knex, categoryName, args);\n\n                      case 12:\n                        item = _context13.sent;\n\n                        if (!_lodash2.default.isArray(item)) {\n                          _context13.next = 15;\n                          break;\n                        }\n\n                        throw new Error('Provider \"' + provider + '\" returned an array instead of an object');\n\n                      case 15:\n                        _context13.next = 20;\n                        break;\n\n                      case 17:\n                        _context13.next = 19;\n                        return getItemDefault(query);\n\n                      case 19:\n                        item = _context13.sent;\n\n                      case 20:\n                        if (item) {\n                          _context13.next = 22;\n                          break;\n                        }\n\n                        return _context13.abrupt('return', null);\n\n                      case 22:\n                        category = _lodash2.default.find(categories, { id: item.categoryId });\n                        return _context13.abrupt('return', _extends({}, transformItemDbToApi(item), {\n                          categoryTitle: category.title,\n                          categorySchema: getCategorySchema(item.categoryId)\n                        }));\n\n                      case 24:\n                      case 'end':\n                        return _context13.stop();\n                    }\n                  }\n                }, _callee13, undefined);\n              }));\n\n              return function getItem(_x18) {\n                return _ref20.apply(this, arguments);\n              };\n            }();\n\n            /**\n             * Retrieves multiple items\n             * @param  {String} query Comma-separted string where each part is\n             * the same as an argument to {@link ContentManager.getItem}.\n             * @return {Array<ContentManager.ElementProvider>}\n             * @memberof! ContentManager\n             * @example\n             * await bp.contentManager.getItems('#!trivia-12345,#!trivia-12346')\n             */\n\n\n            getItems = function getItems(queries) {\n              return _bluebird2.default.map(queries.split(','), getItem);\n            };\n\n            getItemsByMetadata = function () {\n              var _ref21 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(metadata) {\n                var items;\n                return regeneratorRuntime.wrap(function _callee14$(_context14) {\n                  while (1) {\n                    switch (_context14.prev = _context14.next) {\n                      case 0:\n                        _context14.next = 2;\n                        return knex('content_items').where('metadata', 'like', '%|' + metadata + '|%').then();\n\n                      case 2:\n                        items = _context14.sent;\n                        return _context14.abrupt('return', transformItemDbToApi(items));\n\n                      case 4:\n                      case 'end':\n                        return _context14.stop();\n                    }\n                  }\n                }, _callee14, undefined);\n              }));\n\n              return function getItemsByMetadata(_x19) {\n                return _ref21.apply(this, arguments);\n              };\n            }();\n\n            /**\n             * Refreshes the content categories metadata internally.\n             * This must be called after using `loadCategoryFromSchema`\n             * @memberOf!  ContentManager\n             * @public\n             */\n\n\n            recomputeCategoriesMetadata = function () {\n              var _ref22 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16() {\n                var _loop, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _ref23;\n\n                return regeneratorRuntime.wrap(function _callee16$(_context17) {\n                  while (1) {\n                    switch (_context17.prev = _context17.next) {\n                      case 0:\n                        _loop = /*#__PURE__*/regeneratorRuntime.mark(function _loop(_ref23) {\n                          var categoryId;\n                          return regeneratorRuntime.wrap(function _loop$(_context16) {\n                            while (1) {\n                              switch (_context16.prev = _context16.next) {\n                                case 0:\n                                  categoryId = _ref23.id;\n                                  _context16.next = 3;\n                                  return knex('content_items').select('id', 'formData').where('categoryId', categoryId).then().each(function () {\n                                    var _ref24 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(_ref25) {\n                                      var id = _ref25.id,\n                                          formData = _ref25.formData;\n                                      var computedProps;\n                                      return regeneratorRuntime.wrap(function _callee15$(_context15) {\n                                        while (1) {\n                                          switch (_context15.prev = _context15.next) {\n                                            case 0:\n                                              _context15.next = 2;\n                                              return fillComputedProps(categoryById[categoryId], JSON.parse(formData));\n\n                                            case 2:\n                                              computedProps = _context15.sent;\n                                              return _context15.abrupt('return', knex('content_items').where('id', id).update(transformItemApiToDb(computedProps)));\n\n                                            case 4:\n                                            case 'end':\n                                              return _context15.stop();\n                                          }\n                                        }\n                                      }, _callee15, undefined);\n                                    }));\n\n                                    return function (_x20) {\n                                      return _ref24.apply(this, arguments);\n                                    };\n                                  }());\n\n                                case 3:\n                                case 'end':\n                                  return _context16.stop();\n                              }\n                            }\n                          }, _loop, undefined);\n                        });\n                        _iteratorNormalCompletion = true;\n                        _didIteratorError = false;\n                        _iteratorError = undefined;\n                        _context17.prev = 4;\n                        _iterator = categories[Symbol.iterator]();\n\n                      case 6:\n                        if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                          _context17.next = 12;\n                          break;\n                        }\n\n                        _ref23 = _step.value;\n                        return _context17.delegateYield(_loop(_ref23), 't0', 9);\n\n                      case 9:\n                        _iteratorNormalCompletion = true;\n                        _context17.next = 6;\n                        break;\n\n                      case 12:\n                        _context17.next = 18;\n                        break;\n\n                      case 14:\n                        _context17.prev = 14;\n                        _context17.t1 = _context17['catch'](4);\n                        _didIteratorError = true;\n                        _iteratorError = _context17.t1;\n\n                      case 18:\n                        _context17.prev = 18;\n                        _context17.prev = 19;\n\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                          _iterator.return();\n                        }\n\n                      case 21:\n                        _context17.prev = 21;\n\n                        if (!_didIteratorError) {\n                          _context17.next = 24;\n                          break;\n                        }\n\n                        throw _iteratorError;\n\n                      case 24:\n                        return _context17.finish(21);\n\n                      case 25:\n                        return _context17.finish(18);\n\n                      case 26:\n                      case 'end':\n                        return _context17.stop();\n                    }\n                  }\n                }, _callee16, undefined, [[4, 14, 18, 26], [19,, 21, 25]]);\n              }));\n\n              return function recomputeCategoriesMetadata() {\n                return _ref22.apply(this, arguments);\n              };\n            }();\n\n            loadData = function () {\n              var _ref26 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18(category) {\n                var fileName, data;\n                return regeneratorRuntime.wrap(function _callee18$(_context19) {\n                  while (1) {\n                    switch (_context19.prev = _context19.next) {\n                      case 0:\n                        fileName = category.id + '.json';\n\n                        fileById[category.id] = fileName;\n\n                        logger.debug('Loading data for ' + category.id + ' from ' + fileName);\n                        data = [];\n                        _context19.prev = 4;\n                        _context19.next = 7;\n                        return readDataForFile(fileName);\n\n                      case 7:\n                        data = _context19.sent;\n                        _context19.next = 13;\n                        break;\n\n                      case 10:\n                        _context19.prev = 10;\n                        _context19.t0 = _context19['catch'](4);\n\n                        logger.warn('Error reading data from ' + fileName, _context19.t0);\n\n                      case 13:\n                        _context19.next = 15;\n                        return _bluebird2.default.map(data, function () {\n                          var _ref27 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(item) {\n                            return regeneratorRuntime.wrap(function _callee17$(_context18) {\n                              while (1) {\n                                switch (_context18.prev = _context18.next) {\n                                  case 0:\n                                    return _context18.abrupt('return', _extends({}, item, {\n                                      categoryId: category.id,\n                                      id: item.id || getNewItemId(category)\n                                    }));\n\n                                  case 1:\n                                  case 'end':\n                                    return _context18.stop();\n                                }\n                              }\n                            }, _callee17, undefined);\n                          }));\n\n                          return function (_x22) {\n                            return _ref27.apply(this, arguments);\n                          };\n                        }());\n\n                      case 15:\n                        data = _context19.sent;\n                        return _context19.abrupt('return', _bluebird2.default.mapSeries(data, function (item) {\n                          return knex('content_items').insert(transformItemApiToDb(item)).then();\n                        }));\n\n                      case 17:\n                      case 'end':\n                        return _context19.stop();\n                    }\n                  }\n                }, _callee18, undefined, [[4, 10]]);\n              }));\n\n              return function loadData(_x21) {\n                return _ref26.apply(this, arguments);\n              };\n            }();\n\n            /**\n             * Loads a new category from a raw schema definition.\n             * *Important:* do not forget to call `ContentManager~recomputeCategoriesMetadata` after calling this\n             * @param  {ContentManager~Category} schema A schema definition\n             * @memberOf!  ContentManager\n             * @return {Object} Returns the loaded category schema\n             * @public\n             */\n\n\n            loadCategoryFromSchema = function () {\n              var _ref28 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19(schema) {\n                var requiredFields;\n                return regeneratorRuntime.wrap(function _callee19$(_context20) {\n                  while (1) {\n                    switch (_context20.prev = _context20.next) {\n                      case 0:\n                        requiredFields = ['id', 'title', 'jsonSchema'];\n\n\n                        requiredFields.forEach(function (field) {\n                          if (_lodash2.default.isNil(schema[field])) {\n                            throw new Error('\"' + field + '\" is required but missing in schema');\n                          }\n                        });\n\n                        schema.id = schema.id.toLowerCase();\n\n                        if (!categoryById[schema.id]) {\n                          _context20.next = 5;\n                          break;\n                        }\n\n                        throw new Error('There is already a form with id \"' + schema.id + '\"');\n\n                      case 5:\n\n                        if (!schema.jsonSchema.title) {\n                          schema.jsonSchema.title = schema.title;\n                        }\n\n                        categoryById[schema.id] = schema;\n                        categories.push(schema);\n\n                        _context20.next = 10;\n                        return loadData(schema);\n\n                      case 10:\n                        return _context20.abrupt('return', schema);\n\n                      case 11:\n                      case 'end':\n                        return _context20.stop();\n                    }\n                  }\n                }, _callee19, undefined);\n              }));\n\n              return function loadCategoryFromSchema(_x23) {\n                return _ref28.apply(this, arguments);\n              };\n            }();\n\n            loadCategoriesFromPath = function () {\n              var _ref29 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee20(file) {\n                var filePath, schemas, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, schema;\n\n                return regeneratorRuntime.wrap(function _callee20$(_context21) {\n                  while (1) {\n                    switch (_context21.prev = _context21.next) {\n                      case 0:\n                        filePath = _path2.default.resolve(contentDir, './' + file);\n                        schemas = null;\n\n\n                        if (/\\.json$/i.test(filePath)) {\n                          // Using JSON5 instead of regular JSON\n                          schemas = _json2.default.parse(_fs2.default.readFileSync(filePath, 'utf8'));\n                        } else {\n                          // Allows for registering .form.js files\n                          // eslint-disable-next-line no-eval\n                          schemas = eval('require')(filePath); // Dynamic loading require eval for Webpack\n                        }\n\n                        _context21.prev = 3;\n\n                        if (!_lodash2.default.isArray(schemas)) {\n                          _context21.next = 33;\n                          break;\n                        }\n\n                        _iteratorNormalCompletion2 = true;\n                        _didIteratorError2 = false;\n                        _iteratorError2 = undefined;\n                        _context21.prev = 8;\n                        _iterator2 = schemas[Symbol.iterator]();\n\n                      case 10:\n                        if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n                          _context21.next = 17;\n                          break;\n                        }\n\n                        schema = _step2.value;\n                        _context21.next = 14;\n                        return loadCategoryFromSchema(schema);\n\n                      case 14:\n                        _iteratorNormalCompletion2 = true;\n                        _context21.next = 10;\n                        break;\n\n                      case 17:\n                        _context21.next = 23;\n                        break;\n\n                      case 19:\n                        _context21.prev = 19;\n                        _context21.t0 = _context21['catch'](8);\n                        _didIteratorError2 = true;\n                        _iteratorError2 = _context21.t0;\n\n                      case 23:\n                        _context21.prev = 23;\n                        _context21.prev = 24;\n\n                        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                          _iterator2.return();\n                        }\n\n                      case 26:\n                        _context21.prev = 26;\n\n                        if (!_didIteratorError2) {\n                          _context21.next = 29;\n                          break;\n                        }\n\n                        throw _iteratorError2;\n\n                      case 29:\n                        return _context21.finish(26);\n\n                      case 30:\n                        return _context21.finish(23);\n\n                      case 31:\n                        _context21.next = 35;\n                        break;\n\n                      case 33:\n                        _context21.next = 35;\n                        return loadCategoryFromSchema(schemas);\n\n                      case 35:\n                        _context21.next = 40;\n                        break;\n\n                      case 37:\n                        _context21.prev = 37;\n                        _context21.t1 = _context21['catch'](3);\n                        throw new _verror.VError(_context21.t1, 'Error registering Content Element \"' + file + '\"');\n\n                      case 40:\n                      case 'end':\n                        return _context21.stop();\n                    }\n                  }\n                }, _callee20, undefined, [[3, 37], [8, 19, 23, 31], [24,, 26, 30]]);\n              }));\n\n              return function loadCategoriesFromPath(_x24) {\n                return _ref29.apply(this, arguments);\n              };\n            }();\n\n            readDataForFile = function () {\n              var _ref30 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee21(fileName) {\n                var json, data;\n                return regeneratorRuntime.wrap(function _callee21$(_context22) {\n                  while (1) {\n                    switch (_context22.prev = _context22.next) {\n                      case 0:\n                        _context22.next = 2;\n                        return ghostManager.readFile(contentDataDir, fileName);\n\n                      case 2:\n                        json = _context22.sent;\n\n                        if (json) {\n                          _context22.next = 5;\n                          break;\n                        }\n\n                        return _context22.abrupt('return', []);\n\n                      case 5:\n                        _context22.prev = 5;\n                        data = JSON.parse(json);\n\n                        if (Array.isArray(data)) {\n                          _context22.next = 9;\n                          break;\n                        }\n\n                        throw new Error(fileName + ' expected to contain array, contents ignored');\n\n                      case 9:\n                        logger.info('Read ' + data.length + ' item(s) from ' + fileName);\n                        return _context22.abrupt('return', data);\n\n                      case 13:\n                        _context22.prev = 13;\n                        _context22.t0 = _context22['catch'](5);\n\n                        logger.warn('Error reading data from ' + fileName, _context22.t0);\n                        return _context22.abrupt('return', []);\n\n                      case 17:\n                      case 'end':\n                        return _context22.stop();\n                    }\n                  }\n                }, _callee21, undefined, [[5, 13]]);\n              }));\n\n              return function readDataForFile(_x25) {\n                return _ref30.apply(this, arguments);\n              };\n            }();\n\n            init = function () {\n              var _ref31 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee22() {\n                var files, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _iterator3, _step3, file;\n\n                return regeneratorRuntime.wrap(function _callee22$(_context23) {\n                  while (1) {\n                    switch (_context23.prev = _context23.next) {\n                      case 0:\n                        _mkdirp2.default.sync(contentDataDir);\n                        _context23.next = 3;\n                        return ghostManager.addRootFolder(contentDataDir, { filesGlob: '**/*.json' });\n\n                      case 3:\n                        _context23.next = 5;\n                        return _bluebird2.default.fromCallback(function (cb) {\n                          return (0, _glob2.default)('**/*.@(form.json|form.js|json|js)', { cwd: contentDir }, cb);\n                        });\n\n                      case 5:\n                        files = _context23.sent;\n                        _iteratorNormalCompletion3 = true;\n                        _didIteratorError3 = false;\n                        _iteratorError3 = undefined;\n                        _context23.prev = 9;\n                        _iterator3 = files[Symbol.iterator]();\n\n                      case 11:\n                        if (_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done) {\n                          _context23.next = 24;\n                          break;\n                        }\n\n                        file = _step3.value;\n                        _context23.prev = 13;\n                        _context23.next = 16;\n                        return loadCategoriesFromPath(file);\n\n                      case 16:\n                        _context23.next = 21;\n                        break;\n\n                      case 18:\n                        _context23.prev = 18;\n                        _context23.t0 = _context23['catch'](13);\n                        throw new _verror.VError(_context23.t0, '[Content Manager] Could not register Content Element \"' + file + '\"');\n\n                      case 21:\n                        _iteratorNormalCompletion3 = true;\n                        _context23.next = 11;\n                        break;\n\n                      case 24:\n                        _context23.next = 30;\n                        break;\n\n                      case 26:\n                        _context23.prev = 26;\n                        _context23.t1 = _context23['catch'](9);\n                        _didIteratorError3 = true;\n                        _iteratorError3 = _context23.t1;\n\n                      case 30:\n                        _context23.prev = 30;\n                        _context23.prev = 31;\n\n                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                          _iterator3.return();\n                        }\n\n                      case 33:\n                        _context23.prev = 33;\n\n                        if (!_didIteratorError3) {\n                          _context23.next = 36;\n                          break;\n                        }\n\n                        throw _iteratorError3;\n\n                      case 36:\n                        return _context23.finish(33);\n\n                      case 37:\n                        return _context23.finish(30);\n\n                      case 38:\n                        _context23.next = 40;\n                        return recomputeCategoriesMetadata();\n\n                      case 40:\n                      case 'end':\n                        return _context23.stop();\n                    }\n                  }\n                }, _callee22, undefined, [[9, 26, 30, 38], [13, 18], [31,, 33, 37]]);\n              }));\n\n              return function init() {\n                return _ref31.apply(this, arguments);\n              };\n            }();\n\n            /**\n             * @callback ElementProvider\n             * @memberOf!  ContentManager\n             * @param {KnexInstance} knex An instance of Knex\n             * @param {String} category The name of the category\n             * @param {String} args A string with whatever was passed in the parans e.g. \"random(25)\"\n             * @example\n            const randomProvider = (knex, category, args) => {\n            return knex('content_items')\n            .where({ categoryId: category })\n            .orderBy(knex.raw('random()'))\n            .limit(1)\n            .get(0)\n            }\n             */\n\n            /**\n             * Register a new item provider, which is used when parsing query for {@link ContentManager~getItem}\n             * @param  {String} name The name of the provider, e.g. `random`\n             * @param  {ContentManager.ElementProvider} fn A content provider function\n             * @memberOf ContentManager\n             * @public\n             * @example\n            // returns a random element from a given category\n            const randomProvider = (knex, category, args) => {\n            return knex('content_items')\n              .where({ categoryId: category })\n              .orderBy(knex.raw('random()'))\n              .limit(1)\n              .get(0)\n            }\n            bp.contentManager.registerGetItemProvider('random', randomProvider)\n             */\n\n\n            registerGetItemProvider = function registerGetItemProvider(name, fn) {\n              name = name.toLowerCase();\n              getItemProviders[name] = fn;\n            };\n\n            return _context24.abrupt('return', {\n              init: init,\n              listAvailableCategories: listAvailableCategories,\n              getCategorySchema: getCategorySchema,\n\n              loadCategoryFromSchema: loadCategoryFromSchema,\n              recomputeCategoriesMetadata: recomputeCategoriesMetadata,\n\n              createOrUpdateCategoryItem: createOrUpdateCategoryItem,\n              listCategoryItems: listCategoryItems,\n              categoryItemsCount: categoryItemsCount,\n              deleteCategoryItems: deleteCategoryItems,\n\n              getItem: getItem,\n              getItems: getItems,\n              getItemsByMetadata: getItemsByMetadata,\n\n              registerGetItemProvider: registerGetItemProvider\n            });\n\n          case 36:\n          case 'end':\n            return _context24.stop();\n        }\n      }\n    }, _callee23, undefined);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29udGVudC9zZXJ2aWNlLmpzP2EwMjciXSwibmFtZXMiOlsiZ2V0TmV3SXRlbUlkIiwicHJlZml4IiwiY2F0ZWdvcnkiLCJyZW5kZXJlciIsImlkIiwicmVwbGFjZSIsInByZXBhcmVEYiIsImtuZXgiLCJzY2hlbWEiLCJjcmVhdGVUYWJsZSIsInRhYmxlIiwic3RyaW5nIiwicHJpbWFyeSIsInRleHQiLCJ0aW1lc3RhbXAiLCJkZWZhdWx0cyIsImNvbnRlbnREaXIiLCJjb250ZW50RGF0YURpciIsIm1vZHVsZSIsImV4cG9ydHMiLCJib3RmaWxlIiwicHJvamVjdExvY2F0aW9uIiwibG9nZ2VyIiwiZ2hvc3RNYW5hZ2VyIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5QnlJZCIsImZpbGVCeUlkIiwiZ2V0SXRlbVByb3ZpZGVycyIsInBhdGgiLCJyZXNvbHZlIiwidHJhbnNmb3JtSXRlbURiVG9BcGkiLCJpdGVtIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsImZvcm1EYXRhIiwibWV0YWRhdGEiLCJzcGxpdCIsImZpbHRlciIsImkiLCJsZW5ndGgiLCJ0cmFuc2Zvcm1JdGVtQXBpVG9EYiIsInJlc3VsdCIsInN0cmluZ2lmeSIsImpvaW4iLCJsaXN0Q2F0ZWdvcnlJdGVtcyIsImNhdGVnb3J5SWQiLCJmcm9tIiwiY291bnQiLCJzZWFyY2hUZXJtIiwib3JkZXJCeSIsInF1ZXJ5Iiwid2hlcmUiLCJvcldoZXJlIiwib2Zmc2V0IiwibGltaXQiLCJ0aGVuIiwiaXRlbXMiLCJtYXAiLCJkdW1wRGF0YVRvRmlsZSIsIl8iLCJwaWNrIiwidXBzZXJ0RmlsZSIsImR1bXBBbGxEYXRhVG9GaWxlcyIsIlByb21pc2UiLCJnZXRDYXRlZ29yeVNjaGVtYSIsImZpbmQiLCJqc29uIiwianNvblNjaGVtYSIsInVpIiwidWlTY2hlbWEiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwibGlzdEF2YWlsYWJsZUNhdGVnb3JpZXMiLCJnZXQiLCJyb3ciLCJOdW1iZXIiLCJyZXNvbHZlUmVmcyIsIkFycmF5IiwiaXNBcnJheSIsImlzT2JqZWN0IiwicHJvcHMiLCJtYXBWYWx1ZXMiLCJpc1N0cmluZyIsIm0iLCJtYXRjaCIsInNlbGVjdCIsIkVycm9yIiwiY29tcHV0ZURhdGEiLCJjb21wdXRlTWV0YWRhdGEiLCJjb21wdXRlUHJldmlld1RleHQiLCJmaWxsQ29tcHV0ZWRQcm9wcyIsImV4cGFuZGVkRm9ybURhdGEiLCJwcmV2aWV3VGV4dCIsImNyZWF0ZU9yVXBkYXRlQ2F0ZWdvcnlJdGVtIiwiaXRlbUlkIiwidG9Mb3dlckNhc2UiLCJib2R5IiwiaXNOZXdJdGVtQ3JlYXRpb24iLCJ1cGRhdGUiLCJpbnNlcnQiLCJjcmVhdGVkQnkiLCJjcmVhdGVkT24iLCJkYXRlIiwibm93IiwiY2F0ZWdvcnlJdGVtc0NvdW50IiwicSIsInJlcyIsImRlbGV0ZUNhdGVnb3J5SXRlbXMiLCJpZHMiLCJzb21lIiwid2hlcmVJbiIsImRlbCIsImdldEl0ZW1EZWZhdWx0IiwiZ2V0SXRlbSIsInByb3ZpZGVyUmVnZXgiLCJwTWF0Y2giLCJwcm92aWRlciIsImFyZ3MiLCJjYXRlZ29yeU5hbWUiLCJzdWJzdHIiLCJmbiIsImNhdGVnb3J5VGl0bGUiLCJjYXRlZ29yeVNjaGVtYSIsImdldEl0ZW1zIiwicXVlcmllcyIsImdldEl0ZW1zQnlNZXRhZGF0YSIsInJlY29tcHV0ZUNhdGVnb3JpZXNNZXRhZGF0YSIsImVhY2giLCJjb21wdXRlZFByb3BzIiwibG9hZERhdGEiLCJmaWxlTmFtZSIsImRlYnVnIiwicmVhZERhdGFGb3JGaWxlIiwid2FybiIsIm1hcFNlcmllcyIsImxvYWRDYXRlZ29yeUZyb21TY2hlbWEiLCJyZXF1aXJlZEZpZWxkcyIsImZvckVhY2giLCJpc05pbCIsImZpZWxkIiwicHVzaCIsImxvYWRDYXRlZ29yaWVzRnJvbVBhdGgiLCJmaWxlIiwiZmlsZVBhdGgiLCJzY2hlbWFzIiwidGVzdCIsImpzb241IiwiZnMiLCJyZWFkRmlsZVN5bmMiLCJldmFsIiwiVkVycm9yIiwicmVhZEZpbGUiLCJpbmZvIiwiaW5pdCIsIm1rZGlycCIsInN5bmMiLCJhZGRSb290Rm9sZGVyIiwiZmlsZXNHbG9iIiwiZnJvbUNhbGxiYWNrIiwiY3dkIiwiY2IiLCJmaWxlcyIsInJlZ2lzdGVyR2V0SXRlbVByb3ZpZGVyIiwibmFtZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBVUE7Ozs7QUFDQTs7OztBQUVBOztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOzs7O0FBQ0E7Ozs7OztpZUF2QkE7Ozs7Ozs7Ozs7QUF5QkEsSUFBTUEsZUFBZSxTQUFmQSxZQUFlLFdBQVk7QUFDL0IsTUFBTUMsU0FBUyxDQUFDQyxTQUFTQyxRQUFULElBQXFCRCxTQUFTRSxFQUEvQixFQUFtQ0MsT0FBbkMsQ0FBMkMsSUFBM0MsRUFBaUQsRUFBakQsQ0FBZjtBQUNBLFNBQVVKLE1BQVYsU0FBb0Isc0JBQU8sQ0FBUCxDQUFwQjtBQUNELENBSEQ7O0FBS0EsSUFBTUs7QUFBQSxxRUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDVkMsZ0JBRFUsR0FDSCwwQkFERzs7QUFHaEI7QUFDQTtBQUNBOztBQUxnQjtBQUFBLG1CQU1WQSxLQUFLQyxNQUFMLENBQVlDLFdBQVosQ0FBd0IsZUFBeEIsRUFBeUMsaUJBQVM7QUFDdERDLG9CQUFNQyxNQUFOLENBQWEsSUFBYixFQUFtQkMsT0FBbkI7QUFDQUYsb0JBQU1HLElBQU4sQ0FBVyxNQUFYO0FBQ0FILG9CQUFNRyxJQUFOLENBQVcsVUFBWDtBQUNBSCxvQkFBTUcsSUFBTixDQUFXLFVBQVg7QUFDQUgsb0JBQU1DLE1BQU4sQ0FBYSxZQUFiO0FBQ0FELG9CQUFNRyxJQUFOLENBQVcsYUFBWDtBQUNBSCxvQkFBTUMsTUFBTixDQUFhLFdBQWI7QUFDQUQsb0JBQU1JLFNBQU4sQ0FBZ0IsV0FBaEI7QUFDRCxhQVRLLENBTlU7O0FBQUE7QUFBQSw2Q0FpQlRQLElBakJTOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7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OztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBLCtCQWVMaEIsNkJBZks7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsZUE1ZkU7O0FBQUEsOEJBNGZUMkIsSUE1ZlM7QUFBQTtBQUFBO0FBQUE7O0FBOGdCZjs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWtCTVMsbUNBaGpCUyxHQWdqQmlCLFNBQTFCQSx1QkFBMEIsQ0FBQ0MsSUFBRCxFQUFPM0MsRUFBUCxFQUFjO0FBQzVDMkMscUJBQU9BLEtBQUtwRSxXQUFMLEVBQVA7QUFDQXJFLCtCQUFpQnlJLElBQWpCLElBQXlCM0MsRUFBekI7QUFDRCxhQW5qQmM7O0FBQUEsK0NBcWpCUjtBQUNMaUMsd0JBREs7QUFFTGpGLDhEQUZLO0FBR0xSLGtEQUhLOztBQUtMdUUsNERBTEs7QUFNTFQsc0VBTks7O0FBUUxqQyxvRUFSSztBQVNMakQsa0RBVEs7QUFVTDRELG9EQVZLO0FBV0xHLHNEQVhLOztBQWFMTSw4QkFiSztBQWNMVSxnQ0FkSztBQWVMRSxvREFmSzs7QUFpQkxxQztBQWpCSyxhQXJqQlE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBakI7O0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJmaWxlIjoiLi9zcmMvY29udGVudC9zZXJ2aWNlLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgQ29udGVudCBNYW5hZ2VyIGlzIG1haW5seSBpbiBjaGFyZ2Ugb2Ygc3RvcmluZyBhbmQgcmV0cmlldmluZ1xuICogYWxsIHRoZSBjb250ZW50IHRoYXQgaXMgc3RvcmVkIGFuZCBrbm93biBieSB0aGUgYm90LiBUaGUgY29udGVudCBpbmNsdWRlcyAoYnV0IGlzIG5vdCBsaW1pdGVkIHRvKVxuICogdGhlIG1lc3NhZ2VzIHRoYXQgdGhlIGJvdCBzZW5kcyB0byB1c2Vycy5cbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vYm90cHJlc3MuaW8vZG9jcy8xMC4wL2dldHRpbmdfc3RhcnRlZC90cml2aWFfY29udGVudC99XG4gKiBAbmFtZXNwYWNlICBDb250ZW50TWFuYWdlclxuICogQGV4YW1wbGVcbiAqIGJwLmNvbnRlbnRNYW5hZ2VyXG4gKi9cblxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcblxuaW1wb3J0IHsgVkVycm9yIH0gZnJvbSAndmVycm9yJ1xuXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCBnbG9iIGZyb20gJ2dsb2InXG5pbXBvcnQgbWtkaXJwIGZyb20gJ21rZGlycCdcbmltcG9ydCBuYW5vaWQgZnJvbSAnbmFub2lkJ1xuaW1wb3J0IGpzb241IGZyb20gJ2pzb241J1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuLi9kYXRhYmFzZS9oZWxwZXJzJ1xuaW1wb3J0IHsgZ2V0SW5NZW1vcnlEYiB9IGZyb20gJy4uL3V0aWwnXG5cbmNvbnN0IGdldE5ld0l0ZW1JZCA9IGNhdGVnb3J5ID0+IHtcbiAgY29uc3QgcHJlZml4ID0gKGNhdGVnb3J5LnJlbmRlcmVyIHx8IGNhdGVnb3J5LmlkKS5yZXBsYWNlKC9eIy8sICcnKVxuICByZXR1cm4gYCR7cHJlZml4fS0ke25hbm9pZCg2KX1gXG59XG5cbmNvbnN0IHByZXBhcmVEYiA9IGFzeW5jICgpID0+IHtcbiAgY29uc3Qga25leCA9IGdldEluTWVtb3J5RGIoKVxuXG4gIC8vIE5CISBUaGlzIGlzIGluLW1lbW9yeSB0ZW1wcm9yYXJ5IGRhdGFiYXNlXG4gIC8vIEl0IGlzIGZyZXNobHkgY3JlYXRlZCBzbyB3ZSBrbm93IHRoZXJlIGFyZSBubyB0YWJsZXNcbiAgLy8gV2UgYWxzbyB1c2UgY2FtZWxDYXNlZCBjb2x1bW5zIGZvciBjb252ZW5pZW5jZVxuICBhd2FpdCBrbmV4LnNjaGVtYS5jcmVhdGVUYWJsZSgnY29udGVudF9pdGVtcycsIHRhYmxlID0+IHtcbiAgICB0YWJsZS5zdHJpbmcoJ2lkJykucHJpbWFyeSgpXG4gICAgdGFibGUudGV4dCgnZGF0YScpXG4gICAgdGFibGUudGV4dCgnZm9ybURhdGEnKVxuICAgIHRhYmxlLnRleHQoJ21ldGFkYXRhJylcbiAgICB0YWJsZS5zdHJpbmcoJ2NhdGVnb3J5SWQnKVxuICAgIHRhYmxlLnRleHQoJ3ByZXZpZXdUZXh0JylcbiAgICB0YWJsZS5zdHJpbmcoJ2NyZWF0ZWRCeScpXG4gICAgdGFibGUudGltZXN0YW1wKCdjcmVhdGVkT24nKVxuICB9KVxuXG4gIHJldHVybiBrbmV4XG59XG5cbmNvbnN0IGRlZmF1bHRzID0ge1xuICBjb250ZW50RGlyOiAnLi9jb250ZW50JyxcbiAgY29udGVudERhdGFEaXI6ICcuL2NvbnRlbnRfZGF0YSdcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoeyBib3RmaWxlLCBwcm9qZWN0TG9jYXRpb24sIGxvZ2dlciwgZ2hvc3RNYW5hZ2VyIH0pID0+IHtcbiAgY29uc3QgY2F0ZWdvcmllcyA9IFtdXG4gIGNvbnN0IGNhdGVnb3J5QnlJZCA9IHt9XG4gIGNvbnN0IGZpbGVCeUlkID0ge31cblxuICBjb25zdCBnZXRJdGVtUHJvdmlkZXJzID0ge31cblxuICBjb25zdCBjb250ZW50RGlyID0gcGF0aC5yZXNvbHZlKHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZS5jb250ZW50RGlyIHx8IGRlZmF1bHRzLmNvbnRlbnREaXIpXG4gIGNvbnN0IGNvbnRlbnREYXRhRGlyID0gcGF0aC5yZXNvbHZlKHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZS5jb250ZW50RGF0YURpciB8fCBkZWZhdWx0cy5jb250ZW50RGF0YURpcilcblxuICBjb25zdCBrbmV4ID0gYXdhaXQgcHJlcGFyZURiKClcblxuICBjb25zdCB0cmFuc2Zvcm1JdGVtRGJUb0FwaSA9IGl0ZW0gPT4ge1xuICAgIGlmICghaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uaXRlbSxcbiAgICAgIGRhdGE6IEpTT04ucGFyc2UoaXRlbS5kYXRhKSxcbiAgICAgIGZvcm1EYXRhOiBKU09OLnBhcnNlKGl0ZW0uZm9ybURhdGEpLFxuICAgICAgbWV0YWRhdGE6IChpdGVtLm1ldGFkYXRhIHx8ICcnKS5zcGxpdCgnfCcpLmZpbHRlcihpID0+IGkubGVuZ3RoID4gMClcbiAgICB9XG4gIH1cblxuICBjb25zdCB0cmFuc2Zvcm1JdGVtQXBpVG9EYiA9IGl0ZW0gPT4ge1xuICAgIGlmICghaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSB7IC4uLml0ZW0gfVxuXG4gICAgaWYgKCdmb3JtRGF0YScgaW4gaXRlbSkge1xuICAgICAgcmVzdWx0LmZvcm1EYXRhID0gSlNPTi5zdHJpbmdpZnkoaXRlbS5mb3JtRGF0YSlcbiAgICB9XG4gICAgaWYgKCdkYXRhJyBpbiBpdGVtKSB7XG4gICAgICByZXN1bHQuZGF0YSA9IEpTT04uc3RyaW5naWZ5KGl0ZW0uZGF0YSlcbiAgICB9XG4gICAgaWYgKCdtZXRhZGF0YScgaW4gaXRlbSkge1xuICAgICAgcmVzdWx0Lm1ldGFkYXRhID0gJ3wnICsgKGl0ZW0ubWV0YWRhdGEgfHwgW10pLmZpbHRlcihpID0+ICEhaSkuam9pbignfCcpICsgJ3wnXG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IENvbnRlbnRNYW5hZ2VyfkVsZW1lbnRcbiAgICogQG1lbWJlck9mIENvbnRlbnRNYW5hZ2VyXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBDb250ZW50TWFuYWdlcn5DYXRlZ29yeVNjaGVtYVxuICAgKiBAbWVtYmVyT2YgQ29udGVudE1hbmFnZXJcbiAgICogQHByb3Age09iamVjdH0ganNvbiBUaGUgSlNPTlNjaGVtYVxuICAgKiBAcHJvcCB7U3RyaW5nfSB1aSBUaGUgVUkgSlNPTlNjaGVtYVxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gZGVzY3JpcHRpb25cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHJlbmRlcmVyIFRoZSBuYW1lIG9mIHRoZSBDb250ZW50IFJlbmRlcmVyXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBDb250ZW50TWFuYWdlcn5DYXRlZ29yeVxuICAgKiBAbWVtYmVyT2YgQ29udGVudE1hbmFnZXJcbiAgICogQHByb3Age1N0cmluZ30gaWRcbiAgICogQHByb3Age1N0cmluZ30gdGl0bGVcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IGRlc2NyaXB0aW9uXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoYXQgY2F0ZWdvcnlcbiAgICogQHByb3BlcnR5IHtDb250ZW50TWFuYWdlcn5DYXRlZ29yeVNjaGVtYX0gc2NoZW1hXG4gICAqL1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBlbGVtZW50cyBvZiBhIGdpdmVuIGNhdGVnb3J5XG4gICAqIEBwYXJhbSAge1N0cmluZ30gY2F0ZWdvcnlJZCBUaGUgY2F0ZWdvcnksIGZvciBleGFtcGxlIGB0ZXh0YCBvciBgdHJpdmlhYC5cbiAgICogQHBhcmFtICB7TnVtYmVyfSBbb3B0aW9ucy5mcm9tPTBdIFBhZ2luYXRpb24gcGFyYW1ldGVyICh3aGVyZSB0byBzdGFydClcbiAgICogQHBhcmFtICB7TnVtYmVyfSBbb3B0aW9ucy5jb3VudD01MF0gUGFnaW5hdGlvbiBwYXJhbWV0ZXIgKGhvdyBtYW55IGVsZW1lbnRzIHRvIHJldHVybilcbiAgICogQHBhcmFtICB7U3RyaW5nfSBbb3B0aW9ucy5zZWFyY2hUZXJtPV0gT25seSByZXR1cm4gdGhlIGVsZW1lbnRzIGNvbnRhaW5pbmcgdGhpcyB0ZXJtXG4gICAqIEBwYXJhbSAge0FycmF5LjxTdHJpbmc+fSAgW29wdGlvbnMub3JkZXJCeT1bJ2NyZWF0ZWRPbiddXSAgICBBIGxpc3Qgb2YgcHJvcGVydGllcyB0byBvcmRlciB0aGUgZWxlbWVudHMgYnkuXG4gICAqIEByZXR1cm4ge0NvbnRlbnRNYW5hZ2VyfkVsZW1lbnRbXX1cbiAgICogQHB1YmxpY1xuICAgKiBAbWVtYmVyT2YhIENvbnRlbnRNYW5hZ2VyXG4gICAqL1xuICBjb25zdCBsaXN0Q2F0ZWdvcnlJdGVtcyA9IGFzeW5jIChjYXRlZ29yeUlkLCB7IGZyb20gPSAwLCBjb3VudCA9IDUwLCBzZWFyY2hUZXJtLCBvcmRlckJ5ID0gWydjcmVhdGVkT24nXSB9ID0ge30pID0+IHtcbiAgICBsZXQgcXVlcnkgPSBrbmV4KCdjb250ZW50X2l0ZW1zJylcblxuICAgIGlmIChjYXRlZ29yeUlkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKHsgY2F0ZWdvcnlJZCB9KVxuICAgIH1cblxuICAgIGlmIChzZWFyY2hUZXJtKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLndoZXJlKCdtZXRhZGF0YScsICdsaWtlJywgYCUke3NlYXJjaFRlcm19JWApXG4gICAgICAgICAgLm9yV2hlcmUoJ2Zvcm1EYXRhJywgJ2xpa2UnLCBgJSR7c2VhcmNoVGVybX0lYClcbiAgICAgICAgICAub3JXaGVyZSgnaWQnLCAnbGlrZScsIGAlJHtzZWFyY2hUZXJtfSVgKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHF1ZXJ5XG4gICAgICAub3JkZXJCeSguLi5vcmRlckJ5KVxuICAgICAgLm9mZnNldChmcm9tKVxuICAgICAgLmxpbWl0KGNvdW50KVxuICAgICAgLnRoZW4oKVxuXG4gICAgcmV0dXJuIGl0ZW1zLm1hcCh0cmFuc2Zvcm1JdGVtRGJUb0FwaSlcbiAgfVxuXG4gIGNvbnN0IGR1bXBEYXRhVG9GaWxlID0gYXN5bmMgY2F0ZWdvcnlJZCA9PiB7XG4gICAgLy8gVE9ETyBEbyBwYWdpbmcgaGVyZSBhbmQgZHVtcCAqZXZlcnl0aGluZypcbiAgICBjb25zdCBpdGVtcyA9IChhd2FpdCBsaXN0Q2F0ZWdvcnlJdGVtcyhjYXRlZ29yeUlkLCB7IGNvdW50OiAxMDAwMCB9KSkubWFwKGl0ZW0gPT5cbiAgICAgIF8ucGljayhpdGVtLCAnaWQnLCAnZm9ybURhdGEnLCAnY3JlYXRlZEJ5JywgJ2NyZWF0ZWRPbicpXG4gICAgKVxuXG4gICAgYXdhaXQgZ2hvc3RNYW5hZ2VyLnVwc2VydEZpbGUoY29udGVudERhdGFEaXIsIGZpbGVCeUlkW2NhdGVnb3J5SWRdLCBKU09OLnN0cmluZ2lmeShpdGVtcywgbnVsbCwgMikpXG4gIH1cblxuICBjb25zdCBkdW1wQWxsRGF0YVRvRmlsZXMgPSAoKSA9PiBQcm9taXNlLm1hcChjYXRlZ29yaWVzLCAoeyBpZCB9KSA9PiBkdW1wRGF0YVRvRmlsZShpZCkpXG5cbiAgLyoqXG4gICAqIEdldCB0aGUgc2NoZW1hIGZvciBhIGdpdmVuIGNhdGVnb3J5XG4gICAqIEBwYXJhbSAge1N0cmluZ30gY2F0ZWdvcnlJZCBbZGVzY3JpcHRpb25dXG4gICAqIEByZXR1cm4ge0NvbnRlbnRNYW5hZ2VyfkNhdGVnb3J5U2NoZW1hfVxuICAgKi9cbiAgY29uc3QgZ2V0Q2F0ZWdvcnlTY2hlbWEgPSBjYXRlZ29yeUlkID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeSA9IF8uZmluZChjYXRlZ29yaWVzLCB7IGlkOiBjYXRlZ29yeUlkIH0pXG4gICAgaWYgKGNhdGVnb3J5ID09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGpzb246IGNhdGVnb3J5Lmpzb25TY2hlbWEsXG4gICAgICB1aTogY2F0ZWdvcnkudWlTY2hlbWEsXG4gICAgICB0aXRsZTogY2F0ZWdvcnkudGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogY2F0ZWdvcnkuZGVzY3JpcHRpb24sXG4gICAgICByZW5kZXJlcjogY2F0ZWdvcnkucmVuZGVyZXJcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbGwgdGhlIGNhdGVnb3JpZXNcbiAgICogQHB1YmxpY1xuICAgKiBAcmV0dXJuIHtDb250ZW50TWFuYWdlcn5DYXRlZ29yeVtdfVxuICAgKiBAbWVtYmVyT2YhIENvbnRlbnRNYW5hZ2VyXG4gICAqL1xuICBjb25zdCBsaXN0QXZhaWxhYmxlQ2F0ZWdvcmllcyA9ICgpID0+XG4gICAgUHJvbWlzZS5tYXAoY2F0ZWdvcmllcywgYXN5bmMgY2F0ZWdvcnkgPT4ge1xuICAgICAgY29uc3QgY291bnQgPSBhd2FpdCBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgICAgICAgLndoZXJlKHsgY2F0ZWdvcnlJZDogY2F0ZWdvcnkuaWQgfSlcbiAgICAgICAgLmNvdW50KCcqIGFzIGNvdW50JylcbiAgICAgICAgLmdldCgwKVxuICAgICAgICAudGhlbihyb3cgPT4gKHJvdyAmJiBOdW1iZXIocm93LmNvdW50KSkgfHwgMClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IGNhdGVnb3J5LmlkLFxuICAgICAgICB0aXRsZTogY2F0ZWdvcnkudGl0bGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBjYXRlZ29yeS5kZXNjcmlwdGlvbixcbiAgICAgICAgY291bnQsXG4gICAgICAgIHNjaGVtYTogZ2V0Q2F0ZWdvcnlTY2hlbWEoY2F0ZWdvcnkuaWQpXG4gICAgICB9XG4gICAgfSlcblxuICBjb25zdCByZXNvbHZlUmVmcyA9IGFzeW5jIGRhdGEgPT4ge1xuICAgIGlmICghZGF0YSkge1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLm1hcChkYXRhLCByZXNvbHZlUmVmcylcbiAgICB9XG4gICAgaWYgKF8uaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnByb3BzKF8ubWFwVmFsdWVzKGRhdGEsIHJlc29sdmVSZWZzKSlcbiAgICB9XG4gICAgaWYgKF8uaXNTdHJpbmcoZGF0YSkpIHtcbiAgICAgIGNvbnN0IG0gPSBkYXRhLm1hdGNoKC9eIyNyZWZcXCgoLiopXFwpJC8pXG4gICAgICBpZiAoIW0pIHtcbiAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgIH1cbiAgICAgIHJldHVybiBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgICAgICAgLnNlbGVjdCgnZm9ybURhdGEnKVxuICAgICAgICAud2hlcmUoJ2lkJywgbVsxXSlcbiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICBpZiAoIXJlc3VsdCB8fCAhcmVzdWx0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciByZXNvbHZpbmcgcmVmZXJlbmNlOiBJRCAke21bMV19IG5vdCBmb3VuZC5gKVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXN1bHRbMF0uZm9ybURhdGEpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlc29sdmVSZWZzKVxuICAgIH1cbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgY29uc3QgY29tcHV0ZURhdGEgPSBhc3luYyAoY2F0ZWdvcnlJZCwgZm9ybURhdGEpID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeSA9IGNhdGVnb3J5QnlJZFtjYXRlZ29yeUlkXVxuICAgIGlmICghY2F0ZWdvcnkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBjYXRlZ29yeSAke2NhdGVnb3J5SWR9YClcbiAgICB9XG4gICAgcmV0dXJuICFjYXRlZ29yeS5jb21wdXRlRGF0YSA/IGZvcm1EYXRhIDogY2F0ZWdvcnkuY29tcHV0ZURhdGEoZm9ybURhdGEsIGNvbXB1dGVEYXRhKVxuICB9XG5cbiAgY29uc3QgY29tcHV0ZU1ldGFkYXRhID0gYXN5bmMgKGNhdGVnb3J5SWQsIGZvcm1EYXRhKSA9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnkgPSBjYXRlZ29yeUJ5SWRbY2F0ZWdvcnlJZF1cbiAgICBpZiAoIWNhdGVnb3J5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gY2F0ZWdvcnkgJHtjYXRlZ29yeUlkfWApXG4gICAgfVxuICAgIHJldHVybiAhY2F0ZWdvcnkuY29tcHV0ZU1ldGFkYXRhID8gW10gOiBjYXRlZ29yeS5jb21wdXRlTWV0YWRhdGEoZm9ybURhdGEsIGNvbXB1dGVNZXRhZGF0YSlcbiAgfVxuXG4gIGNvbnN0IGNvbXB1dGVQcmV2aWV3VGV4dCA9IGFzeW5jIChjYXRlZ29yeUlkLCBmb3JtRGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhdGVnb3J5ID0gY2F0ZWdvcnlCeUlkW2NhdGVnb3J5SWRdXG4gICAgaWYgKCFjYXRlZ29yeSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGNhdGVnb3J5ICR7Y2F0ZWdvcnlJZH1gKVxuICAgIH1cbiAgICByZXR1cm4gIWNhdGVnb3J5LmNvbXB1dGVQcmV2aWV3VGV4dCA/ICdObyBwcmV2aWV3JyA6IGNhdGVnb3J5LmNvbXB1dGVQcmV2aWV3VGV4dChmb3JtRGF0YSwgY29tcHV0ZVByZXZpZXdUZXh0KVxuICB9XG5cbiAgY29uc3QgZmlsbENvbXB1dGVkUHJvcHMgPSBhc3luYyAoY2F0ZWdvcnksIGZvcm1EYXRhKSA9PiB7XG4gICAgaWYgKGZvcm1EYXRhID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignXCJmb3JtRGF0YVwiIG11c3QgYmUgYSB2YWxpZCBvYmplY3QnKVxuICAgIH1cblxuICAgIGNvbnN0IGV4cGFuZGVkRm9ybURhdGEgPSBhd2FpdCByZXNvbHZlUmVmcyhmb3JtRGF0YSlcblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjb21wdXRlRGF0YShjYXRlZ29yeS5pZCwgZXhwYW5kZWRGb3JtRGF0YSlcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGNvbXB1dGVNZXRhZGF0YShjYXRlZ29yeS5pZCwgZXhwYW5kZWRGb3JtRGF0YSlcbiAgICBjb25zdCBwcmV2aWV3VGV4dCA9IGF3YWl0IGNvbXB1dGVQcmV2aWV3VGV4dChjYXRlZ29yeS5pZCwgZXhwYW5kZWRGb3JtRGF0YSlcblxuICAgIGlmICghXy5pc0FycmF5KG1ldGFkYXRhKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb21wdXRlTWV0YWRhdGEgbXVzdCByZXR1cm4gYW4gYXJyYXkgb2Ygc3RyaW5ncycpXG4gICAgfVxuXG4gICAgaWYgKCFfLmlzU3RyaW5nKHByZXZpZXdUZXh0KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb21wdXRlUHJldmlld1RleHQgbXVzdCByZXR1cm4gYSBzdHJpbmcnKVxuICAgIH1cblxuICAgIGlmIChkYXRhID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY29tcHV0ZURhdGEgbXVzdCByZXR1cm4gYSB2YWxpZCBvYmplY3QnKVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhLFxuICAgICAgbWV0YWRhdGEsXG4gICAgICBwcmV2aWV3VGV4dFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIG9yIHVwZGF0ZXMgYW4gW0VsZW1lbnRde0BsaW5rIENvbnRlbnRNYW5hZ2VyfkVsZW1lbnR9XG4gICAqIEBwYXJhbSAge1N0cmluZ30gW29wdGlvbnMuaXRlbUlkPV0gVGhlIGlkIG9mIHRoZSBlbGVtZW50IHRvIGFkZFxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IG9wdGlvbnMuY2F0ZWdvcnlJZCBUaGUgY2F0ZWdvcnkgb2YgdGhlIGVsZW1lbnRcbiAgICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zLmZvcm1EYXRhIFRoZSBjb250ZW50IG9mIHRoZSBlbGVtZW50XG4gICAqIEBhc3luY1xuICAgKiBAcHVibGljXG4gICAqIEBtZW1iZXJPZiEgQ29udGVudE1hbmFnZXJcbiAgICovXG4gIGNvbnN0IGNyZWF0ZU9yVXBkYXRlQ2F0ZWdvcnlJdGVtID0gYXN5bmMgKHsgaXRlbUlkLCBjYXRlZ29yeUlkLCBmb3JtRGF0YSB9KSA9PiB7XG4gICAgY2F0ZWdvcnlJZCA9IGNhdGVnb3J5SWQgJiYgY2F0ZWdvcnlJZC50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBfLmZpbmQoY2F0ZWdvcmllcywgeyBpZDogY2F0ZWdvcnlJZCB9KVxuXG4gICAgaWYgKGNhdGVnb3J5ID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2F0ZWdvcnkgXCIke2NhdGVnb3J5SWR9XCIgaXMgbm90IGEgdmFsaWQgcmVnaXN0ZXJlZCBjYXRlZ29yeUlkYClcbiAgICB9XG5cbiAgICBjb25zdCBpdGVtID0geyBmb3JtRGF0YSwgLi4uKGF3YWl0IGZpbGxDb21wdXRlZFByb3BzKGNhdGVnb3J5LCBmb3JtRGF0YSkpIH1cbiAgICBjb25zdCBib2R5ID0gdHJhbnNmb3JtSXRlbUFwaVRvRGIoaXRlbSlcblxuICAgIGNvbnN0IGlzTmV3SXRlbUNyZWF0aW9uID0gIWl0ZW1JZFxuICAgIGlmIChpc05ld0l0ZW1DcmVhdGlvbikge1xuICAgICAgaXRlbUlkID0gZ2V0TmV3SXRlbUlkKGNhdGVnb3J5KVxuICAgIH1cblxuICAgIGlmICghaXNOZXdJdGVtQ3JlYXRpb24pIHtcbiAgICAgIGF3YWl0IGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgICAudXBkYXRlKGJvZHkpXG4gICAgICAgIC53aGVyZSh7IGlkOiBpdGVtSWQgfSlcbiAgICAgICAgLnRoZW4oKVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBrbmV4KCdjb250ZW50X2l0ZW1zJykuaW5zZXJ0KHtcbiAgICAgICAgLi4uYm9keSxcbiAgICAgICAgY3JlYXRlZEJ5OiAnYWRtaW4nLFxuICAgICAgICBjcmVhdGVkT246IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKSxcbiAgICAgICAgaWQ6IGl0ZW1JZCxcbiAgICAgICAgY2F0ZWdvcnlJZFxuICAgICAgfSlcbiAgICB9XG5cbiAgICBhd2FpdCBkdW1wRGF0YVRvRmlsZShjYXRlZ29yeUlkKVxuICAgIHJldHVybiBpdGVtSWRcbiAgfVxuXG4gIGNvbnN0IGNhdGVnb3J5SXRlbXNDb3VudCA9IGNhdGVnb3J5SWQgPT4ge1xuICAgIGxldCBxID0ga25leCgnY29udGVudF9pdGVtcycpXG4gICAgaWYgKGNhdGVnb3J5SWQgJiYgY2F0ZWdvcnlJZCAhPT0gJ2FsbCcpIHtcbiAgICAgIHEgPSBxLndoZXJlKHsgY2F0ZWdvcnlJZCB9KVxuICAgIH1cbiAgICByZXR1cm4gcS5jb3VudCgnaWQgYXMgY291bnQnKS50aGVuKChbcmVzXSkgPT4gTnVtYmVyKHJlcy5jb3VudCkpXG4gIH1cblxuICBjb25zdCBkZWxldGVDYXRlZ29yeUl0ZW1zID0gYXN5bmMgaWRzID0+IHtcbiAgICBpZiAoIV8uaXNBcnJheShpZHMpIHx8IF8uc29tZShpZHMsIGlkID0+ICFfLmlzU3RyaW5nKGlkKSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgYW4gYXJyYXkgb2YgSWRzIHRvIGRlbGV0ZScpXG4gICAgfVxuXG4gICAgYXdhaXQga25leCgnY29udGVudF9pdGVtcycpXG4gICAgICAud2hlcmVJbignaWQnLCBpZHMpXG4gICAgICAuZGVsKClcbiAgICAgIC50aGVuKClcblxuICAgIHJldHVybiBkdW1wQWxsRGF0YVRvRmlsZXMoKVxuICB9XG5cbiAgY29uc3QgZ2V0SXRlbURlZmF1bHQgPSBhc3luYyBpZCA9PiB7XG4gICAgcmV0dXJuIGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgLndoZXJlKHsgaWQgfSlcbiAgICAgIC5nZXQoMClcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgb25lIGl0ZW1cbiAgICogQHBhcmFtICB7U3RyaW5nfSBxdWVyeSBVc3VhbGx5IHRoZSBpZCBvZiB0aGUge0BsaW5rIENvbnRlbnRNYW5hZ2VyLkVsZW1lbnR9LFxuICAgKiBidXQgY2FuIGFsc28gYmUgYSBjYWxsIHRvIGEge0BsaW5rIENvbnRlbnRNYW5hZ2VyLkVsZW1lbnRQcm92aWRlcn0uXG4gICAqIEByZXR1cm4ge0NvbnRlbnRNYW5hZ2VyLkVsZW1lbnRQcm92aWRlcn1cbiAgICogQG1lbWJlcm9mISBDb250ZW50TWFuYWdlclxuICAgKiBAZXhhbXBsZVxuICAgKiBhd2FpdCBicC5jb250ZW50TWFuYWdlci5nZXRJdGVtKCcjIXRyaXZpYS0xMjM0NScpXG4gICAqIGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmdldEl0ZW0oJyN0cml2aWEtcmFuZG9tKCknKVxuICAgKi9cbiAgY29uc3QgZ2V0SXRlbSA9IGFzeW5jIHF1ZXJ5ID0+IHtcbiAgICBjb25zdCBwcm92aWRlclJlZ2V4ID0gLy0oLispXFwoKC4qKVxcKSQvaVxuXG4gICAgY29uc3QgcE1hdGNoID0gcXVlcnkubWF0Y2gocHJvdmlkZXJSZWdleClcbiAgICBsZXQgaXRlbVxuXG4gICAgaWYgKHBNYXRjaCkge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBwTWF0Y2hbMV0udG9Mb3dlckNhc2UoKVxuICAgICAgY29uc3QgYXJncyA9IHBNYXRjaFsyXVxuICAgICAgY29uc3QgY2F0ZWdvcnlOYW1lID0gcXVlcnkuc3Vic3RyKDAsIHF1ZXJ5Lmxlbmd0aCAtIHBNYXRjaFswXS5sZW5ndGgpXG5cbiAgICAgIGNvbnN0IGZuID0gZ2V0SXRlbVByb3ZpZGVyc1twcm92aWRlcl1cblxuICAgICAgaWYgKCFmbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgY29udGVudCBleHByZXNzaW9uIFwiJHtxdWVyeX1cIiwgZGlkIHlvdSBmb3JnZXQgdG8gcmVnaXN0ZXIgdGhlIFwiJHtwcm92aWRlcn1cIiBwcm92aWRlcj9gKVxuICAgICAgfVxuXG4gICAgICBpdGVtID0gYXdhaXQgZm4oa25leCwgY2F0ZWdvcnlOYW1lLCBhcmdzKVxuXG4gICAgICBpZiAoXy5pc0FycmF5KGl0ZW0pKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgUHJvdmlkZXIgXCIke3Byb3ZpZGVyfVwiIHJldHVybmVkIGFuIGFycmF5IGluc3RlYWQgb2YgYW4gb2JqZWN0YClcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaXRlbSA9IGF3YWl0IGdldEl0ZW1EZWZhdWx0KHF1ZXJ5KVxuICAgIH1cblxuICAgIGlmICghaXRlbSkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBjYXRlZ29yeSA9IF8uZmluZChjYXRlZ29yaWVzLCB7IGlkOiBpdGVtLmNhdGVnb3J5SWQgfSlcblxuICAgIHJldHVybiB7XG4gICAgICAuLi50cmFuc2Zvcm1JdGVtRGJUb0FwaShpdGVtKSxcbiAgICAgIGNhdGVnb3J5VGl0bGU6IGNhdGVnb3J5LnRpdGxlLFxuICAgICAgY2F0ZWdvcnlTY2hlbWE6IGdldENhdGVnb3J5U2NoZW1hKGl0ZW0uY2F0ZWdvcnlJZClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIG11bHRpcGxlIGl0ZW1zXG4gICAqIEBwYXJhbSAge1N0cmluZ30gcXVlcnkgQ29tbWEtc2VwYXJ0ZWQgc3RyaW5nIHdoZXJlIGVhY2ggcGFydCBpc1xuICAgKiB0aGUgc2FtZSBhcyBhbiBhcmd1bWVudCB0byB7QGxpbmsgQ29udGVudE1hbmFnZXIuZ2V0SXRlbX0uXG4gICAqIEByZXR1cm4ge0FycmF5PENvbnRlbnRNYW5hZ2VyLkVsZW1lbnRQcm92aWRlcj59XG4gICAqIEBtZW1iZXJvZiEgQ29udGVudE1hbmFnZXJcbiAgICogQGV4YW1wbGVcbiAgICogYXdhaXQgYnAuY29udGVudE1hbmFnZXIuZ2V0SXRlbXMoJyMhdHJpdmlhLTEyMzQ1LCMhdHJpdmlhLTEyMzQ2JylcbiAgICovXG4gIGNvbnN0IGdldEl0ZW1zID0gcXVlcmllcyA9PiBQcm9taXNlLm1hcChxdWVyaWVzLnNwbGl0KCcsJyksIGdldEl0ZW0pXG5cbiAgY29uc3QgZ2V0SXRlbXNCeU1ldGFkYXRhID0gYXN5bmMgbWV0YWRhdGEgPT4ge1xuICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQga25leCgnY29udGVudF9pdGVtcycpXG4gICAgICAud2hlcmUoJ21ldGFkYXRhJywgJ2xpa2UnLCAnJXwnICsgbWV0YWRhdGEgKyAnfCUnKVxuICAgICAgLnRoZW4oKVxuXG4gICAgcmV0dXJuIHRyYW5zZm9ybUl0ZW1EYlRvQXBpKGl0ZW1zKVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZnJlc2hlcyB0aGUgY29udGVudCBjYXRlZ29yaWVzIG1ldGFkYXRhIGludGVybmFsbHkuXG4gICAqIFRoaXMgbXVzdCBiZSBjYWxsZWQgYWZ0ZXIgdXNpbmcgYGxvYWRDYXRlZ29yeUZyb21TY2hlbWFgXG4gICAqIEBtZW1iZXJPZiEgIENvbnRlbnRNYW5hZ2VyXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGNvbnN0IHJlY29tcHV0ZUNhdGVnb3JpZXNNZXRhZGF0YSA9IGFzeW5jICgpID0+IHtcbiAgICBmb3IgKGNvbnN0IHsgaWQ6IGNhdGVnb3J5SWQgfSBvZiBjYXRlZ29yaWVzKSB7XG4gICAgICBhd2FpdCBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgICAgICAgLnNlbGVjdCgnaWQnLCAnZm9ybURhdGEnKVxuICAgICAgICAud2hlcmUoJ2NhdGVnb3J5SWQnLCBjYXRlZ29yeUlkKVxuICAgICAgICAudGhlbigpXG4gICAgICAgIC5lYWNoKGFzeW5jICh7IGlkLCBmb3JtRGF0YSB9KSA9PiB7XG4gICAgICAgICAgY29uc3QgY29tcHV0ZWRQcm9wcyA9IGF3YWl0IGZpbGxDb21wdXRlZFByb3BzKGNhdGVnb3J5QnlJZFtjYXRlZ29yeUlkXSwgSlNPTi5wYXJzZShmb3JtRGF0YSkpXG4gICAgICAgICAgcmV0dXJuIGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgICAgICAgLndoZXJlKCdpZCcsIGlkKVxuICAgICAgICAgICAgLnVwZGF0ZSh0cmFuc2Zvcm1JdGVtQXBpVG9EYihjb21wdXRlZFByb3BzKSlcbiAgICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBjb25zdCBsb2FkRGF0YSA9IGFzeW5jIGNhdGVnb3J5ID0+IHtcbiAgICBjb25zdCBmaWxlTmFtZSA9IGNhdGVnb3J5LmlkICsgJy5qc29uJ1xuICAgIGZpbGVCeUlkW2NhdGVnb3J5LmlkXSA9IGZpbGVOYW1lXG5cbiAgICBsb2dnZXIuZGVidWcoYExvYWRpbmcgZGF0YSBmb3IgJHtjYXRlZ29yeS5pZH0gZnJvbSAke2ZpbGVOYW1lfWApXG4gICAgbGV0IGRhdGEgPSBbXVxuICAgIHRyeSB7XG4gICAgICBkYXRhID0gYXdhaXQgcmVhZERhdGFGb3JGaWxlKGZpbGVOYW1lKVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nZ2VyLndhcm4oYEVycm9yIHJlYWRpbmcgZGF0YSBmcm9tICR7ZmlsZU5hbWV9YCwgZXJyKVxuICAgIH1cblxuICAgIGRhdGEgPSBhd2FpdCBQcm9taXNlLm1hcChkYXRhLCBhc3luYyBpdGVtID0+ICh7XG4gICAgICAuLi5pdGVtLFxuICAgICAgY2F0ZWdvcnlJZDogY2F0ZWdvcnkuaWQsXG4gICAgICBpZDogaXRlbS5pZCB8fCBnZXROZXdJdGVtSWQoY2F0ZWdvcnkpXG4gICAgfSkpXG5cbiAgICAvLyBUT0RPOiB1c2UgdHJhbnNhY3Rpb25cbiAgICByZXR1cm4gUHJvbWlzZS5tYXBTZXJpZXMoZGF0YSwgaXRlbSA9PlxuICAgICAga25leCgnY29udGVudF9pdGVtcycpXG4gICAgICAgIC5pbnNlcnQodHJhbnNmb3JtSXRlbUFwaVRvRGIoaXRlbSkpXG4gICAgICAgIC50aGVuKClcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogTG9hZHMgYSBuZXcgY2F0ZWdvcnkgZnJvbSBhIHJhdyBzY2hlbWEgZGVmaW5pdGlvbi5cbiAgICogKkltcG9ydGFudDoqIGRvIG5vdCBmb3JnZXQgdG8gY2FsbCBgQ29udGVudE1hbmFnZXJ+cmVjb21wdXRlQ2F0ZWdvcmllc01ldGFkYXRhYCBhZnRlciBjYWxsaW5nIHRoaXNcbiAgICogQHBhcmFtICB7Q29udGVudE1hbmFnZXJ+Q2F0ZWdvcnl9IHNjaGVtYSBBIHNjaGVtYSBkZWZpbml0aW9uXG4gICAqIEBtZW1iZXJPZiEgIENvbnRlbnRNYW5hZ2VyXG4gICAqIEByZXR1cm4ge09iamVjdH0gUmV0dXJucyB0aGUgbG9hZGVkIGNhdGVnb3J5IHNjaGVtYVxuICAgKiBAcHVibGljXG4gICAqL1xuICBjb25zdCBsb2FkQ2F0ZWdvcnlGcm9tU2NoZW1hID0gYXN5bmMgc2NoZW1hID0+IHtcbiAgICBjb25zdCByZXF1aXJlZEZpZWxkcyA9IFsnaWQnLCAndGl0bGUnLCAnanNvblNjaGVtYSddXG5cbiAgICByZXF1aXJlZEZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgIGlmIChfLmlzTmlsKHNjaGVtYVtmaWVsZF0pKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgXCIke2ZpZWxkfVwiIGlzIHJlcXVpcmVkIGJ1dCBtaXNzaW5nIGluIHNjaGVtYWApXG4gICAgICB9XG4gICAgfSlcblxuICAgIHNjaGVtYS5pZCA9IHNjaGVtYS5pZC50b0xvd2VyQ2FzZSgpXG5cbiAgICBpZiAoY2F0ZWdvcnlCeUlkW3NjaGVtYS5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlcmUgaXMgYWxyZWFkeSBhIGZvcm0gd2l0aCBpZCBcIiR7c2NoZW1hLmlkfVwiYClcbiAgICB9XG5cbiAgICBpZiAoIXNjaGVtYS5qc29uU2NoZW1hLnRpdGxlKSB7XG4gICAgICBzY2hlbWEuanNvblNjaGVtYS50aXRsZSA9IHNjaGVtYS50aXRsZVxuICAgIH1cblxuICAgIGNhdGVnb3J5QnlJZFtzY2hlbWEuaWRdID0gc2NoZW1hXG4gICAgY2F0ZWdvcmllcy5wdXNoKHNjaGVtYSlcblxuICAgIGF3YWl0IGxvYWREYXRhKHNjaGVtYSlcblxuICAgIHJldHVybiBzY2hlbWFcbiAgfVxuXG4gIGNvbnN0IGxvYWRDYXRlZ29yaWVzRnJvbVBhdGggPSBhc3luYyBmaWxlID0+IHtcbiAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGgucmVzb2x2ZShjb250ZW50RGlyLCAnLi8nICsgZmlsZSlcblxuICAgIGxldCBzY2hlbWFzID0gbnVsbFxuXG4gICAgaWYgKC9cXC5qc29uJC9pLnRlc3QoZmlsZVBhdGgpKSB7XG4gICAgICAvLyBVc2luZyBKU09ONSBpbnN0ZWFkIG9mIHJlZ3VsYXIgSlNPTlxuICAgICAgc2NoZW1hcyA9IGpzb241LnBhcnNlKGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKSlcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQWxsb3dzIGZvciByZWdpc3RlcmluZyAuZm9ybS5qcyBmaWxlc1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICAgIHNjaGVtYXMgPSBldmFsKCdyZXF1aXJlJykoZmlsZVBhdGgpIC8vIER5bmFtaWMgbG9hZGluZyByZXF1aXJlIGV2YWwgZm9yIFdlYnBhY2tcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgaWYgKF8uaXNBcnJheShzY2hlbWFzKSkge1xuICAgICAgICBmb3IgKGNvbnN0IHNjaGVtYSBvZiBzY2hlbWFzKSB7XG4gICAgICAgICAgYXdhaXQgbG9hZENhdGVnb3J5RnJvbVNjaGVtYShzY2hlbWEpXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IGxvYWRDYXRlZ29yeUZyb21TY2hlbWEoc2NoZW1hcylcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBWRXJyb3IoZXJyLCBgRXJyb3IgcmVnaXN0ZXJpbmcgQ29udGVudCBFbGVtZW50IFwiJHtmaWxlfVwiYClcbiAgICB9XG4gIH1cblxuICBjb25zdCByZWFkRGF0YUZvckZpbGUgPSBhc3luYyBmaWxlTmFtZSA9PiB7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IGdob3N0TWFuYWdlci5yZWFkRmlsZShjb250ZW50RGF0YURpciwgZmlsZU5hbWUpXG4gICAgaWYgKCFqc29uKSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoanNvbilcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZmlsZU5hbWV9IGV4cGVjdGVkIHRvIGNvbnRhaW4gYXJyYXksIGNvbnRlbnRzIGlnbm9yZWRgKVxuICAgICAgfVxuICAgICAgbG9nZ2VyLmluZm8oYFJlYWQgJHtkYXRhLmxlbmd0aH0gaXRlbShzKSBmcm9tICR7ZmlsZU5hbWV9YClcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2dnZXIud2FybihgRXJyb3IgcmVhZGluZyBkYXRhIGZyb20gJHtmaWxlTmFtZX1gLCBlcnIpXG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cblxuICBjb25zdCBpbml0ID0gYXN5bmMgKCkgPT4ge1xuICAgIG1rZGlycC5zeW5jKGNvbnRlbnREYXRhRGlyKVxuICAgIGF3YWl0IGdob3N0TWFuYWdlci5hZGRSb290Rm9sZGVyKGNvbnRlbnREYXRhRGlyLCB7IGZpbGVzR2xvYjogJyoqLyouanNvbicgfSlcblxuICAgIC8vIERFUFJFQ0FURUQ6IEZpbGVzIGRvbid0IGhhdmUgdG8gY29udGFpbiAuZm9ybSBhbnltb3JlXG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYiA9PiBnbG9iKCcqKi8qLkAoZm9ybS5qc29ufGZvcm0uanN8anNvbnxqcyknLCB7IGN3ZDogY29udGVudERpciB9LCBjYikpXG5cbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGxvYWRDYXRlZ29yaWVzRnJvbVBhdGgoZmlsZSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBuZXcgVkVycm9yKGVyciwgYFtDb250ZW50IE1hbmFnZXJdIENvdWxkIG5vdCByZWdpc3RlciBDb250ZW50IEVsZW1lbnQgXCIke2ZpbGV9XCJgKVxuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHJlY29tcHV0ZUNhdGVnb3JpZXNNZXRhZGF0YSgpXG4gIH1cblxuICAvKipcbiAgICogQGNhbGxiYWNrIEVsZW1lbnRQcm92aWRlclxuICAgKiBAbWVtYmVyT2YhICBDb250ZW50TWFuYWdlclxuICAgKiBAcGFyYW0ge0tuZXhJbnN0YW5jZX0ga25leCBBbiBpbnN0YW5jZSBvZiBLbmV4XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBjYXRlZ29yeSBUaGUgbmFtZSBvZiB0aGUgY2F0ZWdvcnlcbiAgICogQHBhcmFtIHtTdHJpbmd9IGFyZ3MgQSBzdHJpbmcgd2l0aCB3aGF0ZXZlciB3YXMgcGFzc2VkIGluIHRoZSBwYXJhbnMgZS5nLiBcInJhbmRvbSgyNSlcIlxuICAgKiBAZXhhbXBsZVxuY29uc3QgcmFuZG9tUHJvdmlkZXIgPSAoa25leCwgY2F0ZWdvcnksIGFyZ3MpID0+IHtcbnJldHVybiBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgLndoZXJlKHsgY2F0ZWdvcnlJZDogY2F0ZWdvcnkgfSlcbiAgLm9yZGVyQnkoa25leC5yYXcoJ3JhbmRvbSgpJykpXG4gIC5saW1pdCgxKVxuICAuZ2V0KDApXG59XG4gICAqL1xuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhIG5ldyBpdGVtIHByb3ZpZGVyLCB3aGljaCBpcyB1c2VkIHdoZW4gcGFyc2luZyBxdWVyeSBmb3Ige0BsaW5rIENvbnRlbnRNYW5hZ2VyfmdldEl0ZW19XG4gICAqIEBwYXJhbSAge1N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgcHJvdmlkZXIsIGUuZy4gYHJhbmRvbWBcbiAgICogQHBhcmFtICB7Q29udGVudE1hbmFnZXIuRWxlbWVudFByb3ZpZGVyfSBmbiBBIGNvbnRlbnQgcHJvdmlkZXIgZnVuY3Rpb25cbiAgICogQG1lbWJlck9mIENvbnRlbnRNYW5hZ2VyXG4gICAqIEBwdWJsaWNcbiAgICogQGV4YW1wbGVcbi8vIHJldHVybnMgYSByYW5kb20gZWxlbWVudCBmcm9tIGEgZ2l2ZW4gY2F0ZWdvcnlcbmNvbnN0IHJhbmRvbVByb3ZpZGVyID0gKGtuZXgsIGNhdGVnb3J5LCBhcmdzKSA9PiB7XG4gIHJldHVybiBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgICAud2hlcmUoeyBjYXRlZ29yeUlkOiBjYXRlZ29yeSB9KVxuICAgIC5vcmRlckJ5KGtuZXgucmF3KCdyYW5kb20oKScpKVxuICAgIC5saW1pdCgxKVxuICAgIC5nZXQoMClcbn1cblxuYnAuY29udGVudE1hbmFnZXIucmVnaXN0ZXJHZXRJdGVtUHJvdmlkZXIoJ3JhbmRvbScsIHJhbmRvbVByb3ZpZGVyKVxuICAgKi9cbiAgY29uc3QgcmVnaXN0ZXJHZXRJdGVtUHJvdmlkZXIgPSAobmFtZSwgZm4pID0+IHtcbiAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgZ2V0SXRlbVByb3ZpZGVyc1tuYW1lXSA9IGZuXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGluaXQsXG4gICAgbGlzdEF2YWlsYWJsZUNhdGVnb3JpZXMsXG4gICAgZ2V0Q2F0ZWdvcnlTY2hlbWEsXG5cbiAgICBsb2FkQ2F0ZWdvcnlGcm9tU2NoZW1hLFxuICAgIHJlY29tcHV0ZUNhdGVnb3JpZXNNZXRhZGF0YSxcblxuICAgIGNyZWF0ZU9yVXBkYXRlQ2F0ZWdvcnlJdGVtLFxuICAgIGxpc3RDYXRlZ29yeUl0ZW1zLFxuICAgIGNhdGVnb3J5SXRlbXNDb3VudCxcbiAgICBkZWxldGVDYXRlZ29yeUl0ZW1zLFxuXG4gICAgZ2V0SXRlbSxcbiAgICBnZXRJdGVtcyxcbiAgICBnZXRJdGVtc0J5TWV0YWRhdGEsXG5cbiAgICByZWdpc3RlckdldEl0ZW1Qcm92aWRlclxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/content/service.js\n");

/***/ }),

/***/ "./src/database/ghost.js":
/*!*******************************!*\
  !*** ./src/database/ghost.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  var h = (0, _helpers2.default)(knex);\n  return h.createTableIfNotExists('ghost_content', function (table) {\n    table.increments('id');\n    table.string('folder');\n    table.string('file');\n    table.text('content');\n    table.timestamp('modified_on').defaultTo(knex.fn.now());\n  }).then(function () {\n    return h.createTableIfNotExists('ghost_revisions', function (table) {\n      table.increments('id');\n      table.integer('content_id').references('ghost_content.id');\n      table.string('revision');\n      table.timestamp('created_on').defaultTo(knex.fn.now());\n      table.string('created_by');\n    });\n  });\n}; /*\n     Tables storing ghost content and its revisions\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2UvZ2hvc3QuanM/ZmM3ZSJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiaCIsImtuZXgiLCJjcmVhdGVUYWJsZUlmTm90RXhpc3RzIiwidGFibGUiLCJpbmNyZW1lbnRzIiwic3RyaW5nIiwidGV4dCIsInRpbWVzdGFtcCIsImRlZmF1bHRUbyIsImZuIiwibm93IiwidGhlbiIsImludGVnZXIiLCJyZWZlcmVuY2VzIl0sIm1hcHBpbmdzIjoiOztBQUlBOzs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixnQkFBUTtBQUN2QixNQUFNQyxJQUFJLHVCQUFRQyxJQUFSLENBQVY7QUFDQSxTQUFPRCxFQUNKRSxzQkFESSxDQUNtQixlQURuQixFQUNvQyxpQkFBUztBQUNoREMsVUFBTUMsVUFBTixDQUFpQixJQUFqQjtBQUNBRCxVQUFNRSxNQUFOLENBQWEsUUFBYjtBQUNBRixVQUFNRSxNQUFOLENBQWEsTUFBYjtBQUNBRixVQUFNRyxJQUFOLENBQVcsU0FBWDtBQUNBSCxVQUFNSSxTQUFOLENBQWdCLGFBQWhCLEVBQStCQyxTQUEvQixDQUF5Q1AsS0FBS1EsRUFBTCxDQUFRQyxHQUFSLEVBQXpDO0FBQ0QsR0FQSSxFQVFKQyxJQVJJLENBUUM7QUFBQSxXQUNKWCxFQUFFRSxzQkFBRixDQUF5QixpQkFBekIsRUFBNEMsaUJBQVM7QUFDbkRDLFlBQU1DLFVBQU4sQ0FBaUIsSUFBakI7QUFDQUQsWUFBTVMsT0FBTixDQUFjLFlBQWQsRUFBNEJDLFVBQTVCLENBQXVDLGtCQUF2QztBQUNBVixZQUFNRSxNQUFOLENBQWEsVUFBYjtBQUNBRixZQUFNSSxTQUFOLENBQWdCLFlBQWhCLEVBQThCQyxTQUE5QixDQUF3Q1AsS0FBS1EsRUFBTCxDQUFRQyxHQUFSLEVBQXhDO0FBQ0FQLFlBQU1FLE1BQU4sQ0FBYSxZQUFiO0FBQ0QsS0FORCxDQURJO0FBQUEsR0FSRCxDQUFQO0FBaUJELENBbkJELEMsQ0FOQSIsImZpbGUiOiIuL3NyYy9kYXRhYmFzZS9naG9zdC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gIFRhYmxlcyBzdG9yaW5nIGdob3N0IGNvbnRlbnQgYW5kIGl0cyByZXZpc2lvbnNcbiovXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4vaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSBrbmV4ID0+IHtcbiAgY29uc3QgaCA9IGhlbHBlcnMoa25leClcbiAgcmV0dXJuIGhcbiAgICAuY3JlYXRlVGFibGVJZk5vdEV4aXN0cygnZ2hvc3RfY29udGVudCcsIHRhYmxlID0+IHtcbiAgICAgIHRhYmxlLmluY3JlbWVudHMoJ2lkJylcbiAgICAgIHRhYmxlLnN0cmluZygnZm9sZGVyJylcbiAgICAgIHRhYmxlLnN0cmluZygnZmlsZScpXG4gICAgICB0YWJsZS50ZXh0KCdjb250ZW50JylcbiAgICAgIHRhYmxlLnRpbWVzdGFtcCgnbW9kaWZpZWRfb24nKS5kZWZhdWx0VG8oa25leC5mbi5ub3coKSlcbiAgICB9KVxuICAgIC50aGVuKCgpID0+XG4gICAgICBoLmNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMoJ2dob3N0X3JldmlzaW9ucycsIHRhYmxlID0+IHtcbiAgICAgICAgdGFibGUuaW5jcmVtZW50cygnaWQnKVxuICAgICAgICB0YWJsZS5pbnRlZ2VyKCdjb250ZW50X2lkJykucmVmZXJlbmNlcygnZ2hvc3RfY29udGVudC5pZCcpXG4gICAgICAgIHRhYmxlLnN0cmluZygncmV2aXNpb24nKVxuICAgICAgICB0YWJsZS50aW1lc3RhbXAoJ2NyZWF0ZWRfb24nKS5kZWZhdWx0VG8oa25leC5mbi5ub3coKSlcbiAgICAgICAgdGFibGUuc3RyaW5nKCdjcmVhdGVkX2J5JylcbiAgICAgIH0pXG4gICAgKVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/database/ghost.js\n");

/***/ }),

/***/ "./src/database/helpers.js":
/*!*********************************!*\
  !*** ./src/database/helpers.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _moment = __webpack_require__(/*! moment */ \"moment\");\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _isLite = function _isLite(knex) {\n  return knex.client.config.client === 'sqlite3';\n}; /**\n    * Helpers for the [Botpress Database]{@link Database} running on [Knex]{@link http://knexjs.org/}\n    * @public\n    * @module DatabaseHelpers\n    * @example\n    * import { DatabaseHelpers } from 'botpress'\n    * // or\n    * const { DatabaseHelpers } from 'botpress'\n    *\n    * const helpers = DatabaseHelpers(await bp.db.get())\n    */\n\n/*\n  The goal of these helpers is to generate SQL queries\n  that are valid for both SQLite and Postgres\n*/\n\nmodule.exports = function (knex) {\n  var dateParse = function dateParse(exp) {\n    return _isLite(knex) ? knex.raw('strftime(\\'%Y-%m-%dT%H:%M:%fZ\\', ' + exp + ')') : knex.raw(exp);\n  };\n\n  var dateFormat = function dateFormat(date) {\n    var iso = (0, _moment2.default)(date).toDate().toISOString();\n    return dateParse('\\'' + iso + '\\'');\n  };\n\n  var columnOrDateFormat = function columnOrDateFormat(colOrDate) {\n    var lite = _isLite(knex);\n\n    if (colOrDate.sql) {\n      return colOrDate.sql;\n    }\n\n    if (typeof colOrDate === 'string') {\n      return lite ? dateParse(colOrDate) : '\"' + colOrDate + '\"';\n    }\n\n    return dateFormat(colOrDate);\n  };\n\n  return {\n    /**\n     * Returns whether or not the current database is SQLite\n     * @return {Boolean} Returns true if the database is SQLite, false if Postgres\n     */\n    isLite: function isLite() {\n      return _isLite(knex);\n    },\n\n    /**\n     * **This is a workaround utility function**\n     * knex's createTableIfNotExists doesn't work with postgres\n     * https://github.com/tgriesser/knex/issues/1303\n     * @param  {String}   tableName Name of the table to create\n     * @param  {Function} Callback function. Identical to Knex's callback.\n     */\n    createTableIfNotExists: function createTableIfNotExists(tableName, cb) {\n      return knex.schema.hasTable(tableName).then(function (exists) {\n        if (exists) {\n          return;\n        }\n        return knex.schema.createTableIfNotExists(tableName, cb);\n      });\n    },\n\n    date: {\n      format: dateFormat,\n      now: function now() {\n        return _isLite(knex) ? knex.raw(\"strftime('%Y-%m-%dT%H:%M:%fZ', 'now')\") : knex.raw('now()');\n      },\n\n      isBefore: function isBefore(d1, d2) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n\n        return knex.raw(d1 + ' < ' + d2);\n      },\n\n      isAfter: function isAfter(d1, d2) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n\n        return knex.raw(d1 + ' > ' + d2);\n      },\n\n      isBetween: function isBetween(d1, d2, d3) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n        d3 = columnOrDateFormat(d3);\n\n        return knex.raw(d1 + ' BETWEEN ' + d2 + ' AND ' + d3);\n      },\n\n      isSameDay: function isSameDay(d1, d2) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n\n        return knex.raw('date(' + d1 + ') = date(' + d2 + ')');\n      },\n\n      hourOfDay: function hourOfDay(date) {\n        date = columnOrDateFormat(date);\n        return _isLite(knex) ? knex.raw('strftime(\\'%H\\', ' + date + ')') : knex.raw('to_char(' + date + ', \\'HH24\\')');\n      }\n    },\n\n    bool: {\n      true: function _true() {\n        return _isLite(knex) ? 1 : true;\n      },\n      false: function _false() {\n        return _isLite(knex) ? 0 : false;\n      },\n      parse: function parse(value) {\n        return _isLite(knex) ? !!value : value;\n      }\n    },\n\n    json: {\n      set: function set(obj) {\n        return _isLite(knex) ? obj && JSON.stringify(obj) : obj;\n      },\n      get: function get(obj) {\n        return _isLite(knex) ? obj && JSON.parse(obj) : obj;\n      }\n    }\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2UvaGVscGVycy5qcz81NmFlIl0sIm5hbWVzIjpbImlzTGl0ZSIsImtuZXgiLCJjbGllbnQiLCJjb25maWciLCJtb2R1bGUiLCJleHBvcnRzIiwiZGF0ZVBhcnNlIiwicmF3IiwiZXhwIiwiZGF0ZUZvcm1hdCIsImlzbyIsImRhdGUiLCJ0b0RhdGUiLCJ0b0lTT1N0cmluZyIsImNvbHVtbk9yRGF0ZUZvcm1hdCIsImxpdGUiLCJjb2xPckRhdGUiLCJzcWwiLCJjcmVhdGVUYWJsZUlmTm90RXhpc3RzIiwidGFibGVOYW1lIiwiY2IiLCJzY2hlbWEiLCJoYXNUYWJsZSIsInRoZW4iLCJleGlzdHMiLCJmb3JtYXQiLCJub3ciLCJpc0JlZm9yZSIsImQxIiwiZDIiLCJpc0FmdGVyIiwiaXNCZXR3ZWVuIiwiZDMiLCJpc1NhbWVEYXkiLCJob3VyT2ZEYXkiLCJib29sIiwidHJ1ZSIsImZhbHNlIiwicGFyc2UiLCJ2YWx1ZSIsImpzb24iLCJzZXQiLCJvYmoiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0Il0sIm1hcHBpbmdzIjoiOztBQWlCQTs7Ozs7O0FBRUEsSUFBTUEsVUFBUyxTQUFUQSxPQUFTLE9BQVE7QUFDckIsU0FBT0MsS0FBS0MsTUFBTCxDQUFZQyxNQUFaLENBQW1CRCxNQUFuQixLQUE4QixTQUFyQztBQUNELENBRkQsQyxDQW5CQTs7Ozs7Ozs7Ozs7O0FBWUE7Ozs7O0FBV0FFLE9BQU9DLE9BQVAsR0FBaUIsZ0JBQVE7QUFDdkIsTUFBTUMsWUFBWSxTQUFaQSxTQUFZLE1BQU87QUFDdkIsV0FBT04sUUFBT0MsSUFBUCxJQUFlQSxLQUFLTSxHQUFMLHVDQUEyQ0MsR0FBM0MsT0FBZixHQUFvRVAsS0FBS00sR0FBTCxDQUFTQyxHQUFULENBQTNFO0FBQ0QsR0FGRDs7QUFJQSxNQUFNQyxhQUFhLFNBQWJBLFVBQWEsT0FBUTtBQUN6QixRQUFNQyxNQUFNLHNCQUFPQyxJQUFQLEVBQ1RDLE1BRFMsR0FFVEMsV0FG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QVAsSUFBZSxDQUFmLEdBQW1CLEtBQTFCO0FBQUEsT0FGSDtBQUdKcUMsYUFBTztBQUFBLGVBQVV0QyxRQUFPQyxJQUFQLElBQWUsQ0FBQyxDQUFDc0MsS0FBakIsR0FBeUJBLEtBQW5DO0FBQUE7QUFISCxLQTlERDs7QUFvRUxDLFVBQU07QUFDSkMsV0FBSyxrQkFBTztBQUNWLGVBQU96QyxRQUFPQyxJQUFQLElBQWV5QyxPQUFPQyxLQUFLQyxTQUFMLENBQWVGLEdBQWYsQ0FBdEIsR0FBNENBLEdBQW5EO0FBQ0QsT0FIRztBQUlKRyxXQUFLLGtCQUFPO0FBQ1YsZUFBTzdDLFFBQU9DLElBQVAsSUFBZXlDLE9BQU9DLEtBQUtMLEtBQUwsQ0FBV0ksR0FBWCxDQUF0QixHQUF3Q0EsR0FBL0M7QUFDRDtBQU5HO0FBcEVELEdBQVA7QUE2RUQsQ0F2R0QiLCJmaWxlIjoiLi9zcmMvZGF0YWJhc2UvaGVscGVycy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSGVscGVycyBmb3IgdGhlIFtCb3RwcmVzcyBEYXRhYmFzZV17QGxpbmsgRGF0YWJhc2V9IHJ1bm5pbmcgb24gW0tuZXhde0BsaW5rIGh0dHA6Ly9rbmV4anMub3JnL31cbiAqIEBwdWJsaWNcbiAqIEBtb2R1bGUgRGF0YWJhc2VIZWxwZXJzXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRGF0YWJhc2VIZWxwZXJzIH0gZnJvbSAnYm90cHJlc3MnXG4gKiAvLyBvclxuICogY29uc3QgeyBEYXRhYmFzZUhlbHBlcnMgfSBmcm9tICdib3RwcmVzcydcbiAqXG4gKiBjb25zdCBoZWxwZXJzID0gRGF0YWJhc2VIZWxwZXJzKGF3YWl0IGJwLmRiLmdldCgpKVxuICovXG5cbi8qXG4gIFRoZSBnb2FsIG9mIHRoZXNlIGhlbHBlcnMgaXMgdG8gZ2VuZXJhdGUgU1FMIHF1ZXJpZXNcbiAgdGhhdCBhcmUgdmFsaWQgZm9yIGJvdGggU1FMaXRlIGFuZCBQb3N0Z3Jlc1xuKi9cblxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnXG5cbmNvbnN0IGlzTGl0ZSA9IGtuZXggPT4ge1xuICByZXR1cm4ga25leC5jbGllbnQuY29uZmlnLmNsaWVudCA9PT0gJ3NxbGl0ZTMnXG59XG5cbm1vZHVsZS5leHBvcnRzID0ga25leCA9PiB7XG4gIGNvbnN0IGRhdGVQYXJzZSA9IGV4cCA9PiB7XG4gICAgcmV0dXJuIGlzTGl0ZShrbmV4KSA/IGtuZXgucmF3KGBzdHJmdGltZSgnJVktJW0tJWRUJUg6JU06JWZaJywgJHtleHB9KWApIDoga25leC5yYXcoZXhwKVxuICB9XG5cbiAgY29uc3QgZGF0ZUZvcm1hdCA9IGRhdGUgPT4ge1xuICAgIGNvbnN0IGlzbyA9IG1vbWVudChkYXRlKVxuICAgICAgLnRvRGF0ZSgpXG4gICAgICAudG9JU09TdHJpbmcoKVxuICAgIHJldHVybiBkYXRlUGFyc2UoYCcke2lzb30nYClcbiAgfVxuXG4gIGNvbnN0IGNvbHVtbk9yRGF0ZUZvcm1hdCA9IGNvbE9yRGF0ZSA9PiB7XG4gICAgY29uc3QgbGl0ZSA9IGlzTGl0ZShrbmV4KVxuXG4gICAgaWYgKGNvbE9yRGF0ZS5zcWwpIHtcbiAgICAgIHJldHVybiBjb2xPckRhdGUuc3FsXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBjb2xPckRhdGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gbGl0ZSA/IGRhdGVQYXJzZShjb2xPckRhdGUpIDogYFwiJHtjb2xPckRhdGV9XCJgXG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGVGb3JtYXQoY29sT3JEYXRlKVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBjdXJyZW50IGRhdGFiYXNlIGlzIFNRTGl0ZVxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgZGF0YWJhc2UgaXMgU1FMaXRlLCBmYWxzZSBpZiBQb3N0Z3Jlc1xuICAgICAqL1xuICAgIGlzTGl0ZTogKCkgPT4gaXNMaXRlKGtuZXgpLFxuXG4gICAgLyoqXG4gICAgICogKipUaGlzIGlzIGEgd29ya2Fyb3VuZCB1dGlsaXR5IGZ1bmN0aW9uKipcbiAgICAgKiBrbmV4J3MgY3JlYXRlVGFibGVJZk5vdEV4aXN0cyBkb2Vzbid0IHdvcmsgd2l0aCBwb3N0Z3Jlc1xuICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS90Z3JpZXNzZXIva25leC9pc3N1ZXMvMTMwM1xuICAgICAqIEBwYXJhbSAge1N0cmluZ30gICB0YWJsZU5hbWUgTmFtZSBvZiB0aGUgdGFibGUgdG8gY3JlYXRlXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IENhbGxiYWNrIGZ1bmN0aW9uLiBJZGVudGljYWwgdG8gS25leCdzIGNhbGxiYWNrLlxuICAgICAqL1xuICAgIGNyZWF0ZVRhYmxlSWZOb3RFeGlzdHM6ICh0YWJsZU5hbWUsIGNiKSA9PiB7XG4gICAgICByZXR1cm4ga25leC5zY2hlbWEuaGFzVGFibGUodGFibGVOYW1lKS50aGVuKGV4aXN0cyA9PiB7XG4gICAgICAgIGlmIChleGlzdHMpIHtcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ga25leC5zY2hlbWEuY3JlYXRlVGFibGVJZk5vdEV4aXN0cyh0YWJsZU5hbWUsIGNiKVxuICAgICAgfSlcbiAgICB9LFxuXG4gICAgZGF0ZToge1xuICAgICAgZm9ybWF0OiBkYXRlRm9ybWF0LFxuICAgICAgbm93OiAoKSA9PiAoaXNMaXRlKGtuZXgpID8ga25leC5yYXcoXCJzdHJmdGltZSgnJVktJW0tJWRUJUg6JU06JWZaJywgJ25vdycpXCIpIDoga25leC5yYXcoJ25vdygpJykpLFxuXG4gICAgICBpc0JlZm9yZTogKGQxLCBkMikgPT4ge1xuICAgICAgICBkMSA9IGNvbHVtbk9yRGF0ZUZvcm1hdChkMSlcbiAgICAgICAgZDIgPSBjb2x1bW5PckRhdGVGb3JtYXQoZDIpXG5cbiAgICAgICAgcmV0dXJuIGtuZXgucmF3KGQxICsgJyA8ICcgKyBkMilcbiAgICAgIH0sXG5cbiAgICAgIGlzQWZ0ZXI6IChkMSwgZDIpID0+IHtcbiAgICAgICAgZDEgPSBjb2x1bW5PckRhdGVGb3JtYXQoZDEpXG4gICAgICAgIGQyID0gY29sdW1uT3JEYXRlRm9ybWF0KGQyKVxuXG4gICAgICAgIHJldHVybiBrbmV4LnJhdyhkMSArICcgPiAnICsgZDIpXG4gICAgICB9LFxuXG4gICAgICBpc0JldHdlZW46IChkMSwgZDIsIGQzKSA9PiB7XG4gICAgICAgIGQxID0gY29sdW1uT3JEYXRlRm9ybWF0KGQxKVxuICAgICAgICBkMiA9IGNvbHVtbk9yRGF0ZUZvcm1hdChkMilcbiAgICAgICAgZDMgPSBjb2x1bW5PckRhdGVGb3JtYXQoZDMpXG5cbiAgICAgICAgcmV0dXJuIGtuZXgucmF3KGAke2QxfSBCRVRXRUVOICR7ZDJ9IEFORCAke2QzfWApXG4gICAgICB9LFxuXG4gICAgICBpc1NhbWVEYXk6IChkMSwgZDIpID0+IHtcbiAgICAgICAgZDEgPSBjb2x1bW5PckRhdGVGb3JtYXQoZDEpXG4gICAgICAgIGQyID0gY29sdW1uT3JEYXRlRm9ybWF0KGQyKVxuXG4gICAgICAgIHJldHVybiBrbmV4LnJhdyhgZGF0ZSgke2QxfSkgPSBkYXRlKCR7ZDJ9KWApXG4gICAgICB9LFxuXG4gICAgICBob3VyT2ZEYXk6IGRhdGUgPT4ge1xuICAgICAgICBkYXRlID0gY29sdW1uT3JEYXRlRm9ybWF0KGRhdGUpXG4gICAgICAgIHJldHVybiBpc0xpdGUoa25leCkgPyBrbmV4LnJhdyhgc3RyZnRpbWUoJyVIJywgJHtkYXRlfSlgKSA6IGtuZXgucmF3KGB0b19jaGFyKCR7ZGF0ZX0sICdISDI0JylgKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBib29sOiB7XG4gICAgICB0cnVlOiAoKSA9PiAoaXNMaXRlKGtuZXgpID8gMSA6IHRydWUpLFxuICAgICAgZmFsc2U6ICgpID0+IChpc0xpdGUoa25leCkgPyAwIDogZmFsc2UpLFxuICAgICAgcGFyc2U6IHZhbHVlID0+IChpc0xpdGUoa25leCkgPyAhIXZhbHVlIDogdmFsdWUpXG4gICAgfSxcblxuICAgIGpzb246IHtcbiAgICAgIHNldDogb2JqID0+IHtcbiAgICAgICAgcmV0dXJuIGlzTGl0ZShrbmV4KSA/IG9iaiAmJiBKU09OLnN0cmluZ2lmeShvYmopIDogb2JqXG4gICAgICB9LFxuICAgICAgZ2V0OiBvYmogPT4ge1xuICAgICAgICByZXR1cm4gaXNMaXRlKGtuZXgpID8gb2JqICYmIEpTT04ucGFyc2Uob2JqKSA6IG9ialxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/database/helpers.js\n");

/***/ }),

/***/ "./src/database/index.js":
/*!*******************************!*\
  !*** ./src/database/index.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _moment = __webpack_require__(/*! moment */ \"moment\");\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _knex2 = __webpack_require__(/*! knex */ \"knex\");\n\nvar _knex3 = _interopRequireDefault(_knex2);\n\nvar _pick = __webpack_require__(/*! lodash/pick */ \"lodash/pick\");\n\nvar _pick2 = _interopRequireDefault(_pick);\n\nvar _tables = __webpack_require__(/*! ./tables */ \"./src/database/tables.js\");\n\nvar _tables2 = _interopRequireDefault(_tables);\n\nvar _kvs2 = __webpack_require__(/*! ./kvs */ \"./src/database/kvs.js\");\n\nvar _kvs3 = _interopRequireDefault(_kvs2);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * The db (database) namespace lets you control the database directly via [Knex]{@link http://knexjs.org/}\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @public\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @namespace Database\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * await knex = bp.db.get()\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */\n\nvar initializeCoreDatabase = function initializeCoreDatabase(knex, botpressPath) {\n  if (!knex) {\n    throw new Error('You must initialize the database before');\n  }\n\n  var directory = _path2.default.join(botpressPath, './migrations/');\n  return _bluebird2.default.mapSeries(_tables2.default, function (fn) {\n    return fn(knex);\n  }).then(function () {\n    return knex.migrate.latest({ directory: directory });\n  });\n};\n\nvar createKnex = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(_ref2) {\n    var sqlite = _ref2.sqlite,\n        postgres = _ref2.postgres,\n        botpressPath = _ref2.botpressPath;\n\n    var commonConfig, dbConfig, _knex;\n\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            commonConfig = {\n              useNullAsDefault: true\n            };\n            dbConfig = postgres.enabled ? {\n              client: 'pg',\n              connection: postgres.connection || (0, _pick2.default)(postgres, ['host', 'port', 'user', 'password', 'database', 'ssl'])\n            } : {\n              client: 'sqlite3',\n              connection: { filename: sqlite.location },\n              pool: {\n                afterCreate: function afterCreate(conn, cb) {\n                  conn.run('PRAGMA foreign_keys = ON', cb);\n                }\n              }\n            };\n            _knex = (0, _knex3.default)(Object.assign(commonConfig, dbConfig));\n            _context.next = 5;\n            return initializeCoreDatabase(_knex, botpressPath);\n\n          case 5:\n            return _context.abrupt('return', _knex);\n\n          case 6:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function createKnex(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nmodule.exports = function (_ref3) {\n  var sqlite = _ref3.sqlite,\n      postgres = _ref3.postgres,\n      logger = _ref3.logger,\n      botpressPath = _ref3.botpressPath;\n\n  var knex = null;\n\n  var getDb = function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (knex) {\n                _context2.next = 4;\n                break;\n              }\n\n              _context2.next = 3;\n              return createKnex({ sqlite: sqlite, postgres: postgres, botpressPath: botpressPath });\n\n            case 3:\n              knex = _context2.sent;\n\n            case 4:\n              return _context2.abrupt('return', knex);\n\n            case 5:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function getDb() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var saveUser = function saveUser(_ref5) {\n    var id = _ref5.id,\n        platform = _ref5.platform,\n        _ref5$gender = _ref5.gender,\n        gender = _ref5$gender === undefined ? 'unknown' : _ref5$gender,\n        _ref5$timezone = _ref5.timezone,\n        timezone = _ref5$timezone === undefined ? null : _ref5$timezone,\n        _ref5$locale = _ref5.locale,\n        locale = _ref5$locale === undefined ? null : _ref5$locale,\n        picture_url = _ref5.picture_url,\n        first_name = _ref5.first_name,\n        last_name = _ref5.last_name;\n\n    var userId = platform + ':' + id;\n    var userRow = {\n      id: userId,\n      userId: id,\n      platform: platform,\n      gender: gender,\n      timezone: timezone,\n      locale: locale,\n      created_on: (0, _moment2.default)(new Date()).toISOString(),\n      picture_url: picture_url,\n      last_name: last_name,\n      first_name: first_name\n    };\n\n    return getDb().then(function (knex) {\n      var query = knex('users').insert(userRow).where(function () {\n        return this.select(knex.raw(1)).from('users').where('id', '=', userId);\n      });\n\n      if (postgres.enabled) {\n        query = query + ' on conflict (id) do nothing';\n      } else {\n        // SQLite\n        query = query.toString().replace(/^insert/i, 'insert or ignore');\n      }\n\n      return knex.raw(query);\n    });\n  };\n\n  var kvsInstance = null;\n\n  var createKvs = function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n      var knex, _kvs;\n\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return getDb();\n\n            case 2:\n              knex = _context3.sent;\n              _kvs = new _kvs3.default(knex);\n              _context3.next = 6;\n              return _kvs.bootstrap();\n\n            case 6:\n              return _context3.abrupt('return', _kvs);\n\n            case 7:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function createKvs() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var getKvs = function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!kvsInstance) {\n                kvsInstance = createKvs();\n              }\n\n              return _context4.abrupt('return', kvsInstance);\n\n            case 2:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function getKvs() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var kvsGet = function kvsGet() {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return getKvs().then(function (instance) {\n      return instance.get.apply(instance, args);\n    });\n  };\n  var kvsSet = function kvsSet() {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return getKvs().then(function (instance) {\n      return instance.set.apply(instance, args);\n    });\n  };\n\n  var kvsWrapper = { get: kvsGet, set: kvsSet };\n\n  return {\n    /**\n     * Returns an initialized and connected instance of [Knex]{@link http://knexjs.org/}.\n     * Knex is a SQL Query Builder and database abstractor that Botpress (and every Botpress modules) use internally.\n     * [Knex Documentation]{@link http://knexjs.org/#Builder}\n     * @func\n     * @async\n     * @memberOf! Database\n     * @return {KnexQueryBuilder}\n     */\n    get: getDb,\n    saveUser: saveUser,\n    location: postgres.enabled ? 'postgres' : sqlite.location,\n    get kvs() {\n      logger && logger.warn('[Deprecation Notice] `bp.db.kvs` is deprecated and will be removed in Botpress 11. Please use `bp.kvs` directly instead.');\n      return kvsWrapper;\n    },\n    _kvs: kvsWrapper\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2UvaW5kZXguanM/M2U4YSJdLCJuYW1lcyI6WyJpbml0aWFsaXplQ29yZURhdGFiYXNlIiwia25leCIsImJvdHByZXNzUGF0aCIsIkVycm9yIiwiZGlyZWN0b3J5IiwicGF0aCIsImpvaW4iLCJQcm9taXNlIiwibWFwU2VyaWVzIiwidGFibGVzIiwiZm4iLCJ0aGVuIiwibWlncmF0ZSIsImxhdGVzdCIsImNyZWF0ZUtuZXgiLCJzcWxpdGUiLCJwb3N0Z3JlcyIsImNvbW1vbkNvbmZpZyIsInVzZU51bGxBc0RlZmF1bHQiLCJkYkNvbmZpZyIsImVuYWJsZWQiLCJjbGllbnQiLCJjb25uZWN0aW9uIiwiZmlsZW5hbWUiLCJsb2NhdGlvbiIsInBvb2wiLCJhZnRlckNyZWF0ZSIsImNvbm4iLCJjYiIsInJ1biIsIl9rbmV4IiwiT2JqZWN0IiwiYXNzaWduIiwibW9kdWxlIiwiZXhwb3J0cyIsImxvZ2dlciIsImdldERiIiwic2F2ZVVzZXIiLCJpZCIsInBsYXRmb3JtIiwiZ2VuZGVyIiwidGltZXpvbmUiLCJsb2NhbGUiLCJwaWN0dXJlX3VybCIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJ1c2VySWQiLCJ1c2VyUm93IiwiY3JlYXRlZF9vbiIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInF1ZXJ5IiwiaW5zZXJ0Iiwid2hlcmUiLCJzZWxlY3QiLCJyYXciLCJmcm9tIiwidG9TdHJpbmciLCJyZXBsYWNlIiwia3ZzSW5zdGFuY2UiLCJjcmVhdGVLdnMiLCJfa3ZzIiwia3ZzIiwiYm9vdHN0cmFwIiwiZ2V0S3ZzIiwia3ZzR2V0IiwiYXJncyIsImluc3RhbmNlIiwiZ2V0Iiwia3ZzU2V0Iiwic2V0Iiwia3ZzV3JhcHBlciIsIndhcm4iXSwibWFwcGluZ3MiOiI7O0FBUUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFFQTs7OztBQUNBOzs7O0FBQ0E7Ozs7OztpZUFmQTs7Ozs7Ozs7QUFpQkEsSUFBTUEseUJBQXlCLFNBQXpCQSxzQkFBeUIsQ0FBQ0MsSUFBRCxFQUFPQyxZQUFQLEVBQXdCO0FBQ3JELE1BQUksQ0FBQ0QsSUFBTCxFQUFXO0FBQ1QsVUFBTSxJQUFJRSxLQUFKLENBQVUseUNBQVYsQ0FBTjtBQUNEOztBQUVELE1BQU1DLFlBQVlDLGVBQUtDLElBQUwsQ0FBVUosWUFBVixFQUF3QixlQUF4QixDQUFsQjtBQUNBLFNBQU9LLG1CQUFRQyxTQUFSLENBQWtCQyxnQkFBbEIsRUFBMEI7QUFBQSxXQUFNQyxHQUFHVCxJQUFILENBQU47QUFBQSxHQUExQixFQUEwQ1UsSUFBMUMsQ0FBK0M7QUFBQSxXQUFNVixLQUFLVyxPQUFMLENBQWFDLE1BQWIsQ0FBb0IsRUFBRVQsb0JBQUYsRUFBcEIsQ0FBTjtBQUFBLEdBQS9DLENBQVA7QUFDRCxDQVBEOztBQVNBLElBQU1VO0FBQUEscUVBQWE7QUFBQSxRQUFTQyxNQUFULFNBQVNBLE1BQVQ7QUFBQSxRQUFpQkMsUUFBakIsU0FBaUJBLFFBQWpCO0FBQUEsUUFBMkJkLFlBQTNCLFNBQTJCQSxZQUEzQjs7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNYZSx3QkFEVyxHQUNJO0FBQ25CQyxnQ0FBa0I7QUFEQyxhQURKO0FBSVhDLG9CQUpXLEdBSUFILFNBQVNJLE9BQVQsR0FDYjtBQUNFQyxzQkFBUSxJQURWO0FBRUVDLDBCQUFZTixTQUFTTSxVQUFULElBQXVCLG9CQUFLTixRQUFMLEVBQWUsQ0FBQyxNQUFELEVBQVMsTUFBVCxFQUFpQixNQUFqQixFQUF5QixVQUF6QixFQUFxQyxVQUFyQyxFQUFpRCxLQUFqRCxDQUFmO0FBRnJDLGFBRGEsR0FLYjtBQUNFSyxzQkFBUSxTQURWO0FBRUVDLDBCQUFZLEVBQUVDLFVBQVVSLE9BQU9TLFFBQW5CLEVBRmQ7QUFHRUMsb0JBQU07QUFDSkMsNkJBQWEscUJBQUNDLElBQUQsRUFBT0MsRUFBUCxFQUFjO0FBQ3pCRCx1QkFBS0UsR0FBTCxDQUFTLDBCQUFULEVBQXFDRCxFQUFyQztBQUNEO0FBSEc7QUFIUixhQVRhO0FBbUJYRSxpQkFuQlcsR0FtQkgsb0JBQUtDLE9BQU9DLE1BQVAsQ0FBY2YsWUFBZCxFQUE0QkUsUUFBNUIsQ0FBTCxDQW5CRztBQUFBO0FBQUEsbUJBcUJYbkIsdUJBQXVCOEIsS0FBdkIsRUFBOEI1QixZQUE5QixDQXJCVzs7QUFBQTtBQUFBLDZDQXNCVjRCLEtBdEJVOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWI7O0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBTjs7QUF5QkFHLE9BQU9DLE9BQVAsR0FBaUIsaUJBQWdEO0FBQUEsTUFBN0NuQixNQUE2QyxTQUE3Q0EsTUFBNkM7QUFBQSxNQUFyQ0MsUUFBcUMsU0FBckNBLFFBQXFDO0FBQUEsTUFBM0JtQixNQUEyQixTQUEzQkEsTUFBMkI7QUFBQSxNQUFuQmpDLFlBQW1CLFNBQW5CQSxZQUFtQjs7QUFDL0QsTUFBSUQsT0FBTyxJQUFYOztBQUVBLE1BQU1tQztBQUFBLHdFQUFRO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxrQkFDUG5DLElBRE87QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQSxxQkFFR2EsV0FBVyxFQUFFQyxjQUFGLEVBQVVDLGtCQUFWLEVBQW9CZCwwQkFBcEIsRUFBWCxDQUZIOztBQUFBO0FBRVZELGtCQUZVOztBQUFBO0FBQUEsZ0RBS0xBLElBTEs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBUjs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQVFBLE1BQU1vQyxXQUFXLFNBQVhBLFFBQVcsUUFTWDtBQUFBLFFBUkpDLEVBUUksU0FSSkEsRUFRSTtBQUFBLFFBUEpDLFFBT0ksU0FQSkEsUUFPSTtBQUFBLDZCQU5KQyxNQU1JO0FBQUEsUUFOSkEsTUFNSSxnQ0FOSyxTQU1MO0FBQUEsK0JBTEpDLFFBS0k7QUFBQSxRQUxKQSxRQUtJLGtDQUxPLElBS1A7QUFBQSw2QkFKSkMsTUFJSTtBQUFBLFFBSkpBLE1BSUksZ0NBSkssSUFJTDtBQUFBLFFBSEpDLFdBR0ksU0FISkEsV0FHSTtBQUFBLFFBRkpDLFVBRUksU0FGSkEsVUFFSTtBQUFBLFFBREpDLFNBQ0ksU0FESkEsU0FDSTs7QUFDSixRQUFNQyxTQUFTUCxXQUFXLEdBQVgsR0FBaUJELEVBQWhDO0FBQ0EsUUFBTVMsVUFBVTtBQUNkVCxVQUFJUSxNQURVO0FBRWRBLGNBQVFSLEVBRk07QUFHZEMsd0JBSGM7QUFJZEMsb0JBSmM7QUFLZEMsd0JBTGM7QUFNZEMsb0JBTmM7QUFPZE0sa0JBQVksc0JBQU8sSUFBSUMsSUFBSixFQUFQLEVBQW1CQyxXQUFuQixFQVBFO0FBUWRQLG1CQUFhQSxXQVJDO0FBU2RFLGlCQUFXQSxTQVRHO0FBVWRELGtCQUFZQTtBQVZFLEtBQWhCOztBQWFBLFdBQU9SLFFBQVF6QixJQUFSLENBQWEsZ0JBQVE7QUFDMUIsVUFBSXdDLFFBQVFsRCxLQUFLLE9BQUwsRUFDVG1ELE1BRFMsQ0FDRkwsT0FERSxFQUVUTSxLQUZTLENBRUgsWUFBVztBQUNoQixlQUFPLEtBQUtDLE1BQUwsQ0FBWXJELEtBQUtzRCxHQUFMLENBQVMsQ0FBVCxDQUFaLEVBQ0pDLElBREksQ0FDQyxPQURELEVBRUpILEtBRkksQ0FFRSxJQUZGLEVBRVEsR0FGUixFQUVhUCxNQUZiLENBQVA7QUFHRCxPQU5TLENBQVo7O0FBUUEsVUFBSTlCLFNBQVNJLE9BQWIsRUFBc0I7QUFDcEIrQixnQkFBV0EsS0FBWDtBQUNELE9BRkQsTUFFTztBQUNMO0FBQ0FBLGdCQUFRQSxNQUFNTSxRQUFOLEdBQWlCQyxPQUFqQixDQUF5QixVQUF6QixFQUFxQyxrQkFBckMsQ0FBUjtBQUNEOztBQUVELGFBQU96RCxLQUFLc0QsR0FBTCxDQUFTSixLQUFULENBQVA7QUFDRCxLQWpCTSxDQUFQO0FBa0JELEdBMUNEOztBQTRDQSxNQUFJUSxjQUFjLElBQWxCOztBQUVBLE1BQU1DO0FBQUEsd0VBQVk7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQ0d4QixPQURIOztBQUFBO0FBQ1ZuQyxrQkFEVTtBQUVWNEQsa0JBRlUsR0FFSCxJQUFJQyxhQUFKLENBQVE3RCxJQUFSLENBRkc7QUFBQTtBQUFBLHFCQUdWNEQsS0FBS0UsU0FBTCxFQUhVOztBQUFBO0FBQUEsZ0RBSVRGLElBSlM7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBWjs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQU9BLE1BQU1HO0FBQUEsd0VBQVM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNiLGtCQUFJLENBQUNMLFdBQUwsRUFBa0I7QUFDaEJBLDhCQUFjQyxXQUFkO0FBQ0Q7O0FBSFksZ0RBS05ELFdBTE07O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBVDs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQVFBLE1BQU1NLFNBQVMsU0FBVEEsTUFBUztBQUFBLHNDQUFJQyxJQUFKO0FBQUlBLFVBQUo7QUFBQTs7QUFBQSxXQUFhRixTQUFTckQsSUFBVCxDQUFjO0FBQUEsYUFBWXdELFNBQVNDLEdBQVQsaUJBQWdCRixJQUFoQixDQUFaO0FBQUEsS0FBZCxDQUFiO0FBQUEsR0FBZjtBQUNBLE1BQU1HLFNBQVMsU0FBVEEsTUFBUztBQUFBLHVDQUFJSCxJQUFKO0FBQUlBLFVBQUo7QUFBQTs7QUFBQSxXQUFhRixTQUFTckQsSUFBVCxDQUFjO0FBQUEsYUFBWXdELFNBQVNHLEdBQVQsaUJBQWdCSixJQUFoQixDQUFaO0FBQUEsS0FBZCxDQUFiO0FBQUEsR0FBZjs7QUFFQSxNQUFNSyxhQUFhLEVBQUVILEtBQUtILE1BQVAsRUFBZUssS0FBS0QsTUFBcEIsRUFBbkI7O0FBRUEsU0FBTztBQUNMOzs7Ozs7Ozs7QUFTQUQsU0FBS2hDLEtBVkE7QUFXTEMsc0JBWEs7QUFZTGIsY0FBVVIsU0FBU0ksT0FBVCxHQUFtQixVQUFuQixHQUFnQ0wsT0FBT1MsUUFaNUM7QUFhTCxRQUFJc0MsR0FBSixHQUFVO0FBQ1IzQixnQkFDRUEsT0FBT3FDLElBQVAsQ0FDRSwwSEFERixDQURGO0FBSUEsYUFBT0QsVUFBUDtBQUNELEtBbkJJO0FBb0JMVixVQUFNVTtBQXBCRCxHQUFQO0FBc0JELENBbkdEIiwiZmlsZSI6Ii4vc3JjL2RhdGFiYXNlL2luZGV4LmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgZGIgKGRhdGFiYXNlKSBuYW1lc3BhY2UgbGV0cyB5b3UgY29udHJvbCB0aGUgZGF0YWJhc2UgZGlyZWN0bHkgdmlhIFtLbmV4XXtAbGluayBodHRwOi8va25leGpzLm9yZy99XG4gKiBAcHVibGljXG4gKiBAbmFtZXNwYWNlIERhdGFiYXNlXG4gKiBAZXhhbXBsZVxuICogYXdhaXQga25leCA9IGJwLmRiLmdldCgpXG4gKi9cblxuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCdcbmltcG9ydCBrbmV4IGZyb20gJ2tuZXgnXG5pbXBvcnQgcGljayBmcm9tICdsb2Rhc2gvcGljaydcblxuaW1wb3J0IHRhYmxlcyBmcm9tICcuL3RhYmxlcydcbmltcG9ydCBrdnMgZnJvbSAnLi9rdnMnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5jb25zdCBpbml0aWFsaXplQ29yZURhdGFiYXNlID0gKGtuZXgsIGJvdHByZXNzUGF0aCkgPT4ge1xuICBpZiAoIWtuZXgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGluaXRpYWxpemUgdGhlIGRhdGFiYXNlIGJlZm9yZScpXG4gIH1cblxuICBjb25zdCBkaXJlY3RvcnkgPSBwYXRoLmpvaW4oYm90cHJlc3NQYXRoLCAnLi9taWdyYXRpb25zLycpXG4gIHJldHVybiBQcm9taXNlLm1hcFNlcmllcyh0YWJsZXMsIGZuID0+IGZuKGtuZXgpKS50aGVuKCgpID0+IGtuZXgubWlncmF0ZS5sYXRlc3QoeyBkaXJlY3RvcnkgfSkpXG59XG5cbmNvbnN0IGNyZWF0ZUtuZXggPSBhc3luYyAoeyBzcWxpdGUsIHBvc3RncmVzLCBib3RwcmVzc1BhdGggfSkgPT4ge1xuICBjb25zdCBjb21tb25Db25maWcgPSB7XG4gICAgdXNlTnVsbEFzRGVmYXVsdDogdHJ1ZVxuICB9XG4gIGNvbnN0IGRiQ29uZmlnID0gcG9zdGdyZXMuZW5hYmxlZFxuICAgID8ge1xuICAgICAgICBjbGllbnQ6ICdwZycsXG4gICAgICAgIGNvbm5lY3Rpb246IHBvc3RncmVzLmNvbm5lY3Rpb24gfHwgcGljayhwb3N0Z3JlcywgWydob3N0JywgJ3BvcnQnLCAndXNlcicsICdwYXNzd29yZCcsICdkYXRhYmFzZScsICdzc2wnXSlcbiAgICAgIH1cbiAgICA6IHtcbiAgICAgICAgY2xpZW50OiAnc3FsaXRlMycsXG4gICAgICAgIGNvbm5lY3Rpb246IHsgZmlsZW5hbWU6IHNxbGl0ZS5sb2NhdGlvbiB9LFxuICAgICAgICBwb29sOiB7XG4gICAgICAgICAgYWZ0ZXJDcmVhdGU6IChjb25uLCBjYikgPT4ge1xuICAgICAgICAgICAgY29ubi5ydW4oJ1BSQUdNQSBmb3JlaWduX2tleXMgPSBPTicsIGNiKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gIGNvbnN0IF9rbmV4ID0ga25leChPYmplY3QuYXNzaWduKGNvbW1vbkNvbmZpZywgZGJDb25maWcpKVxuXG4gIGF3YWl0IGluaXRpYWxpemVDb3JlRGF0YWJhc2UoX2tuZXgsIGJvdHByZXNzUGF0aClcbiAgcmV0dXJuIF9rbmV4XG59XG5cbm1vZHVsZS5leHBvcnRzID0gKHsgc3FsaXRlLCBwb3N0Z3JlcywgbG9nZ2VyLCBib3RwcmVzc1BhdGggfSkgPT4ge1xuICBsZXQga25leCA9IG51bGxcblxuICBjb25zdCBnZXREYiA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWtuZXgpIHtcbiAgICAgIGtuZXggPSBhd2FpdCBjcmVhdGVLbmV4KHsgc3FsaXRlLCBwb3N0Z3JlcywgYm90cHJlc3NQYXRoIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGtuZXhcbiAgfVxuXG4gIGNvbnN0IHNhdmVVc2VyID0gKHtcbiAgICBpZCxcbiAgICBwbGF0Zm9ybSxcbiAgICBnZW5kZXIgPSAndW5rbm93bicsXG4gICAgdGltZXpvbmUgPSBudWxsLFxuICAgIGxvY2FsZSA9IG51bGwsXG4gICAgcGljdHVyZV91cmwsXG4gICAgZmlyc3RfbmFtZSxcbiAgICBsYXN0X25hbWVcbiAgfSkgPT4ge1xuICAgIGNvbnN0IHVzZXJJZCA9IHBsYXRmb3JtICsgJzonICsgaWRcbiAgICBjb25zdCB1c2VyUm93ID0ge1xuICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgIHVzZXJJZDogaWQsXG4gICAgICBwbGF0Zm9ybSxcbiAgICAgIGdlbmRlcixcbiAgICAgIHRpbWV6b25lLFxuICAgICAgbG9jYWxlLFxuICAgICAgY3JlYXRlZF9vbjogbW9tZW50KG5ldyBEYXRlKCkpLnRvSVNPU3RyaW5nKCksXG4gICAgICBwaWN0dXJlX3VybDogcGljdHVyZV91cmwsXG4gICAgICBsYXN0X25hbWU6IGxhc3RfbmFtZSxcbiAgICAgIGZpcnN0X25hbWU6IGZpcnN0X25hbWVcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0RGIoKS50aGVuKGtuZXggPT4ge1xuICAgICAgbGV0IHF1ZXJ5ID0ga25leCgndXNlcnMnKVxuICAgICAgICAuaW5zZXJ0KHVzZXJSb3cpXG4gICAgICAgIC53aGVyZShmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Qoa25leC5yYXcoMSkpXG4gICAgICAgICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgICAgICAgLndoZXJlKCdpZCcsICc9JywgdXNlcklkKVxuICAgICAgICB9KVxuXG4gICAgICBpZiAocG9zdGdyZXMuZW5hYmxlZCkge1xuICAgICAgICBxdWVyeSA9IGAke3F1ZXJ5fSBvbiBjb25mbGljdCAoaWQpIGRvIG5vdGhpbmdgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBTUUxpdGVcbiAgICAgICAgcXVlcnkgPSBxdWVyeS50b1N0cmluZygpLnJlcGxhY2UoL15pbnNlcnQvaSwgJ2luc2VydCBvciBpZ25vcmUnKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ga25leC5yYXcocXVlcnkpXG4gICAgfSlcbiAgfVxuXG4gIGxldCBrdnNJbnN0YW5jZSA9IG51bGxcblxuICBjb25zdCBjcmVhdGVLdnMgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGdldERiKClcbiAgICBjb25zdCBfa3ZzID0gbmV3IGt2cyhrbmV4KVxuICAgIGF3YWl0IF9rdnMuYm9vdHN0cmFwKClcbiAgICByZXR1cm4gX2t2c1xuICB9XG5cbiAgY29uc3QgZ2V0S3ZzID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICgha3ZzSW5zdGFuY2UpIHtcbiAgICAgIGt2c0luc3RhbmNlID0gY3JlYXRlS3ZzKClcbiAgICB9XG5cbiAgICByZXR1cm4ga3ZzSW5zdGFuY2VcbiAgfVxuXG4gIGNvbnN0IGt2c0dldCA9ICguLi5hcmdzKSA9PiBnZXRLdnMoKS50aGVuKGluc3RhbmNlID0+IGluc3RhbmNlLmdldCguLi5hcmdzKSlcbiAgY29uc3Qga3ZzU2V0ID0gKC4uLmFyZ3MpID0+IGdldEt2cygpLnRoZW4oaW5zdGFuY2UgPT4gaW5zdGFuY2Uuc2V0KC4uLmFyZ3MpKVxuXG4gIGNvbnN0IGt2c1dyYXBwZXIgPSB7IGdldDoga3ZzR2V0LCBzZXQ6IGt2c1NldCB9XG5cbiAgcmV0dXJuIHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGluaXRpYWxpemVkIGFuZCBjb25uZWN0ZWQgaW5zdGFuY2Ugb2YgW0tuZXhde0BsaW5rIGh0dHA6Ly9rbmV4anMub3JnL30uXG4gICAgICogS25leCBpcyBhIFNRTCBRdWVyeSBCdWlsZGVyIGFuZCBkYXRhYmFzZSBhYnN0cmFjdG9yIHRoYXQgQm90cHJlc3MgKGFuZCBldmVyeSBCb3RwcmVzcyBtb2R1bGVzKSB1c2UgaW50ZXJuYWxseS5cbiAgICAgKiBbS25leCBEb2N1bWVudGF0aW9uXXtAbGluayBodHRwOi8va25leGpzLm9yZy8jQnVpbGRlcn1cbiAgICAgKiBAZnVuY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBtZW1iZXJPZiEgRGF0YWJhc2VcbiAgICAgKiBAcmV0dXJuIHtLbmV4UXVlcnlCdWlsZGVyfVxuICAgICAqL1xuICAgIGdldDogZ2V0RGIsXG4gICAgc2F2ZVVzZXIsXG4gICAgbG9jYXRpb246IHBvc3RncmVzLmVuYWJsZWQgPyAncG9zdGdyZXMnIDogc3FsaXRlLmxvY2F0aW9uLFxuICAgIGdldCBrdnMoKSB7XG4gICAgICBsb2dnZXIgJiZcbiAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgJ1tEZXByZWNhdGlvbiBOb3RpY2VdIGBicC5kYi5rdnNgIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBCb3RwcmVzcyAxMS4gUGxlYXNlIHVzZSBgYnAua3ZzYCBkaXJlY3RseSBpbnN0ZWFkLidcbiAgICAgICAgKVxuICAgICAgcmV0dXJuIGt2c1dyYXBwZXJcbiAgICB9LFxuICAgIF9rdnM6IGt2c1dyYXBwZXJcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/database/index.js\n");

/***/ }),

/***/ "./src/database/kvs.js":
/*!*****************************!*\
  !*** ./src/database/kvs.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n  Possible options:\n    - betweenGetAndSetCallback: will be called between the get and the set\n    and wait for promise to resolve\n    - tableName: overrides the KVS table's name\n*/\nmodule.exports = function (knex) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var getSetCallback = options.betweenGetAndSetCallback || function () {\n    return _bluebird2.default.resolve();\n  };\n  var tableName = options.tableName || 'kvs';\n\n  var upsert = function upsert(key, value) {\n    var sql = void 0;\n\n    var params = {\n      tableName: tableName,\n      keyCol: 'key',\n      valueCol: 'value',\n      modifiedOnCol: 'modified_on',\n      key: key,\n      value: JSON.stringify(value),\n      now: (0, _helpers2.default)(knex).date.now()\n    };\n\n    if ((0, _helpers2.default)(knex).isLite()) {\n      sql = '\\n        INSERT OR REPLACE INTO :tableName: (:keyCol:, :valueCol:, :modifiedOnCol:)\\n        VALUES (:key, :value, :now)\\n      ';\n    } else {\n      sql = '\\n        INSERT INTO :tableName: (:keyCol:, :valueCol:, :modifiedOnCol:)\\n        VALUES (:key, :value, :now)\\n        ON CONFLICT (:keyCol:) DO UPDATE\\n          SET :valueCol: = :value, :modifiedOnCol: = :now\\n      ';\n    }\n\n    return knex.raw(sql, params);\n  };\n\n  /**\n   * Returns the unserialized value stored at a given key\n   * @param  {String} key  The unique key where you want to get the value at\n   * @param  {String=} [path] If specified, returns the value at the path inside the retrieved object (if stored object was an object).\n   * @return {?*} Returns the unserialized object of any type stored at that key or null if it doesn't exist\n   * @example\n   * // Assuming 'user001' is an Object like `{ profile: { first_name: \"Sylvain\" } }`\n   * const first_name = await bp.kvs.get('user001', 'profile.first_name')\n   * const fullUser = await bp.kvs.get('user001')\n   *\n   * // You can also retrieve array elements\n   * const first_subscriber = await bp.kvs.get('subscribers', '[0].name')\n   * @memberOf! KVS\n   * @async\n   */\n  var get = function get(key, path) {\n    return knex(tableName).where({ key: key }).limit(1).then().get(0).then(function (row) {\n      if (!row) {\n        return null;\n      }\n\n      var obj = JSON.parse(row.value);\n      if (!path) {\n        return obj;\n      }\n\n      return _lodash2.default.at(obj, [path])[0];\n    });\n  };\n\n  /**\n   * Serializes and stores any value at the specified key, and optionally set a value inside an existing object at `path`.\n   * @param  {String} key   The unique key of the value you want to store\n   * @param  {*} value The value to store. Note that if you provide an object or array, it will be serialized to JSON automatically.\n   * Therefore, you have to make sure that your object is serializable (i.e. it has no circular references)\n   * @param  {String=} [path]  The path inside the object to set the value (see example)\n   * @example\n   * const user = { profile: { name: 'Sylvain' } }\n   * await bp.kvs.set('user001', user)\n   *\n   * // You can later overwrite the `name` property directly\n   * await bp.kvs.set('user001', 'Sylvain Perron', 'name')\n   * @async\n   * @memberof! KVS\n   */\n  var set = function set(key, value, path) {\n    if (!path) {\n      return upsert(key, value);\n    }\n\n    var setValue = function setValue(obj) {\n      if (path) {\n        _lodash2.default.set(obj, path, value);\n        return obj;\n      } else {\n        return value;\n      }\n    };\n\n    return get(key).then(function (original) {\n      return getSetCallback().then(function () {\n        if (!_lodash2.default.isNil(original)) {\n          return upsert(key, setValue(Object.assign({}, original)));\n        } else {\n          return upsert(key, setValue({}));\n        }\n      });\n    });\n  };\n\n  var bootstrap = function bootstrap() {\n    return (0, _helpers2.default)(knex).createTableIfNotExists(tableName, function (table) {\n      table.string('key').primary();\n      table.text('value');\n      table.timestamp('modified_on');\n    });\n  };\n\n  return { get: get, set: set, bootstrap: bootstrap };\n}; /**\n    * The KVS (Key-Value Store) serves as a convenient, high-level data storing mechanism.\n    * The KVS is an abstraction layer on top of the configured [Botpress Database]{@link Database}\n    * @public\n    * @namespace KVS\n    * @example\n    * bp.kvs\n    * bp.db.kvs // ⚠️ Deprecated, will be removed in Botpress 11\n    *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2Uva3ZzLmpzP2RlZDIiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImtuZXgiLCJvcHRpb25zIiwiZ2V0U2V0Q2FsbGJhY2siLCJiZXR3ZWVuR2V0QW5kU2V0Q2FsbGJhY2siLCJQcm9taXNlIiwicmVzb2x2ZSIsInRhYmxlTmFtZSIsInVwc2VydCIsImtleSIsInZhbHVlIiwic3FsIiwicGFyYW1zIiwia2V5Q29sIiwidmFsdWVDb2wiLCJtb2RpZmllZE9uQ29sIiwiSlNPTiIsInN0cmluZ2lmeSIsIm5vdyIsImRhdGUiLCJpc0xpdGUiLCJyYXciLCJnZXQiLCJwYXRoIiwid2hlcmUiLCJsaW1pdCIsInRoZW4iLCJyb3ciLCJvYmoiLCJwYXJzZSIsIl8iLCJhdCIsInNldCIsInNldFZhbHVlIiwiaXNOaWwiLCJvcmlnaW5hbCIsIk9iamVjdCIsImFzc2lnbiIsImJvb3RzdHJhcCIsImNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMiLCJ0YWJsZSIsInN0cmluZyIsInByaW1hcnkiLCJ0ZXh0IiwidGltZXN0YW1wIl0sIm1hcHBpbmdzIjoiOztBQVVBOzs7O0FBQ0E7Ozs7QUFFQTs7Ozs7O0FBRUE7Ozs7OztBQU1BQSxPQUFPQyxPQUFQLEdBQWlCLFVBQUNDLElBQUQsRUFBd0I7QUFBQSxNQUFqQkMsT0FBaUIsdUVBQVAsRUFBTzs7QUFDdkMsTUFBTUMsaUJBQWlCRCxRQUFRRSx3QkFBUixJQUFxQztBQUFBLFdBQU1DLG1CQUFRQyxPQUFSLEVBQU47QUFBQSxHQUE1RDtBQUNBLE1BQU1DLFlBQVlMLFFBQVFLLFNBQVIsSUFBcUIsS0FBdkM7O0FBRUEsTUFBTUMsU0FBUyxTQUFUQSxNQUFTLENBQUNDLEdBQUQsRUFBTUMsS0FBTixFQUFnQjtBQUM3QixRQUFJQyxZQUFKOztBQUVBLFFBQU1DLFNBQVM7QUFDYkwsMEJBRGE7QUFFYk0sY0FBUSxLQUZLO0FBR2JDLGdCQUFVLE9BSEc7QUFJYkMscUJBQWUsYUFKRjtBQUtiTixjQUxhO0FBTWJDLGFBQU9NLEtBQUtDLFNBQUwsQ0FBZVAsS0FBZixDQU5NO0FBT2JRLFdBQUssdUJBQVFqQixJQUFSLEVBQWNrQixJQUFkLENBQW1CRCxHQUFuQjtBQVBRLEtBQWY7O0FBVUEsUUFBSSx1QkFBUWpCLElBQVIsRUFBY21CLE1BQWQsRUFBSixFQUE0QjtBQUMxQlQ7QUFJRCxLQUxELE1BS087QUFDTEE7QUFNRDs7QUFFRCxXQUFPVixLQUFLb0IsR0FBTCxDQUFTVixHQUFULEVBQWNDLE1BQWQsQ0FBUDtBQUNELEdBNUJEOztBQThCQTs7Ozs7Ozs7Ozs7Ozs7O0FBZUEsTUFBTVUsTUFBTSxTQUFOQSxHQUFNLENBQUNiLEdBQUQsRUFBTWMsSUFBTixFQUFlO0FBQ3pCLFdBQU90QixLQUFLTSxTQUFMLEVBQ0ppQixLQURJLENBQ0UsRUFBRWYsUUFBRixFQURGLEVBRUpnQixLQUZJLENBRUUsQ0FGRixFQUdKQyxJQUhJLEdBSUpKLEdBSkksQ0FJQSxDQUpBLEVBS0pJLElBTEksQ0FLQyxlQUFPO0FBQ1gsVUFBSSxDQUFDQyxHQUFMLEVBQVU7QUFDUixlQUFPLElBQVA7QUFDRDs7QUFFRCxVQUFNQyxNQUFNWixLQUFLYSxLQUFMLENBQVdGLElBQUlqQixLQUFmLENBQVo7QUFDQSxVQUFJLENBQUNhLElBQUwsRUFBVztBQUNULGVBQU9LLEdBQVA7QUFDRDs7QUFFRCxhQUFPRSxpQkFBRUMsRUFBRixDQUFLSCxHQUFMLEVBQVUsQ0FBQ0wsSUFBRCxDQUFWLEVBQWtCLENBQWxCLENBQVA7QUFDRCxLQWhCSSxDQUFQO0FBaUJELEdBbEJEOztBQW9CQTs7Ozs7Ozs7Ozs7Ozs7O0FBZUEsTUFBTVMsTUFBTSxTQUFOQSxHQUFNLENBQUN2QixHQUFELEVBQU1DLEtBQU4sRUFBYWEsSUFBYixFQUFzQjtBQUNoQyxRQUFJLENBQUNBLElBQUwsRUFBVztBQUNULGFBQU9mLE9BQU9DLEdBQVAsRUFBWUMsS0FBWixDQUFQO0FBQ0Q7O0FBRUQsUUFBTXVCLFdBQVcsU0FBWEEsUUFBVyxNQUFPO0FBQ3RCLFVBQUlWLElBQUosRUFBVTtBQUNSTyx5QkFBRUUsR0FBRixDQUFNSixHQUFOLEVBQVdMLElBQVgsRUFBaUJiLEtBQWpCO0FBQ0EsZUFBT2tCLEdBQVA7QUFDRCxPQUhELE1BR087QUFDTCxlQUFPbEIsS0FBUDtBQUNEO0FBQ0YsS0FQRDs7QUFTQSxXQUFPWSxJQUFJYixHQUFKLEVBQVNpQixJQUFULENBQWMsb0JBQVk7QUFDL0IsYUFBT3ZCLGlCQUFpQnVCLElBQWpCLENBQXNCLFlBQU07QUFDakMsWUFBSSxDQUFDSSxpQkFBRUksS0FBRixDQUFRQyxRQUFSLENBQUwsRUFBd0I7QUFDdEIsaUJBQU8zQixPQUFPQyxHQUFQLEVBQVl3QixTQUFTRyxPQUFPQyxNQUFQLENBQWMsRUFBZCxFQUFrQkYsUUFBbEIsQ0FBVCxDQUFaLENBQVA7QUFDRCxTQUZELE1BRU87QUFDTCxpQkFBTzNCLE9BQU9DLEdBQVAsRUFBWXdCLFNBQVMsRUFBVCxDQUFaLENBQVA7QUFDRDtBQUNGLE9BTk0sQ0FBUDtBQU9ELEtBUk0sQ0FBUDtBQVNELEdBdkJEOztBQXlCQSxNQUFNSyxZQUFZLFNBQVpBLFNBQVk7QUFBQSxXQUNoQix1QkFBUXJDLElBQVIsRUFBY3NDLHNCQUFkLENBQXFDaEMsU0FBckMsRUFBZ0QsaUJBQVM7QUFDdkRpQyxZQUFNQyxNQUFOLENBQWEsS0FBYixFQUFvQkMsT0FBcEI7QUFDQUYsWUFBTUcsSUFBTixDQUFXLE9BQVg7QUFDQUgsWUFBTUksU0FBTixDQUFnQixhQUFoQjtBQUNELEtBSkQsQ0FEZ0I7QUFBQSxHQUFsQjs7QUFPQSxTQUFPLEVBQUV0QixRQUFGLEVBQU9VLFFBQVAsRUFBWU0sb0JBQVosRUFBUDtBQUNELENBckhELEMsQ0FyQkEiLCJmaWxlIjoiLi9zcmMvZGF0YWJhc2Uva3ZzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgS1ZTIChLZXktVmFsdWUgU3RvcmUpIHNlcnZlcyBhcyBhIGNvbnZlbmllbnQsIGhpZ2gtbGV2ZWwgZGF0YSBzdG9yaW5nIG1lY2hhbmlzbS5cbiAqIFRoZSBLVlMgaXMgYW4gYWJzdHJhY3Rpb24gbGF5ZXIgb24gdG9wIG9mIHRoZSBjb25maWd1cmVkIFtCb3RwcmVzcyBEYXRhYmFzZV17QGxpbmsgRGF0YWJhc2V9XG4gKiBAcHVibGljXG4gKiBAbmFtZXNwYWNlIEtWU1xuICogQGV4YW1wbGVcbiAqIGJwLmt2c1xuICogYnAuZGIua3ZzIC8vIOKaoO+4jyBEZXByZWNhdGVkLCB3aWxsIGJlIHJlbW92ZWQgaW4gQm90cHJlc3MgMTFcbiAqL1xuXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxuaW1wb3J0IGhlbHBlcnMgZnJvbSAnLi9oZWxwZXJzJ1xuXG4vKlxuICBQb3NzaWJsZSBvcHRpb25zOlxuICAgIC0gYmV0d2VlbkdldEFuZFNldENhbGxiYWNrOiB3aWxsIGJlIGNhbGxlZCBiZXR3ZWVuIHRoZSBnZXQgYW5kIHRoZSBzZXRcbiAgICBhbmQgd2FpdCBmb3IgcHJvbWlzZSB0byByZXNvbHZlXG4gICAgLSB0YWJsZU5hbWU6IG92ZXJyaWRlcyB0aGUgS1ZTIHRhYmxlJ3MgbmFtZVxuKi9cbm1vZHVsZS5leHBvcnRzID0gKGtuZXgsIG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCBnZXRTZXRDYWxsYmFjayA9IG9wdGlvbnMuYmV0d2VlbkdldEFuZFNldENhbGxiYWNrIHx8ICgoKSA9PiBQcm9taXNlLnJlc29sdmUoKSlcbiAgY29uc3QgdGFibGVOYW1lID0gb3B0aW9ucy50YWJsZU5hbWUgfHwgJ2t2cydcblxuICBjb25zdCB1cHNlcnQgPSAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgIGxldCBzcWxcblxuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgIHRhYmxlTmFtZSxcbiAgICAgIGtleUNvbDogJ2tleScsXG4gICAgICB2YWx1ZUNvbDogJ3ZhbHVlJyxcbiAgICAgIG1vZGlmaWVkT25Db2w6ICdtb2RpZmllZF9vbicsXG4gICAgICBrZXksXG4gICAgICB2YWx1ZTogSlNPTi5zdHJpbmdpZnkodmFsdWUpLFxuICAgICAgbm93OiBoZWxwZXJzKGtuZXgpLmRhdGUubm93KClcbiAgICB9XG5cbiAgICBpZiAoaGVscGVycyhrbmV4KS5pc0xpdGUoKSkge1xuICAgICAgc3FsID0gYFxuICAgICAgICBJTlNFUlQgT1IgUkVQTEFDRSBJTlRPIDp0YWJsZU5hbWU6ICg6a2V5Q29sOiwgOnZhbHVlQ29sOiwgOm1vZGlmaWVkT25Db2w6KVxuICAgICAgICBWQUxVRVMgKDprZXksIDp2YWx1ZSwgOm5vdylcbiAgICAgIGBcbiAgICB9IGVsc2Uge1xuICAgICAgc3FsID0gYFxuICAgICAgICBJTlNFUlQgSU5UTyA6dGFibGVOYW1lOiAoOmtleUNvbDosIDp2YWx1ZUNvbDosIDptb2RpZmllZE9uQ29sOilcbiAgICAgICAgVkFMVUVTICg6a2V5LCA6dmFsdWUsIDpub3cpXG4gICAgICAgIE9OIENPTkZMSUNUICg6a2V5Q29sOikgRE8gVVBEQVRFXG4gICAgICAgICAgU0VUIDp2YWx1ZUNvbDogPSA6dmFsdWUsIDptb2RpZmllZE9uQ29sOiA9IDpub3dcbiAgICAgIGBcbiAgICB9XG5cbiAgICByZXR1cm4ga25leC5yYXcoc3FsLCBwYXJhbXMpXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgdW5zZXJpYWxpemVkIHZhbHVlIHN0b3JlZCBhdCBhIGdpdmVuIGtleVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGtleSAgVGhlIHVuaXF1ZSBrZXkgd2hlcmUgeW91IHdhbnQgdG8gZ2V0IHRoZSB2YWx1ZSBhdFxuICAgKiBAcGFyYW0gIHtTdHJpbmc9fSBbcGF0aF0gSWYgc3BlY2lmaWVkLCByZXR1cm5zIHRoZSB2YWx1ZSBhdCB0aGUgcGF0aCBpbnNpZGUgdGhlIHJldHJpZXZlZCBvYmplY3QgKGlmIHN0b3JlZCBvYmplY3Qgd2FzIGFuIG9iamVjdCkuXG4gICAqIEByZXR1cm4gez8qfSBSZXR1cm5zIHRoZSB1bnNlcmlhbGl6ZWQgb2JqZWN0IG9mIGFueSB0eXBlIHN0b3JlZCBhdCB0aGF0IGtleSBvciBudWxsIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICogQGV4YW1wbGVcbiAgICogLy8gQXNzdW1pbmcgJ3VzZXIwMDEnIGlzIGFuIE9iamVjdCBsaWtlIGB7IHByb2ZpbGU6IHsgZmlyc3RfbmFtZTogXCJTeWx2YWluXCIgfSB9YFxuICAgKiBjb25zdCBmaXJzdF9uYW1lID0gYXdhaXQgYnAua3ZzLmdldCgndXNlcjAwMScsICdwcm9maWxlLmZpcnN0X25hbWUnKVxuICAgKiBjb25zdCBmdWxsVXNlciA9IGF3YWl0IGJwLmt2cy5nZXQoJ3VzZXIwMDEnKVxuICAgKlxuICAgKiAvLyBZb3UgY2FuIGFsc28gcmV0cmlldmUgYXJyYXkgZWxlbWVudHNcbiAgICogY29uc3QgZmlyc3Rfc3Vic2NyaWJlciA9IGF3YWl0IGJwLmt2cy5nZXQoJ3N1YnNjcmliZXJzJywgJ1swXS5uYW1lJylcbiAgICogQG1lbWJlck9mISBLVlNcbiAgICogQGFzeW5jXG4gICAqL1xuICBjb25zdCBnZXQgPSAoa2V5LCBwYXRoKSA9PiB7XG4gICAgcmV0dXJuIGtuZXgodGFibGVOYW1lKVxuICAgICAgLndoZXJlKHsga2V5IH0pXG4gICAgICAubGltaXQoMSlcbiAgICAgIC50aGVuKClcbiAgICAgIC5nZXQoMClcbiAgICAgIC50aGVuKHJvdyA9PiB7XG4gICAgICAgIGlmICghcm93KSB7XG4gICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9iaiA9IEpTT04ucGFyc2Uocm93LnZhbHVlKVxuICAgICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgICByZXR1cm4gb2JqXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gXy5hdChvYmosIFtwYXRoXSlbMF1cbiAgICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogU2VyaWFsaXplcyBhbmQgc3RvcmVzIGFueSB2YWx1ZSBhdCB0aGUgc3BlY2lmaWVkIGtleSwgYW5kIG9wdGlvbmFsbHkgc2V0IGEgdmFsdWUgaW5zaWRlIGFuIGV4aXN0aW5nIG9iamVjdCBhdCBgcGF0aGAuXG4gICAqIEBwYXJhbSAge1N0cmluZ30ga2V5ICAgVGhlIHVuaXF1ZSBrZXkgb2YgdGhlIHZhbHVlIHlvdSB3YW50IHRvIHN0b3JlXG4gICAqIEBwYXJhbSAgeyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzdG9yZS4gTm90ZSB0aGF0IGlmIHlvdSBwcm92aWRlIGFuIG9iamVjdCBvciBhcnJheSwgaXQgd2lsbCBiZSBzZXJpYWxpemVkIHRvIEpTT04gYXV0b21hdGljYWxseS5cbiAgICogVGhlcmVmb3JlLCB5b3UgaGF2ZSB0byBtYWtlIHN1cmUgdGhhdCB5b3VyIG9iamVjdCBpcyBzZXJpYWxpemFibGUgKGkuZS4gaXQgaGFzIG5vIGNpcmN1bGFyIHJlZmVyZW5jZXMpXG4gICAqIEBwYXJhbSAge1N0cmluZz19IFtwYXRoXSAgVGhlIHBhdGggaW5zaWRlIHRoZSBvYmplY3QgdG8gc2V0IHRoZSB2YWx1ZSAoc2VlIGV4YW1wbGUpXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IHVzZXIgPSB7IHByb2ZpbGU6IHsgbmFtZTogJ1N5bHZhaW4nIH0gfVxuICAgKiBhd2FpdCBicC5rdnMuc2V0KCd1c2VyMDAxJywgdXNlcilcbiAgICpcbiAgICogLy8gWW91IGNhbiBsYXRlciBvdmVyd3JpdGUgdGhlIGBuYW1lYCBwcm9wZXJ0eSBkaXJlY3RseVxuICAgKiBhd2FpdCBicC5rdnMuc2V0KCd1c2VyMDAxJywgJ1N5bHZhaW4gUGVycm9uJywgJ25hbWUnKVxuICAgKiBAYXN5bmNcbiAgICogQG1lbWJlcm9mISBLVlNcbiAgICovXG4gIGNvbnN0IHNldCA9IChrZXksIHZhbHVlLCBwYXRoKSA9PiB7XG4gICAgaWYgKCFwYXRoKSB7XG4gICAgICByZXR1cm4gdXBzZXJ0KGtleSwgdmFsdWUpXG4gICAgfVxuXG4gICAgY29uc3Qgc2V0VmFsdWUgPSBvYmogPT4ge1xuICAgICAgaWYgKHBhdGgpIHtcbiAgICAgICAgXy5zZXQob2JqLCBwYXRoLCB2YWx1ZSlcbiAgICAgICAgcmV0dXJuIG9ialxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldChrZXkpLnRoZW4ob3JpZ2luYWwgPT4ge1xuICAgICAgcmV0dXJuIGdldFNldENhbGxiYWNrKCkudGhlbigoKSA9PiB7XG4gICAgICAgIGlmICghXy5pc05pbChvcmlnaW5hbCkpIHtcbiAgICAgICAgICByZXR1cm4gdXBzZXJ0KGtleSwgc2V0VmFsdWUoT2JqZWN0LmFzc2lnbih7fSwgb3JpZ2luYWwpKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdXBzZXJ0KGtleSwgc2V0VmFsdWUoe30pKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBjb25zdCBib290c3RyYXAgPSAoKSA9PlxuICAgIGhlbHBlcnMoa25leCkuY3JlYXRlVGFibGVJZk5vdEV4aXN0cyh0YWJsZU5hbWUsIHRhYmxlID0+IHtcbiAgICAgIHRhYmxlLnN0cmluZygna2V5JykucHJpbWFyeSgpXG4gICAgICB0YWJsZS50ZXh0KCd2YWx1ZScpXG4gICAgICB0YWJsZS50aW1lc3RhbXAoJ21vZGlmaWVkX29uJylcbiAgICB9KVxuXG4gIHJldHVybiB7IGdldCwgc2V0LCBib290c3RyYXAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/database/kvs.js\n");

/***/ }),

/***/ "./src/database/notifications.js":
/*!***************************************!*\
  !*** ./src/database/notifications.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('notifications', function (table) {\n    table.string('id').unique();\n    table.string('message');\n    table.string('level');\n    table.string('module_id');\n    table.string('module_icon');\n    table.string('module_name');\n    table.string('redirect_url');\n\n    table.timestamp('created_on');\n\n    table.boolean('read');\n    table.boolean('archived');\n  });\n}; /*\n     A table storing all notifications\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2Uvbm90aWZpY2F0aW9ucy5qcz82OWQ2Il0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJrbmV4IiwiY3JlYXRlVGFibGVJZk5vdEV4aXN0cyIsInRhYmxlIiwic3RyaW5nIiwidW5pcXVlIiwidGltZXN0YW1wIiwiYm9vbGVhbiJdLCJtYXBwaW5ncyI6Ijs7QUFJQTs7Ozs7O0FBRUFBLE9BQU9DLE9BQVAsR0FBaUIsZ0JBQVE7QUFDdkIsU0FBTyx1QkFBUUMsSUFBUixFQUFjQyxzQkFBZCxDQUFxQyxlQUFyQyxFQUFzRCxpQkFBUztBQUNwRUMsVUFBTUMsTUFBTixDQUFhLElBQWIsRUFBbUJDLE1BQW5CO0FBQ0FGLFVBQU1DLE1BQU4sQ0FBYSxTQUFiO0FBQ0FELFVBQU1DLE1BQU4sQ0FBYSxPQUFiO0FBQ0FELFVBQU1DLE1BQU4sQ0FBYSxXQUFiO0FBQ0FELFVBQU1DLE1BQU4sQ0FBYSxhQUFiO0FBQ0FELFVBQU1DLE1BQU4sQ0FBYSxhQUFiO0FBQ0FELFVBQU1DLE1BQU4sQ0FBYSxjQUFiOztBQUVBRCxVQUFNRyxTQUFOLENBQWdCLFlBQWhCOztBQUVBSCxVQUFNSSxPQUFOLENBQWMsTUFBZDtBQUNBSixVQUFNSSxPQUFOLENBQWMsVUFBZDtBQUNELEdBYk0sQ0FBUDtBQWNELENBZkQsQyxDQU5BIiwiZmlsZSI6Ii4vc3JjL2RhdGFiYXNlL25vdGlmaWNhdGlvbnMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICBBIHRhYmxlIHN0b3JpbmcgYWxsIG5vdGlmaWNhdGlvbnNcbiovXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4vaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSBrbmV4ID0+IHtcbiAgcmV0dXJuIGhlbHBlcnMoa25leCkuY3JlYXRlVGFibGVJZk5vdEV4aXN0cygnbm90aWZpY2F0aW9ucycsIHRhYmxlID0+IHtcbiAgICB0YWJsZS5zdHJpbmcoJ2lkJykudW5pcXVlKClcbiAgICB0YWJsZS5zdHJpbmcoJ21lc3NhZ2UnKVxuICAgIHRhYmxlLnN0cmluZygnbGV2ZWwnKVxuICAgIHRhYmxlLnN0cmluZygnbW9kdWxlX2lkJylcbiAgICB0YWJsZS5zdHJpbmcoJ21vZHVsZV9pY29uJylcbiAgICB0YWJsZS5zdHJpbmcoJ21vZHVsZV9uYW1lJylcbiAgICB0YWJsZS5zdHJpbmcoJ3JlZGlyZWN0X3VybCcpXG5cbiAgICB0YWJsZS50aW1lc3RhbXAoJ2NyZWF0ZWRfb24nKVxuXG4gICAgdGFibGUuYm9vbGVhbigncmVhZCcpXG4gICAgdGFibGUuYm9vbGVhbignYXJjaGl2ZWQnKVxuICB9KVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/database/notifications.js\n");

/***/ }),

/***/ "./src/database/sessions.js":
/*!**********************************!*\
  !*** ./src/database/sessions.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('dialog_sessions', function (table) {\n    table.string('id').primary(); // Usually the user id, channel id, etc..\n    table.string('namespace'); // Could be used for A/B testing\n    table.text('state');\n    table.timestamp('created_on').defaultTo(knex.fn.now());\n    table.timestamp('active_on');\n  });\n}; /*\n     Table storing the current dialog sessions\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2Uvc2Vzc2lvbnMuanM/ZWEwNCJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwia25leCIsImNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMiLCJ0YWJsZSIsInN0cmluZyIsInByaW1hcnkiLCJ0ZXh0IiwidGltZXN0YW1wIiwiZGVmYXVsdFRvIiwiZm4iLCJub3ciXSwibWFwcGluZ3MiOiI7O0FBSUE7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCO0FBQUEsU0FDZix1QkFBUUMsSUFBUixFQUFjQyxzQkFBZCxDQUFxQyxpQkFBckMsRUFBd0QsaUJBQVM7QUFDL0RDLFVBQU1DLE1BQU4sQ0FBYSxJQUFiLEVBQW1CQyxPQUFuQixHQUQrRCxDQUNsQztBQUM3QkYsVUFBTUMsTUFBTixDQUFhLFdBQWIsRUFGK0QsQ0FFckM7QUFDMUJELFVBQU1HLElBQU4sQ0FBVyxPQUFYO0FBQ0FILFVBQU1JLFNBQU4sQ0FBZ0IsWUFBaEIsRUFBOEJDLFNBQTlCLENBQXdDUCxLQUFLUSxFQUFMLENBQVFDLEdBQVIsRUFBeEM7QUFDQVAsVUFBTUksU0FBTixDQUFnQixXQUFoQjtBQUNELEdBTkQsQ0FEZTtBQUFBLENBQWpCLEMsQ0FOQSIsImZpbGUiOiIuL3NyYy9kYXRhYmFzZS9zZXNzaW9ucy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gIFRhYmxlIHN0b3JpbmcgdGhlIGN1cnJlbnQgZGlhbG9nIHNlc3Npb25zXG4qL1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuL2hlbHBlcnMnXG5cbm1vZHVsZS5leHBvcnRzID0ga25leCA9PlxuICBoZWxwZXJzKGtuZXgpLmNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMoJ2RpYWxvZ19zZXNzaW9ucycsIHRhYmxlID0+IHtcbiAgICB0YWJsZS5zdHJpbmcoJ2lkJykucHJpbWFyeSgpIC8vIFVzdWFsbHkgdGhlIHVzZXIgaWQsIGNoYW5uZWwgaWQsIGV0Yy4uXG4gICAgdGFibGUuc3RyaW5nKCduYW1lc3BhY2UnKSAvLyBDb3VsZCBiZSB1c2VkIGZvciBBL0IgdGVzdGluZ1xuICAgIHRhYmxlLnRleHQoJ3N0YXRlJylcbiAgICB0YWJsZS50aW1lc3RhbXAoJ2NyZWF0ZWRfb24nKS5kZWZhdWx0VG8oa25leC5mbi5ub3coKSlcbiAgICB0YWJsZS50aW1lc3RhbXAoJ2FjdGl2ZV9vbicpXG4gIH0pXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/database/sessions.js\n");

/***/ }),

/***/ "./src/database/tables.js":
/*!********************************!*\
  !*** ./src/database/tables.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nmodule.exports = [__webpack_require__(/*! ./users.js */ \"./src/database/users.js\"), __webpack_require__(/*! ./tags.js */ \"./src/database/tags.js\"), __webpack_require__(/*! ./notifications.js */ \"./src/database/notifications.js\"), __webpack_require__(/*! ./sessions.js */ \"./src/database/sessions.js\"), __webpack_require__(/*! ./ghost.js */ \"./src/database/ghost.js\")];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2UvdGFibGVzLmpzPzU4MGIiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsInJlcXVpcmUiXSwibWFwcGluZ3MiOiI7O0FBQUFBLE9BQU9DLE9BQVAsR0FBaUIsQ0FDZixtQkFBQUMsQ0FBUSwyQ0FBUixDQURlLEVBRWYsbUJBQUFBLENBQVEseUNBQVIsQ0FGZSxFQUdmLG1CQUFBQSxDQUFRLDJEQUFSLENBSGUsRUFJZixtQkFBQUEsQ0FBUSxpREFBUixDQUplLEVBS2YsbUJBQUFBLENBQVEsMkNBQVIsQ0FMZSxDQUFqQiIsImZpbGUiOiIuL3NyYy9kYXRhYmFzZS90YWJsZXMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IFtcbiAgcmVxdWlyZSgnLi91c2Vycy5qcycpLFxuICByZXF1aXJlKCcuL3RhZ3MuanMnKSxcbiAgcmVxdWlyZSgnLi9ub3RpZmljYXRpb25zLmpzJyksXG4gIHJlcXVpcmUoJy4vc2Vzc2lvbnMuanMnKSxcbiAgcmVxdWlyZSgnLi9naG9zdC5qcycpXG5dXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/database/tables.js\n");

/***/ }),

/***/ "./src/database/tags.js":
/*!******************************!*\
  !*** ./src/database/tags.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('users_tags', function (table) {\n    table.string('userId');\n    table.string('tag');\n    table.string('value');\n    table.timestamp('tagged_on');\n    table.unique(['userId', 'tag']);\n  });\n}; /*\n     A table storing all the user tags\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2UvdGFncy5qcz8wMzJiIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJrbmV4IiwiY3JlYXRlVGFibGVJZk5vdEV4aXN0cyIsInRhYmxlIiwic3RyaW5nIiwidGltZXN0YW1wIiwidW5pcXVlIl0sIm1hcHBpbmdzIjoiOztBQUlBOzs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixnQkFBUTtBQUN2QixTQUFPLHVCQUFRQyxJQUFSLEVBQWNDLHNCQUFkLENBQXFDLFlBQXJDLEVBQW1ELGlCQUFTO0FBQ2pFQyxVQUFNQyxNQUFOLENBQWEsUUFBYjtBQUNBRCxVQUFNQyxNQUFOLENBQWEsS0FBYjtBQUNBRCxVQUFNQyxNQUFOLENBQWEsT0FBYjtBQUNBRCxVQUFNRSxTQUFOLENBQWdCLFdBQWhCO0FBQ0FGLFVBQU1HLE1BQU4sQ0FBYSxDQUFDLFFBQUQsRUFBVyxLQUFYLENBQWI7QUFDRCxHQU5NLENBQVA7QUFPRCxDQVJELEMsQ0FOQSIsImZpbGUiOiIuL3NyYy9kYXRhYmFzZS90YWdzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAgQSB0YWJsZSBzdG9yaW5nIGFsbCB0aGUgdXNlciB0YWdzXG4qL1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuL2hlbHBlcnMnXG5cbm1vZHVsZS5leHBvcnRzID0ga25leCA9PiB7XG4gIHJldHVybiBoZWxwZXJzKGtuZXgpLmNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMoJ3VzZXJzX3RhZ3MnLCB0YWJsZSA9PiB7XG4gICAgdGFibGUuc3RyaW5nKCd1c2VySWQnKVxuICAgIHRhYmxlLnN0cmluZygndGFnJylcbiAgICB0YWJsZS5zdHJpbmcoJ3ZhbHVlJylcbiAgICB0YWJsZS50aW1lc3RhbXAoJ3RhZ2dlZF9vbicpXG4gICAgdGFibGUudW5pcXVlKFsndXNlcklkJywgJ3RhZyddKVxuICB9KVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/database/tags.js\n");

/***/ }),

/***/ "./src/database/users.js":
/*!*******************************!*\
  !*** ./src/database/users.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('users', function (table) {\n    table.string('id').primary();\n    table.string('userId');\n    table.string('platform');\n    table.enu('gender', ['unknown', 'male', 'female']);\n    table.integer('timezone');\n    table.string('picture_url');\n    table.string('first_name');\n    table.string('last_name');\n    table.string('locale');\n    table.timestamp('created_on');\n  });\n}; /*\n     A table storing all the interlocutors (users) and their information\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGF0YWJhc2UvdXNlcnMuanM/YWUyOSJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwia25leCIsImNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMiLCJ0YWJsZSIsInN0cmluZyIsInByaW1hcnkiLCJlbnUiLCJpbnRlZ2VyIiwidGltZXN0YW1wIl0sIm1hcHBpbmdzIjoiOztBQUlBOzs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixnQkFBUTtBQUN2QixTQUFPLHVCQUFRQyxJQUFSLEVBQWNDLHNCQUFkLENBQXFDLE9BQXJDLEVBQThDLGlCQUFTO0FBQzVEQyxVQUFNQyxNQUFOLENBQWEsSUFBYixFQUFtQkMsT0FBbkI7QUFDQUYsVUFBTUMsTUFBTixDQUFhLFFBQWI7QUFDQUQsVUFBTUMsTUFBTixDQUFhLFVBQWI7QUFDQUQsVUFBTUcsR0FBTixDQUFVLFFBQVYsRUFBb0IsQ0FBQyxTQUFELEVBQVksTUFBWixFQUFvQixRQUFwQixDQUFwQjtBQUNBSCxVQUFNSSxPQUFOLENBQWMsVUFBZDtBQUNBSixVQUFNQyxNQUFOLENBQWEsYUFBYjtBQUNBRCxVQUFNQyxNQUFOLENBQWEsWUFBYjtBQUNBRCxVQUFNQyxNQUFOLENBQWEsV0FBYjtBQUNBRCxVQUFNQyxNQUFOLENBQWEsUUFBYjtBQUNBRCxVQUFNSyxTQUFOLENBQWdCLFlBQWhCO0FBQ0QsR0FYTSxDQUFQO0FBWUQsQ0FiRCxDLENBTkEiLCJmaWxlIjoiLi9zcmMvZGF0YWJhc2UvdXNlcnMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICBBIHRhYmxlIHN0b3JpbmcgYWxsIHRoZSBpbnRlcmxvY3V0b3JzICh1c2VycykgYW5kIHRoZWlyIGluZm9ybWF0aW9uXG4qL1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuL2hlbHBlcnMnXG5cbm1vZHVsZS5leHBvcnRzID0ga25leCA9PiB7XG4gIHJldHVybiBoZWxwZXJzKGtuZXgpLmNyZWF0ZVRhYmxlSWZOb3RFeGlzdHMoJ3VzZXJzJywgdGFibGUgPT4ge1xuICAgIHRhYmxlLnN0cmluZygnaWQnKS5wcmltYXJ5KClcbiAgICB0YWJsZS5zdHJpbmcoJ3VzZXJJZCcpXG4gICAgdGFibGUuc3RyaW5nKCdwbGF0Zm9ybScpXG4gICAgdGFibGUuZW51KCdnZW5kZXInLCBbJ3Vua25vd24nLCAnbWFsZScsICdmZW1hbGUnXSlcbiAgICB0YWJsZS5pbnRlZ2VyKCd0aW1lem9uZScpXG4gICAgdGFibGUuc3RyaW5nKCdwaWN0dXJlX3VybCcpXG4gICAgdGFibGUuc3RyaW5nKCdmaXJzdF9uYW1lJylcbiAgICB0YWJsZS5zdHJpbmcoJ2xhc3RfbmFtZScpXG4gICAgdGFibGUuc3RyaW5nKCdsb2NhbGUnKVxuICAgIHRhYmxlLnRpbWVzdGFtcCgnY3JlYXRlZF9vbicpXG4gIH0pXG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/database/users.js\n");

/***/ }),

/***/ "./src/dialog/engine.js":
/*!******************************!*\
  !*** ./src/dialog/engine.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _vm = __webpack_require__(/*! vm2 */ \"vm2\");\n\nvar _mware = __webpack_require__(/*! mware */ \"mware\");\n\nvar _mware2 = _interopRequireDefault(_mware);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar loggerShim = { debug: function debug() {} };\nvar callSubflowRegex = /(.+\\.flow\\.json)\\s?@?\\s?(.+)?/i; // e.g. './login.flow.json' or './login.flow.json @ username'\nvar MAX_STACK_SIZE = 100;\n\n/** The Dialog Engine (or Dialog Manager) is the component that\n handles the flow logic. It it responsible for executing flows, including\n executing the actions and flowing to the nodes, redirections etc.\n @namespace DialogEngine\n @example\n bp.dialogEngine.processMessage(...)\n */\n\nvar DialogEngine = function () {\n  function DialogEngine(_ref) {\n    var _this = this;\n\n    var flowProvider = _ref.flowProvider,\n        stateManager = _ref.stateManager,\n        options = _ref.options,\n        _ref$logger = _ref.logger,\n        logger = _ref$logger === undefined ? loggerShim : _ref$logger;\n\n    _classCallCheck(this, DialogEngine);\n\n    this.onError = function (fn) {\n      return _this.errorHandlers.push(fn);\n    };\n\n    Object.assign(this, { logger: logger, flowProvider: flowProvider, stateManager: stateManager });\n\n    this.flowsLoaded = false;\n    this.flows = [];\n    this.defaultFlow = _lodash2.default.get(options, 'defaultFlow') || 'main.flow.json';\n    this.outputProcessors = [];\n    this.errorHandlers = [];\n    this.actions = {};\n    this.actionMetadataProviders = [];\n\n    /**\n     * @typedef {Function} DialogEngine~DialogMiddleware\n     * @param {object} ctx A mutable context object\n     * @param {function} next Call this to continue processing\n     */\n\n    /**\n     * Middleware triggered before a new session is started.\n     * > **Note:** This middleware allows you to alter `ctx.flowName` to change\n     * > which flow will be selected to start the conversation.\n     * @function DialogEngine#onBeforeCreated\n     * @param {DialogEngine~DialogMiddleware} middleware\n     * @example\n    bp.dialogEngine.onBeforeCreated((ctx, next) => {\n    ctx.flowName = 'example.flow.json'\n    next()\n    })\n     */\n    this.onBeforeCreated = (0, _mware2.default)();\n\n    /**\n     * Middleware triggered **after** a new session is started.\n     * `ctx` is not mutable.\n     * @function DialogEngine#onAfterCreated\n     * @param {DialogEngine~DialogMiddleware} middleware\n     * @example\n    bp.dialogEngine.onAfterCreated((ctx, next) => {\n    // Do something here\n    next()\n    })\n     */\n    this.onAfterCreated = (0, _mware2.default)();\n\n    /**\n     * Middleware triggered **before** a conversation is ended for any reason.\n     * `ctx` is not mutable.\n     * @function DialogEngine#onBeforeEnd\n     * @param {DialogEngine~DialogMiddleware} middleware\n     * @example\n    bp.dialogEngine.onBeforeEnd((ctx, next) => {\n    // Do something here\n    next()\n    })\n     */\n    this.onBeforeEnd = (0, _mware2.default)();\n\n    /**\n     * Middleware triggered **before** a node is entered (before the `onEnter` execution).\n     * > **⚠️ Warn:** It is **not** recommended to mutate `ctx.node` for now, it might break in a future version of Botpress.\n     * @function DialogEngine#onBeforeNodeEnter\n     * @param {DialogEngine~DialogMiddleware} middleware\n     * @example\n    bp.dialogEngine.onBeforeNodeEnter((ctx, next) => {\n    // Do something here\n    next()\n    })\n     */\n    this.onBeforeNodeEnter = (0, _mware2.default)();\n\n    /**\n     * Middleware triggered **before** a conversation/session times out.\n     * > **Note:** You can't prevent it from timing out at this point.\n     * > You also can't change the timeout behavior/location at this time.\n     * @function DialogEngine#onBeforeSessionTimeout\n     * @param {DialogEngine~DialogMiddleware} middleware\n     * @example\n    bp.dialogEngine.onBeforeSessionTimeout((ctx, next) => {\n    // Do something here\n    next()\n    })\n     */\n    this.onBeforeSessionTimeout = (0, _mware2.default)();\n\n    flowProvider.on('flowsChanged', function () {\n      return Object.assign(_this, { flows: [], flowsLoaded: false });\n    });\n  }\n\n  /**\n   * Process a new incoming message from the user.\n   * This will execute and run the flow until the flow ends or gets paused by user input\n   * @param  {string} stateId The Id of the state.\n   *                          This is usually unique per user/group/channel, depending on the platform.\n   * @param  {BPIncomingEvent} event   The incoming event (message)\n   * @return {Promise<State>}         Returns a promise that resolves with the new state\n   *                                  when the flow is done processing\n   */\n\n\n  _createClass(DialogEngine, [{\n    key: 'processMessage',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(stateId, event) {\n        var context, state, msg, catchAllOnReceive, catchAllNext, i;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n\n                if (this.flowsLoaded) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 4;\n                return this.reloadFlows();\n\n              case 4:\n                _context.next = 6;\n                return this._getOrCreateContext(stateId);\n\n              case 6:\n                context = _context.sent;\n                _context.next = 9;\n                return this.stateManager.getState(stateId);\n\n              case 9:\n                state = _context.sent;\n\n                if (!(event.type === 'bp_dialog_timeout')) {\n                  _context.next = 18;\n                  break;\n                }\n\n                _context.next = 13;\n                return this._processTimeout(stateId, state, context, event);\n\n              case 13:\n                state = _context.sent;\n\n                if (_lodash2.default.isNil(state)) {\n                  _context.next = 17;\n                  break;\n                }\n\n                _context.next = 17;\n                return this.stateManager.setState(stateId, state);\n\n              case 17:\n                return _context.abrupt('return', state);\n\n              case 18:\n                msg = (event.text || '').substr(0, 20);\n\n                this._trace('<~', 'RECV', '\"' + msg + '\"', context, state);\n\n                if (context.currentFlow) {\n                  _context.next = 22;\n                  break;\n                }\n\n                throw new Error('Expected currentFlow to be defined for stateId=' + stateId);\n\n              case 22:\n                catchAllOnReceive = _lodash2.default.get(context, 'currentFlow.catchAll.onReceive');\n\n                if (!catchAllOnReceive) {\n                  _context.next = 28;\n                  break;\n                }\n\n                this._trace('!!', 'KALL', '', context, state);\n                _context.next = 27;\n                return this._processInstructions(catchAllOnReceive, state, event, context);\n\n              case 27:\n                state = _context.sent;\n\n              case 28:\n\n                // If there's a 'next' defined in catchAll, this will try to match any condition and if it is matched it\n                // will run the node defined in the next instead of the current context node\n                catchAllNext = _lodash2.default.get(context, 'currentFlow.catchAll.next');\n\n                if (!catchAllNext) {\n                  _context.next = 41;\n                  break;\n                }\n\n                this._trace('..', 'KALL', '', context, state);\n                i = 0;\n\n              case 32:\n                if (!(i < catchAllNext.length)) {\n                  _context.next = 40;\n                  break;\n                }\n\n                _context.next = 35;\n                return this._evaluateCondition(catchAllNext[i].condition, state, event);\n\n              case 35:\n                if (!_context.sent) {\n                  _context.next = 37;\n                  break;\n                }\n\n                return _context.abrupt('return', this._processNode(stateId, state, context, catchAllNext[i].node, event));\n\n              case 37:\n                i++;\n                _context.next = 32;\n                break;\n\n              case 40:\n\n                this._trace('?X', 'KALL', '', context, state);\n\n              case 41:\n                _context.next = 43;\n                return this._processNode(stateId, state, context, context.node, event);\n\n              case 43:\n                state = _context.sent;\n\n                if (_lodash2.default.isNil(state)) {\n                  _context.next = 47;\n                  break;\n                }\n\n                _context.next = 47;\n                return this.stateManager.setState(stateId, state);\n\n              case 47:\n                return _context.abrupt('return', state);\n\n              case 50:\n                _context.prev = 50;\n                _context.t0 = _context['catch'](0);\n\n                this.errorHandlers.forEach(function (errorHandler) {\n                  return errorHandler(_context.t0);\n                });\n\n              case 53:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 50]]);\n      }));\n\n      function processMessage(_x, _x2) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return processMessage;\n    }()\n\n    /**\n     * Make the stateId jump to the specified flow and node\n     * regardless of if there was already an active flow or not\n     * in execution. If there was already an active flow executing,\n     * this will override it. Note that by default, the current state\n     * will be preserved; if you wish to reset the state as well,\n     * set `resetState` to `true`.\n     * Note that this will not continue processing, i.e. the user must send a message or\n     * you should call {@link BotEngine#processMessage} manually to continue execution.\n     * @example\n     * // inside a bp.hear (...)\n     * bp.dialogEngine.jumpTo(stateId, 'main.flow.json')\n     * bp.dialogEngine.processMessage(stateId, event) // Continue processing\n     * @param  {string} stateId  The stateId of the user/channel/group to make jump.\n     * @param  {string} flowName The name of the flow, e.g. `main.flow.json`\n     * @param  {string} [nodeName=null] The name of the node to jump to. Defaults to the flow's entry point.\n     * @param  {boolean} [options.resetState=false] Whether or not the state should be reset\n     */\n\n  }, {\n    key: 'jumpTo',\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(stateId, flowName) {\n        var nodeName = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        var options = arguments[3];\n        var flow;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                options = Object.assign({\n                  resetState: false\n                }, options);\n\n                if (this.flowsLoaded) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                _context2.next = 4;\n                return this.reloadFlows();\n\n              case 4:\n                flow = this._findFlow(flowName, true);\n\n\n                if (nodeName) {\n                  // We're just calling for throwing if doesn't exist\n                  DialogEngine._findNode(flow, nodeName, true);\n                }\n\n                _context2.next = 8;\n                return this._setContext(stateId, {\n                  currentFlow: flow,\n                  node: nodeName || flow.startNode,\n                  hasJumped: true,\n                  flowStack: [{ flow: flow.name, node: nodeName || flow.startNode }]\n                });\n\n              case 8:\n                if (!options.resetState) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                _context2.next = 11;\n                return this.stateManager.setState(stateId, {});\n\n              case 11:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function jumpTo(_x3, _x4) {\n        return _ref3.apply(this, arguments);\n      }\n\n      return jumpTo;\n    }()\n\n    /**\n     * Get the current flow and node for a specific stateId\n     * @param  {string} stateId\n     * @return {{ flow: string, node: string }} Returns the current flow and node\n     */\n\n  }, {\n    key: 'getCurrentPosition',\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(stateId) {\n        var context;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this._getContext(stateId);\n\n              case 2:\n                context = _context3.sent;\n\n                if (!context) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                return _context3.abrupt('return', {\n                  flow: context.currentFlow && context.currentFlow.name,\n                  node: context.node\n                });\n\n              case 5:\n                return _context3.abrupt('return', {\n                  flow: null,\n                  node: null\n                });\n\n              case 6:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getCurrentPosition(_x6) {\n        return _ref4.apply(this, arguments);\n      }\n\n      return getCurrentPosition;\n    }()\n\n    /**\n     * Ends the flow for a specific stateId if there's an active flow,\n     * otherwise does nothing.\n     * @param  {string} stateId [description]\n     */\n\n  }, {\n    key: 'endFlow',\n    value: function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(stateId) {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt('return', this._endFlow(stateId));\n\n              case 1:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function endFlow(_x7) {\n        return _ref5.apply(this, arguments);\n      }\n\n      return endFlow;\n    }()\n  }, {\n    key: 'reloadFlows',\n    value: function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                this._trace('**', 'LOAD', '');\n                _context5.next = 3;\n                return this.flowProvider.loadAll();\n\n              case 3:\n                this.flows = _context5.sent;\n\n                this.flowsLoaded = true;\n\n              case 5:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function reloadFlows() {\n        return _ref6.apply(this, arguments);\n      }\n\n      return reloadFlows;\n    }()\n  }, {\n    key: 'getFlows',\n    value: function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (this.flowsLoaded) {\n                  _context6.next = 3;\n                  break;\n                }\n\n                _context6.next = 3;\n                return this.reloadFlows();\n\n              case 3:\n                return _context6.abrupt('return', this.flows);\n\n              case 4:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function getFlows() {\n        return _ref7.apply(this, arguments);\n      }\n\n      return getFlows;\n    }()\n\n    /**\n     * Registers a new output processor (there can be many, which all get triggered on output).\n     * @param {OutpoutProcessor} processor - Is an object with {id, send}\n     * @param {string} processor.id - The unique id of the processor\n     * @param {Function} processor.send - The `send` function of the processor\n     * @returns {void}\n     * @private\n     */\n\n  }, {\n    key: 'registerOutputProcessor',\n    value: function registerOutputProcessor(processor) {\n      if (_lodash2.default.isNil(processor) || !_lodash2.default.isFunction(processor.send) || !_lodash2.default.isString(processor.id)) {\n        throw new Error('Invalid processor. Processor must have a function `send` defined and a valid `id`');\n      }\n\n      // For now we only ever support a single output processor\n      // We might want many output processors in the future, for example to hook up a debugger or a test suite\n      this.outputProcessors = [processor];\n    }\n\n    /**\n     * @typedef {object} DialogEngine~ActionMetadata\n     * @var {string} title\n     * @var {string} description\n     * @var {boolean} required\n     * @var {string} default\n     * @var {string} type\n     * @private\n     */\n\n    /**\n     * A metadata provider returns metadata for an action or\n     * returns null, in which case other providers will be called\n     * @typedef {Function} DialogEngine~MetadataProvider\n     * @param {string} action The name of the action\n     * @returns {DialogEngine~ActionMetadata}\n     * @private\n     */\n\n    /**\n     * Adds a new provider of function metadata\n     * @param {DialogEngine~MetadataProvider} provider\n     * @returns {void}\n     * @private\n     */\n\n  }, {\n    key: 'registerActionMetadataProvider',\n    value: function registerActionMetadataProvider(provider) {\n      if (!_lodash2.default.isFunction(provider)) {\n        throw new Error('Expected the function metadata provider to be a function');\n      }\n\n      if (!_lodash2.default.includes(this.actionMetadataProviders, provider)) {\n        this.actionMetadataProviders.push(provider);\n      }\n    }\n\n    /**\n     * Introduce new actions to the Flows that they can call.\n     * @param {Object} fnMap\n     * @param {bool} [overwrite=false] - Whether or not it should overwrite existing actions with the same name.\n     * Note that if overwrite is false, an error will be thrown on conflict.\n     * @returns {Promise.<void>}\n     */\n\n  }, {\n    key: 'registerActions',\n    value: function () {\n      var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(fnMap) {\n        var _this2 = this;\n\n        var overwrite = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var toRegister;\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                toRegister = {};\n\n                _lodash2.default.keys(fnMap).forEach(function (name) {\n                  if (_this2.actions[name] && !overwrite) {\n                    throw new Error('There is already a function named \"' + name + '\" registered');\n                  }\n\n                  var handler = fnMap[name];\n                  var metadata = null;\n\n                  if (!_lodash2.default.isFunction(fnMap[name])) {\n                    if (!_lodash2.default.isObject(fnMap[name]) || !_lodash2.default.isFunction(fnMap[name].handler)) {\n                      throw new Error('Expected function \"' + name + '\" to be a function or an object with a \\'hander\\' function');\n                    }\n\n                    handler = fnMap[name].handler;\n                    metadata = Object.assign({}, fnMap[name], { name: name, handler: null });\n                  }\n\n                  var _iteratorNormalCompletion = true;\n                  var _didIteratorError = false;\n                  var _iteratorError = undefined;\n\n                  try {\n                    for (var _iterator = _this2.actionMetadataProviders[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                      var provider = _step.value;\n\n                      var extra = provider(name);\n\n                      if (extra) {\n                        metadata = Object.assign({}, extra, metadata || {});\n                        break;\n                      }\n                    }\n                  } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                      }\n                    } finally {\n                      if (_didIteratorError) {\n                        throw _iteratorError;\n                      }\n                    }\n                  }\n\n                  toRegister[name] = {\n                    name: name,\n                    metadata: metadata,\n                    fn: handler\n                  };\n                });\n\n                Object.assign(this.actions, toRegister);\n\n              case 3:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function registerActions(_x8) {\n        return _ref8.apply(this, arguments);\n      }\n\n      return registerActions;\n    }()\n\n    /**\n     * @deprecated Use registerActions() instead\n     */\n\n  }, {\n    key: 'registerFunctions',\n    value: function () {\n      var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(fnMap) {\n        var overwrite = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                return _context8.abrupt('return', this.registerActions(fnMap, overwrite));\n\n              case 1:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function registerFunctions(_x10) {\n        return _ref9.apply(this, arguments);\n      }\n\n      return registerFunctions;\n    }()\n\n    /**\n     * Returns all the available actions along with their metadata\n     * @private\n     */\n\n  }, {\n    key: 'getAvailableActions',\n    value: function getAvailableActions() {\n      return _lodash2.default.values(this.actions).filter(function (x) {\n        return !String(x.name).startsWith('__');\n      }).map(function (x) {\n        return Object.assign({}, x, { fn: null });\n      });\n    }\n  }, {\n    key: '_processTimeout',\n    value: function () {\n      var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(stateId, userState, context, event) {\n        var _this3 = this;\n\n        var beforeCtx, currentNodeTimeout, currentFlowTimeout, fallbackTimeoutNode, fallbackTimeoutFlow;\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                beforeCtx = { stateId: stateId };\n                _context9.next = 3;\n                return _bluebird2.default.fromCallback(function (callback) {\n                  return _this3.onBeforeSessionTimeout.run(beforeCtx, callback);\n                });\n\n              case 3:\n                currentNodeTimeout = _lodash2.default.get(DialogEngine._findNode(context.currentFlow, context.node), 'timeoutNode');\n                currentFlowTimeout = _lodash2.default.get(context, 'currentFlow.timeoutNode');\n                fallbackTimeoutNode = DialogEngine._findNode(context.currentFlow, 'timeout');\n                fallbackTimeoutFlow = this._findFlow('timeout.flow.json');\n\n                if (!currentNodeTimeout) {\n                  _context9.next = 14;\n                  break;\n                }\n\n                this._trace('<>', 'SNDE', '', context);\n                _context9.next = 11;\n                return this._processNode(stateId, userState, context, currentNodeTimeout, event);\n\n              case 11:\n                userState = _context9.sent;\n                _context9.next = 39;\n                break;\n\n              case 14:\n                if (!currentFlowTimeout) {\n                  _context9.next = 21;\n                  break;\n                }\n\n                this._trace('<>', 'SFLW', '', context);\n                _context9.next = 18;\n                return this._processNode(stateId, userState, context, currentFlowTimeout, event);\n\n              case 18:\n                userState = _context9.sent;\n                _context9.next = 39;\n                break;\n\n              case 21:\n                if (!fallbackTimeoutNode) {\n                  _context9.next = 28;\n                  break;\n                }\n\n                this._trace('<>', 'DNDE', '', context);\n                _context9.next = 25;\n                return this._processNode(stateId, userState, context, fallbackTimeoutNode.name, event);\n\n              case 25:\n                userState = _context9.sent;\n                _context9.next = 39;\n                break;\n\n              case 28:\n                if (!fallbackTimeoutFlow) {\n                  _context9.next = 35;\n                  break;\n                }\n\n                this._trace('<>', 'DFLW', '', context);\n                _context9.next = 32;\n                return this._processNode(stateId, userState, context, fallbackTimeoutFlow.name, event);\n\n              case 32:\n                userState = _context9.sent;\n                _context9.next = 39;\n                break;\n\n              case 35:\n                this._trace('<>', 'NTHG', '', context);\n                _context9.next = 38;\n                return this._endFlow(stateId);\n\n              case 38:\n                userState = _context9.sent;\n\n              case 39:\n                return _context9.abrupt('return', userState);\n\n              case 40:\n              case 'end':\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function _processTimeout(_x12, _x13, _x14, _x15) {\n        return _ref10.apply(this, arguments);\n      }\n\n      return _processTimeout;\n    }()\n  }, {\n    key: '_processNode',\n    value: function () {\n      var _ref11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(stateId, userState, context, nodeName, event) {\n        var _this4 = this;\n\n        var switchedFlow, switchedNode, originalFlow, originalNode, node, beforeCtx;\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                switchedFlow = false;\n                switchedNode = false;\n\n\n                if (context.hasJumped) {\n                  context.hasJumped = false;\n                  switchedNode = true;\n                }\n\n                originalFlow = context.currentFlow.name;\n                originalNode = context.node;\n\n\n                if (callSubflowRegex.test(nodeName)) {\n                  this._trace('>>', 'FLOW', '\"' + nodeName + '\"', context, null);\n                  context = this._gotoSubflow(nodeName, context);\n                  switchedFlow = true;\n                } else if (/^#/.test(nodeName)) {\n                  // e.g. '#success'\n                  this._trace('<<', 'FLOW', '\"' + nodeName + '\"', context, null);\n                  context = this._gotoPreviousFlow(nodeName, context);\n                  switchedFlow = true;\n                } else if (context.node !== nodeName) {\n                  this._trace('>>', 'FLOW', '\"' + nodeName + '\"');\n                  switchedNode = true;\n                  context.node = nodeName;\n                } else if (_lodash2.default.isNil(context.node)) {\n                  // We just created the context\n                  switchedNode = true;\n                  context.node = context.currentFlow.startNode;\n                }\n\n                node = DialogEngine._findNode(context.currentFlow, context.node);\n\n                if (!(!node || !node.name)) {\n                  _context10.next = 13;\n                  break;\n                }\n\n                _context10.next = 10;\n                return this._endFlow(stateId);\n\n              case 10:\n                userState = _context10.sent;\n                return _context10.abrupt('return', userState);\n\n              case 13:\n                if (!(switchedFlow || switchedNode)) {\n                  _context10.next = 42;\n                  break;\n                }\n\n                context.flowStack.push({\n                  flow: context.currentFlow.name,\n                  node: context.node\n                });\n\n                // Flattens the stack to only include flow jumps, not node jumps\n                context.flowStack = context.flowStack.filter(function (el, i) {\n                  return i === context.flowStack.length - 1 || context.flowStack[i + 1].flow !== el.flow;\n                });\n\n                if (!(context.flowStack.length >= MAX_STACK_SIZE)) {\n                  _context10.next = 19;\n                  break;\n                }\n\n                throw new Error('Exceeded maximum flow stack size (' + MAX_STACK_SIZE + ').\\n         This might be due to an unexpected infinite loop in your flows.\\n         Current flow: ' + context.currentFlow.name + '\\n         Current node: ' + context.node);\n\n              case 19:\n                _context10.next = 21;\n                return this._setContext(stateId, context);\n\n              case 21:\n                beforeCtx = { stateId: stateId, node: node };\n                _context10.next = 24;\n                return _bluebird2.default.fromCallback(function (callback) {\n                  return _this4.onBeforeNodeEnter.run(beforeCtx, callback);\n                });\n\n              case 24:\n                if (!node.onEnter) {\n                  _context10.next = 29;\n                  break;\n                }\n\n                this._trace('!!', 'ENTR', '', context, userState);\n                _context10.next = 28;\n                return this._processInstructions(node.onEnter, userState, event, context);\n\n              case 28:\n                userState = _context10.sent;\n\n              case 29:\n                if (node.onReceive) {\n                  _context10.next = 40;\n                  break;\n                }\n\n                this._trace('..', 'NOWT', '', context, userState);\n\n                if (!(node.type === 'skill-call' && originalFlow !== node.flow)) {\n                  _context10.next = 37;\n                  break;\n                }\n\n                _context10.next = 34;\n                return this._processNode(stateId, userState, context, node.flow, event);\n\n              case 34:\n                userState = _context10.sent;\n                _context10.next = 40;\n                break;\n\n              case 37:\n                _context10.next = 39;\n                return this._transitionToNextNodes(node, context, userState, stateId, event);\n\n              case 39:\n                userState = _context10.sent;\n\n              case 40:\n                _context10.next = 57;\n                break;\n\n              case 42:\n                if (!node.onReceive) {\n                  _context10.next = 47;\n                  break;\n                }\n\n                this._trace('!!', 'RECV', '', context, userState);\n                _context10.next = 46;\n                return this._processInstructions(node.onReceive, userState, event, context);\n\n              case 46:\n                userState = _context10.sent;\n\n              case 47:\n\n                this._trace('..', 'RECV', '', context, userState);\n\n                if (!(node.type === 'skill-call' && originalFlow !== node.flow)) {\n                  _context10.next = 54;\n                  break;\n                }\n\n                _context10.next = 51;\n                return this._processNode(stateId, userState, context, node.flow, event);\n\n              case 51:\n                userState = _context10.sent;\n                _context10.next = 57;\n                break;\n\n              case 54:\n                _context10.next = 56;\n                return this._transitionToNextNodes(node, context, userState, stateId, event);\n\n              case 56:\n                userState = _context10.sent;\n\n              case 57:\n                return _context10.abrupt('return', userState);\n\n              case 58:\n              case 'end':\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function _processNode(_x16, _x17, _x18, _x19, _x20) {\n        return _ref11.apply(this, arguments);\n      }\n\n      return _processNode;\n    }()\n  }, {\n    key: '_transitionToNextNodes',\n    value: function () {\n      var _ref12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(node, context, userState, stateId, event) {\n        var nextNodes, i;\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                nextNodes = node.next || [];\n                i = 0;\n\n              case 2:\n                if (!(i < nextNodes.length)) {\n                  _context11.next = 15;\n                  break;\n                }\n\n                _context11.next = 5;\n                return this._evaluateCondition(nextNodes[i].condition, userState, event);\n\n              case 5:\n                if (!_context11.sent) {\n                  _context11.next = 12;\n                  break;\n                }\n\n                this._trace('??', 'MTCH', 'cond = \"' + nextNodes[i].condition + '\"', context);\n\n                if (!/^end$/i.test(nextNodes[i].node)) {\n                  _context11.next = 11;\n                  break;\n                }\n\n                return _context11.abrupt('return', this._endFlow(stateId));\n\n              case 11:\n                return _context11.abrupt('return', this._processNode(stateId, userState, context, nextNodes[i].node, event));\n\n              case 12:\n                i++;\n                _context11.next = 2;\n                break;\n\n              case 15:\n                if (nextNodes.length) {\n                  _context11.next = 17;\n                  break;\n                }\n\n                return _context11.abrupt('return', this._endFlow(stateId));\n\n              case 17:\n                return _context11.abrupt('return', userState);\n\n              case 18:\n              case 'end':\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function _transitionToNextNodes(_x21, _x22, _x23, _x24, _x25) {\n        return _ref12.apply(this, arguments);\n      }\n\n      return _transitionToNextNodes;\n    }()\n  }, {\n    key: '_endFlow',\n    value: function () {\n      var _ref13 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(stateId) {\n        var _this5 = this;\n\n        var beforeCtx;\n        return regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                beforeCtx = { stateId: stateId };\n                _context12.next = 3;\n                return _bluebird2.default.fromCallback(function (callback) {\n                  return _this5.onBeforeEnd.run(beforeCtx, callback);\n                });\n\n              case 3:\n\n                this._trace('--', 'ENDF', '', null, null);\n                _context12.next = 6;\n                return this.stateManager.deleteState(stateId, ['context']);\n\n              case 6:\n                return _context12.abrupt('return', null);\n\n              case 7:\n              case 'end':\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function _endFlow(_x26) {\n        return _ref13.apply(this, arguments);\n      }\n\n      return _endFlow;\n    }()\n  }, {\n    key: '_getOrCreateContext',\n    value: function () {\n      var _ref14 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(stateId) {\n        var _this6 = this;\n\n        var state, beforeCtx, flow, afterCtx;\n        return regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                _context13.next = 2;\n                return this._getContext(stateId);\n\n              case 2:\n                state = _context13.sent;\n\n                if (!(!state || !state.currentFlow)) {\n                  _context13.next = 16;\n                  break;\n                }\n\n                beforeCtx = { stateId: stateId, flowName: this.defaultFlow };\n                _context13.next = 7;\n                return _bluebird2.default.fromCallback(function (callback) {\n                  return _this6.onBeforeCreated.run(beforeCtx, callback);\n                });\n\n              case 7:\n                flow = this._findFlow(beforeCtx.flowName, true);\n\n                if (flow) {\n                  _context13.next = 10;\n                  break;\n                }\n\n                throw new Error('Could not find the default flow \"' + this.defaultFlow + '\"');\n\n              case 10:\n\n                state = {\n                  currentFlow: flow,\n                  flowStack: [{ flow: flow.name, node: flow.startNode }]\n                };\n\n                _context13.next = 13;\n                return this._setContext(stateId, state);\n\n              case 13:\n                afterCtx = _extends({}, beforeCtx);\n                _context13.next = 16;\n                return _bluebird2.default.fromCallback(function (callback) {\n                  return _this6.onAfterCreated.run(afterCtx, callback);\n                });\n\n              case 16:\n                return _context13.abrupt('return', state);\n\n              case 17:\n              case 'end':\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function _getOrCreateContext(_x27) {\n        return _ref14.apply(this, arguments);\n      }\n\n      return _getOrCreateContext;\n    }()\n  }, {\n    key: '_getContext',\n    value: function _getContext(stateId) {\n      return this.stateManager.getState(stateId + '___context');\n    }\n  }, {\n    key: '_setContext',\n    value: function _setContext(stateId, state) {\n      return this.stateManager.setState(stateId + '___context', state);\n    }\n  }, {\n    key: '_gotoSubflow',\n    value: function _gotoSubflow(nodeName, context) {\n      var _nodeName$match = nodeName.match(callSubflowRegex),\n          _nodeName$match2 = _slicedToArray(_nodeName$match, 3),\n          subflow = _nodeName$match2[1],\n          subflowNode = _nodeName$match2[2];\n\n      var flow = this._findFlow(subflow, true);\n\n      if (_lodash2.default.isNil(subflowNode)) {\n        subflowNode = flow.startNode;\n      }\n\n      Object.assign(context, {\n        currentFlow: flow,\n        node: subflowNode\n      });\n\n      return context;\n    }\n  }, {\n    key: '_gotoPreviousFlow',\n    value: function _gotoPreviousFlow(nodeName, context) {\n      if (!context.flowStack) {\n        context.flowStack = [];\n      }\n\n      while (context.currentFlow.name === _lodash2.default.get(_lodash2.default.last(context.flowStack), 'flow')) {\n        context.flowStack.pop();\n      }\n\n      if (context.flowStack.length < 1) {\n        this._trace('Flow tried to go back to previous flow but there was none. Exiting flow.', context, null);\n        // TODO END FLOW\n      } else {\n        var _$last = _lodash2.default.last(context.flowStack),\n            flow = _$last.flow,\n            node = _$last.node;\n\n        if (nodeName !== '#') {\n          node = nodeName.substr(1);\n        }\n\n        Object.assign(context, {\n          currentFlow: this._findFlow(flow, true),\n          node: node\n        });\n      }\n\n      return context;\n    }\n  }, {\n    key: '_processInstructions',\n    value: function () {\n      var _ref15 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(instructions, userState, event, context) {\n        var _this7 = this;\n\n        return regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                if (!_lodash2.default.isArray(instructions)) {\n                  instructions = [instructions];\n                }\n\n                _context15.next = 3;\n                return _bluebird2.default.mapSeries(instructions, function () {\n                  var _ref16 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(instruction) {\n                    var chunks, params;\n                    return regeneratorRuntime.wrap(function _callee14$(_context14) {\n                      while (1) {\n                        switch (_context14.prev = _context14.next) {\n                          case 0:\n                            if (!(_lodash2.default.isString(instruction) && instruction.startsWith('say '))) {\n                              _context14.next = 10;\n                              break;\n                            }\n\n                            chunks = instruction.split(' ');\n                            params = _lodash2.default.slice(chunks, 2).join(' ');\n\n                            if (!(chunks.length < 2)) {\n                              _context14.next = 6;\n                              break;\n                            }\n\n                            _this7.trace('ERROR Invalid text instruction. Expected an instruction along \"say #text Something\"');\n                            return _context14.abrupt('return', userState);\n\n                          case 6:\n                            _context14.next = 8;\n                            return _this7._dispatchOutput({\n                              type: chunks[1], // e.g. \"#text\" or \"#!trivia-12342\"\n                              value: params // e.g. Any additional parameter provided to the template\n                            }, userState, event, context);\n\n                          case 8:\n                            _context14.next = 13;\n                            break;\n\n                          case 10:\n                            _context14.next = 12;\n                            return _this7._invokeAction(instruction, userState, event, context);\n\n                          case 12:\n                            userState = _context14.sent;\n\n                          case 13:\n                          case 'end':\n                            return _context14.stop();\n                        }\n                      }\n                    }, _callee14, _this7);\n                  }));\n\n                  return function (_x32) {\n                    return _ref16.apply(this, arguments);\n                  };\n                }());\n\n              case 3:\n                return _context15.abrupt('return', userState);\n\n              case 4:\n              case 'end':\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      function _processInstructions(_x28, _x29, _x30, _x31) {\n        return _ref15.apply(this, arguments);\n      }\n\n      return _processInstructions;\n    }()\n  }, {\n    key: '_dispatchOutput',\n    value: function () {\n      var _ref17 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16(output, userState, event, context) {\n        var msg;\n        return regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                msg = String(output.type + (output.value || '')).substr(0, 20);\n\n                this._trace('~>', 'SEND', '\"' + msg + '\"');\n\n                this.outputProcessors.forEach(function (processor) {\n                  processor.send({\n                    message: output,\n                    state: userState,\n                    originalEvent: event,\n                    flowContext: context\n                  });\n                });\n\n              case 3:\n              case 'end':\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function _dispatchOutput(_x33, _x34, _x35, _x36) {\n        return _ref17.apply(this, arguments);\n      }\n\n      return _dispatchOutput;\n    }()\n  }, {\n    key: '_invokeAction',\n    value: function () {\n      var _ref18 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(instruction, userState, event, context) {\n        var name, args, chunks, argsStr, ret;\n        return regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                name = null;\n                args = {};\n\n                if (!_lodash2.default.isString(instruction)) {\n                  _context17.next = 20;\n                  break;\n                }\n\n                if (!instruction.includes(' ')) {\n                  _context17.next = 17;\n                  break;\n                }\n\n                chunks = instruction.split(' ');\n                argsStr = _lodash2.default.tail(chunks).join(' ');\n\n                name = _lodash2.default.first(chunks);\n                _context17.prev = 7;\n\n                args = JSON.parse(argsStr);\n                args = _lodash2.default.mapValues(args, function (value) {\n                  if (_lodash2.default.isString(value) && value.startsWith('{{') && value.endsWith('}}')) {\n                    var key = value.substr(2, value.length - 4);\n                    return _lodash2.default.get({ state: userState, s: userState, event: event, e: event }, key);\n                  }\n                  return value;\n                });\n                _context17.next = 15;\n                break;\n\n              case 12:\n                _context17.prev = 12;\n                _context17.t0 = _context17['catch'](7);\n                throw new Error('ERROR function has invalid arguments (not a valid JSON string): ' + argsStr);\n\n              case 15:\n                _context17.next = 18;\n                break;\n\n              case 17:\n                name = instruction;\n\n              case 18:\n                _context17.next = 21;\n                break;\n\n              case 20:\n                this._trace('ERROR function is not a valid string');\n\n              case 21:\n                if (this.actions[name]) {\n                  _context17.next = 25;\n                  break;\n                }\n\n                this._trace('ERROR function \"' + name + '\" not found', context, userState);\n                _context17.next = 42;\n                break;\n\n              case 25:\n                _context17.prev = 25;\n\n                this._trace('!!', 'EXEC', 'func \"' + name + '\"', context, userState);\n                _context17.next = 29;\n                return this.actions[name].fn(Object.freeze(userState), event, args || {});\n\n              case 29:\n                ret = _context17.sent;\n\n                if (!(ret && _lodash2.default.isObject(ret))) {\n                  _context17.next = 37;\n                  break;\n                }\n\n                if (!Object.isFrozen(ret)) {\n                  _context17.next = 35;\n                  break;\n                }\n\n                this._trace('ERROR function \"' + name + '\" returned the original (frozen) state. You should clone the state (see \\'Object.assign()\\') instead of returning the original state.', context, userState);\n                _context17.next = 37;\n                break;\n\n              case 35:\n                this._trace('!!', 'SSET', '', context);\n                return _context17.abrupt('return', ret);\n\n              case 37:\n                _context17.next = 42;\n                break;\n\n              case 39:\n                _context17.prev = 39;\n                _context17.t1 = _context17['catch'](25);\n                throw new Error('ERROR function \"' + name + '\" thrown an error: ' + (_context17.t1 && _context17.t1.message));\n\n              case 42:\n                return _context17.abrupt('return', userState);\n\n              case 43:\n              case 'end':\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this, [[7, 12], [25, 39]]);\n      }));\n\n      function _invokeAction(_x37, _x38, _x39, _x40) {\n        return _ref18.apply(this, arguments);\n      }\n\n      return _invokeAction;\n    }()\n  }, {\n    key: '_evaluateCondition',\n    value: function () {\n      var _ref19 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18(condition, userState, event) {\n        var _this8 = this;\n\n        var vm;\n        return regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                if (!(/^true|always|yes$/i.test(condition) || condition === '')) {\n                  _context18.next = 2;\n                  break;\n                }\n\n                return _context18.abrupt('return', true);\n\n              case 2:\n                vm = new _vm.VM({\n                  timeout: 5000\n                });\n\n\n                _lodash2.default.keys(this.actions).forEach(function (name) {\n                  vm.freeze(_this8.actions[name].fn, name);\n                });\n\n                vm.freeze(userState, 's');\n                vm.freeze(userState, 'state');\n                vm.freeze(event, 'event');\n                vm.freeze(event, 'e');\n\n                _context18.prev = 8;\n                _context18.next = 11;\n                return vm.run(condition);\n\n              case 11:\n                _context18.t0 = _context18.sent;\n                return _context18.abrupt('return', _context18.t0 == true);\n\n              case 15:\n                _context18.prev = 15;\n                _context18.t1 = _context18['catch'](8);\n                throw new Error('ERROR evaluating condition \"' + condition + '\": ' + _context18.t1.message);\n\n              case 18:\n              case 'end':\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this, [[8, 15]]);\n      }));\n\n      function _evaluateCondition(_x41, _x42, _x43) {\n        return _ref19.apply(this, arguments);\n      }\n\n      return _evaluateCondition;\n    }()\n  }, {\n    key: '_findFlow',\n    value: function _findFlow(flowName) {\n      var throwIfNotFound = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var flow = _lodash2.default.find(this.flows, { name: flowName });\n\n      if (throwIfNotFound && _lodash2.default.isNil(flow)) {\n        throw new Error('Could not find flow \"' + flowName + '\"');\n      }\n\n      return flow;\n    }\n  }, {\n    key: 'log',\n    value: function log(message, context, state) {\n      var flow = (_lodash2.default.get(context, 'currentFlow.name') || 'NONE').replace(/\\.flow\\.json/i, '');\n      var node = context && context.node || 'NONE';\n      var msg = 'Dialog: [' + flow + ' \\u2013 ' + node + ']\\t' + message;\n      this.logger.debug(msg);\n    }\n\n    /**\n     * Dialog: [flow] (node) \\t OP  RESN  \"Description\"\n     * @param message\n     * @param context\n     * @param state\n     * @private\n     */\n\n  }, {\n    key: '_trace',\n    value: function _trace(operation, reason, message, context) {\n      var flow = (_lodash2.default.get(context, 'currentFlow.name') || ' N/A ').replace(/\\.flow\\.json/i, '');\n      var node = context && context.node || ' N/A ';\n\n      flow = flow.length > 13 ? flow.substr(0, 13) + '&' : flow;\n      node = node.length > 13 ? node.substr(0, 13) + '&' : node;\n\n      var spc = _lodash2.default.repeat(' ', 30 - flow.length - node.length);\n\n      var msg = 'Dialog: [' + flow + '] (' + node + ') ' + spc + ' ' + operation + '  ' + reason + ' \\t ' + message;\n\n      this.logger.debug(msg);\n    }\n  }], [{\n    key: '_findNode',\n    value: function _findNode(flow, nodeName) {\n      var throwIfNotFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (throwIfNotFound && _lodash2.default.isNil(flow)) {\n        throw new Error('Could not find node ' + nodeName + ' because the flow was not defined (null)');\n      }\n\n      var node = _lodash2.default.find(flow.nodes, { name: nodeName });\n\n      if (throwIfNotFound && _lodash2.default.isNil(nodeName)) {\n        throw new Error('Could not find node \"' + nodeName + '\" in flow \"' + flow.name + '\"');\n      }\n\n      return node;\n    }\n  }]);\n\n  return DialogEngine;\n}();\n\nmodule.exports = DialogEngine;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGlhbG9nL2VuZ2luZS5qcz9mODY0Il0sIm5hbWVzIjpbImxvZ2dlclNoaW0iLCJkZWJ1ZyIsImNhbGxTdWJmbG93UmVnZXgiLCJNQVhfU1RBQ0tfU0laRSIsIkRpYWxvZ0VuZ2luZSIsImZsb3dQcm92aWRlciIsInN0YXRlTWFuYWdlciIsIm9wdGlvbnMiLCJsb2dnZXIiLCJvbkVycm9yIiwiZXJyb3JIYW5kbGVycyIsInB1c2giLCJmbiIsIk9iamVjdCIsImFzc2lnbiIsImZsb3dzTG9hZGVkIiwiZmxvd3MiLCJkZWZhdWx0RmxvdyIsIl8iLCJnZXQiLCJvdXRwdXRQcm9jZXNzb3JzIiwiYWN0aW9ucyIsImFjdGlvbk1ldGFkYXRhUHJvdmlkZXJzIiwib25CZWZvcmVDcmVhdGVkIiwib25BZnRlckNyZWF0ZWQiLCJvbkJlZm9yZUVuZCIsIm9uQmVmb3JlTm9kZUVudGVyIiwib25CZWZvcmVTZXNzaW9uVGltZW91dCIsIm9uIiwic3RhdGVJZCIsImV2ZW50IiwicmVsb2FkRmxvd3MiLCJfZ2V0T3JDcmVhdGVDb250ZXh0IiwiY29udGV4dCIsImdldFN0YXRlIiwic3RhdGUiLCJ0eXBlIiwiX3Byb2Nlc3NUaW1lb3V0IiwiaXNOaWwiLCJzZXRTdGF0ZSIsIm1zZyIsInRleHQiLCJzdWJzdHIiLCJfdHJhY2UiLCJjdXJyZW50RmxvdyIsIkVycm9yIiwiY2F0Y2hBbGxPblJlY2VpdmUiLCJfcHJvY2Vzc0luc3RydWN0aW9ucyIsImNhdGNoQWxsTmV4dCIsImkiLCJsZW5ndGgiLCJfZXZhbHVhdGVDb25kaXRpb24iLCJjb25kaXRpb24iLCJfcHJvY2Vzc05vZGUiLCJub2RlIiwiZm9yRWFjaCIsImVycm9ySGFuZGxlciIsImZsb3dOYW1lIiwibm9kZU5hbWUiLCJyZXNldFN0YXRlIiwiZmxvdyIsIl9maW5kRmxvdyIsIl9maW5kTm9kZSIsIl9zZXRDb250ZXh0Iiwic3RhcnROb2RlIiwiaGFzSnVtcGVkIiwiZmxvd1N0YWNrIiwibmFtZSIsIl9nZXRDb250ZXh0IiwiX2VuZEZsb3ciLCJsb2FkQWxsIiwicHJvY2Vzc29yIiwiaXNGdW5jdGlvbiIsInNlbmQiLCJpc1N0cmluZyIsImlkIiwicHJvdmlkZXIiLCJpbmNsdWRlcyIsImZuTWFwIiwib3ZlcndyaXRlIiwidG9SZWdpc3RlciIsImtleXMiLCJoYW5kbGVyIiwibWV0YWRhdGEiLCJpc09iamVjdCIsImV4dHJhIiwicmVnaXN0ZXJBY3Rpb25zIiwidmFsdWVzIiwiZmlsdGVyIiwiU3RyaW5nIiwieCIsInN0YXJ0c1dpdGgiLCJtYXAiLCJ1c2VyU3RhdGUiLCJiZWZvcmVDdHgiLCJQcm9taXNlIiwiZnJvbUNhbGxiYWNrIiwicnVuIiwiY2FsbGJhY2siLCJjdXJyZW50Tm9kZVRpbWVvdXQiLCJjdXJyZW50Rmxvd1RpbWVvdXQiLCJmYWxsYmFja1RpbWVvdXROb2RlIiwiZmFsbGJhY2tUaW1lb3V0RmxvdyIsInN3aXRjaGVkRmxvdyIsInN3aXRjaGVkTm9kZSIsIm9yaWdpbmFsRmxvdyIsIm9yaWdpbmFsTm9kZSIsInRlc3QiLCJfZ290b1N1YmZsb3ciLCJfZ290b1ByZXZpb3VzRmxvdyIsImVsIiwib25FbnRlciIsIm9uUmVjZWl2ZSIsIl90cmFuc2l0aW9uVG9OZXh0Tm9kZXMiLCJuZXh0Tm9kZXMiLCJuZXh0IiwiZGVsZXRlU3RhdGUiLCJhZnRlckN0eCIsIm1hdGNoIiwic3ViZmxvdyIsInN1YmZsb3dOb2RlIiwibGFzdCIsInBvcCIsImluc3RydWN0aW9ucyIsImlzQXJyYXkiLCJtYXBTZXJpZXMiLCJpbnN0cnVjdGlvbiIsImNodW5rcyIsInNwbGl0IiwicGFyYW1zIiwic2xpY2UiLCJqb2luIiwidHJhY2UiLCJfZGlzcGF0Y2hPdXRwdXQiLCJ2YWx1ZSIsIl9pbnZva2VBY3Rpb24iLCJvdXRwdXQiLCJtZXNzYWdlIiwib3JpZ2luYWxFdmVudCIsImZsb3dDb250ZXh0IiwiYXJncyIsImFyZ3NTdHIiLCJ0YWlsIiwiZmlyc3QiLCJKU09OIiwicGFyc2UiLCJtYXBWYWx1ZXMiLCJlbmRzV2l0aCIsImtleSIsInMiLCJlIiwiZnJlZXplIiwicmV0IiwiaXNGcm96ZW4iLCJ2bSIsIlZNIiwidGltZW91dCIsInRocm93SWZOb3RGb3VuZCIsImZpbmQiLCJyZXBsYWNlIiwib3BlcmF0aW9uIiwicmVhc29uIiwic3BjIiwicmVwZWF0Iiwibm9kZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7Ozs7Ozs7OztBQUVBLElBQU1BLGFBQWEsRUFBRUMsT0FBTyxpQkFBTSxDQUFFLENBQWpCLEVBQW5CO0FBQ0EsSUFBTUMsbUJBQW1CLGdDQUF6QixDLENBQTBEO0FBQzFELElBQU1DLGlCQUFpQixHQUF2Qjs7QUFFQTs7Ozs7Ozs7SUFPTUMsWTtBQUNKLDhCQUEwRTtBQUFBOztBQUFBLFFBQTVEQyxZQUE0RCxRQUE1REEsWUFBNEQ7QUFBQSxRQUE5Q0MsWUFBOEMsUUFBOUNBLFlBQThDO0FBQUEsUUFBaENDLE9BQWdDLFFBQWhDQSxPQUFnQztBQUFBLDJCQUF2QkMsTUFBdUI7QUFBQSxRQUF2QkEsTUFBdUIsK0JBQWRSLFVBQWM7O0FBQUE7O0FBQUEsU0EyVzFFUyxPQTNXMEUsR0EyV2hFO0FBQUEsYUFBTSxNQUFLQyxhQUFMLENBQW1CQyxJQUFuQixDQUF3QkMsRUFBeEIsQ0FBTjtBQUFBLEtBM1dnRTs7QUFDeEVDLFdBQU9DLE1BQVAsQ0FBYyxJQUFkLEVBQW9CLEVBQUVOLGNBQUYsRUFBVUgsMEJBQVYsRUFBd0JDLDBCQUF4QixFQUFwQjs7QUFFQSxTQUFLUyxXQUFMLEdBQW1CLEtBQW5CO0FBQ0EsU0FBS0MsS0FBTCxHQUFhLEVBQWI7QUFDQSxTQUFLQyxXQUFMLEdBQW1CQyxpQkFBRUMsR0FBRixDQUFNWixPQUFOLEVBQWUsYUFBZixLQUFpQyxnQkFBcEQ7QUFDQSxTQUFLYSxnQkFBTCxHQUF3QixFQUF4QjtBQUNBLFNBQUtWLGFBQUwsR0FBcUIsRUFBckI7QUFDQSxTQUFLVyxPQUFMLEdBQWUsRUFB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SixNQUFGLENBQVMsR0FBVCxFQUFjLEtBQUt2RyxLQUFLVixNQUFWLEdBQW1CSSxLQUFLSixNQUF0QyxDQUFaOztBQUVBLFVBQU1WLG9CQUFrQm9CLElBQWxCLFdBQTRCTixJQUE1QixVQUFxQzRHLEdBQXJDLFNBQTRDRixTQUE1QyxVQUEwREMsTUFBMUQsWUFBdUV4QixPQUE3RTs7QUFFQSxXQUFLakksTUFBTCxDQUFZUCxLQUFaLENBQWtCdUMsR0FBbEI7QUFDRDs7OzhCQWxEZ0JvQixJLEVBQU1GLFEsRUFBbUM7QUFBQSxVQUF6Qm1HLGVBQXlCLHVFQUFQLEtBQU87O0FBQ3hELFVBQUlBLG1CQUFtQjNJLGlCQUFFb0IsS0FBRixDQUFRc0IsSUFBUixDQUF2QixFQUFzQztBQUNwQyxjQUFNLElBQUlmLEtBQUosMEJBQWlDYSxRQUFqQyw4Q0FBTjtBQUNEOztBQUVELFVBQU1KLE9BQU9wQyxpQkFBRTRJLElBQUYsQ0FBT2xHLEtBQUt3RyxLQUFaLEVBQW1CLEVBQUVqRyxNQUFNVCxRQUFSLEVBQW5CLENBQWI7O0FBRUEsVUFBSW1HLG1CQUFtQjNJLGlCQUFFb0IsS0FBRixDQUFRb0IsUUFBUixDQUF2QixFQUEwQztBQUN4QyxjQUFNLElBQUliLEtBQUosMkJBQWtDYSxRQUFsQyxtQkFBd0RFLEtBQUtPLElBQTdELE9BQU47QUFDRDs7QUFFRCxhQUFPYixJQUFQO0FBQ0Q7Ozs7OztBQXlDSCtHLE9BQU9DLE9BQVAsR0FBaUJsSyxZQUFqQiIsImZpbGUiOiIuL3NyYy9kaWFsb2cvZW5naW5lLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgeyBWTSB9IGZyb20gJ3ZtMidcbmltcG9ydCBtd2FyZSBmcm9tICdtd2FyZSdcblxuY29uc3QgbG9nZ2VyU2hpbSA9IHsgZGVidWc6ICgpID0+IHt9IH1cbmNvbnN0IGNhbGxTdWJmbG93UmVnZXggPSAvKC4rXFwuZmxvd1xcLmpzb24pXFxzP0A/XFxzPyguKyk/L2kgLy8gZS5nLiAnLi9sb2dpbi5mbG93Lmpzb24nIG9yICcuL2xvZ2luLmZsb3cuanNvbiBAIHVzZXJuYW1lJ1xuY29uc3QgTUFYX1NUQUNLX1NJWkUgPSAxMDBcblxuLyoqIFRoZSBEaWFsb2cgRW5naW5lIChvciBEaWFsb2cgTWFuYWdlcikgaXMgdGhlIGNvbXBvbmVudCB0aGF0XG4gaGFuZGxlcyB0aGUgZmxvdyBsb2dpYy4gSXQgaXQgcmVzcG9uc2libGUgZm9yIGV4ZWN1dGluZyBmbG93cywgaW5jbHVkaW5nXG4gZXhlY3V0aW5nIHRoZSBhY3Rpb25zIGFuZCBmbG93aW5nIHRvIHRoZSBub2RlcywgcmVkaXJlY3Rpb25zIGV0Yy5cbiBAbmFtZXNwYWNlIERpYWxvZ0VuZ2luZVxuIEBleGFtcGxlXG4gYnAuZGlhbG9nRW5naW5lLnByb2Nlc3NNZXNzYWdlKC4uLilcbiAqL1xuY2xhc3MgRGlhbG9nRW5naW5lIHtcbiAgY29uc3RydWN0b3IoeyBmbG93UHJvdmlkZXIsIHN0YXRlTWFuYWdlciwgb3B0aW9ucywgbG9nZ2VyID0gbG9nZ2VyU2hpbSB9KSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7IGxvZ2dlciwgZmxvd1Byb3ZpZGVyLCBzdGF0ZU1hbmFnZXIgfSlcblxuICAgIHRoaXMuZmxvd3NMb2FkZWQgPSBmYWxzZVxuICAgIHRoaXMuZmxvd3MgPSBbXVxuICAgIHRoaXMuZGVmYXVsdEZsb3cgPSBfLmdldChvcHRpb25zLCAnZGVmYXVsdEZsb3cnKSB8fCAnbWFpbi5mbG93Lmpzb24nXG4gICAgdGhpcy5vdXRwdXRQcm9jZXNzb3JzID0gW11cbiAgICB0aGlzLmVycm9ySGFuZGxlcnMgPSBbXVxuICAgIHRoaXMuYWN0aW9ucyA9IHt9XG4gICAgdGhpcy5hY3Rpb25NZXRhZGF0YVByb3ZpZGVycyA9IFtdXG5cbiAgICAvKipcbiAgICAgKiBAdHlwZWRlZiB7RnVuY3Rpb259IERpYWxvZ0VuZ2luZX5EaWFsb2dNaWRkbGV3YXJlXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGN0eCBBIG11dGFibGUgY29udGV4dCBvYmplY3RcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBuZXh0IENhbGwgdGhpcyB0byBjb250aW51ZSBwcm9jZXNzaW5nXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBNaWRkbGV3YXJlIHRyaWdnZXJlZCBiZWZvcmUgYSBuZXcgc2Vzc2lvbiBpcyBzdGFydGVkLlxuICAgICAqID4gKipOb3RlOioqIFRoaXMgbWlkZGxld2FyZSBhbGxvd3MgeW91IHRvIGFsdGVyIGBjdHguZmxvd05hbWVgIHRvIGNoYW5nZVxuICAgICAqID4gd2hpY2ggZmxvdyB3aWxsIGJlIHNlbGVjdGVkIHRvIHN0YXJ0IHRoZSBjb252ZXJzYXRpb24uXG4gICAgICogQGZ1bmN0aW9uIERpYWxvZ0VuZ2luZSNvbkJlZm9yZUNyZWF0ZWRcbiAgICAgKiBAcGFyYW0ge0RpYWxvZ0VuZ2luZX5EaWFsb2dNaWRkbGV3YXJlfSBtaWRkbGV3YXJlXG4gICAgICogQGV4YW1wbGVcbmJwLmRpYWxvZ0VuZ2luZS5vbkJlZm9yZUNyZWF0ZWQoKGN0eCwgbmV4dCkgPT4ge1xuICBjdHguZmxvd05hbWUgPSAnZXhhbXBsZS5mbG93Lmpzb24nXG4gIG5leHQoKVxufSlcbiAgICAgKi9cbiAgICB0aGlzLm9uQmVmb3JlQ3JlYXRlZCA9IG13YXJlKClcblxuICAgIC8qKlxuICAgICAqIE1pZGRsZXdhcmUgdHJpZ2dlcmVkICoqYWZ0ZXIqKiBhIG5ldyBzZXNzaW9uIGlzIHN0YXJ0ZWQuXG4gICAgICogYGN0eGAgaXMgbm90IG11dGFibGUuXG4gICAgICogQGZ1bmN0aW9uIERpYWxvZ0VuZ2luZSNvbkFmdGVyQ3JlYXRlZFxuICAgICAqIEBwYXJhbSB7RGlhbG9nRW5naW5lfkRpYWxvZ01pZGRsZXdhcmV9IG1pZGRsZXdhcmVcbiAgICAgKiBAZXhhbXBsZVxuYnAuZGlhbG9nRW5naW5lLm9uQWZ0ZXJDcmVhdGVkKChjdHgsIG5leHQpID0+IHtcbiAgLy8gRG8gc29tZXRoaW5nIGhlcmVcbiAgbmV4dCgpXG59KVxuICAgICAqL1xuICAgIHRoaXMub25BZnRlckNyZWF0ZWQgPSBtd2FyZSgpXG5cbiAgICAvKipcbiAgICAgKiBNaWRkbGV3YXJlIHRyaWdnZXJlZCAqKmJlZm9yZSoqIGEgY29udmVyc2F0aW9uIGlzIGVuZGVkIGZvciBhbnkgcmVhc29uLlxuICAgICAqIGBjdHhgIGlzIG5vdCBtdXRhYmxlLlxuICAgICAqIEBmdW5jdGlvbiBEaWFsb2dFbmdpbmUjb25CZWZvcmVFbmRcbiAgICAgKiBAcGFyYW0ge0RpYWxvZ0VuZ2luZX5EaWFsb2dNaWRkbGV3YXJlfSBtaWRkbGV3YXJlXG4gICAgICogQGV4YW1wbGVcbmJwLmRpYWxvZ0VuZ2luZS5vbkJlZm9yZUVuZCgoY3R4LCBuZXh0KSA9PiB7XG4gIC8vIERvIHNvbWV0aGluZyBoZXJlXG4gIG5leHQoKVxufSlcbiAgICAgKi9cbiAgICB0aGlzLm9uQmVmb3JlRW5kID0gbXdhcmUoKVxuXG4gICAgLyoqXG4gICAgICogTWlkZGxld2FyZSB0cmlnZ2VyZWQgKipiZWZvcmUqKiBhIG5vZGUgaXMgZW50ZXJlZCAoYmVmb3JlIHRoZSBgb25FbnRlcmAgZXhlY3V0aW9uKS5cbiAgICAgKiA+ICoq4pqg77iPIFdhcm46KiogSXQgaXMgKipub3QqKiByZWNvbW1lbmRlZCB0byBtdXRhdGUgYGN0eC5ub2RlYCBmb3Igbm93LCBpdCBtaWdodCBicmVhayBpbiBhIGZ1dHVyZSB2ZXJzaW9uIG9mIEJvdHByZXNzLlxuICAgICAqIEBmdW5jdGlvbiBEaWFsb2dFbmdpbmUjb25CZWZvcmVOb2RlRW50ZXJcbiAgICAgKiBAcGFyYW0ge0RpYWxvZ0VuZ2luZX5EaWFsb2dNaWRkbGV3YXJlfSBtaWRkbGV3YXJlXG4gICAgICogQGV4YW1wbGVcbmJwLmRpYWxvZ0VuZ2luZS5vbkJlZm9yZU5vZGVFbnRlcigoY3R4LCBuZXh0KSA9PiB7XG4gIC8vIERvIHNvbWV0aGluZyBoZXJlXG4gIG5leHQoKVxufSlcbiAgICAgKi9cbiAgICB0aGlzLm9uQmVmb3JlTm9kZUVudGVyID0gbXdhcmUoKVxuXG4gICAgLyoqXG4gICAgICogTWlkZGxld2FyZSB0cmlnZ2VyZWQgKipiZWZvcmUqKiBhIGNvbnZlcnNhdGlvbi9zZXNzaW9uIHRpbWVzIG91dC5cbiAgICAgKiA+ICoqTm90ZToqKiBZb3UgY2FuJ3QgcHJldmVudCBpdCBmcm9tIHRpbWluZyBvdXQgYXQgdGhpcyBwb2ludC5cbiAgICAgKiA+IFlvdSBhbHNvIGNhbid0IGNoYW5nZSB0aGUgdGltZW91dCBiZWhhdmlvci9sb2NhdGlvbiBhdCB0aGlzIHRpbWUuXG4gICAgICogQGZ1bmN0aW9uIERpYWxvZ0VuZ2luZSNvbkJlZm9yZVNlc3Npb25UaW1lb3V0XG4gICAgICogQHBhcmFtIHtEaWFsb2dFbmdpbmV+RGlhbG9nTWlkZGxld2FyZX0gbWlkZGxld2FyZVxuICAgICAqIEBleGFtcGxlXG5icC5kaWFsb2dFbmdpbmUub25CZWZvcmVTZXNzaW9uVGltZW91dCgoY3R4LCBuZXh0KSA9PiB7XG4gIC8vIERvIHNvbWV0aGluZyBoZXJlXG4gIG5leHQoKVxufSlcbiAgICAgKi9cbiAgICB0aGlzLm9uQmVmb3JlU2Vzc2lvblRpbWVvdXQgPSBtd2FyZSgpXG5cbiAgICBmbG93UHJvdmlkZXIub24oJ2Zsb3dzQ2hhbmdlZCcsICgpID0+IE9iamVjdC5hc3NpZ24odGhpcywgeyBmbG93czogW10sIGZsb3dzTG9hZGVkOiBmYWxzZSB9KSlcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIGEgbmV3IGluY29taW5nIG1lc3NhZ2UgZnJvbSB0aGUgdXNlci5cbiAgICogVGhpcyB3aWxsIGV4ZWN1dGUgYW5kIHJ1biB0aGUgZmxvdyB1bnRpbCB0aGUgZmxvdyBlbmRzIG9yIGdldHMgcGF1c2VkIGJ5IHVzZXIgaW5wdXRcbiAgICogQHBhcmFtICB7c3RyaW5nfSBzdGF0ZUlkIFRoZSBJZCBvZiB0aGUgc3RhdGUuXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICBUaGlzIGlzIHVzdWFsbHkgdW5pcXVlIHBlciB1c2VyL2dyb3VwL2NoYW5uZWwsIGRlcGVuZGluZyBvbiB0aGUgcGxhdGZvcm0uXG4gICAqIEBwYXJhbSAge0JQSW5jb21pbmdFdmVudH0gZXZlbnQgICBUaGUgaW5jb21pbmcgZXZlbnQgKG1lc3NhZ2UpXG4gICAqIEByZXR1cm4ge1Byb21pc2U8U3RhdGU+fSAgICAgICAgIFJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbmV3IHN0YXRlXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIGZsb3cgaXMgZG9uZSBwcm9jZXNzaW5nXG4gICAqL1xuICBhc3luYyBwcm9jZXNzTWVzc2FnZShzdGF0ZUlkLCBldmVudCkge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIXRoaXMuZmxvd3NMb2FkZWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWxvYWRGbG93cygpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLl9nZXRPckNyZWF0ZUNvbnRleHQoc3RhdGVJZClcbiAgICAgIGxldCBzdGF0ZSA9IGF3YWl0IHRoaXMuc3RhdGVNYW5hZ2VyLmdldFN0YXRlKHN0YXRlSWQpXG5cbiAgICAgIGlmIChldmVudC50eXBlID09PSAnYnBfZGlhbG9nX3RpbWVvdXQnKSB7XG4gICAgICAgIHN0YXRlID0gYXdhaXQgdGhpcy5fcHJvY2Vzc1RpbWVvdXQoc3RhdGVJZCwgc3RhdGUsIGNvbnRleHQsIGV2ZW50KVxuXG4gICAgICAgIGlmICghXy5pc05pbChzdGF0ZSkpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnN0YXRlTWFuYWdlci5zZXRTdGF0ZShzdGF0ZUlkLCBzdGF0ZSlcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdGF0ZVxuICAgICAgfVxuXG4gICAgICBjb25zdCBtc2cgPSAoZXZlbnQudGV4dCB8fCAnJykuc3Vic3RyKDAsIDIwKVxuICAgICAgdGhpcy5fdHJhY2UoJzx+JywgJ1JFQ1YnLCBgXCIke21zZ31cImAsIGNvbnRleHQsIHN0YXRlKVxuXG4gICAgICBpZiAoIWNvbnRleHQuY3VycmVudEZsb3cpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBjdXJyZW50RmxvdyB0byBiZSBkZWZpbmVkIGZvciBzdGF0ZUlkPScgKyBzdGF0ZUlkKVxuICAgICAgfVxuXG4gICAgICBjb25zdCBjYXRjaEFsbE9uUmVjZWl2ZSA9IF8uZ2V0KGNvbnRleHQsICdjdXJyZW50Rmxvdy5jYXRjaEFsbC5vblJlY2VpdmUnKVxuXG4gICAgICBpZiAoY2F0Y2hBbGxPblJlY2VpdmUpIHtcbiAgICAgICAgdGhpcy5fdHJhY2UoJyEhJywgJ0tBTEwnLCAnJywgY29udGV4dCwgc3RhdGUpXG4gICAgICAgIHN0YXRlID0gYXdhaXQgdGhpcy5fcHJvY2Vzc0luc3RydWN0aW9ucyhjYXRjaEFsbE9uUmVjZWl2ZSwgc3RhdGUsIGV2ZW50LCBjb250ZXh0KVxuICAgICAgfVxuXG4gICAgICAvLyBJZiB0aGVyZSdzIGEgJ25leHQnIGRlZmluZWQgaW4gY2F0Y2hBbGwsIHRoaXMgd2lsbCB0cnkgdG8gbWF0Y2ggYW55IGNvbmRpdGlvbiBhbmQgaWYgaXQgaXMgbWF0Y2hlZCBpdFxuICAgICAgLy8gd2lsbCBydW4gdGhlIG5vZGUgZGVmaW5lZCBpbiB0aGUgbmV4dCBpbnN0ZWFkIG9mIHRoZSBjdXJyZW50IGNvbnRleHQgbm9kZVxuICAgICAgY29uc3QgY2F0Y2hBbGxOZXh0ID0gXy5nZXQoY29udGV4dCwgJ2N1cnJlbnRGbG93LmNhdGNoQWxsLm5leHQnKVxuICAgICAgaWYgKGNhdGNoQWxsTmV4dCkge1xuICAgICAgICB0aGlzLl90cmFjZSgnLi4nLCAnS0FMTCcsICcnLCBjb250ZXh0LCBzdGF0ZSlcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYXRjaEFsbE5leHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoYXdhaXQgdGhpcy5fZXZhbHVhdGVDb25kaXRpb24oY2F0Y2hBbGxOZXh0W2ldLmNvbmRpdGlvbiwgc3RhdGUsIGV2ZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb2Nlc3NOb2RlKHN0YXRlSWQsIHN0YXRlLCBjb250ZXh0LCBjYXRjaEFsbE5leHRbaV0ubm9kZSwgZXZlbnQpXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdHJhY2UoJz9YJywgJ0tBTEwnLCAnJywgY29udGV4dCwgc3RhdGUpXG4gICAgICB9XG5cbiAgICAgIHN0YXRlID0gYXdhaXQgdGhpcy5fcHJvY2Vzc05vZGUoc3RhdGVJZCwgc3RhdGUsIGNvbnRleHQsIGNvbnRleHQubm9kZSwgZXZlbnQpXG5cbiAgICAgIGlmICghXy5pc05pbChzdGF0ZSkpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zdGF0ZU1hbmFnZXIuc2V0U3RhdGUoc3RhdGVJZCwgc3RhdGUpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdGF0ZVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRoaXMuZXJyb3JIYW5kbGVycy5mb3JFYWNoKGVycm9ySGFuZGxlciA9PiBlcnJvckhhbmRsZXIoZSkpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1ha2UgdGhlIHN0YXRlSWQganVtcCB0byB0aGUgc3BlY2lmaWVkIGZsb3cgYW5kIG5vZGVcbiAgICogcmVnYXJkbGVzcyBvZiBpZiB0aGVyZSB3YXMgYWxyZWFkeSBhbiBhY3RpdmUgZmxvdyBvciBub3RcbiAgICogaW4gZXhlY3V0aW9uLiBJZiB0aGVyZSB3YXMgYWxyZWFkeSBhbiBhY3RpdmUgZmxvdyBleGVjdXRpbmcsXG4gICAqIHRoaXMgd2lsbCBvdmVycmlkZSBpdC4gTm90ZSB0aGF0IGJ5IGRlZmF1bHQsIHRoZSBjdXJyZW50IHN0YXRlXG4gICAqIHdpbGwgYmUgcHJlc2VydmVkOyBpZiB5b3Ugd2lzaCB0byByZXNldCB0aGUgc3RhdGUgYXMgd2VsbCxcbiAgICogc2V0IGByZXNldFN0YXRlYCB0byBgdHJ1ZWAuXG4gICAqIE5vdGUgdGhhdCB0aGlzIHdpbGwgbm90IGNvbnRpbnVlIHByb2Nlc3NpbmcsIGkuZS4gdGhlIHVzZXIgbXVzdCBzZW5kIGEgbWVzc2FnZSBvclxuICAgKiB5b3Ugc2hvdWxkIGNhbGwge0BsaW5rIEJvdEVuZ2luZSNwcm9jZXNzTWVzc2FnZX0gbWFudWFsbHkgdG8gY29udGludWUgZXhlY3V0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKiAvLyBpbnNpZGUgYSBicC5oZWFyICguLi4pXG4gICAqIGJwLmRpYWxvZ0VuZ2luZS5qdW1wVG8oc3RhdGVJZCwgJ21haW4uZmxvdy5qc29uJylcbiAgICogYnAuZGlhbG9nRW5naW5lLnByb2Nlc3NNZXNzYWdlKHN0YXRlSWQsIGV2ZW50KSAvLyBDb250aW51ZSBwcm9jZXNzaW5nXG4gICAqIEBwYXJhbSAge3N0cmluZ30gc3RhdGVJZCAgVGhlIHN0YXRlSWQgb2YgdGhlIHVzZXIvY2hhbm5lbC9ncm91cCB0byBtYWtlIGp1bXAuXG4gICAqIEBwYXJhbSAge3N0cmluZ30gZmxvd05hbWUgVGhlIG5hbWUgb2YgdGhlIGZsb3csIGUuZy4gYG1haW4uZmxvdy5qc29uYFxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IFtub2RlTmFtZT1udWxsXSBUaGUgbmFtZSBvZiB0aGUgbm9kZSB0byBqdW1wIHRvLiBEZWZhdWx0cyB0byB0aGUgZmxvdydzIGVudHJ5IHBvaW50LlxuICAgKiBAcGFyYW0gIHtib29sZWFufSBbb3B0aW9ucy5yZXNldFN0YXRlPWZhbHNlXSBXaGV0aGVyIG9yIG5vdCB0aGUgc3RhdGUgc2hvdWxkIGJlIHJlc2V0XG4gICAqL1xuICBhc3luYyBqdW1wVG8oc3RhdGVJZCwgZmxvd05hbWUsIG5vZGVOYW1lID0gbnVsbCwgb3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKFxuICAgICAge1xuICAgICAgICByZXNldFN0YXRlOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIG9wdGlvbnNcbiAgICApXG5cbiAgICBpZiAoIXRoaXMuZmxvd3NMb2FkZWQpIHtcbiAgICAgIGF3YWl0IHRoaXMucmVsb2FkRmxvd3MoKVxuICAgIH1cblxuICAgIGNvbnN0IGZsb3cgPSB0aGlzLl9maW5kRmxvdyhmbG93TmFtZSwgdHJ1ZSlcblxuICAgIGlmIChub2RlTmFtZSkge1xuICAgICAgLy8gV2UncmUganVzdCBjYWxsaW5nIGZvciB0aHJvd2luZyBpZiBkb2Vzbid0IGV4aXN0XG4gICAgICBEaWFsb2dFbmdpbmUuX2ZpbmROb2RlKGZsb3csIG5vZGVOYW1lLCB0cnVlKVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuX3NldENvbnRleHQoc3RhdGVJZCwge1xuICAgICAgY3VycmVudEZsb3c6IGZsb3csXG4gICAgICBub2RlOiBub2RlTmFtZSB8fCBmbG93LnN0YXJ0Tm9kZSxcbiAgICAgIGhhc0p1bXBlZDogdHJ1ZSxcbiAgICAgIGZsb3dTdGFjazogW3sgZmxvdzogZmxvdy5uYW1lLCBub2RlOiBub2RlTmFtZSB8fCBmbG93LnN0YXJ0Tm9kZSB9XVxuICAgIH0pXG5cbiAgICBpZiAob3B0aW9ucy5yZXNldFN0YXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLnN0YXRlTWFuYWdlci5zZXRTdGF0ZShzdGF0ZUlkLCB7fSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IGZsb3cgYW5kIG5vZGUgZm9yIGEgc3BlY2lmaWMgc3RhdGVJZFxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IHN0YXRlSWRcbiAgICogQHJldHVybiB7eyBmbG93OiBzdHJpbmcsIG5vZGU6IHN0cmluZyB9fSBSZXR1cm5zIHRoZSBjdXJyZW50IGZsb3cgYW5kIG5vZGVcbiAgICovXG4gIGFzeW5jIGdldEN1cnJlbnRQb3NpdGlvbihzdGF0ZUlkKSB7XG4gICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuX2dldENvbnRleHQoc3RhdGVJZClcblxuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmbG93OiBjb250ZXh0LmN1cnJlbnRGbG93ICYmIGNvbnRleHQuY3VycmVudEZsb3cubmFtZSxcbiAgICAgICAgbm9kZTogY29udGV4dC5ub2RlXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGZsb3c6IG51bGwsXG4gICAgICBub2RlOiBudWxsXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVuZHMgdGhlIGZsb3cgZm9yIGEgc3BlY2lmaWMgc3RhdGVJZCBpZiB0aGVyZSdzIGFuIGFjdGl2ZSBmbG93LFxuICAgKiBvdGhlcndpc2UgZG9lcyBub3RoaW5nLlxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IHN0YXRlSWQgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgYXN5bmMgZW5kRmxvdyhzdGF0ZUlkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2VuZEZsb3coc3RhdGVJZClcbiAgfVxuXG4gIGFzeW5jIHJlbG9hZEZsb3dzKCkge1xuICAgIHRoaXMuX3RyYWNlKCcqKicsICdMT0FEJywgJycpXG4gICAgdGhpcy5mbG93cyA9IGF3YWl0IHRoaXMuZmxvd1Byb3ZpZGVyLmxvYWRBbGwoKVxuICAgIHRoaXMuZmxvd3NMb2FkZWQgPSB0cnVlXG4gIH1cblxuICBhc3luYyBnZXRGbG93cygpIHtcbiAgICBpZiAoIXRoaXMuZmxvd3NMb2FkZWQpIHtcbiAgICAgIGF3YWl0IHRoaXMucmVsb2FkRmxvd3MoKVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmZsb3dzXG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgbmV3IG91dHB1dCBwcm9jZXNzb3IgKHRoZXJlIGNhbiBiZSBtYW55LCB3aGljaCBhbGwgZ2V0IHRyaWdnZXJlZCBvbiBvdXRwdXQpLlxuICAgKiBAcGFyYW0ge091dHBvdXRQcm9jZXNzb3J9IHByb2Nlc3NvciAtIElzIGFuIG9iamVjdCB3aXRoIHtpZCwgc2VuZH1cbiAgICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3Nvci5pZCAtIFRoZSB1bmlxdWUgaWQgb2YgdGhlIHByb2Nlc3NvclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcm9jZXNzb3Iuc2VuZCAtIFRoZSBgc2VuZGAgZnVuY3Rpb24gb2YgdGhlIHByb2Nlc3NvclxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlZ2lzdGVyT3V0cHV0UHJvY2Vzc29yKHByb2Nlc3Nvcikge1xuICAgIGlmIChfLmlzTmlsKHByb2Nlc3NvcikgfHwgIV8uaXNGdW5jdGlvbihwcm9jZXNzb3Iuc2VuZCkgfHwgIV8uaXNTdHJpbmcocHJvY2Vzc29yLmlkKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHByb2Nlc3Nvci4gUHJvY2Vzc29yIG11c3QgaGF2ZSBhIGZ1bmN0aW9uIGBzZW5kYCBkZWZpbmVkIGFuZCBhIHZhbGlkIGBpZGAnKVxuICAgIH1cblxuICAgIC8vIEZvciBub3cgd2Ugb25seSBldmVyIHN1cHBvcnQgYSBzaW5nbGUgb3V0cHV0IHByb2Nlc3NvclxuICAgIC8vIFdlIG1pZ2h0IHdhbnQgbWFueSBvdXRwdXQgcHJvY2Vzc29ycyBpbiB0aGUgZnV0dXJlLCBmb3IgZXhhbXBsZSB0byBob29rIHVwIGEgZGVidWdnZXIgb3IgYSB0ZXN0IHN1aXRlXG4gICAgdGhpcy5vdXRwdXRQcm9jZXNzb3JzID0gW3Byb2Nlc3Nvcl1cbiAgfVxuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBEaWFsb2dFbmdpbmV+QWN0aW9uTWV0YWRhdGFcbiAgICogQHZhciB7c3RyaW5nfSB0aXRsZVxuICAgKiBAdmFyIHtzdHJpbmd9IGRlc2NyaXB0aW9uXG4gICAqIEB2YXIge2Jvb2xlYW59IHJlcXVpcmVkXG4gICAqIEB2YXIge3N0cmluZ30gZGVmYXVsdFxuICAgKiBAdmFyIHtzdHJpbmd9IHR5cGVcbiAgICogQHByaXZhdGVcbiAgICovXG5cbiAgLyoqXG4gICAqIEEgbWV0YWRhdGEgcHJvdmlkZXIgcmV0dXJucyBtZXRhZGF0YSBmb3IgYW4gYWN0aW9uIG9yXG4gICAqIHJldHVybnMgbnVsbCwgaW4gd2hpY2ggY2FzZSBvdGhlciBwcm92aWRlcnMgd2lsbCBiZSBjYWxsZWRcbiAgICogQHR5cGVkZWYge0Z1bmN0aW9ufSBEaWFsb2dFbmdpbmV+TWV0YWRhdGFQcm92aWRlclxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uIFRoZSBuYW1lIG9mIHRoZSBhY3Rpb25cbiAgICogQHJldHVybnMge0RpYWxvZ0VuZ2luZX5BY3Rpb25NZXRhZGF0YX1cbiAgICogQHByaXZhdGVcbiAgICovXG5cbiAgLyoqXG4gICAqIEFkZHMgYSBuZXcgcHJvdmlkZXIgb2YgZnVuY3Rpb24gbWV0YWRhdGFcbiAgICogQHBhcmFtIHtEaWFsb2dFbmdpbmV+TWV0YWRhdGFQcm92aWRlcn0gcHJvdmlkZXJcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICByZWdpc3RlckFjdGlvbk1ldGFkYXRhUHJvdmlkZXIocHJvdmlkZXIpIHtcbiAgICBpZiAoIV8uaXNGdW5jdGlvbihwcm92aWRlcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdGhlIGZ1bmN0aW9uIG1ldGFkYXRhIHByb3ZpZGVyIHRvIGJlIGEgZnVuY3Rpb24nKVxuICAgIH1cblxuICAgIGlmICghXy5pbmNsdWRlcyh0aGlzLmFjdGlvbk1ldGFkYXRhUHJvdmlkZXJzLCBwcm92aWRlcikpIHtcbiAgICAgIHRoaXMuYWN0aW9uTWV0YWRhdGFQcm92aWRlcnMucHVzaChwcm92aWRlcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW50cm9kdWNlIG5ldyBhY3Rpb25zIHRvIHRoZSBGbG93cyB0aGF0IHRoZXkgY2FuIGNhbGwuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBmbk1hcFxuICAgKiBAcGFyYW0ge2Jvb2x9IFtvdmVyd3JpdGU9ZmFsc2VdIC0gV2hldGhlciBvciBub3QgaXQgc2hvdWxkIG92ZXJ3cml0ZSBleGlzdGluZyBhY3Rpb25zIHdpdGggdGhlIHNhbWUgbmFtZS5cbiAgICogTm90ZSB0aGF0IGlmIG92ZXJ3cml0ZSBpcyBmYWxzZSwgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd24gb24gY29uZmxpY3QuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlLjx2b2lkPn1cbiAgICovXG4gIGFzeW5jIHJlZ2lzdGVyQWN0aW9ucyhmbk1hcCwgb3ZlcndyaXRlID0gZmFsc2UpIHtcbiAgICBjb25zdCB0b1JlZ2lzdGVyID0ge31cbiAgICBfLmtleXMoZm5NYXApLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICBpZiAodGhpcy5hY3Rpb25zW25hbWVdICYmICFvdmVyd3JpdGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGVyZSBpcyBhbHJlYWR5IGEgZnVuY3Rpb24gbmFtZWQgXCIke25hbWV9XCIgcmVnaXN0ZXJlZGApXG4gICAgICB9XG5cbiAgICAgIGxldCBoYW5kbGVyID0gZm5NYXBbbmFtZV1cbiAgICAgIGxldCBtZXRhZGF0YSA9IG51bGxcblxuICAgICAgaWYgKCFfLmlzRnVuY3Rpb24oZm5NYXBbbmFtZV0pKSB7XG4gICAgICAgIGlmICghXy5pc09iamVjdChmbk1hcFtuYW1lXSkgfHwgIV8uaXNGdW5jdGlvbihmbk1hcFtuYW1lXS5oYW5kbGVyKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgZnVuY3Rpb24gXCIke25hbWV9XCIgdG8gYmUgYSBmdW5jdGlvbiBvciBhbiBvYmplY3Qgd2l0aCBhICdoYW5kZXInIGZ1bmN0aW9uYClcbiAgICAgICAgfVxuXG4gICAgICAgIGhhbmRsZXIgPSBmbk1hcFtuYW1lXS5oYW5kbGVyXG4gICAgICAgIG1ldGFkYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgZm5NYXBbbmFtZV0sIHsgbmFtZTogbmFtZSwgaGFuZGxlcjogbnVsbCB9KVxuICAgICAgfVxuXG4gICAgICBmb3IgKGNvbnN0IHByb3ZpZGVyIG9mIHRoaXMuYWN0aW9uTWV0YWRhdGFQcm92aWRlcnMpIHtcbiAgICAgICAgY29uc3QgZXh0cmEgPSBwcm92aWRlcihuYW1lKVxuXG4gICAgICAgIGlmIChleHRyYSkge1xuICAgICAgICAgIG1ldGFkYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgZXh0cmEsIG1ldGFkYXRhIHx8IHt9KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdG9SZWdpc3RlcltuYW1lXSA9IHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhLFxuICAgICAgICBmbjogaGFuZGxlclxuICAgICAgfVxuICAgIH0pXG5cbiAgICBPYmplY3QuYXNzaWduKHRoaXMuYWN0aW9ucywgdG9SZWdpc3RlcilcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCBVc2UgcmVnaXN0ZXJBY3Rpb25zKCkgaW5zdGVhZFxuICAgKi9cbiAgYXN5bmMgcmVnaXN0ZXJGdW5jdGlvbnMoZm5NYXAsIG92ZXJ3cml0ZSA9IGZhbHNlKSB7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJBY3Rpb25zKGZuTWFwLCBvdmVyd3JpdGUpXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbGwgdGhlIGF2YWlsYWJsZSBhY3Rpb25zIGFsb25nIHdpdGggdGhlaXIgbWV0YWRhdGFcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldEF2YWlsYWJsZUFjdGlvbnMoKSB7XG4gICAgcmV0dXJuIF8udmFsdWVzKHRoaXMuYWN0aW9ucylcbiAgICAgIC5maWx0ZXIoeCA9PiAhU3RyaW5nKHgubmFtZSkuc3RhcnRzV2l0aCgnX18nKSlcbiAgICAgIC5tYXAoeCA9PiBPYmplY3QuYXNzaWduKHt9LCB4LCB7IGZuOiBudWxsIH0pKVxuICB9XG5cbiAgb25FcnJvciA9IGZuID0+IHRoaXMuZXJyb3JIYW5kbGVycy5wdXNoKGZuKVxuXG4gIGFzeW5jIF9wcm9jZXNzVGltZW91dChzdGF0ZUlkLCB1c2VyU3RhdGUsIGNvbnRleHQsIGV2ZW50KSB7XG4gICAgY29uc3QgYmVmb3JlQ3R4ID0geyBzdGF0ZUlkIH1cbiAgICBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYWxsYmFjayA9PiB0aGlzLm9uQmVmb3JlU2Vzc2lvblRpbWVvdXQucnVuKGJlZm9yZUN0eCwgY2FsbGJhY2spKVxuXG4gICAgY29uc3QgY3VycmVudE5vZGVUaW1lb3V0ID0gXy5nZXQoRGlhbG9nRW5naW5lLl9maW5kTm9kZShjb250ZXh0LmN1cnJlbnRGbG93LCBjb250ZXh0Lm5vZGUpLCAndGltZW91dE5vZGUnKVxuICAgIGNvbnN0IGN1cnJlbnRGbG93VGltZW91dCA9IF8uZ2V0KGNvbnRleHQsICdjdXJyZW50Rmxvdy50aW1lb3V0Tm9kZScpXG4gICAgY29uc3QgZmFsbGJhY2tUaW1lb3V0Tm9kZSA9IERpYWxvZ0VuZ2luZS5fZmluZE5vZGUoY29udGV4dC5jdXJyZW50RmxvdywgJ3RpbWVvdXQnKVxuICAgIGNvbnN0IGZhbGxiYWNrVGltZW91dEZsb3cgPSB0aGlzLl9maW5kRmxvdygndGltZW91dC5mbG93Lmpzb24nKVxuXG4gICAgaWYgKGN1cnJlbnROb2RlVGltZW91dCkge1xuICAgICAgdGhpcy5fdHJhY2UoJzw+JywgJ1NOREUnLCAnJywgY29udGV4dClcbiAgICAgIHVzZXJTdGF0ZSA9IGF3YWl0IHRoaXMuX3Byb2Nlc3NOb2RlKHN0YXRlSWQsIHVzZXJTdGF0ZSwgY29udGV4dCwgY3VycmVudE5vZGVUaW1lb3V0LCBldmVudClcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRGbG93VGltZW91dCkge1xuICAgICAgdGhpcy5fdHJhY2UoJzw+JywgJ1NGTFcnLCAnJywgY29udGV4dClcbiAgICAgIHVzZXJTdGF0ZSA9IGF3YWl0IHRoaXMuX3Byb2Nlc3NOb2RlKHN0YXRlSWQsIHVzZXJTdGF0ZSwgY29udGV4dCwgY3VycmVudEZsb3dUaW1lb3V0LCBldmVudClcbiAgICB9IGVsc2UgaWYgKGZhbGxiYWNrVGltZW91dE5vZGUpIHtcbiAgICAgIHRoaXMuX3RyYWNlKCc8PicsICdETkRFJywgJycsIGNvbnRleHQpXG4gICAgICB1c2VyU3RhdGUgPSBhd2FpdCB0aGlzLl9wcm9jZXNzTm9kZShzdGF0ZUlkLCB1c2VyU3RhdGUsIGNvbnRleHQsIGZhbGxiYWNrVGltZW91dE5vZGUubmFtZSwgZXZlbnQpXG4gICAgfSBlbHNlIGlmIChmYWxsYmFja1RpbWVvdXRGbG93KSB7XG4gICAgICB0aGlzLl90cmFjZSgnPD4nLCAnREZMVycsICcnLCBjb250ZXh0KVxuICAgICAgdXNlclN0YXRlID0gYXdhaXQgdGhpcy5fcHJvY2Vzc05vZGUoc3RhdGVJZCwgdXNlclN0YXRlLCBjb250ZXh0LCBmYWxsYmFja1RpbWVvdXRGbG93Lm5hbWUsIGV2ZW50KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl90cmFjZSgnPD4nLCAnTlRIRycsICcnLCBjb250ZXh0KVxuICAgICAgdXNlclN0YXRlID0gYXdhaXQgdGhpcy5fZW5kRmxvdyhzdGF0ZUlkKVxuICAgIH1cblxuICAgIHJldHVybiB1c2VyU3RhdGVcbiAgfVxuXG4gIGFzeW5jIF9wcm9jZXNzTm9kZShzdGF0ZUlkLCB1c2VyU3RhdGUsIGNvbnRleHQsIG5vZGVOYW1lLCBldmVudCkge1xuICAgIGxldCBzd2l0Y2hlZEZsb3cgPSBmYWxzZVxuICAgIGxldCBzd2l0Y2hlZE5vZGUgPSBmYWxzZVxuXG4gICAgaWYgKGNvbnRleHQuaGFzSnVtcGVkKSB7XG4gICAgICBjb250ZXh0Lmhhc0p1bXBlZCA9IGZhbHNlXG4gICAgICBzd2l0Y2hlZE5vZGUgPSB0cnVlXG4gICAgfVxuXG4gICAgY29uc3Qgb3JpZ2luYWxGbG93ID0gY29udGV4dC5jdXJyZW50Rmxvdy5uYW1lXG4gICAgY29uc3Qgb3JpZ2luYWxOb2RlID0gY29udGV4dC5ub2RlXG5cbiAgICBpZiAoY2FsbFN1YmZsb3dSZWdleC50ZXN0KG5vZGVOYW1lKSkge1xuICAgICAgdGhpcy5fdHJhY2UoJz4+JywgJ0ZMT1cnLCBgXCIke25vZGVOYW1lfVwiYCwgY29udGV4dCwgbnVsbClcbiAgICAgIGNvbnRleHQgPSB0aGlzLl9nb3RvU3ViZmxvdyhub2RlTmFtZSwgY29udGV4dClcbiAgICAgIHN3aXRjaGVkRmxvdyA9IHRydWVcbiAgICB9IGVsc2UgaWYgKC9eIy8udGVzdChub2RlTmFtZSkpIHtcbiAgICAgIC8vIGUuZy4gJyNzdWNjZXNzJ1xuICAgICAgdGhpcy5fdHJhY2UoJzw8JywgJ0ZMT1cnLCBgXCIke25vZGVOYW1lfVwiYCwgY29udGV4dCwgbnVsbClcbiAgICAgIGNvbnRleHQgPSB0aGlzLl9nb3RvUHJldmlvdXNGbG93KG5vZGVOYW1lLCBjb250ZXh0KVxuICAgICAgc3dpdGNoZWRGbG93ID0gdHJ1ZVxuICAgIH0gZWxzZSBpZiAoY29udGV4dC5ub2RlICE9PSBub2RlTmFtZSkge1xuICAgICAgdGhpcy5fdHJhY2UoJz4+JywgJ0ZMT1cnLCBgXCIke25vZGVOYW1lfVwiYClcbiAgICAgIHN3aXRjaGVkTm9kZSA9IHRydWVcbiAgICAgIGNvbnRleHQubm9kZSA9IG5vZGVOYW1lXG4gICAgfSBlbHNlIGlmIChfLmlzTmlsKGNvbnRleHQubm9kZSkpIHtcbiAgICAgIC8vIFdlIGp1c3QgY3JlYXRlZCB0aGUgY29udGV4dFxuICAgICAgc3dpdGNoZWROb2RlID0gdHJ1ZVxuICAgICAgY29udGV4dC5ub2RlID0gY29udGV4dC5jdXJyZW50Rmxvdy5zdGFydE5vZGVcbiAgICB9XG5cbiAgICBjb25zdCBub2RlID0gRGlhbG9nRW5naW5lLl9maW5kTm9kZShjb250ZXh0LmN1cnJlbnRGbG93LCBjb250ZXh0Lm5vZGUpXG5cbiAgICBpZiAoIW5vZGUgfHwgIW5vZGUubmFtZSkge1xuICAgICAgdXNlclN0YXRlID0gYXdhaXQgdGhpcy5fZW5kRmxvdyhzdGF0ZUlkKVxuICAgICAgcmV0dXJuIHVzZXJTdGF0ZVxuICAgICAgLy8gVE9ETyBUcmFjZSBlcnJvclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBub2RlIFwiJHtjb250ZXh0Lm5vZGV9XCIgaW4gZmxvdyBcIiR7Y29udGV4dC5jdXJyZW50Rmxvdy5uYW1lfVwiYClcbiAgICB9XG5cbiAgICBpZiAoc3dpdGNoZWRGbG93IHx8IHN3aXRjaGVkTm9kZSkge1xuICAgICAgY29udGV4dC5mbG93U3RhY2sucHVzaCh7XG4gICAgICAgIGZsb3c6IGNvbnRleHQuY3VycmVudEZsb3cubmFtZSxcbiAgICAgICAgbm9kZTogY29udGV4dC5ub2RlXG4gICAgICB9KVxuXG4gICAgICAvLyBGbGF0dGVucyB0aGUgc3RhY2sgdG8gb25seSBpbmNsdWRlIGZsb3cganVtcHMsIG5vdCBub2RlIGp1bXBzXG4gICAgICBjb250ZXh0LmZsb3dTdGFjayA9IGNvbnRleHQuZmxvd1N0YWNrLmZpbHRlcigoZWwsIGkpID0+IHtcbiAgICAgICAgcmV0dXJuIGkgPT09IGNvbnRleHQuZmxvd1N0YWNrLmxlbmd0aCAtIDEgfHwgY29udGV4dC5mbG93U3RhY2tbaSArIDFdLmZsb3cgIT09IGVsLmZsb3dcbiAgICAgIH0pXG5cbiAgICAgIGlmIChjb250ZXh0LmZsb3dTdGFjay5sZW5ndGggPj0gTUFYX1NUQUNLX1NJWkUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIGBFeGNlZWRlZCBtYXhpbXVtIGZsb3cgc3RhY2sgc2l6ZSAoJHtNQVhfU1RBQ0tfU0laRX0pLlxuICAgICAgICAgVGhpcyBtaWdodCBiZSBkdWUgdG8gYW4gdW5leHBlY3RlZCBpbmZpbml0ZSBsb29wIGluIHlvdXIgZmxvd3MuXG4gICAgICAgICBDdXJyZW50IGZsb3c6ICR7Y29udGV4dC5jdXJyZW50Rmxvdy5uYW1lfVxuICAgICAgICAgQ3VycmVudCBub2RlOiAke2NvbnRleHQubm9kZX1gXG4gICAgICAgIClcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VuZEZsb3coc3RhdGVJZClcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5fc2V0Q29udGV4dChzdGF0ZUlkLCBjb250ZXh0KVxuXG4gICAgICBjb25zdCBiZWZvcmVDdHggPSB7IHN0YXRlSWQsIG5vZGUgfVxuICAgICAgYXdhaXQgUHJvbWlzZS5mcm9tQ2FsbGJhY2soY2FsbGJhY2sgPT4gdGhpcy5vbkJlZm9yZU5vZGVFbnRlci5ydW4oYmVmb3JlQ3R4LCBjYWxsYmFjaykpXG5cbiAgICAgIGlmIChub2RlLm9uRW50ZXIpIHtcbiAgICAgICAgdGhpcy5fdHJhY2UoJyEhJywgJ0VOVFInLCAnJywgY29udGV4dCwgdXNlclN0YXRlKVxuICAgICAgICB1c2VyU3RhdGUgPSBhd2FpdCB0aGlzLl9wcm9jZXNzSW5zdHJ1Y3Rpb25zKG5vZGUub25FbnRlciwgdXNlclN0YXRlLCBldmVudCwgY29udGV4dClcbiAgICAgIH1cblxuICAgICAgaWYgKCFub2RlLm9uUmVjZWl2ZSkge1xuICAgICAgICB0aGlzLl90cmFjZSgnLi4nLCAnTk9XVCcsICcnLCBjb250ZXh0LCB1c2VyU3RhdGUpXG5cbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ3NraWxsLWNhbGwnICYmIG9yaWdpbmFsRmxvdyAhPT0gbm9kZS5mbG93KSB7XG4gICAgICAgICAgdXNlclN0YXRlID0gYXdhaXQgdGhpcy5fcHJvY2Vzc05vZGUoc3RhdGVJZCwgdXNlclN0YXRlLCBjb250ZXh0LCBub2RlLmZsb3csIGV2ZW50KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVzZXJTdGF0ZSA9IGF3YWl0IHRoaXMuX3RyYW5zaXRpb25Ub05leHROb2Rlcyhub2RlLCBjb250ZXh0LCB1c2VyU3RhdGUsIHN0YXRlSWQsIGV2ZW50KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGkuZS4gd2Ugd2VyZSBhbHJlYWR5IG9uIHRoYXQgbm9kZSBiZWZvcmUgd2UgcmVjZWl2ZWQgdGhlIG1lc3NhZ2VcbiAgICAgIGlmIChub2RlLm9uUmVjZWl2ZSkge1xuICAgICAgICB0aGlzLl90cmFjZSgnISEnLCAnUkVDVicsICcnLCBjb250ZXh0LCB1c2VyU3RhdGUpXG4gICAgICAgIHVzZXJTdGF0ZSA9IGF3YWl0IHRoaXMuX3Byb2Nlc3NJbnN0cnVjdGlvbnMobm9kZS5vblJlY2VpdmUsIHVzZXJTdGF0ZSwgZXZlbnQsIGNvbnRleHQpXG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3RyYWNlKCcuLicsICdSRUNWJywgJycsIGNvbnRleHQsIHVzZXJTdGF0ZSlcblxuICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ3NraWxsLWNhbGwnICYmIG9yaWdpbmFsRmxvdyAhPT0gbm9kZS5mbG93KSB7XG4gICAgICAgIHVzZXJTdGF0ZSA9IGF3YWl0IHRoaXMuX3Byb2Nlc3NOb2RlKHN0YXRlSWQsIHVzZXJTdGF0ZSwgY29udGV4dCwgbm9kZS5mbG93LCBldmVudClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVzZXJTdGF0ZSA9IGF3YWl0IHRoaXMuX3RyYW5zaXRpb25Ub05leHROb2Rlcyhub2RlLCBjb250ZXh0LCB1c2VyU3RhdGUsIHN0YXRlSWQsIGV2ZW50KVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB1c2VyU3RhdGVcbiAgfVxuXG4gIGFzeW5jIF90cmFuc2l0aW9uVG9OZXh0Tm9kZXMobm9kZSwgY29udGV4dCwgdXNlclN0YXRlLCBzdGF0ZUlkLCBldmVudCkge1xuICAgIGNvbnN0IG5leHROb2RlcyA9IG5vZGUubmV4dCB8fCBbXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmV4dE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYXdhaXQgdGhpcy5fZXZhbHVhdGVDb25kaXRpb24obmV4dE5vZGVzW2ldLmNvbmRpdGlvbiwgdXNlclN0YXRlLCBldmVudCkpIHtcbiAgICAgICAgdGhpcy5fdHJhY2UoJz8/JywgJ01UQ0gnLCBgY29uZCA9IFwiJHtuZXh0Tm9kZXNbaV0uY29uZGl0aW9ufVwiYCwgY29udGV4dClcbiAgICAgICAgaWYgKC9eZW5kJC9pLnRlc3QobmV4dE5vZGVzW2ldLm5vZGUpKSB7XG4gICAgICAgICAgLy8gTm9kZSBcIkVORFwiIG9yIFwiZW5kXCIgZW5kcyB0aGUgZmxvdyAocmVzZXJ2ZWQga2V5d29yZClcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZW5kRmxvdyhzdGF0ZUlkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9wcm9jZXNzTm9kZShzdGF0ZUlkLCB1c2VyU3RhdGUsIGNvbnRleHQsIG5leHROb2Rlc1tpXS5ub2RlLCBldmVudClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghbmV4dE5vZGVzLmxlbmd0aCkge1xuICAgICAgLy8gWW91IHJlYWNoIHRoaXMgaWYgdGhlcmUgd2VyZSBubyBuZXh0IG5vZGVzLCBpbiB3aGljaCBjYXNlIHdlIGVuZCB0aGUgZmxvd1xuICAgICAgcmV0dXJuIHRoaXMuX2VuZEZsb3coc3RhdGVJZClcbiAgICB9XG5cbiAgICByZXR1cm4gdXNlclN0YXRlXG4gIH1cblxuICBhc3luYyBfZW5kRmxvdyhzdGF0ZUlkKSB7XG4gICAgY29uc3QgYmVmb3JlQ3R4ID0geyBzdGF0ZUlkIH1cbiAgICBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYWxsYmFjayA9PiB0aGlzLm9uQmVmb3JlRW5kLnJ1bihiZWZvcmVDdHgsIGNhbGxiYWNrKSlcblxuICAgIHRoaXMuX3RyYWNlKCctLScsICdFTkRGJywgJycsIG51bGwsIG51bGwpXG4gICAgYXdhaXQgdGhpcy5zdGF0ZU1hbmFnZXIuZGVsZXRlU3RhdGUoc3RhdGVJZCwgWydjb250ZXh0J10pXG5cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgYXN5bmMgX2dldE9yQ3JlYXRlQ29udGV4dChzdGF0ZUlkKSB7XG4gICAgbGV0IHN0YXRlID0gYXdhaXQgdGhpcy5fZ2V0Q29udGV4dChzdGF0ZUlkKVxuXG4gICAgaWYgKCFzdGF0ZSB8fCAhc3RhdGUuY3VycmVudEZsb3cpIHtcbiAgICAgIGNvbnN0IGJlZm9yZUN0eCA9IHsgc3RhdGVJZCwgZmxvd05hbWU6IHRoaXMuZGVmYXVsdEZsb3cgfVxuICAgICAgYXdhaXQgUHJvbWlzZS5mcm9tQ2FsbGJhY2soY2FsbGJhY2sgPT4gdGhpcy5vbkJlZm9yZUNyZWF0ZWQucnVuKGJlZm9yZUN0eCwgY2FsbGJhY2spKVxuXG4gICAgICBjb25zdCBmbG93ID0gdGhpcy5fZmluZEZsb3coYmVmb3JlQ3R4LmZsb3dOYW1lLCB0cnVlKVxuXG4gICAgICBpZiAoIWZsb3cpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCB0aGUgZGVmYXVsdCBmbG93IFwiJHt0aGlzLmRlZmF1bHRGbG93fVwiYClcbiAgICAgIH1cblxuICAgICAgc3RhdGUgPSB7XG4gICAgICAgIGN1cnJlbnRGbG93OiBmbG93LFxuICAgICAgICBmbG93U3RhY2s6IFt7IGZsb3c6IGZsb3cubmFtZSwgbm9kZTogZmxvdy5zdGFydE5vZGUgfV1cbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5fc2V0Q29udGV4dChzdGF0ZUlkLCBzdGF0ZSlcblxuICAgICAgY29uc3QgYWZ0ZXJDdHggPSB7IC4uLmJlZm9yZUN0eCB9XG4gICAgICBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYWxsYmFjayA9PiB0aGlzLm9uQWZ0ZXJDcmVhdGVkLnJ1bihhZnRlckN0eCwgY2FsbGJhY2spKVxuICAgIH1cblxuICAgIHJldHVybiBzdGF0ZVxuICB9XG5cbiAgX2dldENvbnRleHQoc3RhdGVJZCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlTWFuYWdlci5nZXRTdGF0ZShzdGF0ZUlkICsgJ19fX2NvbnRleHQnKVxuICB9XG5cbiAgX3NldENvbnRleHQoc3RhdGVJZCwgc3RhdGUpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZU1hbmFnZXIuc2V0U3RhdGUoc3RhdGVJZCArICdfX19jb250ZXh0Jywgc3RhdGUpXG4gIH1cblxuICBfZ290b1N1YmZsb3cobm9kZU5hbWUsIGNvbnRleHQpIHtcbiAgICBsZXQgWywgc3ViZmxvdywgc3ViZmxvd05vZGVdID0gbm9kZU5hbWUubWF0Y2goY2FsbFN1YmZsb3dSZWdleClcblxuICAgIGNvbnN0IGZsb3cgPSB0aGlzLl9maW5kRmxvdyhzdWJmbG93LCB0cnVlKVxuXG4gICAgaWYgKF8uaXNOaWwoc3ViZmxvd05vZGUpKSB7XG4gICAgICBzdWJmbG93Tm9kZSA9IGZsb3cuc3RhcnROb2RlXG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbihjb250ZXh0LCB7XG4gICAgICBjdXJyZW50RmxvdzogZmxvdyxcbiAgICAgIG5vZGU6IHN1YmZsb3dOb2RlXG4gICAgfSlcblxuICAgIHJldHVybiBjb250ZXh0XG4gIH1cblxuICBfZ290b1ByZXZpb3VzRmxvdyhub2RlTmFtZSwgY29udGV4dCkge1xuICAgIGlmICghY29udGV4dC5mbG93U3RhY2spIHtcbiAgICAgIGNvbnRleHQuZmxvd1N0YWNrID0gW11cbiAgICB9XG5cbiAgICB3aGlsZSAoY29udGV4dC5jdXJyZW50Rmxvdy5uYW1lID09PSBfLmdldChfLmxhc3QoY29udGV4dC5mbG93U3RhY2spLCAnZmxvdycpKSB7XG4gICAgICBjb250ZXh0LmZsb3dTdGFjay5wb3AoKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmZsb3dTdGFjay5sZW5ndGggPCAxKSB7XG4gICAgICB0aGlzLl90cmFjZSgnRmxvdyB0cmllZCB0byBnbyBiYWNrIHRvIHByZXZpb3VzIGZsb3cgYnV0IHRoZXJlIHdhcyBub25lLiBFeGl0aW5nIGZsb3cuJywgY29udGV4dCwgbnVsbClcbiAgICAgIC8vIFRPRE8gRU5EIEZMT1dcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IHsgZmxvdywgbm9kZSB9ID0gXy5sYXN0KGNvbnRleHQuZmxvd1N0YWNrKVxuXG4gICAgICBpZiAobm9kZU5hbWUgIT09ICcjJykge1xuICAgICAgICBub2RlID0gbm9kZU5hbWUuc3Vic3RyKDEpXG4gICAgICB9XG5cbiAgICAgIE9iamVjdC5hc3NpZ24oY29udGV4dCwge1xuICAgICAgICBjdXJyZW50RmxvdzogdGhpcy5fZmluZEZsb3coZmxvdywgdHJ1ZSksXG4gICAgICAgIG5vZGU6IG5vZGVcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbnRleHRcbiAgfVxuXG4gIGFzeW5jIF9wcm9jZXNzSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucywgdXNlclN0YXRlLCBldmVudCwgY29udGV4dCkge1xuICAgIGlmICghXy5pc0FycmF5KGluc3RydWN0aW9ucykpIHtcbiAgICAgIGluc3RydWN0aW9ucyA9IFtpbnN0cnVjdGlvbnNdXG4gICAgfVxuXG4gICAgYXdhaXQgUHJvbWlzZS5tYXBTZXJpZXMoaW5zdHJ1Y3Rpb25zLCBhc3luYyBpbnN0cnVjdGlvbiA9PiB7XG4gICAgICBpZiAoXy5pc1N0cmluZyhpbnN0cnVjdGlvbikgJiYgaW5zdHJ1Y3Rpb24uc3RhcnRzV2l0aCgnc2F5ICcpKSB7XG4gICAgICAgIGNvbnN0IGNodW5rcyA9IGluc3RydWN0aW9uLnNwbGl0KCcgJylcbiAgICAgICAgY29uc3QgcGFyYW1zID0gXy5zbGljZShjaHVua3MsIDIpLmpvaW4oJyAnKVxuXG4gICAgICAgIGlmIChjaHVua3MubGVuZ3RoIDwgMikge1xuICAgICAgICAgIHRoaXMudHJhY2UoJ0VSUk9SIEludmFsaWQgdGV4dCBpbnN0cnVjdGlvbi4gRXhwZWN0ZWQgYW4gaW5zdHJ1Y3Rpb24gYWxvbmcgXCJzYXkgI3RleHQgU29tZXRoaW5nXCInKVxuICAgICAgICAgIHJldHVybiB1c2VyU3RhdGVcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMuX2Rpc3BhdGNoT3V0cHV0KFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6IGNodW5rc1sxXSwgLy8gZS5nLiBcIiN0ZXh0XCIgb3IgXCIjIXRyaXZpYS0xMjM0MlwiXG4gICAgICAgICAgICB2YWx1ZTogcGFyYW1zIC8vIGUuZy4gQW55IGFkZGl0aW9uYWwgcGFyYW1ldGVyIHByb3ZpZGVkIHRvIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdXNlclN0YXRlLFxuICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXNlclN0YXRlID0gYXdhaXQgdGhpcy5faW52b2tlQWN0aW9uKGluc3RydWN0aW9uLCB1c2VyU3RhdGUsIGV2ZW50LCBjb250ZXh0KVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gdXNlclN0YXRlXG4gIH1cblxuICBhc3luYyBfZGlzcGF0Y2hPdXRwdXQob3V0cHV0LCB1c2VyU3RhdGUsIGV2ZW50LCBjb250ZXh0KSB7XG4gICAgY29uc3QgbXNnID0gU3RyaW5nKG91dHB1dC50eXBlICsgKG91dHB1dC52YWx1ZSB8fCAnJykpLnN1YnN0cigwLCAyMClcbiAgICB0aGlzLl90cmFjZSgnfj4nLCAnU0VORCcsIGBcIiR7bXNnfVwiYClcblxuICAgIHRoaXMub3V0cHV0UHJvY2Vzc29ycy5mb3JFYWNoKHByb2Nlc3NvciA9PiB7XG4gICAgICBwcm9jZXNzb3Iuc2VuZCh7XG4gICAgICAgIG1lc3NhZ2U6IG91dHB1dCxcbiAgICAgICAgc3RhdGU6IHVzZXJTdGF0ZSxcbiAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnQsXG4gICAgICAgIGZsb3dDb250ZXh0OiBjb250ZXh0XG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBhc3luYyBfaW52b2tlQWN0aW9uKGluc3RydWN0aW9uLCB1c2VyU3RhdGUsIGV2ZW50LCBjb250ZXh0KSB7XG4gICAgbGV0IG5hbWUgPSBudWxsXG4gICAgbGV0IGFyZ3MgPSB7fVxuXG4gICAgaWYgKF8uaXNTdHJpbmcoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICBpZiAoaW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJyAnKSkge1xuICAgICAgICBjb25zdCBjaHVua3MgPSBpbnN0cnVjdGlvbi5zcGxpdCgnICcpXG4gICAgICAgIGNvbnN0IGFyZ3NTdHIgPSBfLnRhaWwoY2h1bmtzKS5qb2luKCcgJylcbiAgICAgICAgbmFtZSA9IF8uZmlyc3QoY2h1bmtzKVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGFyZ3MgPSBKU09OLnBhcnNlKGFyZ3NTdHIpXG4gICAgICAgICAgYXJncyA9IF8ubWFwVmFsdWVzKGFyZ3MsIHZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmIChfLmlzU3RyaW5nKHZhbHVlKSAmJiB2YWx1ZS5zdGFydHNXaXRoKCd7eycpICYmIHZhbHVlLmVuZHNXaXRoKCd9fScpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGtleSA9IHZhbHVlLnN1YnN0cigyLCB2YWx1ZS5sZW5ndGggLSA0KVxuICAgICAgICAgICAgICByZXR1cm4gXy5nZXQoeyBzdGF0ZTogdXNlclN0YXRlLCBzOiB1c2VyU3RhdGUsIGV2ZW50OiBldmVudCwgZTogZXZlbnQgfSwga2V5KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFUlJPUiBmdW5jdGlvbiBoYXMgaW52YWxpZCBhcmd1bWVudHMgKG5vdCBhIHZhbGlkIEpTT04gc3RyaW5nKTogJyArIGFyZ3NTdHIpXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5hbWUgPSBpbnN0cnVjdGlvblxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl90cmFjZShgRVJST1IgZnVuY3Rpb24gaXMgbm90IGEgdmFsaWQgc3RyaW5nYClcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuYWN0aW9uc1tuYW1lXSkge1xuICAgICAgdGhpcy5fdHJhY2UoYEVSUk9SIGZ1bmN0aW9uIFwiJHtuYW1lfVwiIG5vdCBmb3VuZGAsIGNvbnRleHQsIHVzZXJTdGF0ZSlcbiAgICB9IGVsc2Uge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5fdHJhY2UoJyEhJywgJ0VYRUMnLCBgZnVuYyBcIiR7bmFtZX1cImAsIGNvbnRleHQsIHVzZXJTdGF0ZSlcbiAgICAgICAgY29uc3QgcmV0ID0gYXdhaXQgdGhpcy5hY3Rpb25zW25hbWVdLmZuKE9iamVjdC5mcmVlemUodXNlclN0YXRlKSwgZXZlbnQsIGFyZ3MgfHwge30pXG5cbiAgICAgICAgaWYgKHJldCAmJiBfLmlzT2JqZWN0KHJldCkpIHtcbiAgICAgICAgICBpZiAoT2JqZWN0LmlzRnJvemVuKHJldCkpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYWNlKFxuICAgICAgICAgICAgICBgRVJST1IgZnVuY3Rpb24gXCIke25hbWV9XCIgcmV0dXJuZWQgdGhlIG9yaWdpbmFsIChmcm96ZW4pIHN0YXRlLiBZb3Ugc2hvdWxkIGNsb25lIHRoZSBzdGF0ZSAoc2VlICdPYmplY3QuYXNzaWduKCknKSBpbnN0ZWFkIG9mIHJldHVybmluZyB0aGUgb3JpZ2luYWwgc3RhdGUuYCxcbiAgICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgICAgdXNlclN0YXRlXG4gICAgICAgICAgICApXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYWNlKCchIScsICdTU0VUJywgJycsIGNvbnRleHQpXG4gICAgICAgICAgICByZXR1cm4gcmV0XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFUlJPUiBmdW5jdGlvbiBcIiR7bmFtZX1cIiB0aHJvd24gYW4gZXJyb3I6ICR7ZXJyICYmIGVyci5tZXNzYWdlfWApXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHVzZXJTdGF0ZVxuICB9XG5cbiAgYXN5bmMgX2V2YWx1YXRlQ29uZGl0aW9uKGNvbmRpdGlvbiwgdXNlclN0YXRlLCBldmVudCkge1xuICAgIGlmICgvXnRydWV8YWx3YXlzfHllcyQvaS50ZXN0KGNvbmRpdGlvbikgfHwgY29uZGl0aW9uID09PSAnJykge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBjb25zdCB2bSA9IG5ldyBWTSh7XG4gICAgICB0aW1lb3V0OiA1MDAwXG4gICAgfSlcblxuICAgIF8ua2V5cyh0aGlzLmFjdGlvbnMpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICB2bS5mcmVlemUodGhpcy5hY3Rpb25zW25hbWVdLmZuLCBuYW1lKVxuICAgIH0pXG5cbiAgICB2bS5mcmVlemUodXNlclN0YXRlLCAncycpXG4gICAgdm0uZnJlZXplKHVzZXJTdGF0ZSwgJ3N0YXRlJylcbiAgICB2bS5mcmVlemUoZXZlbnQsICdldmVudCcpXG4gICAgdm0uZnJlZXplKGV2ZW50LCAnZScpXG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIChhd2FpdCB2bS5ydW4oY29uZGl0aW9uKSkgPT0gdHJ1ZVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFUlJPUiBldmFsdWF0aW5nIGNvbmRpdGlvbiBcIiR7Y29uZGl0aW9ufVwiOiAke2Vyci5tZXNzYWdlfWApXG4gICAgfVxuICB9XG5cbiAgc3RhdGljIF9maW5kTm9kZShmbG93LCBub2RlTmFtZSwgdGhyb3dJZk5vdEZvdW5kID0gZmFsc2UpIHtcbiAgICBpZiAodGhyb3dJZk5vdEZvdW5kICYmIF8uaXNOaWwoZmxvdykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgbm9kZSAke25vZGVOYW1lfSBiZWNhdXNlIHRoZSBmbG93IHdhcyBub3QgZGVmaW5lZCAobnVsbClgKVxuICAgIH1cblxuICAgIGNvbnN0IG5vZGUgPSBfLmZpbmQoZmxvdy5ub2RlcywgeyBuYW1lOiBub2RlTmFtZSB9KVxuXG4gICAgaWYgKHRocm93SWZOb3RGb3VuZCAmJiBfLmlzTmlsKG5vZGVOYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBub2RlIFwiJHtub2RlTmFtZX1cIiBpbiBmbG93IFwiJHtmbG93Lm5hbWV9XCJgKVxuICAgIH1cblxuICAgIHJldHVybiBub2RlXG4gIH1cblxuICBfZmluZEZsb3coZmxvd05hbWUsIHRocm93SWZOb3RGb3VuZCA9IGZhbHNlKSB7XG4gICAgY29uc3QgZmxvdyA9IF8uZmluZCh0aGlzLmZsb3dzLCB7IG5hbWU6IGZsb3dOYW1lIH0pXG5cbiAgICBpZiAodGhyb3dJZk5vdEZvdW5kICYmIF8uaXNOaWwoZmxvdykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgZmxvdyBcIiR7Zmxvd05hbWV9XCJgKVxuICAgIH1cblxuICAgIHJldHVybiBmbG93XG4gIH1cblxuICBsb2cobWVzc2FnZSwgY29udGV4dCwgc3RhdGUpIHtcbiAgICBjb25zdCBmbG93ID0gKF8uZ2V0KGNvbnRleHQsICdjdXJyZW50Rmxvdy5uYW1lJykgfHwgJ05PTkUnKS5yZXBsYWNlKC9cXC5mbG93XFwuanNvbi9pLCAnJylcbiAgICBjb25zdCBub2RlID0gKGNvbnRleHQgJiYgY29udGV4dC5ub2RlKSB8fCAnTk9ORSdcbiAgICBjb25zdCBtc2cgPSBgRGlhbG9nOiBbJHtmbG93fSDigJMgJHtub2RlfV1cXHQke21lc3NhZ2V9YFxuICAgIHRoaXMubG9nZ2VyLmRlYnVnKG1zZylcbiAgfVxuXG4gIC8qKlxuICAgKiBEaWFsb2c6IFtmbG93XSAobm9kZSkgXFx0IE9QICBSRVNOICBcIkRlc2NyaXB0aW9uXCJcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICogQHBhcmFtIGNvbnRleHRcbiAgICogQHBhcmFtIHN0YXRlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfdHJhY2Uob3BlcmF0aW9uLCByZWFzb24sIG1lc3NhZ2UsIGNvbnRleHQpIHtcbiAgICBsZXQgZmxvdyA9IChfLmdldChjb250ZXh0LCAnY3VycmVudEZsb3cubmFtZScpIHx8ICcgTi9BICcpLnJlcGxhY2UoL1xcLmZsb3dcXC5qc29uL2ksICcnKVxuICAgIGxldCBub2RlID0gKGNvbnRleHQgJiYgY29udGV4dC5ub2RlKSB8fCAnIE4vQSAnXG5cbiAgICBmbG93ID0gZmxvdy5sZW5ndGggPiAxMyA/IGZsb3cuc3Vic3RyKDAsIDEzKSArICcmJyA6IGZsb3dcbiAgICBub2RlID0gbm9kZS5sZW5ndGggPiAxMyA/IG5vZGUuc3Vic3RyKDAsIDEzKSArICcmJyA6IG5vZGVcblxuICAgIGNvbnN0IHNwYyA9IF8ucmVwZWF0KCcgJywgMzAgLSBmbG93Lmxlbmd0aCAtIG5vZGUubGVuZ3RoKVxuXG4gICAgY29uc3QgbXNnID0gYERpYWxvZzogWyR7Zmxvd31dICgke25vZGV9KSAke3NwY30gJHtvcGVyYXRpb259ICAke3JlYXNvbn0gXFx0ICR7bWVzc2FnZX1gXG5cbiAgICB0aGlzLmxvZ2dlci5kZWJ1Zyhtc2cpXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBEaWFsb2dFbmdpbmVcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/dialog/engine.js\n");

/***/ }),

/***/ "./src/dialog/janitor.js":
/*!*******************************!*\
  !*** ./src/dialog/janitor.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _ms = __webpack_require__(/*! ms */ \"ms\");\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _helpers = __webpack_require__(/*! ../database/helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _moment = __webpack_require__(/*! moment */ \"moment\");\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var db = _ref.db,\n      botfile = _ref.botfile,\n      middlewares = _ref.middlewares;\n\n  var intervalRef = null;\n\n  var defaultJanitorInterval = (0, _ms2.default)(_lodash2.default.get(botfile, 'dialogs.janitorInterval') || '30s');\n  var defaultTimeout = (0, _ms2.default)(_lodash2.default.get(botfile, 'dialogs.timeoutInterval') || '15m');\n\n  var checkStaleSessions = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var knex, timedOutCondition, sessions;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context.sent;\n              timedOutCondition = (0, _helpers2.default)(knex).date.isBefore('active_on', (0, _moment2.default)().subtract(defaultTimeout, 'milliseconds'));\n              _context.next = 6;\n              return knex('dialog_sessions').where(timedOutCondition).andWhereRaw('not \"id\" like \\'%\\\\_\\\\_\\\\_%\\' escape \\'\\\\\\'') // Exclude substates\n              .limit(250).then();\n\n            case 6:\n              sessions = _context.sent;\n              return _context.abrupt('return', _bluebird2.default.map(sessions, function (session) {\n                var platform = 'botpress';\n                var props = {};\n\n                if (session.id.includes(':')) {\n                  var chunks = session.id.split(':');\n                  platform = _lodash2.default.head(chunks);\n                  var userId = _lodash2.default.tail(chunks).join(':');\n                  props.user = { id: userId };\n                }\n\n                return middlewares.sendIncoming(_lodash2.default.merge({\n                  platform: platform,\n                  type: 'bp_dialog_timeout',\n                  raw: { sessionId: session.id },\n                  text: session.id,\n                  sessionId: session.id\n                }, props));\n              }));\n\n            case 8:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function checkStaleSessions() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var run = function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return checkStaleSessions();\n\n            case 2:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function run() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var uninstall = function uninstall() {\n    if (intervalRef) {\n      clearInterval(intervalRef);\n      intervalRef = null;\n    }\n  };\n\n  var install = function install() {\n    var randomMs = Math.random() * 5000;\n\n    if (intervalRef) {\n      uninstall();\n    }\n\n    intervalRef = setInterval(run, defaultJanitorInterval + randomMs);\n  };\n\n  return { install: install, uninstall: uninstall, runOnce: run };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGlhbG9nL2phbml0b3IuanM/YWY5NSJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZGIiLCJib3RmaWxlIiwibWlkZGxld2FyZXMiLCJpbnRlcnZhbFJlZiIsImRlZmF1bHRKYW5pdG9ySW50ZXJ2YWwiLCJfIiwiZ2V0IiwiZGVmYXVsdFRpbWVvdXQiLCJjaGVja1N0YWxlU2Vzc2lvbnMiLCJrbmV4IiwidGltZWRPdXRDb25kaXRpb24iLCJkYXRlIiwiaXNCZWZvcmUiLCJzdWJ0cmFjdCIsIndoZXJlIiwiYW5kV2hlcmVSYXciLCJsaW1pdCIsInRoZW4iLCJzZXNzaW9ucyIsIlByb21pc2UiLCJtYXAiLCJwbGF0Zm9ybSIsInByb3BzIiwic2Vzc2lvbiIsImlkIiwiaW5jbHVkZXMiLCJjaHVua3MiLCJzcGxpdCIsImhlYWQiLCJ1c2VySWQiLCJ0YWlsIiwiam9pbiIsInVzZXIiLCJzZW5kSW5jb21pbmciLCJtZXJnZSIsInR5cGUiLCJyYXciLCJzZXNzaW9uSWQiLCJ0ZXh0IiwicnVuIiwidW5pbnN0YWxsIiwiY2xlYXJJbnRlcnZhbCIsImluc3RhbGwiLCJyYW5kb21NcyIsIk1hdGgiLCJyYW5kb20iLCJzZXRJbnRlcnZhbCIsInJ1bk9uY2UiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixnQkFBa0M7QUFBQSxNQUEvQkMsRUFBK0IsUUFBL0JBLEVBQStCO0FBQUEsTUFBM0JDLE9BQTJCLFFBQTNCQSxPQUEyQjtBQUFBLE1BQWxCQyxXQUFrQixRQUFsQkEsV0FBa0I7O0FBQ2pELE1BQUlDLGNBQWMsSUFBbEI7O0FBRUEsTUFBTUMseUJBQXlCLGtCQUFHQyxpQkFBRUMsR0FBRixDQUFNTCxPQUFOLEVBQWUseUJBQWYsS0FBNkMsS0FBaEQsQ0FBL0I7QUFDQSxNQUFNTSxpQkFBaUIsa0JBQUdGLGlCQUFFQyxHQUFGLENBQU1MLE9BQU4sRUFBZSx5QkFBZixLQUE2QyxLQUFoRCxDQUF2Qjs7QUFFQSxNQUFNTztBQUFBLHdFQUFxQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHFCQUNOUixHQUFHTSxHQUFILEVBRE07O0FBQUE7QUFDbkJHLGtCQURtQjtBQUduQkMsK0JBSG1CLEdBR0MsdUJBQVFELElBQVIsRUFBY0UsSUFBZCxDQUFtQkMsUUFBbkIsQ0FDeEIsV0FEd0IsRUFFeEIsd0JBQVNDLFFBQVQsQ0FBa0JOLGNBQWxCLEVBQWtDLGNBQWxDLENBRndCLENBSEQ7QUFBQTtBQUFBLHFCQVFGRSxLQUFLLGlCQUFMLEVBQ3BCSyxLQURvQixDQUNkSixpQkFEYyxFQUVwQkssV0FGb0IsZ0RBRW1DO0FBRm5DLGVBR3BCQyxLQUhvQixDQUdkLEdBSGMsRUFJcEJDLElBSm9CLEVBUkU7O0FBQUE7QUFRbkJDLHNCQVJtQjtBQUFBLCtDQWNsQkMsbUJBQVFDLEdBQVIsQ0FBWUYsUUFBWixFQUFzQixtQkFBVztBQUN0QyxvQkFBSUcsV0FBVyxVQUFmO0FBQ0Esb0JBQU1DLFFBQVEsRUFBZDs7QUFFQSxvQkFBSUMsUUFBUUMsRUFBUixDQUFXQyxRQUFYLENBQW9CLEdBQXBCLENBQUosRUFBOEI7QUFDNUIsc0JBQU1DLFNBQVNILFFBQVFDLEVBQVIsQ0FBV0csS0FBWCxDQUFpQixHQUFqQixDQUFmO0FBQ0FOLDZCQUFXaEIsaUJBQUV1QixJQUFGLENBQU9GLE1BQVAsQ0FBWDtBQUNBLHNCQUFNRyxTQUFTeEIsaUJBQUV5QixJQUFGLENBQU9KLE1BQVAsRUFBZUssSUFBZixDQUFvQixHQUFwQixDQUFmO0FBQ0FULHdCQUFNVSxJQUFOLEdBQWEsRUFBRVIsSUFBSUssTUFBTixFQUFiO0FBQ0Q7O0FBRUQsdUJBQU8zQixZQUFZK0IsWUFBWixDQUNMNUIsaUJBQUU2QixLQUFGLENBQ0U7QUFDRWIsNEJBQVVBLFFBRFo7QUFFRWMsd0JBQU0sbUJBRlI7QUFHRUMsdUJBQUssRUFBRUMsV0FBV2QsUUFBUUMsRUFBckIsRUFIUDtBQUlFYyx3QkFBTWYsUUFBUUMsRUFKaEI7QUFLRWEsNkJBQVdkLFFBQVFDO0FBTHJCLGlCQURGLEVBUUVGLEtBUkYsQ0FESyxDQUFQO0FBWUQsZUF2Qk0sQ0Fka0I7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBckI7O0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBTjs7QUF3Q0EsTUFBTWlCO0FBQUEsd0VBQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQ0ovQixvQkFESTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQU47O0FBSUEsTUFBTWdDLFlBQVksU0FBWkEsU0FBWSxHQUFNO0FBQ3RCLFFBQUlyQyxXQUFKLEVBQWlCO0FBQ2ZzQyxvQkFBY3RDLFdBQWQ7QUFDQUEsb0JBQWMsSUFBZDtBQUNEO0FBQ0YsR0FMRDs7QUFPQSxNQUFNdUMsVUFBVSxTQUFWQSxPQUFVLEdBQU07QUFDcEIsUUFBTUMsV0FBV0MsS0FBS0MsTUFBTCxLQUFnQixJQUFqQzs7QUFFQSxRQUFJMUMsV0FBSixFQUFpQjtBQUNmcUM7QUFDRDs7QUFFRHJDLGtCQUFjMkMsWUFBWVAsR0FBWixFQUFpQm5DLHlCQUF5QnVDLFFBQTFDLENBQWQ7QUFDRCxHQVJEOztBQVVBLFNBQU8sRUFBRUQsZ0JBQUYsRUFBV0Ysb0JBQVgsRUFBc0JPLFNBQVNSLEdBQS9CLEVBQVA7QUFDRCxDQXBFRCIsImZpbGUiOiIuL3NyYy9kaWFsb2cvamFuaXRvci5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtcyBmcm9tICdtcydcbmltcG9ydCBoZWxwZXJzIGZyb20gJy4uL2RhdGFiYXNlL2hlbHBlcnMnXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCdcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IGRiLCBib3RmaWxlLCBtaWRkbGV3YXJlcyB9KSA9PiB7XG4gIGxldCBpbnRlcnZhbFJlZiA9IG51bGxcblxuICBjb25zdCBkZWZhdWx0SmFuaXRvckludGVydmFsID0gbXMoXy5nZXQoYm90ZmlsZSwgJ2RpYWxvZ3MuamFuaXRvckludGVydmFsJykgfHwgJzMwcycpXG4gIGNvbnN0IGRlZmF1bHRUaW1lb3V0ID0gbXMoXy5nZXQoYm90ZmlsZSwgJ2RpYWxvZ3MudGltZW91dEludGVydmFsJykgfHwgJzE1bScpXG5cbiAgY29uc3QgY2hlY2tTdGFsZVNlc3Npb25zID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgY29uc3QgdGltZWRPdXRDb25kaXRpb24gPSBoZWxwZXJzKGtuZXgpLmRhdGUuaXNCZWZvcmUoXG4gICAgICAnYWN0aXZlX29uJyxcbiAgICAgIG1vbWVudCgpLnN1YnRyYWN0KGRlZmF1bHRUaW1lb3V0LCAnbWlsbGlzZWNvbmRzJylcbiAgICApXG5cbiAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGtuZXgoJ2RpYWxvZ19zZXNzaW9ucycpXG4gICAgICAud2hlcmUodGltZWRPdXRDb25kaXRpb24pXG4gICAgICAuYW5kV2hlcmVSYXcoYG5vdCBcImlkXCIgbGlrZSAnJVxcXFxfXFxcXF9cXFxcXyUnIGVzY2FwZSAnXFxcXCdgKSAvLyBFeGNsdWRlIHN1YnN0YXRlc1xuICAgICAgLmxpbWl0KDI1MClcbiAgICAgIC50aGVuKClcblxuICAgIHJldHVybiBQcm9taXNlLm1hcChzZXNzaW9ucywgc2Vzc2lvbiA9PiB7XG4gICAgICBsZXQgcGxhdGZvcm0gPSAnYm90cHJlc3MnXG4gICAgICBjb25zdCBwcm9wcyA9IHt9XG5cbiAgICAgIGlmIChzZXNzaW9uLmlkLmluY2x1ZGVzKCc6JykpIHtcbiAgICAgICAgY29uc3QgY2h1bmtzID0gc2Vzc2lvbi5pZC5zcGxpdCgnOicpXG4gICAgICAgIHBsYXRmb3JtID0gXy5oZWFkKGNodW5rcylcbiAgICAgICAgY29uc3QgdXNlcklkID0gXy50YWlsKGNodW5rcykuam9pbignOicpXG4gICAgICAgIHByb3BzLnVzZXIgPSB7IGlkOiB1c2VySWQgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWlkZGxld2FyZXMuc2VuZEluY29taW5nKFxuICAgICAgICBfLm1lcmdlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybSxcbiAgICAgICAgICAgIHR5cGU6ICdicF9kaWFsb2dfdGltZW91dCcsXG4gICAgICAgICAgICByYXc6IHsgc2Vzc2lvbklkOiBzZXNzaW9uLmlkIH0sXG4gICAgICAgICAgICB0ZXh0OiBzZXNzaW9uLmlkLFxuICAgICAgICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uLmlkXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwcm9wc1xuICAgICAgICApXG4gICAgICApXG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IHJ1biA9IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBjaGVja1N0YWxlU2Vzc2lvbnMoKVxuICB9XG5cbiAgY29uc3QgdW5pbnN0YWxsID0gKCkgPT4ge1xuICAgIGlmIChpbnRlcnZhbFJlZikge1xuICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbFJlZilcbiAgICAgIGludGVydmFsUmVmID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGluc3RhbGwgPSAoKSA9PiB7XG4gICAgY29uc3QgcmFuZG9tTXMgPSBNYXRoLnJhbmRvbSgpICogNTAwMFxuXG4gICAgaWYgKGludGVydmFsUmVmKSB7XG4gICAgICB1bmluc3RhbGwoKVxuICAgIH1cblxuICAgIGludGVydmFsUmVmID0gc2V0SW50ZXJ2YWwocnVuLCBkZWZhdWx0SmFuaXRvckludGVydmFsICsgcmFuZG9tTXMpXG4gIH1cblxuICByZXR1cm4geyBpbnN0YWxsLCB1bmluc3RhbGwsIHJ1bk9uY2U6IHJ1biB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/dialog/janitor.js\n");

/***/ }),

/***/ "./src/dialog/processors.js":
/*!**********************************!*\
  !*** ./src/dialog/processors.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _mustache = __webpack_require__(/*! mustache */ \"mustache\");\n\nvar _mustache2 = _interopRequireDefault(_mustache);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  default: {\n    id: 'send-message',\n    send: function send(_ref) {\n      var message = _ref.message,\n          originalEvent = _ref.originalEvent,\n          state = _ref.state,\n          flowContext = _ref.flowContext;\n\n      var rendered = message.value;\n\n      var additionalData = { state: state };\n\n      if (/{{/i.test(rendered)) {\n        rendered = _mustache2.default.render(rendered, _extends({}, state, {\n          event: _lodash2.default.pick(originalEvent, ['raw', 'text', 'type', 'platform', 'user']),\n          _context: _extends({}, _lodash2.default.pick(flowContext, ['node', 'flowStack']), {\n            currentFlow: _lodash2.default.pick(flowContext.currentFlow, ['name', 'version', 'startNode'])\n          })\n        }));\n      }\n\n      if (/^{.+}$/.test(rendered)) {\n        // Check if it's JSON\n        Object.assign(additionalData, JSON.parse(rendered));\n      } else if (!_lodash2.default.isEmpty(rendered)) {\n        Object.assign(additionalData, { text: rendered });\n      }\n\n      return originalEvent.reply(message.type, additionalData);\n    }\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGlhbG9nL3Byb2Nlc3NvcnMuanM/NGRjNyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsImlkIiwic2VuZCIsIm1lc3NhZ2UiLCJvcmlnaW5hbEV2ZW50Iiwic3RhdGUiLCJmbG93Q29udGV4dCIsInJlbmRlcmVkIiwidmFsdWUiLCJhZGRpdGlvbmFsRGF0YSIsInRlc3QiLCJNdXN0YWNoZSIsInJlbmRlciIsImV2ZW50IiwiXyIsInBpY2siLCJfY29udGV4dCIsImN1cnJlbnRGbG93IiwiT2JqZWN0IiwiYXNzaWduIiwiSlNPTiIsInBhcnNlIiwiaXNFbXB0eSIsInRleHQiLCJyZXBseSIsInR5cGUiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7OztBQUNBOzs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQjtBQUNmQyxXQUFTO0FBQ1BDLFFBQUksY0FERztBQUVQQyxVQUFNLG9CQUFvRDtBQUFBLFVBQWpEQyxPQUFpRCxRQUFqREEsT0FBaUQ7QUFBQSxVQUF4Q0MsYUFBd0MsUUFBeENBLGFBQXdDO0FBQUEsVUFBekJDLEtBQXlCLFFBQXpCQSxLQUF5QjtBQUFBLFVBQWxCQyxXQUFrQixRQUFsQkEsV0FBa0I7O0FBQ3hELFVBQUlDLFdBQVdKLFFBQVFLLEtBQXZCOztBQUVBLFVBQU1DLGlCQUFpQixFQUFFSixPQUFPQSxLQUFULEVBQXZCOztBQUVBLFVBQUksTUFBTUssSUFBTixDQUFXSCxRQUFYLENBQUosRUFBMEI7QUFDeEJBLG1CQUFXSSxtQkFBU0MsTUFBVCxDQUFnQkwsUUFBaEIsZUFDTkYsS0FETTtBQUVUUSxpQkFBT0MsaUJBQUVDLElBQUYsQ0FBT1gsYUFBUCxFQUFzQixDQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWdCLE1BQWhCLEVBQXdCLFVBQXhCLEVBQW9DLE1BQXBDLENBQXRCLENBRkU7QUFHVFksaUNBQ0tGLGlCQUFFQyxJQUFGLENBQU9ULFdBQVAsRUFBb0IsQ0FBQyxNQUFELEVBQVMsV0FBVCxDQUFwQixDQURMO0FBRUVXLHlCQUFhSCxpQkFBRUMsSUFBRixDQUFPVCxZQUFZVyxXQUFuQixFQUFnQyxDQUFDLE1BQUQsRUFBUyxTQUFULEVBQW9CLFdBQXBCLENBQWhDO0FBRmY7QUFIUyxXQUFYO0FBUUQ7O0FBRUQsVUFBSSxTQUFTUCxJQUFULENBQWNILFFBQWQsQ0FBSixFQUE2QjtBQUMzQjtBQUNBVyxlQUFPQyxNQUFQLENBQWNWLGNBQWQsRUFBOEJXLEtBQUtDLEtBQUwsQ0FBV2QsUUFBWCxDQUE5QjtBQUNELE9BSEQsTUFHTyxJQUFJLENBQUNPLGlCQUFFUSxPQUFGLENBQVVmLFFBQVYsQ0FBTCxFQUEwQjtBQUMvQlcsZUFBT0MsTUFBUCxDQUFjVixjQUFkLEVBQThCLEVBQUVjLE1BQU1oQixRQUFSLEVBQTlCO0FBQ0Q7O0FBRUQsYUFBT0gsY0FBY29CLEtBQWQsQ0FBb0JyQixRQUFRc0IsSUFBNUIsRUFBa0NoQixjQUFsQyxDQUFQO0FBQ0Q7QUExQk07QUFETSxDQUFqQiIsImZpbGUiOiIuL3NyYy9kaWFsb2cvcHJvY2Vzc29ycy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBNdXN0YWNoZSBmcm9tICdtdXN0YWNoZSdcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGRlZmF1bHQ6IHtcbiAgICBpZDogJ3NlbmQtbWVzc2FnZScsXG4gICAgc2VuZDogKHsgbWVzc2FnZSwgb3JpZ2luYWxFdmVudCwgc3RhdGUsIGZsb3dDb250ZXh0IH0pID0+IHtcbiAgICAgIGxldCByZW5kZXJlZCA9IG1lc3NhZ2UudmFsdWVcblxuICAgICAgY29uc3QgYWRkaXRpb25hbERhdGEgPSB7IHN0YXRlOiBzdGF0ZSB9XG5cbiAgICAgIGlmICgve3svaS50ZXN0KHJlbmRlcmVkKSkge1xuICAgICAgICByZW5kZXJlZCA9IE11c3RhY2hlLnJlbmRlcihyZW5kZXJlZCwge1xuICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgIGV2ZW50OiBfLnBpY2sob3JpZ2luYWxFdmVudCwgWydyYXcnLCAndGV4dCcsICd0eXBlJywgJ3BsYXRmb3JtJywgJ3VzZXInXSksXG4gICAgICAgICAgX2NvbnRleHQ6IHtcbiAgICAgICAgICAgIC4uLl8ucGljayhmbG93Q29udGV4dCwgWydub2RlJywgJ2Zsb3dTdGFjayddKSxcbiAgICAgICAgICAgIGN1cnJlbnRGbG93OiBfLnBpY2soZmxvd0NvbnRleHQuY3VycmVudEZsb3csIFsnbmFtZScsICd2ZXJzaW9uJywgJ3N0YXJ0Tm9kZSddKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgaWYgKC9eey4rfSQvLnRlc3QocmVuZGVyZWQpKSB7XG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MgSlNPTlxuICAgICAgICBPYmplY3QuYXNzaWduKGFkZGl0aW9uYWxEYXRhLCBKU09OLnBhcnNlKHJlbmRlcmVkKSlcbiAgICAgIH0gZWxzZSBpZiAoIV8uaXNFbXB0eShyZW5kZXJlZCkpIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihhZGRpdGlvbmFsRGF0YSwgeyB0ZXh0OiByZW5kZXJlZCB9KVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3JpZ2luYWxFdmVudC5yZXBseShtZXNzYWdlLnR5cGUsIGFkZGl0aW9uYWxEYXRhKVxuICAgIH1cbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/dialog/processors.js\n");

/***/ }),

/***/ "./src/dialog/provider.js":
/*!********************************!*\
  !*** ./src/dialog/provider.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _glob = __webpack_require__(/*! glob */ \"glob\");\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _eventemitter = __webpack_require__(/*! eventemitter2 */ \"eventemitter2\");\n\nvar _eventemitter2 = _interopRequireDefault(_eventemitter);\n\nvar _mkdirp = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n\nvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\nvar _validator = __webpack_require__(/*! ./validator */ \"./src/dialog/validator.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar FlowProvider = function (_EventEmitter) {\n  _inherits(FlowProvider, _EventEmitter);\n\n  function FlowProvider(_ref) {\n    var logger = _ref.logger,\n        botfile = _ref.botfile,\n        projectLocation = _ref.projectLocation,\n        ghostManager = _ref.ghostManager;\n\n    _classCallCheck(this, FlowProvider);\n\n    var _this = _possibleConstructorReturn(this, (FlowProvider.__proto__ || Object.getPrototypeOf(FlowProvider)).call(this, {\n      wildcard: true,\n      maxListeners: 100\n    }));\n\n    _this.logger = logger;\n    _this.botfile = botfile;\n    _this.projectLocation = projectLocation;\n    _this.ghostManager = ghostManager;\n    _this.flowsDir = _this.botfile.flowsDir || './flows';\n\n    _mkdirp2.default.sync(_path2.default.dirname(_this.flowsDir));\n    _this.ghostManager.addRootFolder(_this.flowsDir, { filesGlob: '**/*.json' });\n    return _this;\n  }\n\n  _createClass(FlowProvider, [{\n    key: 'loadAll',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        var flowFiles, flows;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.ghostManager.directoryListing(this.flowsDir, '.flow.json');\n\n              case 2:\n                flowFiles = _context2.sent;\n                _context2.next = 5;\n                return _bluebird2.default.map(flowFiles, function () {\n                  var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(flowPath) {\n                    var flow, schemaError, uiEq, unplacedIndex;\n                    return regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.t0 = JSON;\n                            _context.next = 3;\n                            return _this2.ghostManager.readFile(_this2.flowsDir, flowPath);\n\n                          case 3:\n                            _context.t1 = _context.sent;\n                            flow = _context.t0.parse.call(_context.t0, _context.t1);\n                            schemaError = (0, _validator.validateFlowSchema)(flow);\n\n                            if (!(!flow || schemaError)) {\n                              _context.next = 8;\n                              break;\n                            }\n\n                            return _context.abrupt('return', flow ? _this2.logger.warn(schemaError) : null);\n\n                          case 8:\n                            _context.t2 = JSON;\n                            _context.next = 11;\n                            return _this2.ghostManager.readFile(_this2.flowsDir, _this2._uiPath(flowPath));\n\n                          case 11:\n                            _context.t3 = _context.sent;\n                            uiEq = _context.t2.parse.call(_context.t2, _context.t3);\n\n\n                            Object.assign(flow, { links: uiEq.links });\n\n                            // Take position from UI files or create default position\n                            unplacedIndex = -1;\n\n                            flow.nodes = flow.nodes.map(function (node) {\n                              var position = _lodash2.default.get(_lodash2.default.find(uiEq.nodes, { id: node.id }), 'position');\n                              var placingStep = 250;\n                              unplacedIndex = position ? unplacedIndex : unplacedIndex + 1;\n\n                              return _extends({}, node, {\n                                x: position ? position.x : 50 + unplacedIndex * placingStep,\n                                y: position ? position.y : (_lodash2.default.maxBy(flow.nodes, 'y') || { y: 0 }).y + placingStep\n                              });\n                            });\n\n                            return _context.abrupt('return', _extends({\n                              name: flowPath,\n                              location: flowPath,\n                              nodes: _lodash2.default.filter(flow.nodes, function (node) {\n                                return !!node;\n                              })\n                            }, _lodash2.default.pick(flow, 'version', 'catchAll', 'startNode', 'links', 'skillData')));\n\n                          case 17:\n                          case 'end':\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee, _this2);\n                  }));\n\n                  return function (_x) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }());\n\n              case 5:\n                flows = _context2.sent;\n                return _context2.abrupt('return', flows.filter(Boolean));\n\n              case 7:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function loadAll() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return loadAll;\n    }()\n  }, {\n    key: 'saveFlows',\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(flows) {\n        var _this3 = this;\n\n        var flowsToSave, flowsSavePromises, pathsToOmit, flowFiles, flowsDeletePromises;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (flows.find(function (_ref5) {\n                  var flow = _ref5.flow;\n                  return flow === 'main.flow.json';\n                })) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                throw new Error('[Flow] Expected flows list to contain \\'main.flow.json\\'');\n\n              case 2:\n                _context3.next = 4;\n                return _bluebird2.default.mapSeries(flows, function (flow) {\n                  return _this3._prepareSaveFlow(flow);\n                });\n\n              case 4:\n                flowsToSave = _context3.sent;\n                flowsSavePromises = _lodash2.default.flatten(flowsToSave.map(function (_ref6) {\n                  var flowPath = _ref6.flowPath,\n                      uiPath = _ref6.uiPath,\n                      flowContent = _ref6.flowContent,\n                      uiContent = _ref6.uiContent;\n                  return [_this3.ghostManager.upsertFile(_this3.flowsDir, flowPath, JSON.stringify(flowContent, null, 2)), _this3.ghostManager.upsertFile(_this3.flowsDir, uiPath, JSON.stringify(uiContent, null, 2))];\n                }));\n                pathsToOmit = _lodash2.default.flatten(flowsToSave.map(function (flow) {\n                  return [flow.flowPath, flow.uiPath];\n                }));\n                _context3.next = 9;\n                return this.ghostManager.directoryListing(this.flowsDir, '.json', pathsToOmit);\n\n              case 9:\n                flowFiles = _context3.sent;\n                flowsDeletePromises = flowFiles.map(function (filePath) {\n                  return _this3.ghostManager.deleteFile(_this3.flowsDir, filePath);\n                });\n                _context3.next = 13;\n                return _bluebird2.default.all(flowsSavePromises.concat(flowsDeletePromises));\n\n              case 13:\n\n                this.emit('flowsChanged');\n\n              case 14:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function saveFlows(_x2) {\n        return _ref4.apply(this, arguments);\n      }\n\n      return saveFlows;\n    }()\n  }, {\n    key: '_prepareSaveFlow',\n    value: function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(flow) {\n        var schemaError, uiContent, flowContent, flowPath;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                flow = Object.assign({}, flow, { version: '0.1' });\n\n                schemaError = (0, _validator.validateFlowSchema)(flow);\n\n                if (!schemaError) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                throw new Error(schemaError);\n\n              case 4:\n\n                // What goes in the ui.json file\n                uiContent = {\n                  nodes: flow.nodes.map(function (node) {\n                    return { id: node.id, position: _lodash2.default.pick(node, 'x', 'y') };\n                  }),\n                  links: flow.links\n\n                  // What goes in the .flow.json file\n                };\n                flowContent = _extends({}, _lodash2.default.pick(flow, 'version', 'catchAll', 'startNode', 'skillData'), {\n                  nodes: flow.nodes.map(function (node) {\n                    return _lodash2.default.omit(node, 'x', 'y', 'lastModified');\n                  })\n                });\n                flowPath = flow.location;\n                return _context4.abrupt('return', { flowPath: flowPath, uiPath: this._uiPath(flowPath), flowContent: flowContent, uiContent: uiContent });\n\n              case 8:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function _prepareSaveFlow(_x3) {\n        return _ref7.apply(this, arguments);\n      }\n\n      return _prepareSaveFlow;\n    }()\n  }, {\n    key: '_uiPath',\n    value: function _uiPath(flowPath) {\n      return flowPath.replace(/\\.flow\\.json/i, '.ui.json');\n    }\n  }]);\n\n  return FlowProvider;\n}(_eventemitter2.default);\n\nexports.default = FlowProvider;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGlhbG9nL3Byb3ZpZGVyLmpzP2JlMDEiXSwibmFtZXMiOlsiRmxvd1Byb3ZpZGVyIiwibG9nZ2VyIiwiYm90ZmlsZSIsInByb2plY3RMb2NhdGlvbiIsImdob3N0TWFuYWdlciIsIndpbGRjYXJkIiwibWF4TGlzdGVuZXJzIiwiZmxvd3NEaXIiLCJta2RpcnAiLCJzeW5jIiwicGF0aCIsImRpcm5hbWUiLCJhZGRSb290Rm9sZGVyIiwiZmlsZXNHbG9iIiwiZGlyZWN0b3J5TGlzdGluZyIsImZsb3dGaWxlcyIsIlByb21pc2UiLCJtYXAiLCJmbG93UGF0aCIsIkpTT04iLCJyZWFkRmlsZSIsImZsb3ciLCJwYXJzZSIsInNjaGVtYUVycm9yIiwid2FybiIsIl91aVBhdGgiLCJ1aUVxIiwiT2JqZWN0IiwiYXNzaWduIiwibGlua3MiLCJ1bnBsYWNlZEluZGV4Iiwibm9kZXMiLCJwb3NpdGlvbiIsIl8iLCJnZXQiLCJmaW5kIiwiaWQiLCJub2RlIiwicGxhY2luZ1N0ZXAiLCJ4IiwieSIsIm1heEJ5IiwibmFtZSIsImxvY2F0aW9uIiwiZmlsdGVyIiwicGljayIsImZsb3dzIiwiQm9vbGVhbiIsIkVycm9yIiwibWFwU2VyaWVzIiwiX3ByZXBhcmVTYXZlRmxvdyIsImZsb3dzVG9TYXZlIiwiZmxvd3NTYXZlUHJvbWlzZXMiLCJmbGF0dGVuIiwidWlQYXRoIiwiZmxvd0NvbnRlbnQiLCJ1aUNvbnRlbnQiLCJ1cHNlcnRGaWxlIiwic3RyaW5naWZ5IiwicGF0aHNUb09taXQiLCJmbG93c0RlbGV0ZVByb21pc2VzIiwiZGVsZXRlRmlsZSIsImZpbGVQYXRoIiwiYWxsIiwiY29uY2F0IiwiZW1pdCIsInZlcnNpb24iLCJvbWl0IiwicmVwbGFjZSIsIkV2ZW50RW1pdHRlcjIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOzs7Ozs7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QUFhLEdBQWIsRUFBa0IsR0FBbEIsQ0FBekIsRUFBVDtBQUFBLG1CQUFmLENBRFM7QUFFaEJSLHlCQUFPUixLQUFLUTs7QUFHZDtBQUxrQixpQjtBQU1aMEIsMkIsZ0JBQ0R0QixpQkFBRVksSUFBRixDQUFPeEIsSUFBUCxFQUFhLFNBQWIsRUFBd0IsVUFBeEIsRUFBb0MsV0FBcEMsRUFBaUQsV0FBakQsQztBQUNIVSx5QkFBT1YsS0FBS1UsS0FBTCxDQUFXZCxHQUFYLENBQWU7QUFBQSwyQkFBUWdCLGlCQUFFa0MsSUFBRixDQUFPOUIsSUFBUCxFQUFhLEdBQWIsRUFBa0IsR0FBbEIsRUFBdUIsY0FBdkIsQ0FBUjtBQUFBLG1CQUFmOztBQUdIbkIsd0IsR0FBV0csS0FBS3NCLFE7a0RBQ2YsRUFBRXpCLGtCQUFGLEVBQVlvQyxRQUFRLEtBQUs3QixPQUFMLENBQWFQLFFBQWIsQ0FBcEIsRUFBNENxQyx3QkFBNUMsRUFBeURDLG9CQUF6RCxFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7NEJBR0R0QyxRLEVBQVU7QUFDaEIsYUFBT0EsU0FBU2tELE9BQVQsQ0FBaUIsZUFBakIsRUFBa0MsVUFBbEMsQ0FBUDtBQUNEOzs7O0VBekd1Q0Msc0I7O2tCQUFyQnJFLFkiLCJmaWxlIjoiLi9zcmMvZGlhbG9nL3Byb3ZpZGVyLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBnbG9iIGZyb20gJ2dsb2InXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCBFdmVudEVtaXR0ZXIyIGZyb20gJ2V2ZW50ZW1pdHRlcjInXG5pbXBvcnQgbWtkaXJwIGZyb20gJ21rZGlycCdcblxuaW1wb3J0IHsgdmFsaWRhdGVGbG93U2NoZW1hIH0gZnJvbSAnLi92YWxpZGF0b3InXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsb3dQcm92aWRlciBleHRlbmRzIEV2ZW50RW1pdHRlcjIge1xuICBjb25zdHJ1Y3Rvcih7IGxvZ2dlciwgYm90ZmlsZSwgcHJvamVjdExvY2F0aW9uLCBnaG9zdE1hbmFnZXIgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIHdpbGRjYXJkOiB0cnVlLFxuICAgICAgbWF4TGlzdGVuZXJzOiAxMDBcbiAgICB9KVxuXG4gICAgdGhpcy5sb2dnZXIgPSBsb2dnZXJcbiAgICB0aGlzLmJvdGZpbGUgPSBib3RmaWxlXG4gICAgdGhpcy5wcm9qZWN0TG9jYXRpb24gPSBwcm9qZWN0TG9jYXRpb25cbiAgICB0aGlzLmdob3N0TWFuYWdlciA9IGdob3N0TWFuYWdlclxuICAgIHRoaXMuZmxvd3NEaXIgPSB0aGlzLmJvdGZpbGUuZmxvd3NEaXIgfHwgJy4vZmxvd3MnXG5cbiAgICBta2RpcnAuc3luYyhwYXRoLmRpcm5hbWUodGhpcy5mbG93c0RpcikpXG4gICAgdGhpcy5naG9zdE1hbmFnZXIuYWRkUm9vdEZvbGRlcih0aGlzLmZsb3dzRGlyLCB7IGZpbGVzR2xvYjogJyoqLyouanNvbicgfSlcbiAgfVxuXG4gIGFzeW5jIGxvYWRBbGwoKSB7XG4gICAgY29uc3QgZmxvd0ZpbGVzID0gYXdhaXQgdGhpcy5naG9zdE1hbmFnZXIuZGlyZWN0b3J5TGlzdGluZyh0aGlzLmZsb3dzRGlyLCAnLmZsb3cuanNvbicpXG5cbiAgICBjb25zdCBmbG93cyA9IGF3YWl0IFByb21pc2UubWFwKGZsb3dGaWxlcywgYXN5bmMgZmxvd1BhdGggPT4ge1xuICAgICAgY29uc3QgZmxvdyA9IEpTT04ucGFyc2UoYXdhaXQgdGhpcy5naG9zdE1hbmFnZXIucmVhZEZpbGUodGhpcy5mbG93c0RpciwgZmxvd1BhdGgpKVxuXG4gICAgICBjb25zdCBzY2hlbWFFcnJvciA9IHZhbGlkYXRlRmxvd1NjaGVtYShmbG93KVxuICAgICAgaWYgKCFmbG93IHx8IHNjaGVtYUVycm9yKSB7XG4gICAgICAgIHJldHVybiBmbG93ID8gdGhpcy5sb2dnZXIud2FybihzY2hlbWFFcnJvcikgOiBudWxsXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVpRXEgPSBKU09OLnBhcnNlKGF3YWl0IHRoaXMuZ2hvc3RNYW5hZ2VyLnJlYWRGaWxlKHRoaXMuZmxvd3NEaXIsIHRoaXMuX3VpUGF0aChmbG93UGF0aCkpKVxuXG4gICAgICBPYmplY3QuYXNzaWduKGZsb3csIHsgbGlua3M6IHVpRXEubGlua3MgfSlcblxuICAgICAgLy8gVGFrZSBwb3NpdGlvbiBmcm9tIFVJIGZpbGVzIG9yIGNyZWF0ZSBkZWZhdWx0IHBvc2l0aW9uXG4gICAgICBsZXQgdW5wbGFjZWRJbmRleCA9IC0xXG4gICAgICBmbG93Lm5vZGVzID0gZmxvdy5ub2Rlcy5tYXAobm9kZSA9PiB7XG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gXy5nZXQoXy5maW5kKHVpRXEubm9kZXMsIHsgaWQ6IG5vZGUuaWQgfSksICdwb3NpdGlvbicpXG4gICAgICAgIGNvbnN0IHBsYWNpbmdTdGVwID0gMjUwXG4gICAgICAgIHVucGxhY2VkSW5kZXggPSBwb3NpdGlvbiA/IHVucGxhY2VkSW5kZXggOiB1bnBsYWNlZEluZGV4ICsgMVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ubm9kZSxcbiAgICAgICAgICB4OiBwb3NpdGlvbiA/IHBvc2l0aW9uLnggOiA1MCArIHVucGxhY2VkSW5kZXggKiBwbGFjaW5nU3RlcCxcbiAgICAgICAgICB5OiBwb3NpdGlvbiA/IHBvc2l0aW9uLnkgOiAoXy5tYXhCeShmbG93Lm5vZGVzLCAneScpIHx8IHsgeTogMCB9KS55ICsgcGxhY2luZ1N0ZXBcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogZmxvd1BhdGgsXG4gICAgICAgIGxvY2F0aW9uOiBmbG93UGF0aCxcbiAgICAgICAgbm9kZXM6IF8uZmlsdGVyKGZsb3cubm9kZXMsIG5vZGUgPT4gISFub2RlKSxcbiAgICAgICAgLi4uXy5waWNrKGZsb3csICd2ZXJzaW9uJywgJ2NhdGNoQWxsJywgJ3N0YXJ0Tm9kZScsICdsaW5rcycsICdza2lsbERhdGEnKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gZmxvd3MuZmlsdGVyKEJvb2xlYW4pXG4gIH1cblxuICBhc3luYyBzYXZlRmxvd3MoZmxvd3MpIHtcbiAgICBpZiAoIWZsb3dzLmZpbmQoKHsgZmxvdyB9KSA9PiBmbG93ID09PSAnbWFpbi5mbG93Lmpzb24nKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBbRmxvd10gRXhwZWN0ZWQgZmxvd3MgbGlzdCB0byBjb250YWluICdtYWluLmZsb3cuanNvbidgKVxuICAgIH1cbiAgICBjb25zdCBmbG93c1RvU2F2ZSA9IGF3YWl0IFByb21pc2UubWFwU2VyaWVzKGZsb3dzLCBmbG93ID0+IHRoaXMuX3ByZXBhcmVTYXZlRmxvdyhmbG93KSlcbiAgICBjb25zdCBmbG93c1NhdmVQcm9taXNlcyA9IF8uZmxhdHRlbihcbiAgICAgIGZsb3dzVG9TYXZlLm1hcCgoeyBmbG93UGF0aCwgdWlQYXRoLCBmbG93Q29udGVudCwgdWlDb250ZW50IH0pID0+IFtcbiAgICAgICAgdGhpcy5naG9zdE1hbmFnZXIudXBzZXJ0RmlsZSh0aGlzLmZsb3dzRGlyLCBmbG93UGF0aCwgSlNPTi5zdHJpbmdpZnkoZmxvd0NvbnRlbnQsIG51bGwsIDIpKSxcbiAgICAgICAgdGhpcy5naG9zdE1hbmFnZXIudXBzZXJ0RmlsZSh0aGlzLmZsb3dzRGlyLCB1aVBhdGgsIEpTT04uc3RyaW5naWZ5KHVpQ29udGVudCwgbnVsbCwgMikpXG4gICAgICBdKVxuICAgIClcblxuICAgIGNvbnN0IHBhdGhzVG9PbWl0ID0gXy5mbGF0dGVuKGZsb3dzVG9TYXZlLm1hcChmbG93ID0+IFtmbG93LmZsb3dQYXRoLCBmbG93LnVpUGF0aF0pKVxuXG4gICAgY29uc3QgZmxvd0ZpbGVzID0gYXdhaXQgdGhpcy5naG9zdE1hbmFnZXIuZGlyZWN0b3J5TGlzdGluZyh0aGlzLmZsb3dzRGlyLCAnLmpzb24nLCBwYXRoc1RvT21pdClcbiAgICBjb25zdCBmbG93c0RlbGV0ZVByb21pc2VzID0gZmxvd0ZpbGVzLm1hcChmaWxlUGF0aCA9PiB0aGlzLmdob3N0TWFuYWdlci5kZWxldGVGaWxlKHRoaXMuZmxvd3NEaXIsIGZpbGVQYXRoKSlcblxuICAgIGF3YWl0IFByb21pc2UuYWxsKGZsb3dzU2F2ZVByb21pc2VzLmNvbmNhdChmbG93c0RlbGV0ZVByb21pc2VzKSlcblxuICAgIHRoaXMuZW1pdCgnZmxvd3NDaGFuZ2VkJylcbiAgfVxuXG4gIGFzeW5jIF9wcmVwYXJlU2F2ZUZsb3coZmxvdykge1xuICAgIGZsb3cgPSBPYmplY3QuYXNzaWduKHt9LCBmbG93LCB7IHZlcnNpb246ICcwLjEnIH0pXG5cbiAgICBjb25zdCBzY2hlbWFFcnJvciA9IHZhbGlkYXRlRmxvd1NjaGVtYShmbG93KVxuICAgIGlmIChzY2hlbWFFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHNjaGVtYUVycm9yKVxuICAgIH1cblxuICAgIC8vIFdoYXQgZ29lcyBpbiB0aGUgdWkuanNvbiBmaWxlXG4gICAgY29uc3QgdWlDb250ZW50ID0ge1xuICAgICAgbm9kZXM6IGZsb3cubm9kZXMubWFwKG5vZGUgPT4gKHsgaWQ6IG5vZGUuaWQsIHBvc2l0aW9uOiBfLnBpY2sobm9kZSwgJ3gnLCAneScpIH0pKSxcbiAgICAgIGxpbmtzOiBmbG93LmxpbmtzXG4gICAgfVxuXG4gICAgLy8gV2hhdCBnb2VzIGluIHRoZSAuZmxvdy5qc29uIGZpbGVcbiAgICBjb25zdCBmbG93Q29udGVudCA9IHtcbiAgICAgIC4uLl8ucGljayhmbG93LCAndmVyc2lvbicsICdjYXRjaEFsbCcsICdzdGFydE5vZGUnLCAnc2tpbGxEYXRhJyksXG4gICAgICBub2RlczogZmxvdy5ub2Rlcy5tYXAobm9kZSA9PiBfLm9taXQobm9kZSwgJ3gnLCAneScsICdsYXN0TW9kaWZpZWQnKSlcbiAgICB9XG5cbiAgICBjb25zdCBmbG93UGF0aCA9IGZsb3cubG9jYXRpb25cbiAgICByZXR1cm4geyBmbG93UGF0aCwgdWlQYXRoOiB0aGlzLl91aVBhdGgoZmxvd1BhdGgpLCBmbG93Q29udGVudCwgdWlDb250ZW50IH1cbiAgfVxuXG4gIF91aVBhdGgoZmxvd1BhdGgpIHtcbiAgICByZXR1cm4gZmxvd1BhdGgucmVwbGFjZSgvXFwuZmxvd1xcLmpzb24vaSwgJy51aS5qc29uJylcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/dialog/provider.js\n");

/***/ }),

/***/ "./src/dialog/state.js":
/*!*****************************!*\
  !*** ./src/dialog/state.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(/*! ../database/helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * The Dialog State Manager is in charge of keeping track of the state\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * for all conversations. This is being used internally by the [Dialog Engine]{@link DialogEngine}\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * but is also exposed publicly if you need to programmatically alter the state of some conversations.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @namespace DialogStateManager\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * bp.dialogEngine.stateManager\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */\n\nmodule.exports = function (_ref) {\n  var db = _ref.db,\n      _ref$internals = _ref.internals,\n      internals = _ref$internals === undefined ? {} : _ref$internals;\n\n  var _internals = Object.assign({\n    _isExpired: function _isExpired(session) {\n      return false; // TODO Implement\n    }\n  }, internals);\n\n  var _upsertState = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(stateId, state) {\n      var sql, knex, params;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              sql = void 0;\n              _context.next = 3;\n              return db.get();\n\n            case 3:\n              knex = _context.sent;\n              params = {\n                tableName: 'dialog_sessions',\n                stateId: stateId,\n                state: JSON.stringify(state),\n                now: (0, _helpers2.default)(knex).date.now()\n              };\n\n\n              if ((0, _helpers2.default)(knex).isLite()) {\n                sql = '\\n        INSERT OR REPLACE INTO :tableName: (id, state, active_on)\\n        VALUES (:stateId, :state, :now)\\n      ';\n              } else {\n                sql = '\\n        INSERT INTO :tableName: (id, state, active_on, created_on)\\n        VALUES (:stateId, :state, :now, :now)\\n        ON CONFLICT (id) DO UPDATE\\n          SET active_on = :now, state = :state\\n      ';\n              }\n\n              return _context.abrupt('return', knex.raw(sql, params));\n\n            case 7:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function _upsertState(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var _createEmptyState = function _createEmptyState(stateId) {\n    return { _stateId: stateId };\n  };\n\n  var _createSession = function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(stateId) {\n      var knex, now, sessionData;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context2.sent;\n              now = (0, _helpers2.default)(knex).date.now();\n              sessionData = {\n                id: stateId,\n                created_on: now,\n                active_on: now,\n                state: JSON.stringify(_createEmptyState(stateId))\n              };\n              _context2.next = 7;\n              return knex('dialog_sessions').insert(sessionData);\n\n            case 7:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function _createSession(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Returns the current state of the conversation\n   * @param  {String} stateId\n   * @return {Object} The conversation state\n   * @async\n   * @memberof! DialogStateManager\n   * @example\n   * const state = await bp.dialogEngine.stateManager.getState(event.user.id)\n   */\n  var getState = function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(stateId) {\n      var knex, session;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context3.sent;\n              _context3.next = 5;\n              return knex('dialog_sessions').where({ id: stateId }).limit(1).then().get(0).then();\n\n            case 5:\n              session = _context3.sent;\n\n              if (!session) {\n                _context3.next = 16;\n                break;\n              }\n\n              if (!_internals._isExpired(session)) {\n                _context3.next = 13;\n                break;\n              }\n\n              _context3.next = 10;\n              return _createSession(stateId);\n\n            case 10:\n              return _context3.abrupt('return', getState(stateId));\n\n            case 13:\n              return _context3.abrupt('return', JSON.parse(session.state));\n\n            case 14:\n              _context3.next = 19;\n              break;\n\n            case 16:\n              _context3.next = 18;\n              return _createSession(stateId);\n\n            case 18:\n              return _context3.abrupt('return', getState(stateId));\n\n            case 19:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function getState(_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Overwrites the state of a current conversation\n   * @param  {String} stateId\n   * @param {Object} state The conversation state\n   * @return {Object} The new state\n   * @async\n   * @memberof! DialogStateManager\n   */\n  var setState = function setState(stateId, state) {\n    if (_lodash2.default.isNil(state)) {\n      state = _createEmptyState(stateId);\n    }\n\n    if (!_lodash2.default.isPlainObject(state)) {\n      throw new Error('State must be a plain object');\n    }\n\n    return _upsertState(stateId, state);\n  };\n\n  /**\n   * Deletes the state(s) and (optionally) the associated sub-states (for e.g. ___context sub-state)\n   * @param stateId The state to delete\n   * @param {Array<String>} [substates] Detaults to ['context']. If this is empty it will delete no substate\n   * @async\n   * @memberof! DialogStateManager\n   */\n  var deleteState = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(stateId) {\n      var substates = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['context'];\n      var knex, states;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context4.sent;\n              states = [stateId].concat(_toConsumableArray(substates.map(function (x) {\n                return stateId + '___' + x;\n              })));\n              _context4.next = 6;\n              return knex('dialog_sessions').whereIn('id', states).del().then();\n\n            case 6:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function deleteState(_x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return {\n    getState: getState,\n    setState: setState,\n    deleteState: deleteState\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGlhbG9nL3N0YXRlLmpzPzk3N2UiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImRiIiwiaW50ZXJuYWxzIiwiX2ludGVybmFscyIsIk9iamVjdCIsImFzc2lnbiIsIl9pc0V4cGlyZWQiLCJfdXBzZXJ0U3RhdGUiLCJzdGF0ZUlkIiwic3RhdGUiLCJzcWwiLCJnZXQiLCJrbmV4IiwicGFyYW1zIiwidGFibGVOYW1lIiwiSlNPTiIsInN0cmluZ2lmeSIsIm5vdyIsImRhdGUiLCJpc0xpdGUiLCJyYXciLCJfY3JlYXRlRW1wdHlTdGF0ZSIsIl9zdGF0ZUlkIiwiX2NyZWF0ZVNlc3Npb24iLCJzZXNzaW9uRGF0YSIsImlkIiwiY3JlYXRlZF9vbiIsImFjdGl2ZV9vbiIsImluc2VydCIsImdldFN0YXRlIiwid2hlcmUiLCJsaW1pdCIsInRoZW4iLCJzZXNzaW9uIiwicGFyc2UiLCJzZXRTdGF0ZSIsIl8iLCJpc05pbCIsImlzUGxhaW5PYmplY3QiLCJFcnJvciIsImRlbGV0ZVN0YXRlIiwic3Vic3RhdGVzIiwic3RhdGVzIiwibWFwIiwieCIsIndoZXJlSW4iLCJkZWwiXSwibWFwcGluZ3MiOiI7O0FBU0E7Ozs7QUFDQTs7Ozs7Ozs7MmNBVkE7Ozs7Ozs7OztBQVlBQSxPQUFPQyxPQUFQLEdBQWlCLGdCQUE0QjtBQUFBLE1BQXpCQyxFQUF5QixRQUF6QkEsRUFBeUI7QUFBQSw0QkFBckJDLFNBQXFCO0FBQUEsTUFBckJBLFNBQXFCLGtDQUFULEVBQVM7O0FBQzNDLE1BQU1DLGFBQWFDLE9BQU9DLE1BQVAsQ0FDakI7QUFDRUMsZ0JBQVksNkJBQVc7QUFDckIsYUFBTyxLQUFQLENBRHFCLENBQ1I7QUFDZDtBQUhILEdBRGlCLEVBTWpCSixTQU5pQixDQUFuQjs7QUFTQSxNQUFNSztBQUFBLHdFQUFlLGlCQUFPQyxPQUFQLEVBQWdCQyxLQUFoQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDZkMsaUJBRGU7QUFBQTtB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QUFNLElBQUk4QixLQUFKLENBQVUsOEJBQVYsQ0FBTjtBQUNEOztBQUVELFdBQU9oQyxhQUFhQyxPQUFiLEVBQXNCQyxLQUF0QixDQUFQO0FBQ0QsR0FWRDs7QUFZQTs7Ozs7OztBQU9BLE1BQU0rQjtBQUFBLHdFQUFjLGtCQUFPaEMsT0FBUDtBQUFBLFVBQWdCaUMsU0FBaEIsdUVBQTRCLENBQUMsU0FBRCxDQUE1QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHFCQUNDeEMsR0FBR1UsR0FBSCxFQUREOztBQUFBO0FBQ1pDLGtCQURZO0FBR1o4QixvQkFIWSxJQUdGbEMsT0FIRSw0QkFHVWlDLFVBQVVFLEdBQVYsQ0FBYztBQUFBLHVCQUFRbkMsT0FBUixXQUFxQm9DLENBQXJCO0FBQUEsZUFBZCxDQUhWO0FBQUE7QUFBQSxxQkFLWmhDLEtBQUssaUJBQUwsRUFDSGlDLE9BREcsQ0FDSyxJQURMLEVBQ1dILE1BRFgsRUFFSEksR0FGRyxHQUdIZCxJQUhHLEVBTFk7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBZDs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQVdBLFNBQU87QUFDTEgsc0JBREs7QUFFTE0sc0JBRks7QUFHTEs7QUFISyxHQUFQO0FBS0QsQ0FySUQiLCJmaWxlIjoiLi9zcmMvZGlhbG9nL3N0YXRlLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgRGlhbG9nIFN0YXRlIE1hbmFnZXIgaXMgaW4gY2hhcmdlIG9mIGtlZXBpbmcgdHJhY2sgb2YgdGhlIHN0YXRlXG4gKiBmb3IgYWxsIGNvbnZlcnNhdGlvbnMuIFRoaXMgaXMgYmVpbmcgdXNlZCBpbnRlcm5hbGx5IGJ5IHRoZSBbRGlhbG9nIEVuZ2luZV17QGxpbmsgRGlhbG9nRW5naW5lfVxuICogYnV0IGlzIGFsc28gZXhwb3NlZCBwdWJsaWNseSBpZiB5b3UgbmVlZCB0byBwcm9ncmFtbWF0aWNhbGx5IGFsdGVyIHRoZSBzdGF0ZSBvZiBzb21lIGNvbnZlcnNhdGlvbnMuXG4gKiBAbmFtZXNwYWNlIERpYWxvZ1N0YXRlTWFuYWdlclxuICogQGV4YW1wbGVcbiAqIGJwLmRpYWxvZ0VuZ2luZS5zdGF0ZU1hbmFnZXJcbiAqL1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuLi9kYXRhYmFzZS9oZWxwZXJzJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IGRiLCBpbnRlcm5hbHMgPSB7fSB9KSA9PiB7XG4gIGNvbnN0IF9pbnRlcm5hbHMgPSBPYmplY3QuYXNzaWduKFxuICAgIHtcbiAgICAgIF9pc0V4cGlyZWQ6IHNlc3Npb24gPT4ge1xuICAgICAgICByZXR1cm4gZmFsc2UgLy8gVE9ETyBJbXBsZW1lbnRcbiAgICAgIH1cbiAgICB9LFxuICAgIGludGVybmFsc1xuICApXG5cbiAgY29uc3QgX3Vwc2VydFN0YXRlID0gYXN5bmMgKHN0YXRlSWQsIHN0YXRlKSA9PiB7XG4gICAgbGV0IHNxbFxuXG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICB0YWJsZU5hbWU6ICdkaWFsb2dfc2Vzc2lvbnMnLFxuICAgICAgc3RhdGVJZCxcbiAgICAgIHN0YXRlOiBKU09OLnN0cmluZ2lmeShzdGF0ZSksXG4gICAgICBub3c6IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKVxuICAgIH1cblxuICAgIGlmIChoZWxwZXJzKGtuZXgpLmlzTGl0ZSgpKSB7XG4gICAgICBzcWwgPSBgXG4gICAgICAgIElOU0VSVCBPUiBSRVBMQUNFIElOVE8gOnRhYmxlTmFtZTogKGlkLCBzdGF0ZSwgYWN0aXZlX29uKVxuICAgICAgICBWQUxVRVMgKDpzdGF0ZUlkLCA6c3RhdGUsIDpub3cpXG4gICAgICBgXG4gICAgfSBlbHNlIHtcbiAgICAgIHNxbCA9IGBcbiAgICAgICAgSU5TRVJUIElOVE8gOnRhYmxlTmFtZTogKGlkLCBzdGF0ZSwgYWN0aXZlX29uLCBjcmVhdGVkX29uKVxuICAgICAgICBWQUxVRVMgKDpzdGF0ZUlkLCA6c3RhdGUsIDpub3csIDpub3cpXG4gICAgICAgIE9OIENPTkZMSUNUIChpZCkgRE8gVVBEQVRFXG4gICAgICAgICAgU0VUIGFjdGl2ZV9vbiA9IDpub3csIHN0YXRlID0gOnN0YXRlXG4gICAgICBgXG4gICAgfVxuXG4gICAgcmV0dXJuIGtuZXgucmF3KHNxbCwgcGFyYW1zKVxuICB9XG5cbiAgY29uc3QgX2NyZWF0ZUVtcHR5U3RhdGUgPSBzdGF0ZUlkID0+IHtcbiAgICByZXR1cm4geyBfc3RhdGVJZDogc3RhdGVJZCB9XG4gIH1cblxuICBjb25zdCBfY3JlYXRlU2Vzc2lvbiA9IGFzeW5jIHN0YXRlSWQgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuICAgIGNvbnN0IG5vdyA9IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKVxuXG4gICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSB7XG4gICAgICBpZDogc3RhdGVJZCxcbiAgICAgIGNyZWF0ZWRfb246IG5vdyxcbiAgICAgIGFjdGl2ZV9vbjogbm93LFxuICAgICAgc3RhdGU6IEpTT04uc3RyaW5naWZ5KF9jcmVhdGVFbXB0eVN0YXRlKHN0YXRlSWQpKVxuICAgIH1cblxuICAgIGF3YWl0IGtuZXgoJ2RpYWxvZ19zZXNzaW9ucycpLmluc2VydChzZXNzaW9uRGF0YSlcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBjb252ZXJzYXRpb25cbiAgICogQHBhcmFtICB7U3RyaW5nfSBzdGF0ZUlkXG4gICAqIEByZXR1cm4ge09iamVjdH0gVGhlIGNvbnZlcnNhdGlvbiBzdGF0ZVxuICAgKiBAYXN5bmNcbiAgICogQG1lbWJlcm9mISBEaWFsb2dTdGF0ZU1hbmFnZXJcbiAgICogQGV4YW1wbGVcbiAgICogY29uc3Qgc3RhdGUgPSBhd2FpdCBicC5kaWFsb2dFbmdpbmUuc3RhdGVNYW5hZ2VyLmdldFN0YXRlKGV2ZW50LnVzZXIuaWQpXG4gICAqL1xuICBjb25zdCBnZXRTdGF0ZSA9IGFzeW5jIHN0YXRlSWQgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGtuZXgoJ2RpYWxvZ19zZXNzaW9ucycpXG4gICAgICAud2hlcmUoeyBpZDogc3RhdGVJZCB9KVxuICAgICAgLmxpbWl0KDEpXG4gICAgICAudGhlbigpXG4gICAgICAuZ2V0KDApXG4gICAgICAudGhlbigpXG5cbiAgICBpZiAoc2Vzc2lvbikge1xuICAgICAgaWYgKF9pbnRlcm5hbHMuX2lzRXhwaXJlZChzZXNzaW9uKSkge1xuICAgICAgICAvLyBUT0RPIHRyaWdnZXIgdGltZSBvdXRcbiAgICAgICAgYXdhaXQgX2NyZWF0ZVNlc3Npb24oc3RhdGVJZClcbiAgICAgICAgcmV0dXJuIGdldFN0YXRlKHN0YXRlSWQpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzZXNzaW9uLnN0YXRlKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBfY3JlYXRlU2Vzc2lvbihzdGF0ZUlkKVxuICAgICAgcmV0dXJuIGdldFN0YXRlKHN0YXRlSWQpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE92ZXJ3cml0ZXMgdGhlIHN0YXRlIG9mIGEgY3VycmVudCBjb252ZXJzYXRpb25cbiAgICogQHBhcmFtICB7U3RyaW5nfSBzdGF0ZUlkXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBzdGF0ZSBUaGUgY29udmVyc2F0aW9uIHN0YXRlXG4gICAqIEByZXR1cm4ge09iamVjdH0gVGhlIG5ldyBzdGF0ZVxuICAgKiBAYXN5bmNcbiAgICogQG1lbWJlcm9mISBEaWFsb2dTdGF0ZU1hbmFnZXJcbiAgICovXG4gIGNvbnN0IHNldFN0YXRlID0gKHN0YXRlSWQsIHN0YXRlKSA9PiB7XG4gICAgaWYgKF8uaXNOaWwoc3RhdGUpKSB7XG4gICAgICBzdGF0ZSA9IF9jcmVhdGVFbXB0eVN0YXRlKHN0YXRlSWQpXG4gICAgfVxuXG4gICAgaWYgKCFfLmlzUGxhaW5PYmplY3Qoc3RhdGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0YXRlIG11c3QgYmUgYSBwbGFpbiBvYmplY3QnKVxuICAgIH1cblxuICAgIHJldHVybiBfdXBzZXJ0U3RhdGUoc3RhdGVJZCwgc3RhdGUpXG4gIH1cblxuICAvKipcbiAgICogRGVsZXRlcyB0aGUgc3RhdGUocykgYW5kIChvcHRpb25hbGx5KSB0aGUgYXNzb2NpYXRlZCBzdWItc3RhdGVzIChmb3IgZS5nLiBfX19jb250ZXh0IHN1Yi1zdGF0ZSlcbiAgICogQHBhcmFtIHN0YXRlSWQgVGhlIHN0YXRlIHRvIGRlbGV0ZVxuICAgKiBAcGFyYW0ge0FycmF5PFN0cmluZz59IFtzdWJzdGF0ZXNdIERldGF1bHRzIHRvIFsnY29udGV4dCddLiBJZiB0aGlzIGlzIGVtcHR5IGl0IHdpbGwgZGVsZXRlIG5vIHN1YnN0YXRlXG4gICAqIEBhc3luY1xuICAgKiBAbWVtYmVyb2YhIERpYWxvZ1N0YXRlTWFuYWdlclxuICAgKi9cbiAgY29uc3QgZGVsZXRlU3RhdGUgPSBhc3luYyAoc3RhdGVJZCwgc3Vic3RhdGVzID0gWydjb250ZXh0J10pID0+IHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIGNvbnN0IHN0YXRlcyA9IFtzdGF0ZUlkLCAuLi5zdWJzdGF0ZXMubWFwKHggPT4gYCR7c3RhdGVJZH1fX18ke3h9YCldXG5cbiAgICBhd2FpdCBrbmV4KCdkaWFsb2dfc2Vzc2lvbnMnKVxuICAgICAgLndoZXJlSW4oJ2lkJywgc3RhdGVzKVxuICAgICAgLmRlbCgpXG4gICAgICAudGhlbigpXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdldFN0YXRlLFxuICAgIHNldFN0YXRlLFxuICAgIGRlbGV0ZVN0YXRlXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/dialog/state.js\n");

/***/ }),

/***/ "./src/dialog/validator.js":
/*!*********************************!*\
  !*** ./src/dialog/validator.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validateFlowSchema = undefined;\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar validateFlowSchema = exports.validateFlowSchema = function validateFlowSchema(flow) {\n  var errorPrefix = '[Flow] Invalid flow \"' + (flow && flow.location) + '\"';\n\n  if (!flow || !_lodash2.default.isObjectLike(flow)) {\n    return 'Invalid JSON flow schema';\n  }\n\n  if (!flow.version || !_lodash2.default.isString(flow.version)) {\n    return errorPrefix + ', expected valid version but found none';\n  }\n\n  if (!flow.version.startsWith('0.')) {\n    return errorPrefix + ', unsupported version of the schema \"' + flow.version + '\"';\n  }\n\n  if (!_lodash2.default.isString(flow.startNode)) {\n    return errorPrefix + ', expected valid \\'startNode\\'';\n  }\n\n  if (!_lodash2.default.isArray(flow.nodes)) {\n    return errorPrefix + ', expected \\'nodes\\' to be an array of nodes';\n  }\n\n  if (!_lodash2.default.find(flow.nodes, { name: flow.startNode })) {\n    return errorPrefix + ', expected \\'startNode\\' to point to a valid node name';\n  }\n\n  if (flow.catchAll && flow.catchAll.onEnter) {\n    return errorPrefix + ', \"catchAll\" does not support \"onEnter\"';\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = flow.nodes[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var node = _step.value;\n\n      if (!_lodash2.default.isString(node.id) || node.id.length <= 3) {\n        return errorPrefix + ', expected node ' + node.id + ' (' + node.name + ') to have a valid id';\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZGlhbG9nL3ZhbGlkYXRvci5qcz8wMjdiIl0sIm5hbWVzIjpbInZhbGlkYXRlRmxvd1NjaGVtYSIsImVycm9yUHJlZml4IiwiZmxvdyIsImxvY2F0aW9uIiwiXyIsImlzT2JqZWN0TGlrZSIsInZlcnNpb24iLCJpc1N0cmluZyIsInN0YXJ0c1dpdGgiLCJzdGFydE5vZGUiLCJpc0FycmF5Iiwibm9kZXMiLCJmaW5kIiwibmFtZSIsImNhdGNoQWxsIiwib25FbnRlciIsIm5vZGUiLCJpZCIsImxlbmd0aCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7Ozs7QUFFTyxJQUFNQSxrREFBcUIsU0FBckJBLGtCQUFxQixPQUFRO0FBQ3hDLE1BQU1DLHlDQUFzQ0MsUUFBUUEsS0FBS0MsUUFBbkQsT0FBTjs7QUFFQSxNQUFJLENBQUNELElBQUQsSUFBUyxDQUFDRSxpQkFBRUMsWUFBRixDQUFlSCxJQUFmLENBQWQsRUFBb0M7QUFDbEMsV0FBTywwQkFBUDtBQUNEOztBQUVELE1BQUksQ0FBQ0EsS0FBS0ksT0FBTixJQUFpQixDQUFDRixpQkFBRUcsUUFBRixDQUFXTCxLQUFLSSxPQUFoQixDQUF0QixFQUFnRDtBQUM5QyxXQUFVTCxXQUFWO0FBQ0Q7O0FBRUQsTUFBSSxDQUFDQyxLQUFLSSxPQUFMLENBQWFFLFVBQWIsQ0FBd0IsSUFBeEIsQ0FBTCxFQUFvQztBQUNsQyxXQUFVUCxXQUFWLDZDQUE2REMsS0FBS0ksT0FBbEU7QUFDRDs7QUFFRCxNQUFJLENBQUNGLGlCQUFFRyxRQUFGLENBQVdMLEtBQUtPLFNBQWhCLENBQUwsRUFBaUM7QUFDL0IsV0FBVVIsV0FBVjtBQUNEOztBQUVELE1BQUksQ0FBQ0csaUJBQUVNLE9BQUYsQ0FBVVIsS0FBS1MsS0FBZixDQUFMLEVBQTRCO0FBQzFCLFdBQVVWLFdBQVY7QUFDRDs7QUFFRCxNQUFJLENBQUNHLGlCQUFFUSxJQUFGLENBQU9WLEtBQUtTLEtBQVosRUFBbUIsRUFBRUUsTUFBTVgsS0FBS08sU0FBYixFQUFuQixDQUFMLEVBQW1EO0FBQ2pELFdBQVVSLFdBQVY7QUFDRDs7QUFFRCxNQUFJQyxLQUFLWSxRQUFMLElBQWlCWixLQUFLWSxRQUFMLENBQWNDLE9BQW5DLEVBQTRDO0FBQzFDLFdBQVVkLFdBQVY7QUFDRDs7QUE3QnVDO0FBQUE7QUFBQTs7QUFBQTtBQStCeEMseUJBQW1CQyxLQUFLUyxLQUF4Qiw4SEFBK0I7QUFBQSxVQUFwQkssSUFBb0I7O0FBQzdCLFVBQUksQ0FBQ1osaUJBQUVHLFFBQUYsQ0FBV1MsS0FBS0MsRUFBaEIsQ0FBRCxJQUF3QkQsS0FBS0MsRUFBTCxDQUFRQyxNQUFSLElBQWtCLENBQTlDLEVBQWlEO0FBQy9DLGVBQVVqQixXQUFWLHdCQUF3Q2UsS0FBS0MsRUFBN0MsVUFBb0RELEtBQUtILElBQXpEO0FBQ0Q7QUFDRjtBQW5DdUM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQW9DekMsQ0FwQ00iLCJmaWxlIjoiLi9zcmMvZGlhbG9nL3ZhbGlkYXRvci5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlRmxvd1NjaGVtYSA9IGZsb3cgPT4ge1xuICBjb25zdCBlcnJvclByZWZpeCA9IGBbRmxvd10gSW52YWxpZCBmbG93IFwiJHtmbG93ICYmIGZsb3cubG9jYXRpb259XCJgXG5cbiAgaWYgKCFmbG93IHx8ICFfLmlzT2JqZWN0TGlrZShmbG93KSkge1xuICAgIHJldHVybiAnSW52YWxpZCBKU09OIGZsb3cgc2NoZW1hJ1xuICB9XG5cbiAgaWYgKCFmbG93LnZlcnNpb24gfHwgIV8uaXNTdHJpbmcoZmxvdy52ZXJzaW9uKSkge1xuICAgIHJldHVybiBgJHtlcnJvclByZWZpeH0sIGV4cGVjdGVkIHZhbGlkIHZlcnNpb24gYnV0IGZvdW5kIG5vbmVgXG4gIH1cblxuICBpZiAoIWZsb3cudmVyc2lvbi5zdGFydHNXaXRoKCcwLicpKSB7XG4gICAgcmV0dXJuIGAke2Vycm9yUHJlZml4fSwgdW5zdXBwb3J0ZWQgdmVyc2lvbiBvZiB0aGUgc2NoZW1hIFwiJHtmbG93LnZlcnNpb259XCJgXG4gIH1cblxuICBpZiAoIV8uaXNTdHJpbmcoZmxvdy5zdGFydE5vZGUpKSB7XG4gICAgcmV0dXJuIGAke2Vycm9yUHJlZml4fSwgZXhwZWN0ZWQgdmFsaWQgJ3N0YXJ0Tm9kZSdgXG4gIH1cblxuICBpZiAoIV8uaXNBcnJheShmbG93Lm5vZGVzKSkge1xuICAgIHJldHVybiBgJHtlcnJvclByZWZpeH0sIGV4cGVjdGVkICdub2RlcycgdG8gYmUgYW4gYXJyYXkgb2Ygbm9kZXNgXG4gIH1cblxuICBpZiAoIV8uZmluZChmbG93Lm5vZGVzLCB7IG5hbWU6IGZsb3cuc3RhcnROb2RlIH0pKSB7XG4gICAgcmV0dXJuIGAke2Vycm9yUHJlZml4fSwgZXhwZWN0ZWQgJ3N0YXJ0Tm9kZScgdG8gcG9pbnQgdG8gYSB2YWxpZCBub2RlIG5hbWVgXG4gIH1cblxuICBpZiAoZmxvdy5jYXRjaEFsbCAmJiBmbG93LmNhdGNoQWxsLm9uRW50ZXIpIHtcbiAgICByZXR1cm4gYCR7ZXJyb3JQcmVmaXh9LCBcImNhdGNoQWxsXCIgZG9lcyBub3Qgc3VwcG9ydCBcIm9uRW50ZXJcImBcbiAgfVxuXG4gIGZvciAoY29uc3Qgbm9kZSBvZiBmbG93Lm5vZGVzKSB7XG4gICAgaWYgKCFfLmlzU3RyaW5nKG5vZGUuaWQpIHx8IG5vZGUuaWQubGVuZ3RoIDw9IDMpIHtcbiAgICAgIHJldHVybiBgJHtlcnJvclByZWZpeH0sIGV4cGVjdGVkIG5vZGUgJHtub2RlLmlkfSAoJHtub2RlLm5hbWV9KSB0byBoYXZlIGEgdmFsaWQgaWRgXG4gICAgfVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/dialog/validator.js\n");

/***/ }),

/***/ "./src/fallback.js":
/*!*************************!*\
  !*** ./src/fallback.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _listeners = __webpack_require__(/*! ./listeners */ \"./src/listeners.js\");\n\nvar _listeners2 = _interopRequireDefault(_listeners);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (bp) {\n  var middleware = {\n    name: 'fallback',\n    type: 'incoming',\n    order: 200,\n    module: 'botpress',\n    description: 'The built-in fallback handler. You may override this by implementing bp.fallbackHandler',\n    handler: function handler(event, next) {\n      if (_lodash2.default.isFunction(bp.fallbackHandler)) {\n        bp.fallbackHandler(event, next);\n      }\n    }\n  };\n\n  return { middleware: middleware };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZmFsbGJhY2suanM/MTYzNiJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwibWlkZGxld2FyZSIsIm5hbWUiLCJ0eXBlIiwib3JkZXIiLCJkZXNjcmlwdGlvbiIsImhhbmRsZXIiLCJldmVudCIsIm5leHQiLCJfIiwiaXNGdW5jdGlvbiIsImJwIiwiZmFsbGJhY2tIYW5kbGVyIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLGNBQU07QUFDckIsTUFBTUMsYUFBYTtBQUNqQkMsVUFBTSxVQURXO0FBRWpCQyxVQUFNLFVBRlc7QUFHakJDLFdBQU8sR0FIVTtBQUlqQkwsWUFBUSxVQUpTO0FBS2pCTSxpQkFBYSx5RkFMSTtBQU1qQkMsYUFBUyxpQkFBQ0MsS0FBRCxFQUFRQyxJQUFSLEVBQWlCO0FBQ3hCLFVBQUlDLGlCQUFFQyxVQUFGLENBQWFDLEdBQUdDLGVBQWhCLENBQUosRUFBc0M7QUFDcENELFdBQUdDLGVBQUgsQ0FBbUJMLEtBQW5CLEVBQTBCQyxJQUExQjtBQUNEO0FBQ0Y7QUFWZ0IsR0FBbkI7O0FBYUEsU0FBTyxFQUFFUCxzQkFBRixFQUFQO0FBQ0QsQ0FmRCIsImZpbGUiOiIuL3NyYy9mYWxsYmFjay5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBsaXN0ZW5lcnMgZnJvbSAnLi9saXN0ZW5lcnMnXG5cbm1vZHVsZS5leHBvcnRzID0gYnAgPT4ge1xuICBjb25zdCBtaWRkbGV3YXJlID0ge1xuICAgIG5hbWU6ICdmYWxsYmFjaycsXG4gICAgdHlwZTogJ2luY29taW5nJyxcbiAgICBvcmRlcjogMjAwLFxuICAgIG1vZHVsZTogJ2JvdHByZXNzJyxcbiAgICBkZXNjcmlwdGlvbjogJ1RoZSBidWlsdC1pbiBmYWxsYmFjayBoYW5kbGVyLiBZb3UgbWF5IG92ZXJyaWRlIHRoaXMgYnkgaW1wbGVtZW50aW5nIGJwLmZhbGxiYWNrSGFuZGxlcicsXG4gICAgaGFuZGxlcjogKGV2ZW50LCBuZXh0KSA9PiB7XG4gICAgICBpZiAoXy5pc0Z1bmN0aW9uKGJwLmZhbGxiYWNrSGFuZGxlcikpIHtcbiAgICAgICAgYnAuZmFsbGJhY2tIYW5kbGVyKGV2ZW50LCBuZXh0KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IG1pZGRsZXdhcmUgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/fallback.js\n");

/***/ }),

/***/ "./src/ghost-content/index.js":
/*!************************************!*\
  !*** ./src/ghost-content/index.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _glob = __webpack_require__(/*! glob */ \"glob\");\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _get = __webpack_require__(/*! lodash/get */ \"lodash/get\");\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _partition3 = __webpack_require__(/*! lodash/partition */ \"lodash/partition\");\n\nvar _partition4 = _interopRequireDefault(_partition3);\n\nvar _mapValues = __webpack_require__(/*! lodash/mapValues */ \"lodash/mapValues\");\n\nvar _mapValues2 = _interopRequireDefault(_mapValues);\n\nvar _uniq = __webpack_require__(/*! lodash/uniq */ \"lodash/uniq\");\n\nvar _uniq2 = _interopRequireDefault(_uniq);\n\nvar _transparent = __webpack_require__(/*! ./transparent */ \"./src/ghost-content/transparent.js\");\n\nvar _transparent2 = _interopRequireDefault(_transparent);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/ghost-content/util.js\");\n\nvar _util2 = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\n_bluebird2.default.promisifyAll(_fs2.default);\nvar globAsync = _bluebird2.default.promisify(_glob2.default);\n\nvar REVISIONS_FILE_NAME = '.ghost-revisions';\n\nmodule.exports = function (_ref) {\n  var logger = _ref.logger,\n      db = _ref.db,\n      projectLocation = _ref.projectLocation,\n      enabled = _ref.enabled;\n\n  if (!enabled) {\n    return (0, _transparent2.default)({ logger: logger, projectLocation: projectLocation });\n  }\n\n  var normalizeFolder = (0, _util.normalizeFolder)(projectLocation);\n\n  var pendingRevisionsByFolder = {};\n  var trackedFolders = [];\n  var folderOptions = {};\n\n  var upsert = function upsert(_ref2) {\n    var knex = _ref2.knex,\n        tableName = _ref2.tableName,\n        where = _ref2.where,\n        data = _ref2.data,\n        _ref2$idField = _ref2.idField,\n        idField = _ref2$idField === undefined ? 'id' : _ref2$idField,\n        _ref2$trx = _ref2.trx,\n        trx = _ref2$trx === undefined ? null : _ref2$trx;\n\n    var prepareQuery = function prepareQuery() {\n      return trx ? knex(tableName).transacting(trx) : knex(tableName);\n    };\n    return prepareQuery().where(where).select(idField).then(function (res) {\n      var id = (0, _get2.default)(res, '0.id');\n      return id ? prepareQuery().where(idField, id).update(data).thenReturn(id) : prepareQuery().insert(_extends({}, where, data), 'id').then(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 1),\n            insertedId = _ref4[0];\n\n        return insertedId;\n      });\n    });\n  };\n\n  var recordFile = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(folderPath, folder, file) {\n      var _ref6 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {},\n          _ref6$isBinary = _ref6.isBinary,\n          isBinary = _ref6$isBinary === undefined ? false : _ref6$isBinary;\n\n      var knex, filePath, column;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context.sent;\n              filePath = _path2.default.join(folderPath, file);\n              column = isBinary ? 'binary_content' : 'content';\n              _context.next = 7;\n              return _fs2.default.readFileAsync(filePath, isBinary ? null : 'utf8').then(function (content) {\n                return upsert({\n                  knex: knex,\n                  tableName: 'ghost_content',\n                  where: { folder: folder, file: file },\n                  data: _defineProperty({}, column, content)\n                });\n              });\n\n            case 7:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function recordFile(_x, _x2, _x3) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var getPendingRevisions = function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(normalizedFolderName) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context2.sent;\n              return _context2.abrupt('return', knex('ghost_revisions').join('ghost_content', 'ghost_content.id', '=', 'ghost_revisions.content_id').where('ghost_content.folder', normalizedFolderName).select('ghost_content.file', 'ghost_revisions.id', 'ghost_revisions.revision', 'ghost_revisions.created_on', 'ghost_revisions.created_by').orderBy('ghost_revisions.created_on', 'desc').then());\n\n            case 4:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function getPendingRevisions(_x5) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var addRootFolder = function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(rootFolder) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var _normalizeFolder2, folderPath, normalizedFolderName, _options$isBinary, isBinary, _options$filesGlob, filesGlob, revisionsFile, fileRevisionsPromise, _ref9, _ref10, knownRevisions, dbRevisions, _partition, _partition2, revisionsToDelete, remainingRevisions, knex, files;\n\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _normalizeFolder2 = normalizeFolder(rootFolder), folderPath = _normalizeFolder2.folderPath, normalizedFolderName = _normalizeFolder2.normalizedFolderName;\n              _options$isBinary = options.isBinary, isBinary = _options$isBinary === undefined ? false : _options$isBinary, _options$filesGlob = options.filesGlob, filesGlob = _options$filesGlob === undefined ? '**/*' : _options$filesGlob;\n\n\n              logger.debug('[Ghost Content Manager] adding folder ' + normalizedFolderName);\n              trackedFolders.push(normalizedFolderName);\n              folderOptions[normalizedFolderName] = options;\n\n              // read known revisions\n              revisionsFile = _path2.default.join(folderPath, REVISIONS_FILE_NAME);\n              fileRevisionsPromise = _fs2.default.readFileAsync(revisionsFile, 'utf8').catch({ code: 'ENOENT' }, function () {\n                return '';\n              }).then(function (content) {\n                return content.trim().split('\\n').map(function (s) {\n                  return s.trim();\n                }).filter(function (s) {\n                  return !!s && !s.startsWith('#');\n                }).reduce(function (acc, r) {\n                  acc[r] = true;\n                  return acc;\n                }, {});\n              });\n              _context3.next = 9;\n              return _bluebird2.default.all([fileRevisionsPromise, getPendingRevisions(normalizedFolderName)]);\n\n            case 9:\n              _ref9 = _context3.sent;\n              _ref10 = _slicedToArray(_ref9, 2);\n              knownRevisions = _ref10[0];\n              dbRevisions = _ref10[1];\n              _partition = (0, _partition4.default)(dbRevisions, function (_ref11) {\n                var revision = _ref11.revision;\n                return knownRevisions[revision];\n              }), _partition2 = _slicedToArray(_partition, 2), revisionsToDelete = _partition2[0], remainingRevisions = _partition2[1];\n              _context3.next = 16;\n              return db.get();\n\n            case 16:\n              knex = _context3.sent;\n\n              if (!revisionsToDelete.length) {\n                _context3.next = 21;\n                break;\n              }\n\n              logger.debug('[Ghost Content Manager] ' + normalizedFolderName + ': deleting ' + revisionsToDelete.length + ' known revision(s).');\n              _context3.next = 21;\n              return knex('ghost_revisions').whereIn('id', revisionsToDelete.map(function (_ref12) {\n                var id = _ref12.id;\n                return id;\n              })).del();\n\n            case 21:\n              if (!remainingRevisions.length) {\n                _context3.next = 25;\n                break;\n              }\n\n              logger.debug('[Ghost Content Manager] ' + normalizedFolderName + ': ' + remainingRevisions.length + ' pending revision(s).');\n              // record remaining revisions if any\n              pendingRevisionsByFolder[normalizedFolderName] = remainingRevisions;\n              return _context3.abrupt('return');\n\n            case 25:\n\n              logger.debug('[Ghost Content Manager] ' + normalizedFolderName + ' has no pending revisions, updating DB from the file system.');\n              // otherwise update the content in the DB\n              _context3.next = 28;\n              return globAsync(filesGlob, { cwd: folderPath });\n\n            case 28:\n              files = _context3.sent;\n              _context3.next = 31;\n              return _bluebird2.default.map(files, function (file) {\n                return recordFile(folderPath, normalizedFolderName, file, { isBinary: isBinary });\n              });\n\n            case 31:\n              _context3.next = 33;\n              return knex('ghost_content').whereNotIn('file', files).andWhere('folder', normalizedFolderName).del().then();\n\n            case 33:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function addRootFolder(_x6) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var updatePendingForFolder = function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(normalizedFolderName) {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return getPendingRevisions(normalizedFolderName);\n\n            case 2:\n              pendingRevisionsByFolder[normalizedFolderName] = _context4.sent;\n\n\n              if (!pendingRevisionsByFolder[normalizedFolderName].length) {\n                delete pendingRevisionsByFolder[normalizedFolderName];\n              }\n\n            case 4:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function updatePendingForFolder(_x8) {\n      return _ref13.apply(this, arguments);\n    };\n  }();\n\n  var updatePendingForAllFolders = function updatePendingForAllFolders() {\n    return _bluebird2.default.each(trackedFolders, updatePendingForFolder);\n  };\n\n  var recordRevision = function recordRevision(knex, content_id, trx) {\n    return knex('ghost_revisions').transacting(trx).insert({ content_id: content_id, revision: (0, _util2.safeId)(), created_by: 'admin' });\n  };\n\n  var upsertFile = function () {\n    var _ref14 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(rootFolder, file, content) {\n      var knex, folder, isBinary, column;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context5.sent;\n              folder = normalizeFolder(rootFolder).normalizedFolderName;\n              isBinary = folderOptions[folder].isBinary;\n              column = isBinary ? 'binary_content' : 'content';\n              _context5.next = 8;\n              return knex('ghost_content').where(_defineProperty({ folder: folder, file: file }, column, content)).count('id as count').then(function (_ref15) {\n                var _ref16 = _slicedToArray(_ref15, 1),\n                    res = _ref16[0];\n\n                return Number(res.count) > 0;\n              });\n\n            case 8:\n              if (!_context5.sent) {\n                _context5.next = 10;\n                break;\n              }\n\n              return _context5.abrupt('return', _bluebird2.default.resolve());\n\n            case 10:\n              return _context5.abrupt('return', knex.transaction(function (trx) {\n                upsert({\n                  knex: knex,\n                  tableName: 'ghost_content',\n                  where: { folder: folder, file: file },\n                  data: _defineProperty({}, column, content),\n                  trx: trx\n                }).then(function (content_id) {\n                  return recordRevision(knex, content_id, trx);\n                }).then(trx.commit).then(function () {\n                  return updatePendingForFolder(folder);\n                }).catch(function (err) {\n                  logger.error('[Ghost Content Manager]', err);\n                  trx.rollback();\n                });\n              }));\n\n            case 11:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, undefined);\n    }));\n\n    return function upsertFile(_x9, _x10, _x11) {\n      return _ref14.apply(this, arguments);\n    };\n  }();\n\n  var revertAllPendingChangesForFile = function () {\n    var _ref17 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(folder, file) {\n      var knex, _normalizeFolder3, folderPath, normalizedFolderName, filePath, _folderOptions$normal, isBinary;\n\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context6.sent;\n              _normalizeFolder3 = normalizeFolder(folder), folderPath = _normalizeFolder3.folderPath, normalizedFolderName = _normalizeFolder3.normalizedFolderName;\n              filePath = _path2.default.join(folderPath, file);\n              _folderOptions$normal = folderOptions[normalizedFolderName].isBinary, isBinary = _folderOptions$normal === undefined ? false : _folderOptions$normal;\n              _context6.next = 8;\n              return knex('ghost_revisions').whereIn('id', function () {\n                // Subquery because SQLite doesn't support delete with joins\n                this.select('ghost_revisions.id').from('ghost_revisions').join('ghost_content', 'ghost_content.id', '=', 'ghost_revisions.content_id').where('folder', folder).andWhere('file', file);\n              }).del();\n\n            case 8:\n              _context6.next = 10;\n              return updatePendingForFolder(folder);\n\n            case 10:\n              if (!_fs2.default.existsSync(filePath)) {\n                _context6.next = 14;\n                break;\n              }\n\n              // If the file exists on disk, this means it was initially source controlled\n              recordFile(folderPath, folder, file, { isBinary: isBinary });\n              _context6.next = 16;\n              break;\n\n            case 14:\n              _context6.next = 16;\n              return knex('ghost_content').where('folder', folder).andWhere('file', file).del();\n\n            case 16:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, undefined);\n    }));\n\n    return function revertAllPendingChangesForFile(_x12, _x13) {\n      return _ref17.apply(this, arguments);\n    };\n  }();\n\n  var readFile = function () {\n    var _ref18 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(rootFolder, file) {\n      var knex, _normalizeFolder4, normalizedFolderName, _ref19, isBinary, column;\n\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context7.sent;\n              _normalizeFolder4 = normalizeFolder(rootFolder), normalizedFolderName = _normalizeFolder4.normalizedFolderName;\n              _ref19 = folderOptions[normalizedFolderName] || {}, isBinary = _ref19.isBinary;\n              column = isBinary ? 'binary_content' : 'content';\n              return _context7.abrupt('return', knex('ghost_content').select(column).where({ folder: normalizedFolderName, file: file }).then(function (results) {\n                if (!results || !results.length) {\n                  return null;\n                }\n                var result = results[0];\n                return result && result[column] || null;\n              }));\n\n            case 7:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, undefined);\n    }));\n\n    return function readFile(_x14, _x15) {\n      return _ref18.apply(this, arguments);\n    };\n  }();\n\n  var deleteFile = function () {\n    var _ref20 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(rootFolder, file) {\n      var knex, _normalizeFolder5, normalizedFolderName, id;\n\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context8.sent;\n              _normalizeFolder5 = normalizeFolder(rootFolder), normalizedFolderName = _normalizeFolder5.normalizedFolderName;\n              _context8.t0 = _get2.default;\n              _context8.next = 7;\n              return knex('ghost_content').where({ folder: normalizedFolderName, file: file, deleted: 0 }).select('id');\n\n            case 7:\n              _context8.t1 = _context8.sent;\n              id = (0, _context8.t0)(_context8.t1, '0.id');\n\n              if (id) {\n                _context8.next = 11;\n                break;\n              }\n\n              throw new Error('Can\\'t delete file: ' + file + ': couldn\\'t find it in folder: ' + normalizedFolderName);\n\n            case 11:\n              return _context8.abrupt('return', knex.transaction(function (trx) {\n                knex('ghost_content').transacting(trx).where({ id: id }).update({ deleted: 1, content: null, binary_content: null }).then(function () {\n                  return recordRevision(knex, id, trx);\n                }).then(trx.commit).then(function () {\n                  return updatePendingForFolder(normalizedFolderName);\n                }).catch(function (err) {\n                  logger.error('[Ghost Content Manager]', err);\n                  trx.rollback();\n                });\n              }));\n\n            case 12:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, undefined);\n    }));\n\n    return function deleteFile(_x16, _x17) {\n      return _ref20.apply(this, arguments);\n    };\n  }();\n\n  var directoryListing = function () {\n    var _ref21 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(rootFolder) {\n      var fileEndingPattern = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var pathsToOmit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n      var knex, _normalizeFolder6, normalizedFolderName;\n\n      return regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context9.sent;\n              _normalizeFolder6 = normalizeFolder(rootFolder), normalizedFolderName = _normalizeFolder6.normalizedFolderName;\n              return _context9.abrupt('return', knex('ghost_content').select('file').whereNotIn('file', pathsToOmit).andWhere({ folder: normalizedFolderName, deleted: 0 }).andWhere('file', 'like', '%' + fileEndingPattern).then(function (res) {\n                return res.map(function (row) {\n                  return row.file;\n                });\n              }));\n\n            case 5:\n            case 'end':\n              return _context9.stop();\n          }\n        }\n      }, _callee9, undefined);\n    }));\n\n    return function directoryListing(_x18) {\n      return _ref21.apply(this, arguments);\n    };\n  }();\n\n  var getPending = function getPending() {\n    return pendingRevisionsByFolder;\n  };\n\n  var getPendingWithContentForFolder = function getPendingWithContentForFolder(_ref22) {\n    var _ref22$stringifyBinar = _ref22.stringifyBinary,\n        stringifyBinary = _ref22$stringifyBinar === undefined ? false : _ref22$stringifyBinar;\n    return function () {\n      var _ref23 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(folderInfo, normalizedFolderName) {\n        var revisions, fileNames, isBinary, column, knex, files;\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                revisions = folderInfo.map(function (_ref24) {\n                  var revision = _ref24.revision;\n                  return revision;\n                });\n                fileNames = (0, _uniq2.default)(folderInfo.map(function (_ref25) {\n                  var file = _ref25.file;\n                  return file;\n                }));\n                isBinary = folderOptions[normalizedFolderName].isBinary;\n                column = isBinary ? 'binary_content' : 'content';\n                _context10.next = 6;\n                return db.get();\n\n              case 6:\n                knex = _context10.sent;\n                _context10.next = 9;\n                return knex('ghost_content').select('file', column, 'deleted').whereIn('file', fileNames).andWhere({ folder: normalizedFolderName });\n\n              case 9:\n                files = _context10.sent;\n\n\n                if (isBinary) {\n                  files.forEach(function (data) {\n                    data.content = stringifyBinary ? data.binary_content.toString('base64') : data.binary_content;\n                    delete data.binary_content;\n                  });\n                }\n\n                return _context10.abrupt('return', {\n                  files: files,\n                  revisions: revisions,\n                  binary: isBinary\n                });\n\n              case 12:\n              case 'end':\n                return _context10.stop();\n            }\n          }\n        }, _callee10, undefined);\n      }));\n\n      return function (_x21, _x22) {\n        return _ref23.apply(this, arguments);\n      };\n    }();\n  };\n\n  var getPendingWithContent = function getPendingWithContent() {\n    var _ref26 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref26$stringifyBinar = _ref26.stringifyBinary,\n        stringifyBinary = _ref26$stringifyBinar === undefined ? false : _ref26$stringifyBinar;\n\n    return _bluebird2.default.props((0, _mapValues2.default)(pendingRevisionsByFolder, getPendingWithContentForFolder({ stringifyBinary: stringifyBinary })));\n  };\n\n  logger.info('[Ghost Content Manager] Initialized');\n\n  return {\n    addRootFolder: addRootFolder,\n    upsertFile: upsertFile,\n    readFile: readFile,\n    deleteFile: deleteFile,\n    directoryListing: directoryListing,\n    getPending: getPending,\n    getPendingWithContent: getPendingWithContent,\n    revertAllPendingChangesForFile: revertAllPendingChangesForFile\n  };\n};\n\n// TODO: switch to ES6 modules\nmodule.exports.REVISIONS_FILE_NAME = REVISIONS_FILE_NAME;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ2hvc3QtY29udGVudC9pbmRleC5qcz85ZjkxIl0sIm5hbWVzIjpbIlByb21pc2UiLCJwcm9taXNpZnlBbGwiLCJmcyIsImdsb2JBc3luYyIsInByb21pc2lmeSIsImdsb2IiLCJSRVZJU0lPTlNfRklMRV9OQU1FIiwibW9kdWxlIiwiZXhwb3J0cyIsImxvZ2dlciIsImRiIiwicHJvamVjdExvY2F0aW9uIiwiZW5hYmxlZCIsIm5vcm1hbGl6ZUZvbGRlciIsInBlbmRpbmdSZXZpc2lvbnNCeUZvbGRlciIsInRyYWNrZWRGb2xkZXJzIiwiZm9sZGVyT3B0aW9ucyIsInVwc2VydCIsImtuZXgiLCJ0YWJsZU5hbWUiLCJ3aGVyZSIsImRhdGEiLCJpZEZpZWxkIiwidHJ4IiwicHJlcGFyZVF1ZXJ5IiwidHJhbnNhY3RpbmciLCJzZWxlY3QiLCJ0aGVuIiwiaWQiLCJyZXMiLCJ1cGRhdGUiLCJ0aGVuUmV0dXJuIiwiaW5zZXJ0IiwiaW5zZXJ0ZWRJZCIsInJlY29yZEZpbGUiLCJmb2xkZXJQYXRoIiwiZm9sZGVyIiwiZmlsZSIsImlzQmluYXJ5IiwiZ2V0IiwiZmlsZVBhdGgiLCJwYXRoIiwiam9pbiIsImNvbHVtbiIsInJlYWRGaWxlQXN5bmMiLCJjb250ZW50IiwiZ2V0UGVuZGluZ1JldmlzaW9ucyIsIm5vcm1hbGl6ZWRGb2xkZXJOYW1lIiwib3JkZXJCeSIsImFkZFJvb3RGb2xkZXIiLCJyb290Rm9sZGVyIiwib3B0aW9ucyIsImZpbGVzR2xvYiIsImRlYnVnIiwicHVzaCIsInJldmlzaW9uc0ZpbGUiLCJmaWxlUmV2aXNpb25zUHJvbWlzZSIsImNhdGNoIiwiY29kZSIsInRyaW0iLCJzcGxpdCIsIm1hcCIsInMiLCJmaWx0ZXIiLCJzdGFydHNXaXRoIiwicmVkdWNlIiwiYWNjIiwiciIsImFsbCIsImtub3duUmV2aXNpb25zIiwiZGJSZXZpc2lvbnMiLCJyZXZpc2lvbiIsInJldmlzaW9uc1RvRGVsZXRlIiwicmVtYWluaW5nUmV2aXNpb25zIiwibGVuZ3RoIiwid2hlcmVJbiIsImRlbCIsImN3ZCIsImZpbGVzIiwid2hlcmVOb3RJbiIsImFuZFdoZXJlIiwidXBkYXRlUGVuZGluZ0ZvckZvbGRlciIsInVwZGF0ZVBlbmRpbmdGb3JBbGxGb2xkZXJzIiwiZWFjaCIsInJlY29yZFJldmlzaW9uIiwiY29udGVudF9pZCIsImNyZWF0ZWRfYnkiLCJ1cHNlcnRGaWxlIiwiY291bnQiLCJOdW1iZXIiLCJyZXNvbHZlIiwidHJhbnNhY3Rpb24iLCJjb21taXQiLCJlcnJvciIsImVyciIsInJvbGxiYWNrIiwicmV2ZXJ0QWxsUGVuZGluZ0NoYW5nZXNGb3JGaWxlIiwiZnJvbSIsImV4aXN0c1N5bmMiLCJyZWFkRmlsZSIsInJlc3VsdHMiLCJyZXN1bHQiLCJkZWxldGVGaWxlIiwiZGVsZXRlZCIsIkVycm9yIiwiYmluYXJ5X2NvbnRlbnQiLCJkaXJlY3RvcnlMaXN0aW5nIiwiZmlsZUVuZGluZ1BhdHRlcm4iLCJwYXRoc1RvT21pdCIsInJvdyIsImdldFBlbmRpbmciLCJnZXRQZW5kaW5nV2l0aENvbnRlbnRGb3JGb2xkZXIiLCJzdHJpbmdpZnlCaW5hcnkiLCJmb2xkZXJJbmZvIiwicmV2aXNpb25zIiwiZmlsZU5hbWVzIiwiZm9yRWFjaCIsInRvU3RyaW5nIiwiYmluYXJ5IiwiZ2V0UGVuZGluZ1dpdGhDb250ZW50IiwicHJvcHMiLCJpbmZvIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFFQUEsbUJBQVFDLFlBQVIsQ0FBcUJDLFlBQXJCO0FBQ0EsSUFBTUMsWUFBWUgsbUJBQVFJLFNBQVIsQ0FBa0JDLGNBQWxCLENBQWxCOztBQUVBLElBQU1DLHNCQUFzQixrQkFBNUI7O0FBRUFDLE9BQU9DLE9BQVAsR0FBaUIsZ0JBQThDO0FBQUEsTUFBM0NDLE1BQTJDLFFBQTNDQSxNQUEy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cnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgZ2xvYiBmcm9tICdnbG9iJ1xuXG5pbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC9nZXQnXG5pbXBvcnQgcGFydGl0aW9uIGZyb20gJ2xvZGFzaC9wYXJ0aXRpb24nXG5pbXBvcnQgbWFwVmFsdWVzIGZyb20gJ2xvZGFzaC9tYXBWYWx1ZXMnXG5pbXBvcnQgdW5pcSBmcm9tICdsb2Rhc2gvdW5pcSdcblxuaW1wb3J0IGNyZWF0ZVRyYW5zcGFyZW50IGZyb20gJy4vdHJhbnNwYXJlbnQnXG5pbXBvcnQgeyBub3JtYWxpemVGb2xkZXIgYXMgX25vcm1hbGl6ZUZvbGRlciB9IGZyb20gJy4vdXRpbCdcbmltcG9ydCB7IHNhZmVJZCB9IGZyb20gJy4uL3V0aWwnXG5cblByb21pc2UucHJvbWlzaWZ5QWxsKGZzKVxuY29uc3QgZ2xvYkFzeW5jID0gUHJvbWlzZS5wcm9taXNpZnkoZ2xvYilcblxuY29uc3QgUkVWSVNJT05TX0ZJTEVfTkFNRSA9ICcuZ2hvc3QtcmV2aXNpb25zJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IGxvZ2dlciwgZGIsIHByb2plY3RMb2NhdGlvbiwgZW5hYmxlZCB9KSA9PiB7XG4gIGlmICghZW5hYmxlZCkge1xuICAgIHJldHVybiBjcmVhdGVUcmFuc3BhcmVudCh7IGxvZ2dlciwgcHJvamVjdExvY2F0aW9uIH0pXG4gIH1cblxuICBjb25zdCBub3JtYWxpemVGb2xkZXIgPSBfbm9ybWFsaXplRm9sZGVyKHByb2plY3RMb2NhdGlvbilcblxuICBjb25zdCBwZW5kaW5nUmV2aXNpb25zQnlGb2xkZXIgPSB7fVxuICBjb25zdCB0cmFja2VkRm9sZGVycyA9IFtdXG4gIGNvbnN0IGZvbGRlck9wdGlvbnMgPSB7fVxuXG4gIGNvbnN0IHVwc2VydCA9ICh7IGtuZXgsIHRhYmxlTmFtZSwgd2hlcmUsIGRhdGEsIGlkRmllbGQgPSAnaWQnLCB0cnggPSBudWxsIH0pID0+IHtcbiAgICBjb25zdCBwcmVwYXJlUXVlcnkgPSAoKSA9PiAodHJ4ID8ga25leCh0YWJsZU5hbWUpLnRyYW5zYWN0aW5nKHRyeCkgOiBrbmV4KHRhYmxlTmFtZSkpXG4gICAgcmV0dXJuIHByZXBhcmVRdWVyeSgpXG4gICAgICAud2hlcmUod2hlcmUpXG4gICAgICAuc2VsZWN0KGlkRmllbGQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGdldChyZXMsICcwLmlkJylcbiAgICAgICAgcmV0dXJuIGlkXG4gICAgICAgICAgPyBwcmVwYXJlUXVlcnkoKVxuICAgICAgICAgICAgICAud2hlcmUoaWRGaWVsZCwgaWQpXG4gICAgICAgICAgICAgIC51cGRhdGUoZGF0YSlcbiAgICAgICAgICAgICAgLnRoZW5SZXR1cm4oaWQpXG4gICAgICAgICAgOiBwcmVwYXJlUXVlcnkoKVxuICAgICAgICAgICAgICAuaW5zZXJ0KHsgLi4ud2hlcmUsIC4uLmRhdGEgfSwgJ2lkJylcbiAgICAgICAgICAgICAgLnRoZW4oKFtpbnNlcnRlZElkXSkgPT4gaW5zZXJ0ZWRJZClcbiAgICAgIH0pXG4gIH1cblxuICBjb25zdCByZWNvcmRGaWxlID0gYXN5bmMgKGZvbGRlclBhdGgsIGZvbGRlciwgZmlsZSwgeyBpc0JpbmFyeSA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGZvbGRlclBhdGgsIGZpbGUpXG4gICAgY29uc3QgY29sdW1uID0gaXNCaW5hcnkgPyAnYmluYXJ5X2NvbnRlbnQnIDogJ2NvbnRlbnQnXG4gICAgYXdhaXQgZnMucmVhZEZpbGVBc3luYyhmaWxlUGF0aCwgaXNCaW5hcnkgPyBudWxsIDogJ3V0ZjgnKS50aGVuKGNvbnRlbnQgPT5cbiAgICAgIHVwc2VydCh7XG4gICAgICAgIGtuZXgsXG4gICAgICAgIHRhYmxlTmFtZTogJ2dob3N0X2NvbnRlbnQnLFxuICAgICAgICB3aGVyZTogeyBmb2xkZXIsIGZpbGUgfSxcbiAgICAgICAgZGF0YTogeyBbY29sdW1uXTogY29udGVudCB9XG4gICAgICB9KVxuICAgIClcbiAgfVxuXG4gIGNvbnN0IGdldFBlbmRpbmdSZXZpc2lvbnMgPSBhc3luYyBub3JtYWxpemVkRm9sZGVyTmFtZSA9PiB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICByZXR1cm4ga25leCgnZ2hvc3RfcmV2aXNpb25zJylcbiAgICAgIC5qb2luKCdnaG9zdF9jb250ZW50JywgJ2dob3N0X2NvbnRlbnQuaWQnLCAnPScsICdnaG9zdF9yZXZpc2lvbnMuY29udGVudF9pZCcpXG4gICAgICAud2hlcmUoJ2dob3N0X2NvbnRlbnQuZm9sZGVyJywgbm9ybWFsaXplZEZvbGRlck5hbWUpXG4gICAgICAuc2VsZWN0KFxuICAgICAgICAnZ2hvc3RfY29udGVudC5maWxlJyxcbiAgICAgICAgJ2dob3N0X3JldmlzaW9ucy5pZCcsXG4gICAgICAgICdnaG9zdF9yZXZpc2lvbnMucmV2aXNpb24nLFxuICAgICAgICAnZ2hvc3RfcmV2aXNpb25zLmNyZWF0ZWRfb24nLFxuICAgICAgICAnZ2hvc3RfcmV2aXNpb25zLmNyZWF0ZWRfYnknXG4gICAgICApXG4gICAgICAub3JkZXJCeSgnZ2hvc3RfcmV2aXNpb25zLmNyZWF0ZWRfb24nLCAnZGVzYycpXG4gICAgICAudGhlbigpXG4gIH1cblxuICBjb25zdCBhZGRSb290Rm9sZGVyID0gYXN5bmMgKHJvb3RGb2xkZXIsIG9wdGlvbnMgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHsgZm9sZGVyUGF0aCwgbm9ybWFsaXplZEZvbGRlck5hbWUgfSA9IG5vcm1hbGl6ZUZvbGRlcihyb290Rm9sZGVyKVxuICAgIGNvbnN0IHsgaXNCaW5hcnkgPSBmYWxzZSwgZmlsZXNHbG9iID0gJyoqLyonIH0gPSBvcHRpb25zXG5cbiAgICBsb2dnZXIuZGVidWcoYFtHaG9zdCBDb250ZW50IE1hbmFnZXJdIGFkZGluZyBmb2xkZXIgJHtub3JtYWxpemVkRm9sZGVyTmFtZX1gKVxuICAgIHRyYWNrZWRGb2xkZXJzLnB1c2gobm9ybWFsaXplZEZvbGRlck5hbWUpXG4gICAgZm9sZGVyT3B0aW9uc1tub3JtYWxpemVkRm9sZGVyTmFtZV0gPSBvcHRpb25zXG5cbiAgICAvLyByZWFkIGtub3duIHJldmlzaW9uc1xuICAgIGNvbnN0IHJldmlzaW9uc0ZpbGUgPSBwYXRoLmpvaW4oZm9sZGVyUGF0aCwgUkVWSVNJT05TX0ZJTEVfTkFNRSlcbiAgICBjb25zdCBmaWxlUmV2aXNpb25zUHJvbWlzZSA9IGZzXG4gICAgICAucmVhZEZpbGVBc3luYyhyZXZpc2lvbnNGaWxlLCAndXRmOCcpXG4gICAgICAuY2F0Y2goeyBjb2RlOiAnRU5PRU5UJyB9LCAoKSA9PiAnJylcbiAgICAgIC50aGVuKGNvbnRlbnQgPT5cbiAgICAgICAgY29udGVudFxuICAgICAgICAgIC50cmltKClcbiAgICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgICAgLm1hcChzID0+IHMudHJpbSgpKVxuICAgICAgICAgIC5maWx0ZXIocyA9PiAhIXMgJiYgIXMuc3RhcnRzV2l0aCgnIycpKVxuICAgICAgICAgIC5yZWR1Y2UoKGFjYywgcikgPT4ge1xuICAgICAgICAgICAgYWNjW3JdID0gdHJ1ZVxuICAgICAgICAgICAgcmV0dXJuIGFjY1xuICAgICAgICAgIH0sIHt9KVxuICAgICAgKVxuXG4gICAgY29uc3QgW2tub3duUmV2aXNpb25zLCBkYlJldmlzaW9uc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBmaWxlUmV2aXNpb25zUHJvbWlzZSxcbiAgICAgIGdldFBlbmRpbmdSZXZpc2lvbnMobm9ybWFsaXplZEZvbGRlck5hbWUpXG4gICAgXSlcblxuICAgIGNvbnN0IFtyZXZpc2lvbnNUb0RlbGV0ZSwgcmVtYWluaW5nUmV2aXNpb25zXSA9IHBhcnRpdGlvbihkYlJldmlzaW9ucywgKHsgcmV2aXNpb24gfSkgPT4ga25vd25SZXZpc2lvbnNbcmV2aXNpb25dKVxuXG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICAvLyBjbGVhbnVwIGtub3duIHJldmlzaW9uc1xuICAgIGlmIChyZXZpc2lvbnNUb0RlbGV0ZS5sZW5ndGgpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgYFtHaG9zdCBDb250ZW50IE1hbmFnZXJdICR7bm9ybWFsaXplZEZvbGRlck5hbWV9OiBkZWxldGluZyAke3JldmlzaW9uc1RvRGVsZXRlLmxlbmd0aH0ga25vd24gcmV2aXNpb24ocykuYFxuICAgICAgKVxuICAgICAgYXdhaXQga25leCgnZ2hvc3RfcmV2aXNpb25zJylcbiAgICAgICAgLndoZXJlSW4oJ2lkJywgcmV2aXNpb25zVG9EZWxldGUubWFwKCh7IGlkIH0pID0+IGlkKSlcbiAgICAgICAgLmRlbCgpXG4gICAgfVxuXG4gICAgaWYgKHJlbWFpbmluZ1JldmlzaW9ucy5sZW5ndGgpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgW0dob3N0IENvbnRlbnQgTWFuYWdlcl0gJHtub3JtYWxpemVkRm9sZGVyTmFtZX06ICR7cmVtYWluaW5nUmV2aXNpb25zLmxlbmd0aH0gcGVuZGluZyByZXZpc2lvbihzKS5gKVxuICAgICAgLy8gcmVjb3JkIHJlbWFpbmluZyByZXZpc2lvbnMgaWYgYW55XG4gICAgICBwZW5kaW5nUmV2aXNpb25zQnlGb2xkZXJbbm9ybWFsaXplZEZvbGRlck5hbWVdID0gcmVtYWluaW5nUmV2aXNpb25zXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBsb2dnZXIuZGVidWcoXG4gICAgICBgW0dob3N0IENvbnRlbnQgTWFuYWdlcl0gJHtub3JtYWxpemVkRm9sZGVyTmFtZX0gaGFzIG5vIHBlbmRpbmcgcmV2aXNpb25zLCB1cGRhdGluZyBEQiBmcm9tIHRoZSBmaWxlIHN5c3RlbS5gXG4gICAgKVxuICAgIC8vIG90aGVyd2lzZSB1cGRhdGUgdGhlIGNvbnRlbnQgaW4gdGhlIERCXG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCBnbG9iQXN5bmMoZmlsZXNHbG9iLCB7IGN3ZDogZm9sZGVyUGF0aCB9KVxuICAgIGF3YWl0IFByb21pc2UubWFwKGZpbGVzLCBmaWxlID0+IHJlY29yZEZpbGUoZm9sZGVyUGF0aCwgbm9ybWFsaXplZEZvbGRlck5hbWUsIGZpbGUsIHsgaXNCaW5hcnkgfSkpXG4gICAgLy8gYW5kIGFsc28gZGVsZXRlIHRoZSBmaWxlcyBubyBsb25nZXIgaW4gdGhlIEZTXG4gICAgYXdhaXQga25leCgnZ2hvc3RfY29udGVudCcpXG4gICAgICAud2hlcmVOb3RJbignZmlsZScsIGZpbGVzKVxuICAgICAgLmFuZFdoZXJlKCdmb2xkZXInLCBub3JtYWxpemVkRm9sZGVyTmFtZSlcbiAgICAgIC5kZWwoKVxuICAgICAgLnRoZW4oKVxuICB9XG5cbiAgY29uc3QgdXBkYXRlUGVuZGluZ0ZvckZvbGRlciA9IGFzeW5jIG5vcm1hbGl6ZWRGb2xkZXJOYW1lID0+IHtcbiAgICBwZW5kaW5nUmV2aXNpb25zQnlGb2xkZXJbbm9ybWFsaXplZEZvbGRlck5hbWVdID0gYXdhaXQgZ2V0UGVuZGluZ1JldmlzaW9ucyhub3JtYWxpemVkRm9sZGVyTmFtZSlcblxuICAgIGlmICghcGVuZGluZ1JldmlzaW9uc0J5Rm9sZGVyW25vcm1hbGl6ZWRGb2xkZXJOYW1lXS5sZW5ndGgpIHtcbiAgICAgIGRlbGV0ZSBwZW5kaW5nUmV2aXNpb25zQnlGb2xkZXJbbm9ybWFsaXplZEZvbGRlck5hbWVdXG4gICAgfVxuICB9XG5cbiAgY29uc3QgdXBkYXRlUGVuZGluZ0ZvckFsbEZvbGRlcnMgPSAoKSA9PiBQcm9taXNlLmVhY2godHJhY2tlZEZvbGRlcnMsIHVwZGF0ZVBlbmRpbmdGb3JGb2xkZXIpXG5cbiAgY29uc3QgcmVjb3JkUmV2aXNpb24gPSAoa25leCwgY29udGVudF9pZCwgdHJ4KSA9PlxuICAgIGtuZXgoJ2dob3N0X3JldmlzaW9ucycpXG4gICAgICAudHJhbnNhY3RpbmcodHJ4KVxuICAgICAgLmluc2VydCh7IGNvbnRlbnRfaWQsIHJldmlzaW9uOiBzYWZlSWQoKSwgY3JlYXRlZF9ieTogJ2FkbWluJyB9KVxuXG4gIGNvbnN0IHVwc2VydEZpbGUgPSBhc3luYyAocm9vdEZvbGRlciwgZmlsZSwgY29udGVudCkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgY29uc3QgZm9sZGVyID0gbm9ybWFsaXplRm9sZGVyKHJvb3RGb2xkZXIpLm5vcm1hbGl6ZWRGb2xkZXJOYW1lXG4gICAgY29uc3QgeyBpc0JpbmFyeSB9ID0gZm9sZGVyT3B0aW9uc1tmb2xkZXJdXG4gICAgY29uc3QgY29sdW1uID0gaXNCaW5hcnkgPyAnYmluYXJ5X2NvbnRlbnQnIDogJ2NvbnRlbnQnXG5cbiAgICBpZiAoXG4gICAgICBhd2FpdCBrbmV4KCdnaG9zdF9jb250ZW50JylcbiAgICAgICAgLndoZXJlKHsgZm9sZGVyLCBmaWxlLCBbY29sdW1uXTogY29udGVudCB9KVxuICAgICAgICAuY291bnQoJ2lkIGFzIGNvdW50JylcbiAgICAgICAgLnRoZW4oKFtyZXNdKSA9PiBOdW1iZXIocmVzLmNvdW50KSA+IDApXG4gICAgKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbiAgICB9XG5cbiAgICByZXR1cm4ga25leC50cmFuc2FjdGlvbih0cnggPT4ge1xuICAgICAgdXBzZXJ0KHtcbiAgICAgICAga25leCxcbiAgICAgICAgdGFibGVOYW1lOiAnZ2hvc3RfY29udGVudCcsXG4gICAgICAgIHdoZXJlOiB7IGZvbGRlciwgZmlsZSB9LFxuICAgICAgICBkYXRhOiB7IFtjb2x1bW5dOiBjb250ZW50IH0sXG4gICAgICAgIHRyeFxuICAgICAgfSlcbiAgICAgICAgLnRoZW4oY29udGVudF9pZCA9PiByZWNvcmRSZXZpc2lvbihrbmV4LCBjb250ZW50X2lkLCB0cngpKVxuICAgICAgICAudGhlbih0cnguY29tbWl0KVxuICAgICAgICAudGhlbigoKSA9PiB1cGRhdGVQZW5kaW5nRm9yRm9sZGVyKGZvbGRlcikpXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcignW0dob3N0IENvbnRlbnQgTWFuYWdlcl0nLCBlcnIpXG4gICAgICAgICAgdHJ4LnJvbGxiYWNrKClcbiAgICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgcmV2ZXJ0QWxsUGVuZGluZ0NoYW5nZXNGb3JGaWxlID0gYXN5bmMgKGZvbGRlciwgZmlsZSkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgY29uc3QgeyBmb2xkZXJQYXRoLCBub3JtYWxpemVkRm9sZGVyTmFtZSB9ID0gbm9ybWFsaXplRm9sZGVyKGZvbGRlcilcbiAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihmb2xkZXJQYXRoLCBmaWxlKVxuICAgIGNvbnN0IHsgaXNCaW5hcnkgPSBmYWxzZSB9ID0gZm9sZGVyT3B0aW9uc1tub3JtYWxpemVkRm9sZGVyTmFtZV1cblxuICAgIGF3YWl0IGtuZXgoJ2dob3N0X3JldmlzaW9ucycpXG4gICAgICAud2hlcmVJbignaWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gU3VicXVlcnkgYmVjYXVzZSBTUUxpdGUgZG9lc24ndCBzdXBwb3J0IGRlbGV0ZSB3aXRoIGpvaW5zXG4gICAgICAgIHRoaXMuc2VsZWN0KCdnaG9zdF9yZXZpc2lvbnMuaWQnKVxuICAgICAgICAgIC5mcm9tKCdnaG9zdF9yZXZpc2lvbnMnKVxuICAgICAgICAgIC5qb2luKCdnaG9zdF9jb250ZW50JywgJ2dob3N0X2NvbnRlbnQuaWQnLCAnPScsICdnaG9zdF9yZXZpc2lvbnMuY29udGVudF9pZCcpXG4gICAgICAgICAgLndoZXJlKCdmb2xkZXInLCBmb2xkZXIpXG4gICAgICAgICAgLmFuZFdoZXJlKCdmaWxlJywgZmlsZSlcbiAgICAgIH0pXG4gICAgICAuZGVsKClcblxuICAgIGF3YWl0IHVwZGF0ZVBlbmRpbmdGb3JGb2xkZXIoZm9sZGVyKVxuXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoZmlsZVBhdGgpKSB7XG4gICAgICAvLyBJZiB0aGUgZmlsZSBleGlzdHMgb24gZGlzaywgdGhpcyBtZWFucyBpdCB3YXMgaW5pdGlhbGx5IHNvdXJjZSBjb250cm9sbGVkXG4gICAgICByZWNvcmRGaWxlKGZvbGRlclBhdGgsIGZvbGRlciwgZmlsZSwgeyBpc0JpbmFyeSB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBrbmV4KCdnaG9zdF9jb250ZW50JylcbiAgICAgICAgLndoZXJlKCdmb2xkZXInLCBmb2xkZXIpXG4gICAgICAgIC5hbmRXaGVyZSgnZmlsZScsIGZpbGUpXG4gICAgICAgIC5kZWwoKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlYWRGaWxlID0gYXN5bmMgKHJvb3RGb2xkZXIsIGZpbGUpID0+IHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcbiAgICBjb25zdCB7IG5vcm1hbGl6ZWRGb2xkZXJOYW1lIH0gPSBub3JtYWxpemVGb2xkZXIocm9vdEZvbGRlcilcbiAgICBjb25zdCB7IGlzQmluYXJ5IH0gPSBmb2xkZXJPcHRpb25zW25vcm1hbGl6ZWRGb2xkZXJOYW1lXSB8fCB7fVxuICAgIGNvbnN0IGNvbHVtbiA9IGlzQmluYXJ5ID8gJ2JpbmFyeV9jb250ZW50JyA6ICdjb250ZW50J1xuXG4gICAgcmV0dXJuIGtuZXgoJ2dob3N0X2NvbnRlbnQnKVxuICAgICAgLnNlbGVjdChjb2x1bW4pXG4gICAgICAud2hlcmUoeyBmb2xkZXI6IG5vcm1hbGl6ZWRGb2xkZXJOYW1lLCBmaWxlIH0pXG4gICAgICAudGhlbihyZXN1bHRzID0+IHtcbiAgICAgICAgaWYgKCFyZXN1bHRzIHx8ICFyZXN1bHRzLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gcmVzdWx0c1swXVxuICAgICAgICByZXR1cm4gKHJlc3VsdCAmJiByZXN1bHRbY29sdW1uXSkgfHwgbnVsbFxuICAgICAgfSlcbiAgfVxuXG4gIGNvbnN0IGRlbGV0ZUZpbGUgPSBhc3luYyAocm9vdEZvbGRlciwgZmlsZSkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuICAgIGNvbnN0IHsgbm9ybWFsaXplZEZvbGRlck5hbWUgfSA9IG5vcm1hbGl6ZUZvbGRlcihyb290Rm9sZGVyKVxuXG4gICAgY29uc3QgaWQgPSBnZXQoXG4gICAgICBhd2FpdCBrbmV4KCdnaG9zdF9jb250ZW50JylcbiAgICAgICAgLndoZXJlKHsgZm9sZGVyOiBub3JtYWxpemVkRm9sZGVyTmFtZSwgZmlsZSwgZGVsZXRlZDogMCB9KVxuICAgICAgICAuc2VsZWN0KCdpZCcpLFxuICAgICAgJzAuaWQnXG4gICAgKVxuXG4gICAgaWYgKCFpZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4ndCBkZWxldGUgZmlsZTogJHtmaWxlfTogY291bGRuJ3QgZmluZCBpdCBpbiBmb2xkZXI6ICR7bm9ybWFsaXplZEZvbGRlck5hbWV9YClcbiAgICB9XG5cbiAgICByZXR1cm4ga25leC50cmFuc2FjdGlvbih0cnggPT4ge1xuICAgICAga25leCgnZ2hvc3RfY29udGVudCcpXG4gICAgICAgIC50cmFuc2FjdGluZyh0cngpXG4gICAgICAgIC53aGVyZSh7IGlkIH0pXG4gICAgICAgIC51cGRhdGUoeyBkZWxldGVkOiAxLCBjb250ZW50OiBudWxsLCBiaW5hcnlfY29udGVudDogbnVsbCB9KVxuICAgICAgICAudGhlbigoKSA9PiByZWNvcmRSZXZpc2lvbihrbmV4LCBpZCwgdHJ4KSlcbiAgICAgICAgLnRoZW4odHJ4LmNvbW1pdClcbiAgICAgICAgLnRoZW4oKCkgPT4gdXBkYXRlUGVuZGluZ0ZvckZvbGRlcihub3JtYWxpemVkRm9sZGVyTmFtZSkpXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcignW0dob3N0IENvbnRlbnQgTWFuYWdlcl0nLCBlcnIpXG4gICAgICAgICAgdHJ4LnJvbGxiYWNrKClcbiAgICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgZGlyZWN0b3J5TGlzdGluZyA9IGFzeW5jIChyb290Rm9sZGVyLCBmaWxlRW5kaW5nUGF0dGVybiA9ICcnLCBwYXRoc1RvT21pdCA9IFtdKSA9PiB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG4gICAgY29uc3QgeyBub3JtYWxpemVkRm9sZGVyTmFtZSB9ID0gbm9ybWFsaXplRm9sZGVyKHJvb3RGb2xkZXIpXG4gICAgcmV0dXJuIGtuZXgoJ2dob3N0X2NvbnRlbnQnKVxuICAgICAgLnNlbGVjdCgnZmlsZScpXG4gICAgICAud2hlcmVOb3RJbignZmlsZScsIHBhdGhzVG9PbWl0KVxuICAgICAgLmFuZFdoZXJlKHsgZm9sZGVyOiBub3JtYWxpemVkRm9sZGVyTmFtZSwgZGVsZXRlZDogMCB9KVxuICAgICAgLmFuZFdoZXJlKCdmaWxlJywgJ2xpa2UnLCBgJSR7ZmlsZUVuZGluZ1BhdHRlcm59YClcbiAgICAgIC50aGVuKHJlcyA9PiByZXMubWFwKHJvdyA9PiByb3cuZmlsZSkpXG4gIH1cblxuICBjb25zdCBnZXRQZW5kaW5nID0gKCkgPT4gcGVuZGluZ1JldmlzaW9uc0J5Rm9sZGVyXG5cbiAgY29uc3QgZ2V0UGVuZGluZ1dpdGhDb250ZW50Rm9yRm9sZGVyID0gKHsgc3RyaW5naWZ5QmluYXJ5ID0gZmFsc2UgfSkgPT4gYXN5bmMgKGZvbGRlckluZm8sIG5vcm1hbGl6ZWRGb2xkZXJOYW1lKSA9PiB7XG4gICAgY29uc3QgcmV2aXNpb25zID0gZm9sZGVySW5mby5tYXAoKHsgcmV2aXNpb24gfSkgPT4gcmV2aXNpb24pXG4gICAgY29uc3QgZmlsZU5hbWVzID0gdW5pcShmb2xkZXJJbmZvLm1hcCgoeyBmaWxlIH0pID0+IGZpbGUpKVxuICAgIGNvbnN0IHsgaXNCaW5hcnkgfSA9IGZvbGRlck9wdGlvbnNbbm9ybWFsaXplZEZvbGRlck5hbWVdXG4gICAgY29uc3QgY29sdW1uID0gaXNCaW5hcnkgPyAnYmluYXJ5X2NvbnRlbnQnIDogJ2NvbnRlbnQnXG5cbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcbiAgICBjb25zdCBmaWxlcyA9IGF3YWl0IGtuZXgoJ2dob3N0X2NvbnRlbnQnKVxuICAgICAgLnNlbGVjdCgnZmlsZScsIGNvbHVtbiwgJ2RlbGV0ZWQnKVxuICAgICAgLndoZXJlSW4oJ2ZpbGUnLCBmaWxlTmFtZXMpXG4gICAgICAuYW5kV2hlcmUoeyBmb2xkZXI6IG5vcm1hbGl6ZWRGb2xkZXJOYW1lIH0pXG5cbiAgICBpZiAoaXNCaW5hcnkpIHtcbiAgICAgIGZpbGVzLmZvckVhY2goZGF0YSA9PiB7XG4gICAgICAgIGRhdGEuY29udGVudCA9IHN0cmluZ2lmeUJpbmFyeSA/IGRhdGEuYmluYXJ5X2NvbnRlbnQudG9TdHJpbmcoJ2Jhc2U2NCcpIDogZGF0YS5iaW5hcnlfY29udGVudFxuICAgICAgICBkZWxldGUgZGF0YS5iaW5hcnlfY29udGVudFxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgZmlsZXMsXG4gICAgICByZXZpc2lvbnMsXG4gICAgICBiaW5hcnk6IGlzQmluYXJ5XG4gICAgfVxuICB9XG5cbiAgY29uc3QgZ2V0UGVuZGluZ1dpdGhDb250ZW50ID0gKHsgc3RyaW5naWZ5QmluYXJ5ID0gZmFsc2UgfSA9IHt9KSA9PlxuICAgIFByb21pc2UucHJvcHMobWFwVmFsdWVzKHBlbmRpbmdSZXZpc2lvbnNCeUZvbGRlciwgZ2V0UGVuZGluZ1dpdGhDb250ZW50Rm9yRm9sZGVyKHsgc3RyaW5naWZ5QmluYXJ5IH0pKSlcblxuICBsb2dnZXIuaW5mbygnW0dob3N0IENvbnRlbnQgTWFuYWdlcl0gSW5pdGlhbGl6ZWQnKVxuXG4gIHJldHVybiB7XG4gICAgYWRkUm9vdEZvbGRlcixcbiAgICB1cHNlcnRGaWxlLFxuICAgIHJlYWRGaWxlLFxuICAgIGRlbGV0ZUZpbGUsXG4gICAgZGlyZWN0b3J5TGlzdGluZyxcbiAgICBnZXRQZW5kaW5nLFxuICAgIGdldFBlbmRpbmdXaXRoQ29udGVudCxcbiAgICByZXZlcnRBbGxQZW5kaW5nQ2hhbmdlc0ZvckZpbGVcbiAgfVxufVxuXG4vLyBUT0RPOiBzd2l0Y2ggdG8gRVM2IG1vZHVsZXNcbm1vZHVsZS5leHBvcnRzLlJFVklTSU9OU19GSUxFX05BTUUgPSBSRVZJU0lPTlNfRklMRV9OQU1FXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/ghost-content/index.js\n");

/***/ }),

/***/ "./src/ghost-content/transparent.js":
/*!******************************************!*\
  !*** ./src/ghost-content/transparent.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _mkdirp = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n\nvar _mkdirp2 = _interopRequireDefault(_mkdirp);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _glob = __webpack_require__(/*! glob */ \"glob\");\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/ghost-content/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n  Transparent Ghost Content Manager hs the same API but\n  proxies all calls directly to the FS.\n  It's used while in development.\n*/\n\n_bluebird2.default.promisifyAll(_fs2.default);\nvar mkdirpAsync = _bluebird2.default.promisify(_mkdirp2.default);\n\nmodule.exports = function (_ref) {\n  var logger = _ref.logger,\n      projectLocation = _ref.projectLocation;\n\n  var normalizeFolder = (0, _util.normalizeFolder)(projectLocation);\n\n  var folderOptions = {};\n\n  logger.info('[Ghost Content Manager] (transparent) Initialized');\n\n  return {\n    addRootFolder: function addRootFolder(rootFolder) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var _normalizeFolder2 = normalizeFolder(rootFolder),\n          normalizedFolderName = _normalizeFolder2.normalizedFolderName;\n\n      logger.debug('[Ghost Content Manager] (transparent) Added root folder ' + normalizedFolderName + ', doing nothing.');\n      folderOptions[normalizedFolderName] = options;\n    },\n\n    upsertFile: function upsertFile(folder, file, content) {\n      var _normalizeFolder3 = normalizeFolder(folder),\n          folderPath = _normalizeFolder3.folderPath;\n\n      var filePath = _path2.default.join(folderPath, file);\n      var fullFileFolder = _path2.default.dirname(filePath);\n      return mkdirpAsync(fullFileFolder).then(function () {\n        return _fs2.default.writeFileAsync(filePath, content);\n      }).catch(function (e) {\n        logger.error('[Ghost Content Manager] (transparent) upsertFile error', e);\n        throw e;\n      });\n    },\n\n    readFile: function readFile(folder, file) {\n      var _normalizeFolder4 = normalizeFolder(folder),\n          folderPath = _normalizeFolder4.folderPath,\n          normalizedFolderName = _normalizeFolder4.normalizedFolderName;\n\n      var filePath = _path2.default.join(folderPath, file);\n      var isBinary = (folderOptions[normalizedFolderName] || {}).isBinary || false;\n      return _fs2.default.readFileAsync(filePath, isBinary ? null : 'utf8').catch({ code: 'ENOENT' }, function () {\n        return null;\n      }).catch(function (e) {\n        logger.error('[Ghost Content Manager] (transparent) readFile error', e);\n        throw e;\n      });\n    },\n\n    deleteFile: function deleteFile(folder, file) {\n      var _normalizeFolder5 = normalizeFolder(folder),\n          folderPath = _normalizeFolder5.folderPath;\n\n      var filePath = _path2.default.join(folderPath, file);\n      return _fs2.default.unlinkAsync(filePath).catch(function (e) {\n        logger.error('[Ghost Content Manager] (transparent) deleteFile error', e);\n        throw e;\n      });\n    },\n\n    directoryListing: function directoryListing(rootFolder) {\n      var fileEndingPattern = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var pathsToOmit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n      var _normalizeFolder6 = normalizeFolder(rootFolder),\n          folderPath = _normalizeFolder6.folderPath;\n\n      return _fs2.default.accessAsync(folderPath).then(function () {\n        return _bluebird2.default.fromCallback(function (cb) {\n          return (0, _glob2.default)('**/*' + fileEndingPattern, { cwd: folderPath }, cb);\n        }).then(function (paths) {\n          return paths.filter(function (path) {\n            return !pathsToOmit.includes(path);\n          });\n        });\n      }, function () {\n        return [];\n      }).catch(function (e) {\n        logger.error('[Ghost Content Manager] (transparent) directoryListing error', e);\n        throw e;\n      });\n    },\n\n    getPending: function getPending() {\n      return {};\n    },\n\n    getPendingWithContent: function getPendingWithContent() {\n      return {};\n    }\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ2hvc3QtY29udGVudC90cmFuc3BhcmVudC5qcz85Zjg0Il0sIm5hbWVzIjpbIlByb21pc2UiLCJwcm9taXNpZnlBbGwiLCJmcyIsIm1rZGlycEFzeW5jIiwicHJvbWlzaWZ5IiwibWtkaXJwIiwibW9kdWxlIiwiZXhwb3J0cyIsImxvZ2dlciIsInByb2plY3RMb2NhdGlvbiIsIm5vcm1hbGl6ZUZvbGRlciIsImZvbGRlck9wdGlvbnMiLCJpbmZvIiwiYWRkUm9vdEZvbGRlciIsInJvb3RGb2xkZXIiLCJvcHRpb25zIiwibm9ybWFsaXplZEZvbGRlck5hbWUiLCJkZWJ1ZyIsInVwc2VydEZpbGUiLCJmb2xkZXIiLCJmaWxlIiwiY29udGVudCIsImZvbGRlclBhdGgiLCJmaWxlUGF0aCIsInBhdGgiLCJqb2luIiwiZnVsbEZpbGVGb2xkZXIiLCJkaXJuYW1lIiwidGhlbiIsIndyaXRlRmlsZUFzeW5jIiwiY2F0Y2giLCJlcnJvciIsImUiLCJyZWFkRmlsZSIsImlzQmluYXJ5IiwicmVhZEZpbGVBc3luYyIsImNvZGUiLCJkZWxldGVGaWxlIiwidW5saW5rQXN5bmMiLCJkaXJlY3RvcnlMaXN0aW5nIiwiZmlsZUVuZGluZ1BhdHRlcm4iLCJwYXRoc1RvT21pdCIsImFjY2Vzc0FzeW5jIiwiZnJvbUNhbGxiYWNrIiwiY3dkIiwiY2IiLCJwYXRocyIsImZpbHRlciIsImluY2x1ZGVzIiwiZ2V0UGVuZGluZyIsImdldFBlbmRpbmdXaXRoQ29udGVudCJdLCJtYXBwaW5ncyI6Ijs7QUFNQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFaQTs7Ozs7O0FBY0FBLG1CQUFRQyxZQUFSLENBQXFCQyxZQUFyQjtBQUNBLElBQU1DLGNBQWNILG1CQUFRSSxTQUFSLENBQWtCQyxnQkFBbEIsQ0FBcEI7O0FBRUFDLE9BQU9DLE9BQVAsR0FBaUIsZ0JBQWlDO0FBQUEsTUFBOUJDLE1BQThCLFFBQTlCQSxNQUE4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LElBRkksQ0FHSDtBQUFBLGVBQ0U1QixtQkFBUTJDLFlBQVIsQ0FBcUI7QUFBQSxpQkFBTSw2QkFBWUgsaUJBQVosRUFBaUMsRUFBRUksS0FBS3RCLFVBQVAsRUFBakMsRUFBc0R1QixFQUF0RCxDQUFOO0FBQUEsU0FBckIsRUFBc0ZqQixJQUF0RixDQUEyRjtBQUFBLGlCQUN6RmtCLE1BQU1DLE1BQU4sQ0FBYTtBQUFBLG1CQUFRLENBQUNOLFlBQVlPLFFBQVosQ0FBcUJ4QixJQUFyQixDQUFUO0FBQUEsV0FBYixDQUR5RjtBQUFBLFNBQTNGLENBREY7QUFBQSxPQUhHLEVBT0g7QUFBQSxlQUFNLEVBQU47QUFBQSxPQVBHLEVBU0pNLEtBVEksQ0FTRSxhQUFLO0FBQ1Z0QixlQUFPdUIsS0FBUCxDQUFhLDhEQUFiLEVBQTZFQyxDQUE3RTtBQUNBLGNBQU1BLENBQU47QUFDRCxPQVpJLENBQVA7QUFhRCxLQXhESTs7QUEwRExpQixnQkFBWTtBQUFBLGFBQU8sRUFBUDtBQUFBLEtBMURQOztBQTRETEMsMkJBQXVCO0FBQUEsYUFBTyxFQUFQO0FBQUE7QUE1RGxCLEdBQVA7QUE4REQsQ0FyRUQiLCJmaWxlIjoiLi9zcmMvZ2hvc3QtY29udGVudC90cmFuc3BhcmVudC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gIFRyYW5zcGFyZW50IEdob3N0IENvbnRlbnQgTWFuYWdlciBocyB0aGUgc2FtZSBBUEkgYnV0XG4gIHByb3hpZXMgYWxsIGNhbGxzIGRpcmVjdGx5IHRvIHRoZSBGUy5cbiAgSXQncyB1c2VkIHdoaWxlIGluIGRldmVsb3BtZW50LlxuKi9cblxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBta2RpcnAgZnJvbSAnbWtkaXJwJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgZ2xvYiBmcm9tICdnbG9iJ1xuXG5pbXBvcnQgeyBub3JtYWxpemVGb2xkZXIgYXMgX25vcm1hbGl6ZUZvbGRlciB9IGZyb20gJy4vdXRpbCdcblxuUHJvbWlzZS5wcm9taXNpZnlBbGwoZnMpXG5jb25zdCBta2RpcnBBc3luYyA9IFByb21pc2UucHJvbWlzaWZ5KG1rZGlycClcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBsb2dnZXIsIHByb2plY3RMb2NhdGlvbiB9KSA9PiB7XG4gIGNvbnN0IG5vcm1hbGl6ZUZvbGRlciA9IF9ub3JtYWxpemVGb2xkZXIocHJvamVjdExvY2F0aW9uKVxuXG4gIGNvbnN0IGZvbGRlck9wdGlvbnMgPSB7fVxuXG4gIGxvZ2dlci5pbmZvKCdbR2hvc3QgQ29udGVudCBNYW5hZ2VyXSAodHJhbnNwYXJlbnQpIEluaXRpYWxpemVkJylcblxuICByZXR1cm4ge1xuICAgIGFkZFJvb3RGb2xkZXI6IChyb290Rm9sZGVyLCBvcHRpb25zID0ge30pID0+IHtcbiAgICAgIGNvbnN0IHsgbm9ybWFsaXplZEZvbGRlck5hbWUgfSA9IG5vcm1hbGl6ZUZvbGRlcihyb290Rm9sZGVyKVxuICAgICAgbG9nZ2VyLmRlYnVnKGBbR2hvc3QgQ29udGVudCBNYW5hZ2VyXSAodHJhbnNwYXJlbnQpIEFkZGVkIHJvb3QgZm9sZGVyICR7bm9ybWFsaXplZEZvbGRlck5hbWV9LCBkb2luZyBub3RoaW5nLmApXG4gICAgICBmb2xkZXJPcHRpb25zW25vcm1hbGl6ZWRGb2xkZXJOYW1lXSA9IG9wdGlvbnNcbiAgICB9LFxuXG4gICAgdXBzZXJ0RmlsZTogKGZvbGRlciwgZmlsZSwgY29udGVudCkgPT4ge1xuICAgICAgY29uc3QgeyBmb2xkZXJQYXRoIH0gPSBub3JtYWxpemVGb2xkZXIoZm9sZGVyKVxuICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oZm9sZGVyUGF0aCwgZmlsZSlcbiAgICAgIGNvbnN0IGZ1bGxGaWxlRm9sZGVyID0gcGF0aC5kaXJuYW1lKGZpbGVQYXRoKVxuICAgICAgcmV0dXJuIG1rZGlycEFzeW5jKGZ1bGxGaWxlRm9sZGVyKVxuICAgICAgICAudGhlbigoKSA9PiBmcy53cml0ZUZpbGVBc3luYyhmaWxlUGF0aCwgY29udGVudCkpXG4gICAgICAgIC5jYXRjaChlID0+IHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ1tHaG9zdCBDb250ZW50IE1hbmFnZXJdICh0cmFuc3BhcmVudCkgdXBzZXJ0RmlsZSBlcnJvcicsIGUpXG4gICAgICAgICAgdGhyb3cgZVxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICByZWFkRmlsZTogKGZvbGRlciwgZmlsZSkgPT4ge1xuICAgICAgY29uc3QgeyBmb2xkZXJQYXRoLCBub3JtYWxpemVkRm9sZGVyTmFtZSB9ID0gbm9ybWFsaXplRm9sZGVyKGZvbGRlcilcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGZvbGRlclBhdGgsIGZpbGUpXG4gICAgICBjb25zdCBpc0JpbmFyeSA9IChmb2xkZXJPcHRpb25zW25vcm1hbGl6ZWRGb2xkZXJOYW1lXSB8fCB7fSkuaXNCaW5hcnkgfHwgZmFsc2VcbiAgICAgIHJldHVybiBmc1xuICAgICAgICAucmVhZEZpbGVBc3luYyhmaWxlUGF0aCwgaXNCaW5hcnkgPyBudWxsIDogJ3V0ZjgnKVxuICAgICAgICAuY2F0Y2goeyBjb2RlOiAnRU5PRU5UJyB9LCAoKSA9PiBudWxsKVxuICAgICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdbR2hvc3QgQ29udGVudCBNYW5hZ2VyXSAodHJhbnNwYXJlbnQpIHJlYWRGaWxlIGVycm9yJywgZSlcbiAgICAgICAgICB0aHJvdyBlXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIGRlbGV0ZUZpbGU6IChmb2xkZXIsIGZpbGUpID0+IHtcbiAgICAgIGNvbnN0IHsgZm9sZGVyUGF0aCB9ID0gbm9ybWFsaXplRm9sZGVyKGZvbGRlcilcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGZvbGRlclBhdGgsIGZpbGUpXG4gICAgICByZXR1cm4gZnMudW5saW5rQXN5bmMoZmlsZVBhdGgpLmNhdGNoKGUgPT4ge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ1tHaG9zdCBDb250ZW50IE1hbmFnZXJdICh0cmFuc3BhcmVudCkgZGVsZXRlRmlsZSBlcnJvcicsIGUpXG4gICAgICAgIHRocm93IGVcbiAgICAgIH0pXG4gICAgfSxcblxuICAgIGRpcmVjdG9yeUxpc3Rpbmc6IChyb290Rm9sZGVyLCBmaWxlRW5kaW5nUGF0dGVybiA9ICcnLCBwYXRoc1RvT21pdCA9IFtdKSA9PiB7XG4gICAgICBjb25zdCB7IGZvbGRlclBhdGggfSA9IG5vcm1hbGl6ZUZvbGRlcihyb290Rm9sZGVyKVxuICAgICAgcmV0dXJuIGZzXG4gICAgICAgIC5hY2Nlc3NBc3luYyhmb2xkZXJQYXRoKVxuICAgICAgICAudGhlbihcbiAgICAgICAgICAoKSA9PlxuICAgICAgICAgICAgUHJvbWlzZS5mcm9tQ2FsbGJhY2soY2IgPT4gZ2xvYihgKiovKiR7ZmlsZUVuZGluZ1BhdHRlcm59YCwgeyBjd2Q6IGZvbGRlclBhdGggfSwgY2IpKS50aGVuKHBhdGhzID0+XG4gICAgICAgICAgICAgIHBhdGhzLmZpbHRlcihwYXRoID0+ICFwYXRoc1RvT21pdC5pbmNsdWRlcyhwYXRoKSlcbiAgICAgICAgICAgICksXG4gICAgICAgICAgKCkgPT4gW11cbiAgICAgICAgKVxuICAgICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdbR2hvc3QgQ29udGVudCBNYW5hZ2VyXSAodHJhbnNwYXJlbnQpIGRpcmVjdG9yeUxpc3RpbmcgZXJyb3InLCBlKVxuICAgICAgICAgIHRocm93IGVcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgZ2V0UGVuZGluZzogKCkgPT4gKHt9KSxcblxuICAgIGdldFBlbmRpbmdXaXRoQ29udGVudDogKCkgPT4gKHt9KVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/ghost-content/transparent.js\n");

/***/ }),

/***/ "./src/ghost-content/util.js":
/*!***********************************!*\
  !*** ./src/ghost-content/util.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.normalizeFolder = undefined;\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar normalizeFolder = exports.normalizeFolder = function normalizeFolder(projectLocation) {\n  return function (folder) {\n    var folderPath = _path2.default.resolve(projectLocation, folder);\n    return {\n      folderPath: folderPath,\n      normalizedFolderName: _path2.default.relative(projectLocation, folderPath)\n    };\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ2hvc3QtY29udGVudC91dGlsLmpzP2UyN2QiXSwibmFtZXMiOlsibm9ybWFsaXplRm9sZGVyIiwiZm9sZGVyUGF0aCIsInBhdGgiLCJyZXNvbHZlIiwicHJvamVjdExvY2F0aW9uIiwiZm9sZGVyIiwibm9ybWFsaXplZEZvbGRlck5hbWUiLCJyZWxhdGl2ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7Ozs7QUFFTyxJQUFNQSw0Q0FBa0IsU0FBbEJBLGVBQWtCO0FBQUEsU0FBbUIsa0JBQVU7QUFDMUQsUUFBTUMsYUFBYUMsZUFBS0MsT0FBTCxDQUFhQyxlQUFiLEVBQThCQyxNQUE5QixDQUFuQjtBQUNBLFdBQU87QUFDTEosNEJBREs7QUFFTEssNEJBQXNCSixlQUFLSyxRQUFMLENBQWNILGVBQWQsRUFBK0JILFVBQS9CO0FBRmpCLEtBQVA7QUFJRCxHQU44QjtBQUFBLENBQXhCIiwiZmlsZSI6Ii4vc3JjL2dob3N0LWNvbnRlbnQvdXRpbC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5cbmV4cG9ydCBjb25zdCBub3JtYWxpemVGb2xkZXIgPSBwcm9qZWN0TG9jYXRpb24gPT4gZm9sZGVyID0+IHtcbiAgY29uc3QgZm9sZGVyUGF0aCA9IHBhdGgucmVzb2x2ZShwcm9qZWN0TG9jYXRpb24sIGZvbGRlcilcbiAgcmV0dXJuIHtcbiAgICBmb2xkZXJQYXRoLFxuICAgIG5vcm1hbGl6ZWRGb2xkZXJOYW1lOiBwYXRoLnJlbGF0aXZlKHByb2plY3RMb2NhdGlvbiwgZm9sZGVyUGF0aClcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/ghost-content/util.js\n");

/***/ }),

/***/ "./src/hear.js":
/*!*********************!*\
  !*** ./src/hear.js ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _mware = __webpack_require__(/*! mware */ \"mware\");\n\nvar _mware2 = _interopRequireDefault(_mware);\n\nvar _listeners = __webpack_require__(/*! ./listeners */ \"./src/listeners.js\");\n\nvar _listeners2 = _interopRequireDefault(_listeners);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function () {\n  var chain = (0, _mware2.default)();\n  var handler = function handler(event, next) {\n    chain.run(event, function () {\n      next.apply(this, arguments);\n    });\n  };\n\n  var middleware = {\n    name: 'hear',\n    type: 'incoming',\n    order: 20,\n    module: 'botpress',\n    description: 'The built-in hear convenience middleware',\n    handler: handler\n  };\n\n  var hear = function hear(condition, callback) {\n    chain(_listeners2.default.hear(condition, callback));\n  };\n\n  return { hear: hear, middleware: middleware };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaGVhci5qcz9iMzdmIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjaGFpbiIsImhhbmRsZXIiLCJldmVudCIsIm5leHQiLCJydW4iLCJhcHBseSIsImFyZ3VtZW50cyIsIm1pZGRsZXdhcmUiLCJuYW1lIiwidHlwZSIsIm9yZGVyIiwiZGVzY3JpcHRpb24iLCJoZWFyIiwiY29uZGl0aW9uIiwiY2FsbGJhY2siLCJsaXN0ZW5lcnMiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7Ozs7O0FBRUFBLE9BQU9DLE9BQVAsR0FBaUIsWUFBTTtBQUNyQixNQUFNQyxRQUFRLHNCQUFkO0FBQ0EsTUFBTUMsVUFBVSxTQUFWQSxPQUFVLENBQUNDLEtBQUQsRUFBUUMsSUFBUixFQUFpQjtBQUMvQkgsVUFBTUksR0FBTixDQUFVRixLQUFWLEVBQWlCLFlBQVc7QUFDMUJDLFdBQUtFLEtBQUwsQ0FBVyxJQUFYLEVBQWlCQyxTQUFqQjtBQUNELEtBRkQ7QUFHRCxHQUpEOztBQU1BLE1BQU1DLGFBQWE7QUFDakJDLFVBQU0sTUFEVztBQUVqQkMsVUFBTSxVQUZXO0FBR2pCQyxXQUFPLEVBSFU7QUFJakJaLFlBQVEsVUFKUztBQUtqQmEsaUJBQWEsMENBTEk7QUFNakJWLGFBQVNBO0FBTlEsR0FBbkI7O0FBU0EsTUFBTVcsT0FBTyxTQUFQQSxJQUFPLENBQUNDLFNBQUQsRUFBWUMsUUFBWixFQUF5QjtBQUNwQ2QsVUFBTWUsb0JBQVVILElBQVYsQ0FBZUMsU0FBZixFQUEwQkMsUUFBMUIsQ0FBTjtBQUNELEdBRkQ7O0FBSUEsU0FBTyxFQUFFRixVQUFGLEVBQVFMLHNCQUFSLEVBQVA7QUFDRCxDQXRCRCIsImZpbGUiOiIuL3NyYy9oZWFyLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG13YXJlIGZyb20gJ213YXJlJ1xuaW1wb3J0IGxpc3RlbmVycyBmcm9tICcuL2xpc3RlbmVycydcblxubW9kdWxlLmV4cG9ydHMgPSAoKSA9PiB7XG4gIGNvbnN0IGNoYWluID0gbXdhcmUoKVxuICBjb25zdCBoYW5kbGVyID0gKGV2ZW50LCBuZXh0KSA9PiB7XG4gICAgY2hhaW4ucnVuKGV2ZW50LCBmdW5jdGlvbigpIHtcbiAgICAgIG5leHQuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgIH0pXG4gIH1cblxuICBjb25zdCBtaWRkbGV3YXJlID0ge1xuICAgIG5hbWU6ICdoZWFyJyxcbiAgICB0eXBlOiAnaW5jb21pbmcnLFxuICAgIG9yZGVyOiAyMCxcbiAgICBtb2R1bGU6ICdib3RwcmVzcycsXG4gICAgZGVzY3JpcHRpb246ICdUaGUgYnVpbHQtaW4gaGVhciBjb252ZW5pZW5jZSBtaWRkbGV3YXJlJyxcbiAgICBoYW5kbGVyOiBoYW5kbGVyXG4gIH1cblxuICBjb25zdCBoZWFyID0gKGNvbmRpdGlvbiwgY2FsbGJhY2spID0+IHtcbiAgICBjaGFpbihsaXN0ZW5lcnMuaGVhcihjb25kaXRpb24sIGNhbGxiYWNrKSlcbiAgfVxuXG4gIHJldHVybiB7IGhlYXIsIG1pZGRsZXdhcmUgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/hear.js\n");

/***/ }),

/***/ "./src/helpers.js":
/*!************************!*\
  !*** ./src/helpers.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar database = __webpack_require__(/*! ./database/helpers */ \"./src/database/helpers.js\");\n\nmodule.exports = { database: database };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy5qcz9kN2MyIl0sIm5hbWVzIjpbImRhdGFiYXNlIiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsV0FBVyxtQkFBQUMsQ0FBUSxxREFBUixDQUFqQjs7QUFFQUMsT0FBT0MsT0FBUCxHQUFpQixFQUFFSCxrQkFBRixFQUFqQiIsImZpbGUiOiIuL3NyYy9oZWxwZXJzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGF0YWJhc2UgPSByZXF1aXJlKCcuL2RhdGFiYXNlL2hlbHBlcnMnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgZGF0YWJhc2UgfVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/helpers.js\n");

/***/ }),

/***/ "./src/licensing.js":
/*!**************************!*\
  !*** ./src/licensing.js ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _listeners = __webpack_require__(/*! ./listeners */ \"./src/listeners.js\");\n\nvar _listeners2 = _interopRequireDefault(_listeners);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var projectLocation = _ref.projectLocation,\n      bp = _ref.bp;\n\n  var licensesPath = _path2.default.join(bp.botpressPath, './licenses');\n\n  var getLicenses = function getLicenses() {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var _JSON$parse = JSON.parse(_fs2.default.readFileSync(packageJsonPath)),\n        license = _JSON$parse.license;\n\n    var agplContent = _fs2.default.readFileSync(_path2.default.join(licensesPath, 'LICENSE_AGPL3')).toString();\n    var botpressContent = _fs2.default.readFileSync(_path2.default.join(licensesPath, 'LICENSE_BOTPRESS')).toString();\n\n    return {\n      agpl: {\n        name: 'AGPL-3.0',\n        licensedUnder: license === 'AGPL-3.0',\n        text: agplContent\n      },\n      botpress: {\n        name: 'Botpress',\n        licensedUnder: license.toLowerCase().indexOf('botpress') >= 0,\n        text: botpressContent\n      }\n    };\n  };\n\n  var changeLicense = _bluebird2.default.method(function (license) {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var licensePath = (0, _util.resolveProjectFile)('LICENSE', projectLocation, true);\n    var licenseFileName = license === 'AGPL-3.0' ? 'LICENSE_AGPL3' : 'LICENSE_BOTPRESS';\n    var licenseContent = _fs2.default.readFileSync(_path2.default.join(licensesPath, licenseFileName));\n\n    var pkg = JSON.parse(_fs2.default.readFileSync(packageJsonPath));\n    pkg.license = license;\n\n    _fs2.default.writeFileSync(licensePath, licenseContent);\n    _fs2.default.writeFileSync(packageJsonPath, JSON.stringify(pkg, null, 2));\n  });\n\n  var middleware = _listeners2.default.hear(/^BOT_LICENSE$/, function (event, next) {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var _JSON$parse2 = JSON.parse(_fs2.default.readFileSync(packageJsonPath)),\n        license = _JSON$parse2.license,\n        name = _JSON$parse2.name,\n        author = _JSON$parse2.author;\n\n    var response = 'Bot:  ' + name + '\\nCreated by: ' + author + '\\nLicense: ' + license + '\\nBotpress: ' + bp.version;\n\n    var userId = event.user && event.user.id; // TODO Use botpress standard user getter\n\n    if (bp[event.platform] && bp[event.platform].sendText) {\n      bp[event.platform].sendText(userId, response);\n    } else {\n      bp.middlewares.sendOutgoing({\n        platform: event.platform,\n        type: 'text',\n        text: response,\n        raw: {\n          to: userId,\n          message: response,\n          responseTo: event\n        }\n      });\n    }\n  });\n\n  return {\n    getLicensing: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var licenses, currentLicense;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                licenses = getLicenses();\n                currentLicense = _lodash2.default.find(licenses, { licensedUnder: true }) || licenses.botpress;\n                return _context.abrupt('return', {\n                  licensed: true,\n                  name: currentLicense.name,\n                  status: 'Active',\n                  text: currentLicense.text\n                });\n\n              case 3:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, undefined);\n      }));\n\n      return function getLicensing() {\n        return _ref2.apply(this, arguments);\n      };\n    }(),\n    changeLicense: changeLicense,\n    middleware: middleware,\n    getFeatures: function getFeatures() {\n      return {};\n    }\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbGljZW5zaW5nLmpzPzIwZjQiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsInByb2plY3RMb2NhdGlvbiIsImJwIiwibGljZW5zZXNQYXRoIiwicGF0aCIsImpvaW4iLCJib3RwcmVzc1BhdGgiLCJnZXRMaWNlbnNlcyIsInBhY2thZ2VKc29uUGF0aCIsIkpTT04iLCJwYXJzZSIsImZzIiwicmVhZEZpbGVTeW5jIiwibGljZW5zZSIsImFncGxDb250ZW50IiwidG9TdHJpbmciLCJib3RwcmVzc0NvbnRlbnQiLCJhZ3BsIiwibmFtZSIsImxpY2Vuc2VkVW5kZXIiLCJ0ZXh0IiwiYm90cHJlc3MiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJjaGFuZ2VMaWNlbnNlIiwiUHJvbWlzZSIsIm1ldGhvZCIsImxpY2Vuc2VQYXRoIiwibGljZW5zZUZpbGVOYW1lIiwibGljZW5zZUNvbnRlbnQiLCJwa2ciLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5IiwibWlkZGxld2FyZSIsImxpc3RlbmVycyIsImhlYXIiLCJldmVudCIsIm5leHQiLCJhdXRob3IiLCJyZXNwb25zZSIsInZlcnNpb24iLCJ1c2VySWQiLCJ1c2VyIiwiaWQiLCJwbGF0Zm9ybSIsInNlbmRUZXh0IiwibWlkZGxld2FyZXMiLCJzZW5kT3V0Z29pbmciLCJ0eXBlIiwicmF3IiwidG8iLCJtZXNzYWdlIiwicmVzcG9uc2VUbyIsImdldExpY2Vuc2luZyIsImxpY2Vuc2VzIiwiY3VycmVudExpY2Vuc2UiLCJfIiwiZmluZCIsImxpY2Vuc2VkIiwic3RhdHVzIiwiZ2V0RmVhdHVyZXMiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFFQTs7OztBQUNBOzs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixnQkFBNkI7QUFBQSxNQUExQkMsZUFBMEIsUUFBMUJBLGVBQTBCO0FBQUEsTUFBVEMsRUFBUyxRQUFUQSxFQUFTOztBQUM1QyxNQUFNQyxlQUFlQyxlQUFLQyxJQUFMLENBQVVILEdBQUdJLFlBQWIsRUFBMkIsWUFBM0IsQ0FBckI7O0FBRUEsTUFBTUMsY0FBYyxTQUFkQSxXQUFjLEdBQU07QUFDeEIsUUFBTUMsa0JBQWtCLDhCQUFtQixjQUFuQixFQUFtQ1AsZUFBbkMsRUFBb0QsSUFBcEQsQ0FBeEI7O0FBRHdCLHNCQUVKUSxLQUFLQyxLQUFMLENBQVdDLGFBQUdDLFlBQUgsQ0FBZ0JKLGVBQWhCLENBQVgsQ0FGSTtBQUFBLFFBRWhCSyxPQUZnQixlQUVoQkEsT0FGZ0I7O0FBSXhCLFFBQU1DLGNBQWNILGFBQUdDLFlBQUgsQ0FBZ0JSLGVBQUtDLElBQUwsQ0FBVUYsWUFBVixFQUF3QixlQUF4QixDQUFoQixFQUEwRFksUUFBMUQsRUFBcEI7QUFDQSxRQUFNQyxrQkFBa0JMLGFBQUdDLFlBQUgsQ0FBZ0JSLGVBQUtDLElBQUwsQ0FBVUYsWUFBVixFQUF3QixrQkFBeEIsQ0FBaEIsRUFBNkRZLFFBQTdELEVBQXhCOztBQUVBLFdBQU87QUFDTEUsWUFBTTtBQUNKQyxjQUFNLFVBREY7QUFFSkMsdUJBQWVOLFlBQVksVUFGdkI7QUFHSk8sY0FBTU47QUFIRixPQUREO0FBTUxPLGdCQUFVO0FBQ1JILGNBQU0sVUFERTtBQUVSQyx1QkFBZU4sUUFBUVMsV0FBUixHQUFzQkMsT0FBdEIsQ0FBOEIsVUFBOUIsS0FBNkMsQ0FGcEQ7QUFHUkgsY0FBTUo7QUFIRTtBQU5MLEtBQVA7QUFZRCxHQW5CRDs7QUFxQkEsTUFBTVEsZ0JBQWdCQyxtQkFBUUMsTUFBUixDQUFlLG1CQUFXO0FBQzlDLFFBQU1sQixrQkFBa0IsOEJBQW1CLGNBQW5CLEVBQW1DUCxlQUFuQyxFQUFvRCxJQUFwRCxDQUF4Qjs7QUFFQSxRQUFNMEIsY0FBYyw4QkFBbUIsU0FBbkIsRUFBOEIxQixlQUE5QixFQUErQyxJQUEvQyxDQUFwQjtBQUNBLFFBQU0yQixrQkFBa0JmLFlBQVksVUFBWixHQUF5QixlQUF6QixHQUEyQyxrQkFBbkU7QUFDQSxRQUFNZ0IsaUJBQWlCbEIsYUFBR0MsWUFBSCxDQUFnQlIsZUFBS0MsSUFBTCxDQUFVRixZQUFWLEVBQXdCeUIsZUFBeEIsQ0FBaEIsQ0FBdkI7O0FBRUEsUUFBTUUsTUFBTXJCLEtBQUtDLEtBQUwsQ0FBV0MsYUFBR0MsWUFBSCxDQUFnQkosZUFBaEIsQ0FBWCxDQUFaO0FBQ0FzQixRQUFJakIsT0FBSixHQUFjQSxPQUFkOztBQUVBRixpQkFBR29CLGFBQUgsQ0FBaUJKLFdBQWpCLEVBQThCRSxjQUE5QjtBQUNBbEIsaUJBQUdvQixhQUFILENBQWlCdkIsZUFBakIsRUFBa0NDLEtBQUt1QixTQUFMLENBQWVGLEdBQWYsRUFBb0IsSUFBcEIsRUFBMEIsQ0FBMUIsQ0FBbEM7QUFDRCxHQVpxQixDQUF0Qjs7QUFjQSxNQUFNRyxhQUFhQyxvQkFBVUMsSUFBVixDQUFlLGVBQWYsRUFBZ0MsVUFBQ0MsS0FBRCxFQUFRQyxJQUFSLEVBQWlCO0FBQ2xFLFFBQU03QixrQkFBa0IsOEJBQW1CLGNBQW5CLEVBQW1DUCxlQUFuQyxFQUFvRCxJQUFwRCxDQUF4Qjs7QUFEa0UsdUJBRWhDUSxLQUFLQyxLQUFMLENBQVdDLGFBQUdDLFlBQUgsQ0FBZ0JKLGVBQWhCLENBQVgsQ0FGZ0M7QUFBQSxRQUUxREssT0FGMEQsZ0JBRTFEQSxPQUYwRDtBQUFBLFFBRWpESyxJQUZpRCxnQkFFakRBLElBRmlEO0FBQUEsUUFFM0NvQixNQUYyQyxnQkFFM0NBLE1BRjJDOztBQUlsRSxRQUFNQyxzQkFBb0JyQixJQUFwQixzQkFDSW9CLE1BREosbUJBRUN6QixPQUZELG9CQUdFWCxHQUFHc0MsT0FIWDs7QUFLQSxRQUFNQyxTQUFTTCxNQUFNTSxJQUFOLElBQWNOLE1BQU1NLElBQU4sQ0FBV0MsRUFBeEMsQ0FUa0UsQ0FTdkI7O0FBRTNDLFFBQUl6QyxHQUFHa0MsTUFBTVEsUUFBVCxLQUFzQjFDLEdBQUdrQyxNQUFNUSxRQUFULEVBQW1CQyxRQUE3QyxFQUF1RDtBQUNyRDNDLFNBQUdrQyxNQUFNUSxRQUFULEVBQW1CQyxRQUFuQixDQUE0QkosTUFBNUIsRUFBb0NGLFFBQXBDO0FBQ0QsS0FGRCxNQUVPO0FBQ0xyQyxTQUFHNEMsV0FBSCxDQUFlQyxZQUFmLENBQTRCO0FBQzFCSCxrQkFBVVIsTUFBTVEsUUFEVTtBQUUxQkksY0FBTSxNQUZvQjtBQUcxQjVCLGNBQU1tQixRQUhvQjtBQUkxQlUsYUFBSztBQUNIQyxjQUFJVCxNQUREO0FBRUhVLG1CQUFTWixRQUZOO0FBR0hhLHNCQUFZaEI7QUFIVDtBQUpxQixPQUE1QjtBQVVEO0FBQ0YsR0F6QmtCLENBQW5COztBQTJCQSxTQUFPO0FBQ0xpQjtBQUFBLDBFQUFjO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNOQyx3QkFETSxHQUNLL0MsYUFETDtBQUVOZ0QsOEJBRk0sR0FFV0MsaUJBQUVDLElBQUYsQ0FBT0gsUUFBUCxFQUFpQixFQUFFbkMsZUFBZSxJQUFqQixFQUFqQixLQUE2Q21DLFNBQVNqQyxRQUZqRTtBQUFBLGlEQUlMO0FBQ0xxQyw0QkFBVSxJQURMO0FBRUx4Qyx3QkFBTXFDLGVBQWVyQyxJQUZoQjtBQUdMeUMsMEJBQVEsUUFISDtBQUlMdkMsd0JBQU1tQyxlQUFlbkM7QUFKaEIsaUJBSks7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsT0FBZDs7QUFBQTtBQUFBO0FBQUE7QUFBQSxPQURLO0FBWUxJLGdDQVpLO0FBYUxTLDBCQWJLO0FBY0wyQixpQkFBYTtBQUFBLGFBQU8sRUFBUDtBQUFBO0FBZFIsR0FBUDtBQWdCRCxDQWpGRCIsImZpbGUiOiIuL3NyYy9saWNlbnNpbmcuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxuaW1wb3J0IGxpc3RlbmVycyBmcm9tICcuL2xpc3RlbmVycydcbmltcG9ydCB7IHJlc29sdmVQcm9qZWN0RmlsZSB9IGZyb20gJy4vdXRpbCdcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBwcm9qZWN0TG9jYXRpb24sIGJwIH0pID0+IHtcbiAgY29uc3QgbGljZW5zZXNQYXRoID0gcGF0aC5qb2luKGJwLmJvdHByZXNzUGF0aCwgJy4vbGljZW5zZXMnKVxuXG4gIGNvbnN0IGdldExpY2Vuc2VzID0gKCkgPT4ge1xuICAgIGNvbnN0IHBhY2thZ2VKc29uUGF0aCA9IHJlc29sdmVQcm9qZWN0RmlsZSgncGFja2FnZS5qc29uJywgcHJvamVjdExvY2F0aW9uLCB0cnVlKVxuICAgIGNvbnN0IHsgbGljZW5zZSB9ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGFja2FnZUpzb25QYXRoKSlcblxuICAgIGNvbnN0IGFncGxDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbihsaWNlbnNlc1BhdGgsICdMSUNFTlNFX0FHUEwzJykpLnRvU3RyaW5nKClcbiAgICBjb25zdCBib3RwcmVzc0NvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGxpY2Vuc2VzUGF0aCwgJ0xJQ0VOU0VfQk9UUFJFU1MnKSkudG9TdHJpbmcoKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGFncGw6IHtcbiAgICAgICAgbmFtZTogJ0FHUEwtMy4wJyxcbiAgICAgICAgbGljZW5zZWRVbmRlcjogbGljZW5zZSA9PT0gJ0FHUEwtMy4wJyxcbiAgICAgICAgdGV4dDogYWdwbENvbnRlbnRcbiAgICAgIH0sXG4gICAgICBib3RwcmVzczoge1xuICAgICAgICBuYW1lOiAnQm90cHJlc3MnLFxuICAgICAgICBsaWNlbnNlZFVuZGVyOiBsaWNlbnNlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignYm90cHJlc3MnKSA+PSAwLFxuICAgICAgICB0ZXh0OiBib3RwcmVzc0NvbnRlbnRcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBjb25zdCBjaGFuZ2VMaWNlbnNlID0gUHJvbWlzZS5tZXRob2QobGljZW5zZSA9PiB7XG4gICAgY29uc3QgcGFja2FnZUpzb25QYXRoID0gcmVzb2x2ZVByb2plY3RGaWxlKCdwYWNrYWdlLmpzb24nLCBwcm9qZWN0TG9jYXRpb24sIHRydWUpXG5cbiAgICBjb25zdCBsaWNlbnNlUGF0aCA9IHJlc29sdmVQcm9qZWN0RmlsZSgnTElDRU5TRScsIHByb2plY3RMb2NhdGlvbiwgdHJ1ZSlcbiAgICBjb25zdCBsaWNlbnNlRmlsZU5hbWUgPSBsaWNlbnNlID09PSAnQUdQTC0zLjAnID8gJ0xJQ0VOU0VfQUdQTDMnIDogJ0xJQ0VOU0VfQk9UUFJFU1MnXG4gICAgY29uc3QgbGljZW5zZUNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGxpY2Vuc2VzUGF0aCwgbGljZW5zZUZpbGVOYW1lKSlcblxuICAgIGNvbnN0IHBrZyA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhY2thZ2VKc29uUGF0aCkpXG4gICAgcGtnLmxpY2Vuc2UgPSBsaWNlbnNlXG5cbiAgICBmcy53cml0ZUZpbGVTeW5jKGxpY2Vuc2VQYXRoLCBsaWNlbnNlQ29udGVudClcbiAgICBmcy53cml0ZUZpbGVTeW5jKHBhY2thZ2VKc29uUGF0aCwgSlNPTi5zdHJpbmdpZnkocGtnLCBudWxsLCAyKSlcbiAgfSlcblxuICBjb25zdCBtaWRkbGV3YXJlID0gbGlzdGVuZXJzLmhlYXIoL15CT1RfTElDRU5TRSQvLCAoZXZlbnQsIG5leHQpID0+IHtcbiAgICBjb25zdCBwYWNrYWdlSnNvblBhdGggPSByZXNvbHZlUHJvamVjdEZpbGUoJ3BhY2thZ2UuanNvbicsIHByb2plY3RMb2NhdGlvbiwgdHJ1ZSlcbiAgICBjb25zdCB7IGxpY2Vuc2UsIG5hbWUsIGF1dGhvciB9ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGFja2FnZUpzb25QYXRoKSlcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYEJvdDogICR7bmFtZX1cbkNyZWF0ZWQgYnk6ICR7YXV0aG9yfVxuTGljZW5zZTogJHtsaWNlbnNlfVxuQm90cHJlc3M6ICR7YnAudmVyc2lvbn1gXG5cbiAgICBjb25zdCB1c2VySWQgPSBldmVudC51c2VyICYmIGV2ZW50LnVzZXIuaWQgLy8gVE9ETyBVc2UgYm90cHJlc3Mgc3RhbmRhcmQgdXNlciBnZXR0ZXJcblxuICAgIGlmIChicFtldmVudC5wbGF0Zm9ybV0gJiYgYnBbZXZlbnQucGxhdGZvcm1dLnNlbmRUZXh0KSB7XG4gICAgICBicFtldmVudC5wbGF0Zm9ybV0uc2VuZFRleHQodXNlcklkLCByZXNwb25zZSlcbiAgICB9IGVsc2Uge1xuICAgICAgYnAubWlkZGxld2FyZXMuc2VuZE91dGdvaW5nKHtcbiAgICAgICAgcGxhdGZvcm06IGV2ZW50LnBsYXRmb3JtLFxuICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgIHRleHQ6IHJlc3BvbnNlLFxuICAgICAgICByYXc6IHtcbiAgICAgICAgICB0bzogdXNlcklkLFxuICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLFxuICAgICAgICAgIHJlc3BvbnNlVG86IGV2ZW50XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9KVxuXG4gIHJldHVybiB7XG4gICAgZ2V0TGljZW5zaW5nOiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsaWNlbnNlcyA9IGdldExpY2Vuc2VzKClcbiAgICAgIGNvbnN0IGN1cnJlbnRMaWNlbnNlID0gXy5maW5kKGxpY2Vuc2VzLCB7IGxpY2Vuc2VkVW5kZXI6IHRydWUgfSkgfHwgbGljZW5zZXMuYm90cHJlc3NcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGljZW5zZWQ6IHRydWUsXG4gICAgICAgIG5hbWU6IGN1cnJlbnRMaWNlbnNlLm5hbWUsXG4gICAgICAgIHN0YXR1czogJ0FjdGl2ZScsXG4gICAgICAgIHRleHQ6IGN1cnJlbnRMaWNlbnNlLnRleHRcbiAgICAgIH1cbiAgICB9LFxuICAgIGNoYW5nZUxpY2Vuc2UsXG4gICAgbWlkZGxld2FyZSxcbiAgICBnZXRGZWF0dXJlczogKCkgPT4gKHt9KVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/licensing.js\n");

/***/ }),

/***/ "./src/listeners.js":
/*!**************************!*\
  !*** ./src/listeners.js ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar matches = function matches(conditions, event) {\n  if (!_lodash2.default.isPlainObject(conditions)) {\n    conditions = { text: conditions };\n  }\n\n  var pairs = _lodash2.default.toPairs(conditions);\n  return _lodash2.default.every(pairs, function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        comparrer = _ref2[1];\n\n    var eventValue = _lodash2.default.get(event, key, null);\n\n    if (_lodash2.default.isFunction(comparrer)) {\n      return comparrer(eventValue, event) === true;\n    } else if (_lodash2.default.isRegExp(comparrer)) {\n      var _matches = comparrer.test(eventValue);\n\n      if (_matches && _lodash2.default.isString(eventValue)) {\n        if (_lodash2.default.isNil(event.captured)) {\n          event.captured = [];\n        }\n\n        var a = _lodash2.default.tail(comparrer.exec(eventValue));\n        a.forEach(function (m) {\n          return event.captured.push(m);\n        });\n      }\n\n      return _matches;\n    } else {\n      return _lodash2.default.isEqual(comparrer, eventValue);\n    }\n  });\n};\n\nvar hear = function hear(conditions, callback) {\n  return function (event, next) {\n    var result = false;\n    if (_lodash2.default.isFunction(conditions)) {\n      result = conditions(event);\n    } else if (_lodash2.default.isArray(conditions)) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = conditions[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var conditionsItem = _step.value;\n\n          if (matches(conditionsItem, event)) {\n            result = true;\n            break;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    } else {\n      result = matches(conditions, event);\n    }\n\n    if (result && _lodash2.default.isFunction(callback)) {\n      if (callback.length <= 1) {\n        if (_lodash2.default.isFunction(next)) {\n          next();\n        }\n        callback(event);\n      } else {\n        callback(event, next);\n      }\n    } else {\n      if (_lodash2.default.isFunction(next)) {\n        next();\n      }\n    }\n  };\n};\n\nmodule.exports = { hear: hear, matches: matches };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbGlzdGVuZXJzLmpzPzFjOWUiXSwibmFtZXMiOlsibWF0Y2hlcyIsImNvbmRpdGlvbnMiLCJldmVudCIsIl8iLCJpc1BsYWluT2JqZWN0IiwidGV4dCIsInBhaXJzIiwidG9QYWlycyIsImV2ZXJ5Iiwia2V5IiwiY29tcGFycmVyIiwiZXZlbnRWYWx1ZSIsImdldCIsImlzRnVuY3Rpb24iLCJpc1JlZ0V4cCIsInRlc3QiLCJpc1N0cmluZyIsImlzTmlsIiwiY2FwdHVyZWQiLCJhIiwidGFpbCIsImV4ZWMiLCJmb3JFYWNoIiwicHVzaCIsIm0iLCJpc0VxdWFsIiwiaGVhciIsImNhbGxiYWNrIiwibmV4dCIsInJlc3VsdCIsImlzQXJyYXkiLCJjb25kaXRpb25zSXRlbSIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7Ozs7O0FBRUEsSUFBTUEsVUFBVSxTQUFWQSxPQUFVLENBQUNDLFVBQUQsRUFBYUMsS0FBYixFQUF1QjtBQUNyQyxNQUFJLENBQUNDLGlCQUFFQyxhQUFGLENBQWdCSCxVQUFoQixDQUFMLEVBQWtDO0FBQ2hDQSxpQkFBYSxFQUFFSSxNQUFNSixVQUFSLEVBQWI7QUFDRDs7QUFFRCxNQUFNSyxRQUFRSCxpQkFBRUksT0FBRixDQUFVTixVQUFWLENBQWQ7QUFDQSxTQUFPRSxpQkFBRUssS0FBRixDQUFRRixLQUFSLEVBQWUsZ0JBQXNCO0FBQUE7QUFBQSxRQUFwQkcsR0FBb0I7QUFBQSxRQUFmQyxTQUFlOztBQUMxQyxRQUFNQyxhQUFhUixpQkFBRVMsR0FBRixDQUFNVixLQUFOLEVBQWFPLEdBQWIsRUFBa0IsSUFBbEIsQ0FBbkI7O0FBRUEsUUFBSU4saUJBQUVVLFVBQUYsQ0FBYUgsU0FBYixDQUFKLEVBQTZCO0FBQzNCLGFBQU9BLFVBQVVDLFVBQVYsRUFBc0JULEtBQXRCLE1BQWlDLElBQXhDO0FBQ0QsS0FGRCxNQUVPLElBQUlDLGlCQUFFVyxRQUFGLENBQVdKLFNBQVgsQ0FBSixFQUEyQjtBQUNoQyxVQUFNVixXQUFVVSxVQUFVSyxJQUFWLENBQWVKLFVBQWYsQ0FBaEI7O0FBRUEsVUFBSVgsWUFBV0csaUJBQUVhLFFBQUYsQ0FBV0wsVUFBWCxDQUFmLEVBQXVDO0FBQ3JDLFlBQUlSLGlCQUFFYyxLQUFGLENBQVFmLE1BQU1nQixRQUFkLENBQUosRUFBNkI7QUFDM0JoQixnQkFBTWdCLFFBQU4sR0FBaUIsRUFBakI7QUFDRDs7QUFFRCxZQUFNQyxJQUFJaEIsaUJBQUVpQixJQUFGLENBQU9WLFVBQVVXLElBQVYsQ0FBZVYsVUFBZixDQUFQLENBQVY7QUFDQVEsVUFBRUcsT0FBRixDQUFVO0FBQUEsaUJBQUtwQixNQUFNZ0IsUUFBTixDQUFlSyxJQUFmLENBQW9CQyxDQUFwQixDQUFMO0FBQUEsU0FBVjtBQUNEOztBQUVELGFBQU94QixRQUFQO0FBQ0QsS0FiTSxNQWFBO0FBQ0wsYUFBT0csaUJBQUVzQixPQUFGLENBQVVmLFNBQVYsRUFBcUJDLFVBQXJCLENBQVA7QUFDRDtBQUNGLEdBckJNLENBQVA7QUFzQkQsQ0E1QkQ7O0FBOEJBLElBQU1lLE9BQU8sU0FBUEEsSUFBTyxDQUFDekIsVUFBRCxFQUFhMEIsUUFBYixFQUEwQjtBQUNyQyxTQUFPLFVBQUN6QixLQUFELEVBQVEwQixJQUFSLEVBQWlCO0FBQ3RCLFFBQUlDLFNBQVMsS0FBYjtBQUNBLFFBQUkxQixpQkFBRVUsVUFBRixDQUFhWixVQUFiLENBQUosRUFBOEI7QUFDNUI0QixlQUFTNUIsV0FBV0MsS0FBWCxDQUFUO0FBQ0QsS0FGRCxNQUVPLElBQUlDLGlCQUFFMkIsT0FBRixDQUFVN0IsVUFBVixDQUFKLEVBQTJCO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQ2hDLDZCQUE2QkEsVUFBN0IsOEhBQXlDO0FBQUEsY0FBOUI4QixjQUE4Qjs7QUFDdkMsY0FBSS9CLFFBQVErQixjQUFSLEVBQXdCN0IsS0FBeEIsQ0FBSixFQUFvQztBQUNsQzJCLHFCQUFTLElBQVQ7QUFDQTtBQUNEO0FBQ0Y7QUFOK0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9qQyxLQVBNLE1BT0E7QUFDTEEsZUFBUzdCLFFBQVFDLFVBQVIsRUFBb0JDLEtBQXBCLENBQVQ7QUFDRDs7QUFFRCxRQUFJMkIsVUFBVTFCLGlCQUFFVSxVQUFGLENBQWFjLFFBQWIsQ0FBZCxFQUFzQztBQUNwQyxVQUFJQSxTQUFTSyxNQUFULElBQW1CLENBQXZCLEVBQTBCO0FBQ3hCLFlBQUk3QixpQkFBRVUsVUFBRixDQUFhZSxJQUFiLENBQUosRUFBd0I7QUFDdEJBO0FBQ0Q7QUFDREQsaUJBQVN6QixLQUFUO0FBQ0QsT0FMRCxNQUtPO0FBQ0x5QixpQkFBU3pCLEtBQVQsRUFBZ0IwQixJQUFoQjtBQUNEO0FBQ0YsS0FURCxNQVNPO0FBQ0wsVUFBSXpCLGlCQUFFVSxVQUFGLENBQWFlLElBQWIsQ0FBSixFQUF3QjtBQUN0QkE7QUFDRDtBQUNGO0FBQ0YsR0E3QkQ7QUE4QkQsQ0EvQkQ7O0FBaUNBSyxPQUFPQyxPQUFQLEdBQWlCLEVBQUVSLFVBQUYsRUFBUTFCLGdCQUFSLEVBQWpCIiwiZmlsZSI6Ii4vc3JjL2xpc3RlbmVycy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxuY29uc3QgbWF0Y2hlcyA9IChjb25kaXRpb25zLCBldmVudCkgPT4ge1xuICBpZiAoIV8uaXNQbGFpbk9iamVjdChjb25kaXRpb25zKSkge1xuICAgIGNvbmRpdGlvbnMgPSB7IHRleHQ6IGNvbmRpdGlvbnMgfVxuICB9XG5cbiAgY29uc3QgcGFpcnMgPSBfLnRvUGFpcnMoY29uZGl0aW9ucylcbiAgcmV0dXJuIF8uZXZlcnkocGFpcnMsIChba2V5LCBjb21wYXJyZXJdKSA9PiB7XG4gICAgY29uc3QgZXZlbnRWYWx1ZSA9IF8uZ2V0KGV2ZW50LCBrZXksIG51bGwpXG5cbiAgICBpZiAoXy5pc0Z1bmN0aW9uKGNvbXBhcnJlcikpIHtcbiAgICAgIHJldHVybiBjb21wYXJyZXIoZXZlbnRWYWx1ZSwgZXZlbnQpID09PSB0cnVlXG4gICAgfSBlbHNlIGlmIChfLmlzUmVnRXhwKGNvbXBhcnJlcikpIHtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb21wYXJyZXIudGVzdChldmVudFZhbHVlKVxuXG4gICAgICBpZiAobWF0Y2hlcyAmJiBfLmlzU3RyaW5nKGV2ZW50VmFsdWUpKSB7XG4gICAgICAgIGlmIChfLmlzTmlsKGV2ZW50LmNhcHR1cmVkKSkge1xuICAgICAgICAgIGV2ZW50LmNhcHR1cmVkID0gW11cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGEgPSBfLnRhaWwoY29tcGFycmVyLmV4ZWMoZXZlbnRWYWx1ZSkpXG4gICAgICAgIGEuZm9yRWFjaChtID0+IGV2ZW50LmNhcHR1cmVkLnB1c2gobSkpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBtYXRjaGVzXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBfLmlzRXF1YWwoY29tcGFycmVyLCBldmVudFZhbHVlKVxuICAgIH1cbiAgfSlcbn1cblxuY29uc3QgaGVhciA9IChjb25kaXRpb25zLCBjYWxsYmFjaykgPT4ge1xuICByZXR1cm4gKGV2ZW50LCBuZXh0KSA9PiB7XG4gICAgbGV0IHJlc3VsdCA9IGZhbHNlXG4gICAgaWYgKF8uaXNGdW5jdGlvbihjb25kaXRpb25zKSkge1xuICAgICAgcmVzdWx0ID0gY29uZGl0aW9ucyhldmVudClcbiAgICB9IGVsc2UgaWYgKF8uaXNBcnJheShjb25kaXRpb25zKSkge1xuICAgICAgZm9yIChjb25zdCBjb25kaXRpb25zSXRlbSBvZiBjb25kaXRpb25zKSB7XG4gICAgICAgIGlmIChtYXRjaGVzKGNvbmRpdGlvbnNJdGVtLCBldmVudCkpIHtcbiAgICAgICAgICByZXN1bHQgPSB0cnVlXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgPSBtYXRjaGVzKGNvbmRpdGlvbnMsIGV2ZW50KVxuICAgIH1cblxuICAgIGlmIChyZXN1bHQgJiYgXy5pc0Z1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIGlmIChfLmlzRnVuY3Rpb24obmV4dCkpIHtcbiAgICAgICAgICBuZXh0KClcbiAgICAgICAgfVxuICAgICAgICBjYWxsYmFjayhldmVudClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbGxiYWNrKGV2ZW50LCBuZXh0KVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoXy5pc0Z1bmN0aW9uKG5leHQpKSB7XG4gICAgICAgIG5leHQoKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgaGVhciwgbWF0Y2hlcyB9XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/listeners.js\n");

/***/ }),

/***/ "./src/logger.js":
/*!***********************!*\
  !*** ./src/logger.js ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _winston = __webpack_require__(/*! winston */ \"winston\");\n\nvar _winston2 = _interopRequireDefault(_winston);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _moment = __webpack_require__(/*! moment */ \"moment\");\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (dataLocation, logConfig) {\n  var logger = new _winston2.default.Logger({\n    level: _util.isDeveloping ? 'debug' : 'info',\n    transports: [new _winston2.default.transports.Console({\n      prettyPrint: true,\n      colorize: true,\n      timestamp: function timestamp() {\n        return (0, _moment2.default)().format('HH:mm:ss');\n      }\n    })]\n  });\n\n  logger.enableFileTransport = function () {\n    var logFile = _path2.default.join(dataLocation, logConfig.file);\n    logger.add(_winston2.default.transports.File, {\n      filename: logFile,\n      maxsize: logConfig.maxSize\n    });\n  };\n\n  logger.archiveToFile = function () {\n    var logFile = _path2.default.join(dataLocation, logConfig.file);\n\n    return _bluebird2.default.resolve(logFile);\n  };\n\n  if (!logConfig.disableFileLogs) {\n    logger.enableFileTransport();\n  }\n\n  return logger;\n}; /**\n    * @typedef {Function} Logger~MessageLogger\n    * @param {String} message Message to log\n    * @param {...Object} objects Additional objects to log\n    */\n\n/**\n * @class Logger\n * @prop {Logger~MessageLogger} debug Logs message for debugging purposes\n * (hidden in production by default, see {@link Botfile} to change this)\n * @prop {Logger~MessageLogger} info Logs informative messages (shown in production)\n * @prop {Logger~MessageLogger} warn Logs warning messages (shown in production)\n * @prop {Logger~MessageLogger} error Logs error messages (shown in production)\n *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbG9nZ2VyLmpzPzk3YjUiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImRhdGFMb2NhdGlvbiIsImxvZ0NvbmZpZyIsImxvZ2dlciIsIndpbnN0b24iLCJMb2dnZXIiLCJsZXZlbCIsImlzRGV2ZWxvcGluZyIsInRyYW5zcG9ydHMiLCJDb25zb2xlIiwicHJldHR5UHJpbnQiLCJjb2xvcml6ZSIsInRpbWVzdGFtcCIsImZvcm1hdCIsImVuYWJsZUZpbGVUcmFuc3BvcnQiLCJsb2dGaWxlIiwicGF0aCIsImpvaW4iLCJmaWxlIiwiYWRkIiwiRmlsZSIsImZpbGVuYW1lIiwibWF4c2l6ZSIsIm1heFNpemUiLCJhcmNoaXZlVG9GaWxlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJkaXNhYmxlRmlsZUxvZ3MiXSwibWFwcGluZ3MiOiI7O0FBZUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFFQTs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLFVBQUNDLFlBQUQsRUFBZUMsU0FBZixFQUE2QjtBQUM1QyxNQUFNQyxTQUFTLElBQUlDLGtCQUFRQyxNQUFaLENBQW1CO0FBQ2hDQyxXQUFPQyxxQkFBZSxPQUFmLEdBQXlCLE1BREE7QUFFaENDLGdCQUFZLENBQ1YsSUFBSUosa0JBQVFJLFVBQVIsQ0FBbUJDLE9BQXZCLENBQStCO0FBQzdCQyxtQkFBYSxJQURnQjtBQUU3QkMsZ0JBQVUsSUFGbUI7QUFHN0JDLGlCQUFXO0FBQUEsZUFBTSx3QkFBU0MsTUFBVCxDQUFnQixVQUFoQixDQUFOO0FBQUE7QUFIa0IsS0FBL0IsQ0FEVTtBQUZvQixHQUFuQixDQUFmOztBQVdBVixTQUFPVyxtQkFBUCxHQUE2QixZQUFNO0FBQ2pDLFFBQU1DLFVBQVVDLGVBQUtDLElBQUwsQ0FBVWhCLFlBQVYsRUFBd0JDLFVBQVVnQixJQUFsQyxDQUFoQjtBQUNBZixXQUFPZ0IsR0FBUCxDQUFXZixrQkFBUUksVUFBUixDQUFtQlksSUFBOUIsRUFBb0M7QUFDbENDLGdCQUFVTixPQUR3QjtBQUVsQ08sZUFBU3BCLFVBQVVxQjtBQUZlLEtBQXBDO0FBSUQsR0FORDs7QUFRQXBCLFNBQU9xQixhQUFQLEdBQXVCLFlBQU07QUFDM0IsUUFBTVQsVUFBVUMsZUFBS0MsSUFBTCxDQUFVaEIsWUFBVixFQUF3QkMsVUFBVWdCLElBQWxDLENBQWhCOztBQUVBLFdBQU9PLG1CQUFRQyxPQUFSLENBQWdCWCxPQUFoQixDQUFQO0FBQ0QsR0FKRDs7QUFNQSxNQUFJLENBQUNiLFVBQVV5QixlQUFmLEVBQWdDO0FBQzlCeEIsV0FBT1csbUJBQVA7QUFDRDs7QUFFRCxTQUFPWCxNQUFQO0FBQ0QsQ0EvQkQsQyxDQXRCQTs7Ozs7O0FBTUEiLCJmaWxlIjoiLi9zcmMvbG9nZ2VyLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAdHlwZWRlZiB7RnVuY3Rpb259IExvZ2dlcn5NZXNzYWdlTG9nZ2VyXG4gKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICogQHBhcmFtIHsuLi5PYmplY3R9IG9iamVjdHMgQWRkaXRpb25hbCBvYmplY3RzIHRvIGxvZ1xuICovXG5cbi8qKlxuICogQGNsYXNzIExvZ2dlclxuICogQHByb3Age0xvZ2dlcn5NZXNzYWdlTG9nZ2VyfSBkZWJ1ZyBMb2dzIG1lc3NhZ2UgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlc1xuICogKGhpZGRlbiBpbiBwcm9kdWN0aW9uIGJ5IGRlZmF1bHQsIHNlZSB7QGxpbmsgQm90ZmlsZX0gdG8gY2hhbmdlIHRoaXMpXG4gKiBAcHJvcCB7TG9nZ2Vyfk1lc3NhZ2VMb2dnZXJ9IGluZm8gTG9ncyBpbmZvcm1hdGl2ZSBtZXNzYWdlcyAoc2hvd24gaW4gcHJvZHVjdGlvbilcbiAqIEBwcm9wIHtMb2dnZXJ+TWVzc2FnZUxvZ2dlcn0gd2FybiBMb2dzIHdhcm5pbmcgbWVzc2FnZXMgKHNob3duIGluIHByb2R1Y3Rpb24pXG4gKiBAcHJvcCB7TG9nZ2Vyfk1lc3NhZ2VMb2dnZXJ9IGVycm9yIExvZ3MgZXJyb3IgbWVzc2FnZXMgKHNob3duIGluIHByb2R1Y3Rpb24pXG4gKi9cblxuaW1wb3J0IHdpbnN0b24gZnJvbSAnd2luc3RvbidcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50J1xuXG5pbXBvcnQgeyBpc0RldmVsb3BpbmcgfSBmcm9tICcuL3V0aWwnXG5cbm1vZHVsZS5leHBvcnRzID0gKGRhdGFMb2NhdGlvbiwgbG9nQ29uZmlnKSA9PiB7XG4gIGNvbnN0IGxvZ2dlciA9IG5ldyB3aW5zdG9uLkxvZ2dlcih7XG4gICAgbGV2ZWw6IGlzRGV2ZWxvcGluZyA/ICdkZWJ1ZycgOiAnaW5mbycsXG4gICAgdHJhbnNwb3J0czogW1xuICAgICAgbmV3IHdpbnN0b24udHJhbnNwb3J0cy5Db25zb2xlKHtcbiAgICAgICAgcHJldHR5UHJpbnQ6IHRydWUsXG4gICAgICAgIGNvbG9yaXplOiB0cnVlLFxuICAgICAgICB0aW1lc3RhbXA6ICgpID0+IG1vbWVudCgpLmZvcm1hdCgnSEg6bW06c3MnKVxuICAgICAgfSlcbiAgICBdXG4gIH0pXG5cbiAgbG9nZ2VyLmVuYWJsZUZpbGVUcmFuc3BvcnQgPSAoKSA9PiB7XG4gICAgY29uc3QgbG9nRmlsZSA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sIGxvZ0NvbmZpZy5maWxlKVxuICAgIGxvZ2dlci5hZGQod2luc3Rvbi50cmFuc3BvcnRzLkZpbGUsIHtcbiAgICAgIGZpbGVuYW1lOiBsb2dGaWxlLFxuICAgICAgbWF4c2l6ZTogbG9nQ29uZmlnLm1heFNpemVcbiAgICB9KVxuICB9XG5cbiAgbG9nZ2VyLmFyY2hpdmVUb0ZpbGUgPSAoKSA9PiB7XG4gICAgY29uc3QgbG9nRmlsZSA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sIGxvZ0NvbmZpZy5maWxlKVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsb2dGaWxlKVxuICB9XG5cbiAgaWYgKCFsb2dDb25maWcuZGlzYWJsZUZpbGVMb2dzKSB7XG4gICAgbG9nZ2VyLmVuYWJsZUZpbGVUcmFuc3BvcnQoKVxuICB9XG5cbiAgcmV0dXJuIGxvZ2dlclxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/logger.js\n");

/***/ }),

/***/ "./src/media-manager/index.js":
/*!************************************!*\
  !*** ./src/media-manager/index.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar defaultDir = './media';\n\nmodule.exports = function (_ref) {\n  var botfile = _ref.botfile,\n      logger = _ref.logger,\n      ghostManager = _ref.ghostManager,\n      projectLocation = _ref.projectLocation;\n\n  var mediaDir = _path2.default.resolve(projectLocation, botfile.mediaDir || defaultDir);\n\n  ghostManager.addRootFolder(mediaDir, { isBinary: true });\n\n  var saveFile = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(filename, buffer) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              filename = (0, _util.safeId)(20) + '-' + _path2.default.basename(filename);\n              _context.next = 3;\n              return ghostManager.upsertFile(mediaDir, filename, buffer);\n\n            case 3:\n              return _context.abrupt('return', filename);\n\n            case 4:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function saveFile(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var readFile = function readFile(filename) {\n    return ghostManager.readFile(mediaDir, filename);\n  };\n\n  return { saveFile: saveFile, readFile: readFile };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbWVkaWEtbWFuYWdlci9pbmRleC5qcz84MDQ4Il0sIm5hbWVzIjpbImRlZmF1bHREaXIiLCJtb2R1bGUiLCJleHBvcnRzIiwiYm90ZmlsZSIsImxvZ2dlciIsImdob3N0TWFuYWdlciIsInByb2plY3RMb2NhdGlvbiIsIm1lZGlhRGlyIiwicGF0aCIsInJlc29sdmUiLCJhZGRSb290Rm9sZGVyIiwiaXNCaW5hcnkiLCJzYXZlRmlsZSIsImZpbGVuYW1lIiwiYnVmZmVyIiwiYmFzZW5hbWUiLCJ1cHNlcnRGaWxlIiwicmVhZEZpbGUiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsYUFBYSxTQUFuQjs7QUFFQUMsT0FBT0MsT0FBUCxHQUFpQixnQkFBd0Q7QUFBQSxNQUFyREMsT0FBcUQsUUFBckRBLE9BQXFEO0FBQUEsTUFBNUNDLE1BQTRDLFFBQTVDQSxNQUE0QztBQUFBLE1BQXBDQyxZQUFvQyxRQUFwQ0EsWUFBb0M7QUFBQSxNQUF0QkMsZUFBc0IsUUFBdEJBLGVBQXNCOztBQUN2RSxNQUFNQyxXQUFXQyxlQUFLQyxPQUFMLENBQWFILGVBQWIsRUFBOEJILFFBQVFJLFFBQVIsSUFBb0JQLFVBQWxELENBQWpCOztBQUVBSyxlQUFhSyxhQUFiLENBQTJCSCxRQUEzQixFQUFxQyxFQUFFSSxVQUFVLElBQVosRUFBckM7O0FBRUEsTUFBTUM7QUFBQSx3RUFBVyxpQkFBT0MsUUFBUCxFQUFpQkMsTUFBakI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNmRCx5QkFBYyxrQkFBTyxFQUFQLENBQWQsU0FBNEJMLGVBQUtPLFFBQUwsQ0FBY0YsUUFBZCxDQUE1QjtBQURlO0FBQUEscUJBRVRSLGFBQWFXLFVBQWIsQ0FBd0JULFFBQXhCLEVBQWtDTSxRQUFsQyxFQUE0Q0MsTUFBNUMsQ0FGUzs7QUFBQTtBQUFBLCtDQUdSRCxRQUhROztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQVg7O0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBTjs7QUFNQSxNQUFNSSxXQUFXLFNBQVhBLFFBQVc7QUFBQSxXQUFZWixhQUFhWSxRQUFiLENBQXNCVixRQUF0QixFQUFnQ00sUUFBaEMsQ0FBWjtBQUFBLEdBQWpCOztBQUVBLFNBQU8sRUFBRUQsa0JBQUYsRUFBWUssa0JBQVosRUFBUDtBQUNELENBZEQiLCJmaWxlIjoiLi9zcmMvbWVkaWEtbWFuYWdlci9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgeyBzYWZlSWQgfSBmcm9tICcuLi91dGlsJ1xuXG5jb25zdCBkZWZhdWx0RGlyID0gJy4vbWVkaWEnXG5cbm1vZHVsZS5leHBvcnRzID0gKHsgYm90ZmlsZSwgbG9nZ2VyLCBnaG9zdE1hbmFnZXIsIHByb2plY3RMb2NhdGlvbiB9KSA9PiB7XG4gIGNvbnN0IG1lZGlhRGlyID0gcGF0aC5yZXNvbHZlKHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZS5tZWRpYURpciB8fCBkZWZhdWx0RGlyKVxuXG4gIGdob3N0TWFuYWdlci5hZGRSb290Rm9sZGVyKG1lZGlhRGlyLCB7IGlzQmluYXJ5OiB0cnVlIH0pXG5cbiAgY29uc3Qgc2F2ZUZpbGUgPSBhc3luYyAoZmlsZW5hbWUsIGJ1ZmZlcikgPT4ge1xuICAgIGZpbGVuYW1lID0gYCR7c2FmZUlkKDIwKX0tJHtwYXRoLmJhc2VuYW1lKGZpbGVuYW1lKX1gXG4gICAgYXdhaXQgZ2hvc3RNYW5hZ2VyLnVwc2VydEZpbGUobWVkaWFEaXIsIGZpbGVuYW1lLCBidWZmZXIpXG4gICAgcmV0dXJuIGZpbGVuYW1lXG4gIH1cblxuICBjb25zdCByZWFkRmlsZSA9IGZpbGVuYW1lID0+IGdob3N0TWFuYWdlci5yZWFkRmlsZShtZWRpYURpciwgZmlsZW5hbWUpXG5cbiAgcmV0dXJuIHsgc2F2ZUZpbGUsIHJlYWRGaWxlIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/media-manager/index.js\n");

/***/ }),

/***/ "./src/middlewares.js":
/*!****************************!*\
  !*** ./src/middlewares.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /**\n                                                                                                                                                                                                                                                                               * The middleware chain is in charge of pre-processing incoming and outgoing messages.\n                                                                                                                                                                                                                                                                               * A middleware can for example translate a message on receiving and before sending.\n                                                                                                                                                                                                                                                                               * Most middleware are registered by the modules. For example, the Analytics module\n                                                                                                                                                                                                                                                                               * keeps track of the messages with the help of an incoming and an outgoing middleware.\n                                                                                                                                                                                                                                                                               * @namespace Middleware\n                                                                                                                                                                                                                                                                               */\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _mware = __webpack_require__(/*! mware */ \"mware\");\n\nvar _mware2 = _interopRequireDefault(_mware);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar createMiddleware = function createMiddleware(bp, middlewareName) {\n  var _use = (0, _mware2.default)();\n  var _error = (0, _mware2.default)();\n\n  var use = function use(middleware) {\n    if (typeof middleware !== 'function') {\n      throw new TypeError('Expected all middleware arguments to be functions');\n    }\n\n    if (middleware.length === 2) {\n      _use(middleware);\n    } else if (middleware.length === 3) {\n      _error(middleware);\n    }\n  };\n\n  var dispatch = function dispatch(event) {\n    if (!_lodash2.default.isPlainObject(event)) {\n      throw new TypeError('Expected all dispatch arguments to be plain event objects');\n    }\n\n    var conformity = {\n      type: function type(value) {\n        return typeof value === 'string';\n      },\n      platform: function platform(value) {\n        return typeof value === 'string';\n      },\n      text: function text(value) {\n        return typeof value === 'string';\n      },\n      raw: function raw() {\n        return true;\n      }\n    };\n\n    if (!_lodash2.default.conformsTo(event, conformity)) {\n      throw new TypeError('Expected event to contain (type: string), ' + '(platform: string), (text: string), (raw: any)');\n    }\n\n    // Provide botpress to the event handlers\n    event.bp = bp;\n\n    _use.run(event, function (err) {\n      if (err) {\n        _error.run(err, event, function () {\n          bp.logger.error('[BOTPRESS] Unhandled error in middleware (' + middlewareName + '). Error: ' + err.message);\n        });\n      }\n    });\n\n    return event._promise || _bluebird2.default.resolve();\n  };\n\n  return { use: use, dispatch: dispatch };\n};\n\nmodule.exports = function (bp, dataLocation, projectLocation, logger) {\n  var middlewaresFilePath = _path2.default.join(dataLocation, 'middlewares.json');\n\n  var noopChain = function noopChain(arg) {\n    var message = 'Middleware called before middlewares have been loaded. This is a no-op.' + ' Have you forgotten to call `bp.loadMiddlewares()` in your bot?';\n\n    if (arg && (typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) === 'object') {\n      message += '\\nCalled with: ' + JSON.stringify(arg, null, 2);\n    }\n\n    logger.warn(message);\n  };\n\n  var readCustomizations = function readCustomizations() {\n    if (!_fs2.default.existsSync(middlewaresFilePath)) {\n      _fs2.default.writeFileSync(middlewaresFilePath, '{}');\n    }\n    return JSON.parse(_fs2.default.readFileSync(middlewaresFilePath));\n  };\n\n  var incoming = noopChain,\n      outgoing = noopChain,\n      customizations = readCustomizations();\n  var middlewares = [];\n\n  var writeCustomizations = function writeCustomizations() {\n    _fs2.default.writeFileSync(middlewaresFilePath, JSON.stringify(customizations));\n  };\n\n  var setCustomizations = function setCustomizations(middlewares) {\n    _lodash2.default.each(middlewares, function (middleware) {\n      var name = middleware.name,\n          order = middleware.order,\n          enabled = middleware.enabled;\n\n      customizations[name] = { order: order, enabled: enabled };\n    });\n    writeCustomizations();\n  };\n\n  var resetCustomizations = function resetCustomizations() {\n    customizations = {};\n    writeCustomizations();\n  };\n\n  /**\n   * @typedef {Object} Event\n   * @prop {String} platform\n   * @prop {String} text\n   * @prop {object} raw\n   * @prop {String} type\n   * @memberOf! Middleware\n   */\n\n  /**\n   * @callback Handler\n   * @memberOf! Middleware\n   * @param {Object} event The incoming or outgoing event\n   * @param {Function} next Call this function to make the event flow to the next middleware (see example)\n   */\n\n  /**\n   * @typedef {Object} Middleware\n   * @memberOf! Middleware\n   * @property {String} name Unique name of the middleware\n   * @property {Middleware.Handler} handler The handler function\n   * @property {String} type Can be 'incoming' or 'outgoing'\n   * @property {Number} order A positive number from 0 (before everything else) to 1000 (last middleware)\n   * @property {Boolean} [enabled=true] Whether this middleware is enabled or not\n   */\n\n  /**\n   * Registers a new middleware into the chain\n   * @param  {Middleware.Middleware} middleware The middleware to register\n   * @memberOf! Middleware\n   */\n  var register = function register(middleware) {\n    if (!middleware || !middleware.name) {\n      logger.error('A unique middleware name is mandatory');\n      return false;\n    }\n\n    if (!middleware.handler) {\n      logger.error('A middleware handler is mandatory');\n      return false;\n    }\n\n    if (!middleware.type || middleware.type !== 'incoming' && middleware.type !== 'outgoing') {\n      logger.error('A middleware type (incoming or outgoing) is required');\n      return false;\n    }\n\n    middleware.order = middleware.order || 0;\n    middleware.enabled = typeof middleware.enabled === 'undefined' ? true : !!middleware.enabled;\n\n    if (_lodash2.default.some(middlewares, function (m) {\n      return m.name === middleware.name;\n    })) {\n      logger.error('Another middleware with the same name has already been registered');\n      return false;\n    }\n\n    middlewares.push(middleware);\n  };\n\n  var list = function list() {\n    return _lodash2.default.orderBy(middlewares.map(function (middleware) {\n      var customization = customizations[middleware.name];\n      if (customization) {\n        return Object.assign({}, middleware, customization);\n      }\n      return middleware;\n    }), 'order');\n  };\n\n  var load = function load() {\n    incoming = createMiddleware(bp, 'incoming');\n    outgoing = createMiddleware(bp, 'outgoing');\n\n    var licenseMiddleware = bp.licensing.middleware;\n\n    incoming.use(licenseMiddleware);\n\n    _lodash2.default.each(list(), function (m) {\n      if (!m.enabled) {\n        return logger.debug('SKIPPING middleware:', m.name, ' [Reason=disabled]');\n      }\n\n      logger.debug('Loading middleware:', m.name);\n\n      if (m.type === 'incoming') {\n        incoming.use(m.handler);\n      } else {\n        outgoing.use(m.handler);\n      }\n    });\n  };\n\n  var sendToMiddleware = function sendToMiddleware(type) {\n    return function (event) {\n      var mw = type === 'incoming' ? incoming : outgoing;\n      return mw.dispatch ? mw.dispatch(event) : mw(event);\n    };\n  };\n\n  return {\n    load: load,\n    list: list,\n    register: register,\n    /**\n     * Sends an incoming event (from the user to the bot)\n     * @param  {Middleware.Event} event An event object\n     * @memberOf! Middleware\n     */\n    sendIncoming: function sendIncoming(event) {\n      return bp.messages.in.enqueue(event);\n    },\n\n    /**\n     * Sends an outgoing event (from the bot to the user)\n     * @param  {Middleware.Event} event An event object\n     * @memberOf! Middleware\n     */\n    sendOutgoing: function sendOutgoing(event) {\n      return bp.messages.out.enqueue(event);\n    },\n    sendIncomingImmediately: sendToMiddleware('incoming'),\n    sendOutgoingImmediately: sendToMiddleware('outgoing'),\n    getCustomizations: function getCustomizations() {\n      return customizations;\n    },\n    setCustomizations: setCustomizations,\n    resetCustomizations: resetCustomizations\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbWlkZGxld2FyZXMuanM/NzkwYSJdLCJuYW1lcyI6WyJjcmVhdGVNaWRkbGV3YXJlIiwiYnAiLCJtaWRkbGV3YXJlTmFtZSIsIl91c2UiLCJfZXJyb3IiLCJ1c2UiLCJtaWRkbGV3YXJlIiwiVHlwZUVycm9yIiwibGVuZ3RoIiwiZGlzcGF0Y2giLCJfIiwiaXNQbGFpbk9iamVjdCIsImV2ZW50IiwiY29uZm9ybWl0eSIsInR5cGUiLCJ2YWx1ZSIsInBsYXRmb3JtIiwidGV4dCIsInJhdyIsImNvbmZvcm1zVG8iLCJydW4iLCJlcnIiLCJsb2dnZXIiLCJlcnJvciIsIm1lc3NhZ2UiLCJfcHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwibW9kdWxlIiwiZXhwb3J0cyIsImRhdGFMb2NhdGlvbiIsInByb2plY3RMb2NhdGlvbiIsIm1pZGRsZXdhcmVzRmlsZVBhdGgiLCJwYXRoIiwiam9pbiIsIm5vb3BDaGFpbiIsImFyZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ3YXJuIiwicmVhZEN1c3RvbWl6YXRpb25zIiwiZnMiLCJleGlzdHNTeW5jIiwid3JpdGVGaWxlU3luYyIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwiaW5jb21pbmciLCJvdXRnb2luZyIsImN1c3RvbWl6YXRpb25zIiwibWlkZGxld2FyZXMiLCJ3cml0ZUN1c3RvbWl6YXRpb25zIiwic2V0Q3VzdG9taXphdGlvbnMiLCJlYWNoIiwibmFtZSIsIm9yZGVyIiwiZW5hYmxlZCIsInJlc2V0Q3VzdG9taXphdGlvbnMiLCJyZWdpc3RlciIsImhhbmRsZXIiLCJzb21lIiwibSIsInB1c2giLCJsaXN0Iiwib3JkZXJCeSIsIm1hcCIsImN1c3RvbWl6YXRpb24iLCJPYmplY3QiLCJhc3NpZ24iLCJsb2FkIiwibGljZW5zZU1pZGRsZXdhcmUiLCJsaWNlbnNpbmciLCJkZWJ1ZyIsInNlbmRUb01pZGRsZXdhcmUiLCJtdyIsInNlbmRJbmNvbWluZyIsIm1lc3NhZ2VzIiwiaW4iLCJlbnF1ZXVlIiwic2VuZE91dGdvaW5nIiwib3V0Iiwic2VuZEluY29taW5nSW1tZWRpYXRlbHkiLCJzZW5kT3V0Z29pbmdJbW1lZGlhdGVseSIsImdldEN1c3RvbWl6YXRpb25zIl0sIm1hcHBpbmdzIjoiOzs4UUFBQTs7Ozs7Ozs7QUFRQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQSxtQkFBbUIsU0FBbkJBLGdCQUFtQixDQUFDQyxFQUFELEVBQUtDLGNBQUwsRUFBd0I7QUFDL0MsTUFBTUMsT0FBTyxzQkFBYjtBQUNBLE1BQU1DLFNBQVMsc0JBQWY7O0FBRUEsTUFBTUMsTUFBTSxTQUFOQSxHQUFNLGFBQWM7QUFDeEIsUUFBSSxPQUFPQyxVQUFQLEtBQXNCLFVBQTFCLEVBQXNDO0FBQ3BDLFlBQU0sSUFBSUMsU0FBSixDQUFjLG1EQUFkLENBQU47QUFDRDs7QUFFRCxRQUFJRCxXQUFXRSxNQUFYLEtBQXNCLENBQTFCLEVBQTZCO0FBQzNCTCxXQUFLRyxVQUFMO0FBQ0QsS0FGRCxNQUVPLElBQUlBLFdBQVdFLE1BQVgsS0FBc0IsQ0FBMUIsRUFBNkI7QUFDbENKLGFBQU9FLFVBQVA7QUFDRDtBQUNGLEdBVkQ7O0FBWUEsTUFBTUcsV0FBVyxTQUFYQSxRQUFXLFFBQVM7QUFDeEIsUUFBSSxDQUFDQyxpQkFBRUMsYUFBRixDQUFnQkMsS0FBaEIsQ0FBTCxFQUE2QjtBQUMzQixZQUFNLElBQUlMLFNBQUosQ0FBYywyREFBZCxDQUFOO0FBQ0Q7O0FBRUQsUUFBTU0sYUFBYTtBQUNqQkMsWUFBTTtBQUFBLGVBQVMsT0FBT0MsS0FBUCxLQUFpQixRQUExQjtBQUFBLE9BRFc7QUFFakJDLGdCQUFVO0FBQUEsZUFBUyxPQUFPRCxLQUFQLEtBQWlCLFFBQTFCO0FBQUEsT0FGTztBQUdqQkUsWUFBTTtBQUFBLGVBQVMsT0FBT0YsS0FBUCxLQUFpQixRQUExQjtBQUFBLE9BSFc7QUFJakJHLFdBQUs7QUFBQSxlQUFNLElBQU47QUFBQTtBQUpZLEtBQW5COztBQU9BLFFB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QUFBQSxLQVRUOztBQVdMOzs7OztBQUtBa0Usa0JBQWM7QUFBQSxhQUFTN0UsR0FBRzBFLFFBQUgsQ0FBWUksR0FBWixDQUFnQkYsT0FBaEIsQ0FBd0JqRSxLQUF4QixDQUFUO0FBQUEsS0FoQlQ7QUFpQkxvRSw2QkFBeUJSLGlCQUFpQixVQUFqQixDQWpCcEI7QUFrQkxTLDZCQUF5QlQsaUJBQWlCLFVBQWpCLENBbEJwQjtBQW1CTFUsdUJBQW1CO0FBQUEsYUFBTWxDLGNBQU47QUFBQSxLQW5CZDtBQW9CTEcsd0NBcEJLO0FBcUJMSztBQXJCSyxHQUFQO0FBdUJELENBcktEIiwiZmlsZSI6Ii4vc3JjL21pZGRsZXdhcmVzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgbWlkZGxld2FyZSBjaGFpbiBpcyBpbiBjaGFyZ2Ugb2YgcHJlLXByb2Nlc3NpbmcgaW5jb21pbmcgYW5kIG91dGdvaW5nIG1lc3NhZ2VzLlxuICogQSBtaWRkbGV3YXJlIGNhbiBmb3IgZXhhbXBsZSB0cmFuc2xhdGUgYSBtZXNzYWdlIG9uIHJlY2VpdmluZyBhbmQgYmVmb3JlIHNlbmRpbmcuXG4gKiBNb3N0IG1pZGRsZXdhcmUgYXJlIHJlZ2lzdGVyZWQgYnkgdGhlIG1vZHVsZXMuIEZvciBleGFtcGxlLCB0aGUgQW5hbHl0aWNzIG1vZHVsZVxuICoga2VlcHMgdHJhY2sgb2YgdGhlIG1lc3NhZ2VzIHdpdGggdGhlIGhlbHAgb2YgYW4gaW5jb21pbmcgYW5kIGFuIG91dGdvaW5nIG1pZGRsZXdhcmUuXG4gKiBAbmFtZXNwYWNlIE1pZGRsZXdhcmVcbiAqL1xuXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgbXdhcmUgZnJvbSAnbXdhcmUnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmNvbnN0IGNyZWF0ZU1pZGRsZXdhcmUgPSAoYnAsIG1pZGRsZXdhcmVOYW1lKSA9PiB7XG4gIGNvbnN0IF91c2UgPSBtd2FyZSgpXG4gIGNvbnN0IF9lcnJvciA9IG13YXJlKClcblxuICBjb25zdCB1c2UgPSBtaWRkbGV3YXJlID0+IHtcbiAgICBpZiAodHlwZW9mIG1pZGRsZXdhcmUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIGFsbCBtaWRkbGV3YXJlIGFyZ3VtZW50cyB0byBiZSBmdW5jdGlvbnMnKVxuICAgIH1cblxuICAgIGlmIChtaWRkbGV3YXJlLmxlbmd0aCA9PT0gMikge1xuICAgICAgX3VzZShtaWRkbGV3YXJlKVxuICAgIH0gZWxzZSBpZiAobWlkZGxld2FyZS5sZW5ndGggPT09IDMpIHtcbiAgICAgIF9lcnJvcihtaWRkbGV3YXJlKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGRpc3BhdGNoID0gZXZlbnQgPT4ge1xuICAgIGlmICghXy5pc1BsYWluT2JqZWN0KGV2ZW50KSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXhwZWN0ZWQgYWxsIGRpc3BhdGNoIGFyZ3VtZW50cyB0byBiZSBwbGFpbiBldmVudCBvYmplY3RzJylcbiAgICB9XG5cbiAgICBjb25zdCBjb25mb3JtaXR5ID0ge1xuICAgICAgdHlwZTogdmFsdWUgPT4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyxcbiAgICAgIHBsYXRmb3JtOiB2YWx1ZSA9PiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnLFxuICAgICAgdGV4dDogdmFsdWUgPT4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyxcbiAgICAgIHJhdzogKCkgPT4gdHJ1ZVxuICAgIH1cblxuICAgIGlmICghXy5jb25mb3Jtc1RvKGV2ZW50LCBjb25mb3JtaXR5KSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgJ0V4cGVjdGVkIGV2ZW50IHRvIGNvbnRhaW4gKHR5cGU6IHN0cmluZyksICcgKyAnKHBsYXRmb3JtOiBzdHJpbmcpLCAodGV4dDogc3RyaW5nKSwgKHJhdzogYW55KSdcbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBQcm92aWRlIGJvdHByZXNzIHRvIHRoZSBldmVudCBoYW5kbGVyc1xuICAgIGV2ZW50LmJwID0gYnBcblxuICAgIF91c2UucnVuKGV2ZW50LCBlcnIgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBfZXJyb3IucnVuKGVyciwgZXZlbnQsICgpID0+IHtcbiAgICAgICAgICBicC5sb2dnZXIuZXJyb3IoYFtCT1RQUkVTU10gVW5oYW5kbGVkIGVycm9yIGluIG1pZGRsZXdhcmUgKCR7bWlkZGxld2FyZU5hbWV9KS4gRXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIGV2ZW50Ll9wcm9taXNlIHx8IFByb21pc2UucmVzb2x2ZSgpXG4gIH1cblxuICByZXR1cm4geyB1c2UsIGRpc3BhdGNoIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSAoYnAsIGRhdGFMb2NhdGlvbiwgcHJvamVjdExvY2F0aW9uLCBsb2dnZXIpID0+IHtcbiAgY29uc3QgbWlkZGxld2FyZXNGaWxlUGF0aCA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sICdtaWRkbGV3YXJlcy5qc29uJylcblxuICBjb25zdCBub29wQ2hhaW4gPSBhcmcgPT4ge1xuICAgIGxldCBtZXNzYWdlID1cbiAgICAgICdNaWRkbGV3YXJlIGNhbGxlZCBiZWZvcmUgbWlkZGxld2FyZXMgaGF2ZSBiZWVuIGxvYWRlZC4gVGhpcyBpcyBhIG5vLW9wLicgK1xuICAgICAgJyBIYXZlIHlvdSBmb3Jnb3R0ZW4gdG8gY2FsbCBgYnAubG9hZE1pZGRsZXdhcmVzKClgIGluIHlvdXIgYm90PydcblxuICAgIGlmIChhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcpIHtcbiAgICAgIG1lc3NhZ2UgKz0gJ1xcbkNhbGxlZCB3aXRoOiAnICsgSlNPTi5zdHJpbmdpZnkoYXJnLCBudWxsLCAyKVxuICAgIH1cblxuICAgIGxvZ2dlci53YXJuKG1lc3NhZ2UpXG4gIH1cblxuICBjb25zdCByZWFkQ3VzdG9taXphdGlvbnMgPSAoKSA9PiB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKG1pZGRsZXdhcmVzRmlsZVBhdGgpKSB7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKG1pZGRsZXdhcmVzRmlsZVBhdGgsICd7fScpXG4gICAgfVxuICAgIHJldHVybiBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhtaWRkbGV3YXJlc0ZpbGVQYXRoKSlcbiAgfVxuXG4gIGxldCBpbmNvbWluZyA9IG5vb3BDaGFpbixcbiAgICBvdXRnb2luZyA9IG5vb3BDaGFpbixcbiAgICBjdXN0b21pemF0aW9ucyA9IHJlYWRDdXN0b21pemF0aW9ucygpXG4gIGNvbnN0IG1pZGRsZXdhcmVzID0gW11cblxuICBjb25zdCB3cml0ZUN1c3RvbWl6YXRpb25zID0gKCkgPT4ge1xuICAgIGZzLndyaXRlRmlsZVN5bmMobWlkZGxld2FyZXNGaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkoY3VzdG9taXphdGlvbnMpKVxuICB9XG5cbiAgY29uc3Qgc2V0Q3VzdG9taXphdGlvbnMgPSBtaWRkbGV3YXJlcyA9PiB7XG4gICAgXy5lYWNoKG1pZGRsZXdhcmVzLCBtaWRkbGV3YXJlID0+IHtcbiAgICAgIGNvbnN0IHsgbmFtZSwgb3JkZXIsIGVuYWJsZWQgfSA9IG1pZGRsZXdhcmVcbiAgICAgIGN1c3RvbWl6YXRpb25zW25hbWVdID0geyBvcmRlciwgZW5hYmxlZCB9XG4gICAgfSlcbiAgICB3cml0ZUN1c3RvbWl6YXRpb25zKClcbiAgfVxuXG4gIGNvbnN0IHJlc2V0Q3VzdG9taXphdGlvbnMgPSAoKSA9PiB7XG4gICAgY3VzdG9taXphdGlvbnMgPSB7fVxuICAgIHdyaXRlQ3VzdG9taXphdGlvbnMoKVxuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IEV2ZW50XG4gICAqIEBwcm9wIHtTdHJpbmd9IHBsYXRmb3JtXG4gICAqIEBwcm9wIHtTdHJpbmd9IHRleHRcbiAgICogQHByb3Age29iamVjdH0gcmF3XG4gICAqIEBwcm9wIHtTdHJpbmd9IHR5cGVcbiAgICogQG1lbWJlck9mISBNaWRkbGV3YXJlXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAY2FsbGJhY2sgSGFuZGxlclxuICAgKiBAbWVtYmVyT2YhIE1pZGRsZXdhcmVcbiAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IFRoZSBpbmNvbWluZyBvciBvdXRnb2luZyBldmVudFxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBuZXh0IENhbGwgdGhpcyBmdW5jdGlvbiB0byBtYWtlIHRoZSBldmVudCBmbG93IHRvIHRoZSBuZXh0IG1pZGRsZXdhcmUgKHNlZSBleGFtcGxlKVxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge09iamVjdH0gTWlkZGxld2FyZVxuICAgKiBAbWVtYmVyT2YhIE1pZGRsZXdhcmVcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IG5hbWUgVW5pcXVlIG5hbWUgb2YgdGhlIG1pZGRsZXdhcmVcbiAgICogQHByb3BlcnR5IHtNaWRkbGV3YXJlLkhhbmRsZXJ9IGhhbmRsZXIgVGhlIGhhbmRsZXIgZnVuY3Rpb25cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHR5cGUgQ2FuIGJlICdpbmNvbWluZycgb3IgJ291dGdvaW5nJ1xuICAgKiBAcHJvcGVydHkge051bWJlcn0gb3JkZXIgQSBwb3NpdGl2ZSBudW1iZXIgZnJvbSAwIChiZWZvcmUgZXZlcnl0aGluZyBlbHNlKSB0byAxMDAwIChsYXN0IG1pZGRsZXdhcmUpXG4gICAqIEBwcm9wZXJ0eSB7Qm9vbGVhbn0gW2VuYWJsZWQ9dHJ1ZV0gV2hldGhlciB0aGlzIG1pZGRsZXdhcmUgaXMgZW5hYmxlZCBvciBub3RcbiAgICovXG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyBhIG5ldyBtaWRkbGV3YXJlIGludG8gdGhlIGNoYWluXG4gICAqIEBwYXJhbSAge01pZGRsZXdhcmUuTWlkZGxld2FyZX0gbWlkZGxld2FyZSBUaGUgbWlkZGxld2FyZSB0byByZWdpc3RlclxuICAgKiBAbWVtYmVyT2YhIE1pZGRsZXdhcmVcbiAgICovXG4gIGNvbnN0IHJlZ2lzdGVyID0gbWlkZGxld2FyZSA9PiB7XG4gICAgaWYgKCFtaWRkbGV3YXJlIHx8ICFtaWRkbGV3YXJlLm5hbWUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignQSB1bmlxdWUgbWlkZGxld2FyZSBuYW1lIGlzIG1hbmRhdG9yeScpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoIW1pZGRsZXdhcmUuaGFuZGxlcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdBIG1pZGRsZXdhcmUgaGFuZGxlciBpcyBtYW5kYXRvcnknKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKCFtaWRkbGV3YXJlLnR5cGUgfHwgKG1pZGRsZXdhcmUudHlwZSAhPT0gJ2luY29taW5nJyAmJiBtaWRkbGV3YXJlLnR5cGUgIT09ICdvdXRnb2luZycpKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0EgbWlkZGxld2FyZSB0eXBlIChpbmNvbWluZyBvciBvdXRnb2luZykgaXMgcmVxdWlyZWQnKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgbWlkZGxld2FyZS5vcmRlciA9IG1pZGRsZXdhcmUub3JkZXIgfHwgMFxuICAgIG1pZGRsZXdhcmUuZW5hYmxlZCA9IHR5cGVvZiBtaWRkbGV3YXJlLmVuYWJsZWQgPT09ICd1bmRlZmluZWQnID8gdHJ1ZSA6ICEhbWlkZGxld2FyZS5lbmFibGVkXG5cbiAgICBpZiAoXy5zb21lKG1pZGRsZXdhcmVzLCBtID0+IG0ubmFtZSA9PT0gbWlkZGxld2FyZS5uYW1lKSkge1xuICAgICAgbG9nZ2VyLmVycm9yKCdBbm90aGVyIG1pZGRsZXdhcmUgd2l0aCB0aGUgc2FtZSBuYW1lIGhhcyBhbHJlYWR5IGJlZW4gcmVnaXN0ZXJlZCcpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBtaWRkbGV3YXJlcy5wdXNoKG1pZGRsZXdhcmUpXG4gIH1cblxuICBjb25zdCBsaXN0ID0gKCkgPT4ge1xuICAgIHJldHVybiBfLm9yZGVyQnkoXG4gICAgICBtaWRkbGV3YXJlcy5tYXAobWlkZGxld2FyZSA9PiB7XG4gICAgICAgIGNvbnN0IGN1c3RvbWl6YXRpb24gPSBjdXN0b21pemF0aW9uc1ttaWRkbGV3YXJlLm5hbWVdXG4gICAgICAgIGlmIChjdXN0b21pemF0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIG1pZGRsZXdhcmUsIGN1c3RvbWl6YXRpb24pXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1pZGRsZXdhcmVcbiAgICAgIH0pLFxuICAgICAgJ29yZGVyJ1xuICAgIClcbiAgfVxuXG4gIGNvbnN0IGxvYWQgPSAoKSA9PiB7XG4gICAgaW5jb21pbmcgPSBjcmVhdGVNaWRkbGV3YXJlKGJwLCAnaW5jb21pbmcnKVxuICAgIG91dGdvaW5nID0gY3JlYXRlTWlkZGxld2FyZShicCwgJ291dGdvaW5nJylcblxuICAgIGNvbnN0IHsgbWlkZGxld2FyZTogbGljZW5zZU1pZGRsZXdhcmUgfSA9IGJwLmxpY2Vuc2luZ1xuICAgIGluY29taW5nLnVzZShsaWNlbnNlTWlkZGxld2FyZSlcblxuICAgIF8uZWFjaChsaXN0KCksIG0gPT4ge1xuICAgICAgaWYgKCFtLmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuIGxvZ2dlci5kZWJ1ZygnU0tJUFBJTkcgbWlkZGxld2FyZTonLCBtLm5hbWUsICcgW1JlYXNvbj1kaXNhYmxlZF0nKVxuICAgICAgfVxuXG4gICAgICBsb2dnZXIuZGVidWcoJ0xvYWRpbmcgbWlkZGxld2FyZTonLCBtLm5hbWUpXG5cbiAgICAgIGlmIChtLnR5cGUgPT09ICdpbmNvbWluZycpIHtcbiAgICAgICAgaW5jb21pbmcudXNlKG0uaGFuZGxlcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG91dGdvaW5nLnVzZShtLmhhbmRsZXIpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IHNlbmRUb01pZGRsZXdhcmUgPSB0eXBlID0+IGV2ZW50ID0+IHtcbiAgICBjb25zdCBtdyA9IHR5cGUgPT09ICdpbmNvbWluZycgPyBpbmNvbWluZyA6IG91dGdvaW5nXG4gICAgcmV0dXJuIG13LmRpc3BhdGNoID8gbXcuZGlzcGF0Y2goZXZlbnQpIDogbXcoZXZlbnQpXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGxvYWQsXG4gICAgbGlzdCxcbiAgICByZWdpc3RlcixcbiAgICAvKipcbiAgICAgKiBTZW5kcyBhbiBpbmNvbWluZyBldmVudCAoZnJvbSB0aGUgdXNlciB0byB0aGUgYm90KVxuICAgICAqIEBwYXJhbSAge01pZGRsZXdhcmUuRXZlbnR9IGV2ZW50IEFuIGV2ZW50IG9iamVjdFxuICAgICAqIEBtZW1iZXJPZiEgTWlkZGxld2FyZVxuICAgICAqL1xuICAgIHNlbmRJbmNvbWluZzogZXZlbnQgPT4gYnAubWVzc2FnZXMuaW4uZW5xdWV1ZShldmVudCksXG5cbiAgICAvKipcbiAgICAgKiBTZW5kcyBhbiBvdXRnb2luZyBldmVudCAoZnJvbSB0aGUgYm90IHRvIHRoZSB1c2VyKVxuICAgICAqIEBwYXJhbSAge01pZGRsZXdhcmUuRXZlbnR9IGV2ZW50IEFuIGV2ZW50IG9iamVjdFxuICAgICAqIEBtZW1iZXJPZiEgTWlkZGxld2FyZVxuICAgICAqL1xuICAgIHNlbmRPdXRnb2luZzogZXZlbnQgPT4gYnAubWVzc2FnZXMub3V0LmVucXVldWUoZXZlbnQpLFxuICAgIHNlbmRJbmNvbWluZ0ltbWVkaWF0ZWx5OiBzZW5kVG9NaWRkbGV3YXJlKCdpbmNvbWluZycpLFxuICAgIHNlbmRPdXRnb2luZ0ltbWVkaWF0ZWx5OiBzZW5kVG9NaWRkbGV3YXJlKCdvdXRnb2luZycpLFxuICAgIGdldEN1c3RvbWl6YXRpb25zOiAoKSA9PiBjdXN0b21pemF0aW9ucyxcbiAgICBzZXRDdXN0b21pemF0aW9ucyxcbiAgICByZXNldEN1c3RvbWl6YXRpb25zXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/middlewares.js\n");

/***/ }),

/***/ "./src/modules.js":
/*!************************!*\
  !*** ./src/modules.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _child_process = __webpack_require__(/*! child_process */ \"child_process\");\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _moment = __webpack_require__(/*! moment */ \"moment\");\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _axios = __webpack_require__(/*! axios */ \"axios\");\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _helpers = __webpack_require__(/*! ./helpers */ \"./src/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar MODULES_URL = 'https://s3.amazonaws.com/botpress-io/all-modules.json';\nvar FETCH_TIMEOUT = 5000;\n\nmodule.exports = function (logger, projectLocation, dataLocation, configManager) {\n  var log = function log(level) {\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (logger && logger[level]) {\n      logger[level].apply(undefined, args);\n    } else {\n      _util.print.apply(undefined, [level].concat(args));\n    }\n  };\n\n  var fetchAllModules = function fetchAllModules() {\n    return _axios2.default.get(MODULES_URL, { timeout: FETCH_TIMEOUT }).then(function (_ref) {\n      var data = _ref.data;\n      return data;\n    }).catch(function () {\n      return logger.error('Could not fetch modules');\n    });\n  };\n\n  var loadModules = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(moduleDefinitions, botpress) {\n      var loadedCount, loadedModules;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              loadedCount = 0;\n              loadedModules = {};\n              _context2.next = 4;\n              return _bluebird2.default.mapSeries(moduleDefinitions, function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(mod) {\n                  var loader, configuration;\n                  return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          loader = null;\n                          _context.prev = 1;\n\n                          // eslint-disable-next-line no-eval\n                          loader = eval('require')(mod.entry);\n                          _context.next = 8;\n                          break;\n\n                        case 5:\n                          _context.prev = 5;\n                          _context.t0 = _context['catch'](1);\n                          return _context.abrupt('return', logger.error('Error loading module \"' + mod.name + '\": ' + _context.t0.message));\n\n                        case 8:\n                          if (!((typeof loader === 'undefined' ? 'undefined' : _typeof(loader)) !== 'object')) {\n                            _context.next = 10;\n                            break;\n                          }\n\n                          return _context.abrupt('return', logger.warn('Ignoring module ' + mod.name + '. Invalid entry point signature.'));\n\n                        case 10:\n\n                          mod.handlers = loader;\n\n                          _context.prev = 11;\n                          configuration = configManager.getModuleConfiguration({\n                            name: mod.name,\n                            options: loader.config,\n                            path: mod.root\n                          });\n                          _context.next = 15;\n                          return configuration.isConfigMissing();\n\n                        case 15:\n                          if (!_context.sent) {\n                            _context.next = 18;\n                            break;\n                          }\n\n                          _context.next = 18;\n                          return configuration.bootstrap();\n\n                        case 18:\n\n                          mod.configuration = configuration;\n                          _context.next = 24;\n                          break;\n\n                        case 21:\n                          _context.prev = 21;\n                          _context.t1 = _context['catch'](11);\n\n                          logger.error('Invalid module configuration in module ' + mod.name + ':', _context.t1);\n\n                        case 24:\n                          _context.prev = 24;\n                          _context.t2 = loader.init;\n\n                          if (!_context.t2) {\n                            _context.next = 29;\n                            break;\n                          }\n\n                          _context.next = 29;\n                          return loader.init(botpress, mod.configuration, _helpers2.default);\n\n                        case 29:\n                          _context.next = 34;\n                          break;\n\n                        case 31:\n                          _context.prev = 31;\n                          _context.t3 = _context['catch'](24);\n\n                          logger.warn('Error during module initialization: ', _context.t3);\n\n                        case 34:\n\n                          loadedModules[mod.name] = mod;\n                          logger.info('Loaded ' + mod.name + ', version ' + mod.version);\n                          loadedCount++;\n\n                        case 37:\n                        case 'end':\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee, undefined, [[1, 5], [11, 21], [24, 31]]);\n                }));\n\n                return function (_x3) {\n                  return _ref3.apply(this, arguments);\n                };\n              }());\n\n            case 4:\n\n              if (loadedCount > 0) {\n                logger.info('Loaded ' + loadedCount + ' modules');\n              }\n\n              return _context2.abrupt('return', loadedModules);\n\n            case 6:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function loadModules(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var scanModules = function scanModules() {\n    var packagePath = _path2.default.join(projectLocation, 'package.json');\n\n    if (!_fs2.default.existsSync(packagePath)) {\n      return logger.warn('No package.json found at project root, ' + \"which means botpress can't load any module for the bot.\");\n    }\n\n    // eslint-disable-next-line no-eval\n    var botPackage = eval('require')(packagePath);\n\n    var deps = botPackage.dependencies || {};\n    if (_util.isDeveloping) {\n      deps = _lodash2.default.merge(deps, botPackage.devDependencies || {});\n    }\n\n    return _lodash2.default.reduce(deps, function (result, value, key) {\n      if (!_util2.default.isBotpressPackage(key)) {\n        return result;\n      }\n      var entry = (0, _util.resolveFromDir)(projectLocation, key);\n      if (!entry) {\n        return result;\n      }\n      var root = (0, _util.resolveModuleRootPath)(entry);\n      if (!root) {\n        return result;\n      }\n\n      // eslint-disable-next-line no-eval\n      var modulePackage = eval('require')(_path2.default.join(root, 'package.json'));\n      if (!modulePackage.botpress) {\n        return result;\n      }\n\n      return result.push({\n        name: key,\n        root: root,\n        homepage: modulePackage.homepage,\n        settings: modulePackage.botpress,\n        version: modulePackage.version,\n        entry: entry\n      }) && result;\n    }, []);\n  };\n\n  var listInstalledModules = function listInstalledModules() {\n    var packagePath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var _JSON$parse = JSON.parse(_fs2.default.readFileSync(packagePath)),\n        dependencies = _JSON$parse.dependencies;\n\n    var prodDeps = _lodash2.default.keys(dependencies);\n\n    return _lodash2.default.filter(prodDeps, _util2.default.isBotpressPackage);\n  };\n\n  var mapModuleList = function mapModuleList(modules) {\n    var installed = listInstalledModules();\n    return modules.map(function (mod) {\n      return {\n        name: mod.name,\n        stars: mod.github.stargazers_count,\n        forks: mod.github.forks_count,\n        docLink: mod.homepage,\n        version: mod['dist-tags'].latest,\n        keywords: mod.keywords,\n        fullName: mod.github.full_name,\n        updated: mod.github.updated_at,\n        issues: mod.github.open_issues_count,\n        icon: mod.package.botpress.menuIcon,\n        description: mod.description,\n        installed: _lodash2.default.includes(installed, mod.name),\n        license: mod.license,\n        author: !mod.author.name ? mod.author : mod.author.name,\n        title: mod.title,\n        category: mod.category,\n        featured: mod.featured,\n        popular: mod.popular,\n        official: mod.official\n      };\n    });\n  };\n\n  var listAllCommunityModules = _bluebird2.default.method(function () {\n    if (!_fs2.default) {\n      return []; // TODO Fetch & return\n    }\n\n    var modulesCachePath = _path2.default.join(dataLocation, './modules-cache.json');\n    if (!_fs2.default.existsSync(modulesCachePath)) {\n      _fs2.default.writeFileSync(modulesCachePath, JSON.stringify({\n        modules: [],\n        updated: null\n      }));\n    }\n\n    var _JSON$parse2 = JSON.parse(_fs2.default.readFileSync(modulesCachePath)),\n        modules = _JSON$parse2.modules,\n        updated = _JSON$parse2.updated;\n\n    if (updated && (0, _moment2.default)().diff((0, _moment2.default)(updated), 'minutes') <= 30) {\n      return mapModuleList(modules);\n    }\n\n    return _bluebird2.default.props({\n      newModules: fetchAllModules()\n    }).then(function (_ref4) {\n      var newModules = _ref4.newModules;\n\n      if (!newModules || !newModules.length) {\n        if (modules.length > 0) {\n          logger.debug('Fetched invalid modules. Report this to the Botpress Team.');\n          return mapModuleList(modules);\n        } else {\n          newModules = newModules || [];\n        }\n      }\n\n      _fs2.default.writeFileSync(modulesCachePath, JSON.stringify({\n        modules: newModules,\n        updated: new Date()\n      }));\n\n      return mapModuleList(newModules);\n    });\n  });\n\n  var getRandomCommunityHero = _bluebird2.default.method(function () {\n    var modulesCachePath = _path2.default.join(dataLocation, './modules-cache.json');\n\n    return listAllCommunityModules().then(function () {\n      var _JSON$parse3 = JSON.parse(_fs2.default.readFileSync(modulesCachePath)),\n          modules = _JSON$parse3.modules;\n\n      var module = _lodash2.default.sample(modules);\n\n      if (!module) {\n        return {\n          username: 'danyfs',\n          github: 'https://github.com/danyfs',\n          avatar: 'https://avatars1.githubusercontent.com/u/5629987?v=3',\n          contributions: 'many',\n          module: 'botpress'\n        };\n      }\n\n      var hero = _lodash2.default.sample(module.contributors);\n\n      return {\n        username: hero.login,\n        github: hero.html_url,\n        avatar: hero.avatar_url,\n        contributions: hero.contributions,\n        module: module.name\n      };\n    });\n  });\n\n  return {\n    listAllCommunityModules: listAllCommunityModules,\n    getRandomCommunityHero: getRandomCommunityHero,\n    listInstalled: listInstalledModules,\n    _scan: scanModules,\n    _load: loadModules\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kdWxlcy5qcz9hYmJkIl0sIm5hbWVzIjpbIk1PRFVMRVNfVVJMIiwiRkVUQ0hfVElNRU9VVCIsIm1vZHVsZSIsImV4cG9ydHMiLCJsb2dnZXIiLCJwcm9qZWN0TG9jYXRpb24iLCJkYXRhTG9jYXRpb24iLCJjb25maWdNYW5hZ2VyIiwibG9nIiwibGV2ZWwiLCJhcmdzIiwiYXBwbHkiLCJwcmludCIsImZldGNoQWxsTW9kdWxlcyIsImF4aW9zIiwiZ2V0IiwidGltZW91dCIsInRoZW4iLCJkYXRhIiwiY2F0Y2giLCJlcnJvciIsImxvYWRNb2R1bGVzIiwibW9kdWxlRGVmaW5pdGlvbnMiLCJib3RwcmVzcyIsImxvYWRlZENvdW50IiwibG9hZGVkTW9kdWxlcyIsIlByb21pc2UiLCJtYXBTZXJpZXMiLCJtb2QiLCJsb2FkZXIiLCJldmFsIiwiZW50cnkiLCJuYW1lIiwibWVzc2FnZSIsIndhcm4iLCJoYW5kbGVycyIsImNvbmZpZ3VyYXRpb24iLCJnZXRNb2R1bGVDb25maWd1cmF0aW9uIiwib3B0aW9ucyIsImNvbmZpZyIsInBhdGgiLCJyb290IiwiaXNDb25maWdNaXNzaW5nIiwiYm9vdHN0cmFwIiwiaW5pdCIsImhlbHBlcnMiLCJpbmZvIiwidmVyc2lvbiIsInNjYW5Nb2R1bGVzIiwicGFja2FnZVBhdGgiLCJqb2luIiwiZnMiLCJleGlzdHNTeW5jIiwiYm90UGFja2FnZSIsImRlcHMiLCJkZXBlbmRlbmNpZXMiLCJpc0RldmVsb3BpbmciLCJfIiwibWVyZ2UiLCJkZXZEZXBlbmRlbmNpZXMiLCJyZWR1Y2UiLCJyZXN1bHQiLCJ2YWx1ZSIsImtleSIsInV0aWwiLCJpc0JvdHByZXNzUGFja2FnZSIsIm1vZHVsZVBhY2thZ2UiLCJwdXNoIiwiaG9tZXBhZ2UiLCJzZXR0aW5ncyIsImxpc3RJbnN0YWxsZWRNb2R1bGVzIiwiSlNPTiIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwicHJvZERlcHMiLCJrZXlzIiwiZmlsdGVyIiwibWFwTW9kdWxlTGlzdCIsImluc3RhbGxlZCIsIm1vZHVsZXMiLCJtYXAiLCJzdGFycyIsImdpdGh1YiIsInN0YXJnYXplcnNfY291bnQiLCJmb3JrcyIsImZvcmtzX2NvdW50IiwiZG9jTGluayIsImxhdGVzdCIsImtleXdvcmRzIiwiZnVsbE5hbWUiLCJmdWxsX25hbWUiLCJ1cGRhdGVkIiwidXBkYXRlZF9hdCIsImlzc3VlcyIsIm9wZW5faXNzdWVzX2NvdW50IiwiaWNvbiIsInBhY2thZ2UiLCJtZW51SWNvbiIsImRlc2NyaXB0aW9uIiwiaW5jbHVkZXMiLCJsaWNlbnNlIiwiYXV0aG9yIiwidGl0bGUiLCJjYXRlZ29yeSIsImZlYXR1cmVkIiwicG9wdWxhciIsIm9mZmljaWFsIiwibGlzdEFsbENvbW11bml0eU1vZHVsZXMiLCJtZXRob2QiLCJtb2R1bGVzQ2FjaGVQYXRoIiwid3JpdGVGaWxlU3luYyIsInN0cmluZ2lmeSIsImRpZmYiLCJwcm9wcyIsIm5ld01vZHVsZXMiLCJsZW5ndGgiLCJkZWJ1ZyIsIkRhdGUiLCJnZXRSYW5kb21Db21tdW5pdHlIZXJvIiwic2FtcGxlIiwidXNlcm5hbWUiLCJhdmF0YXIiLCJjb250cmlidXRpb25zIiwiaGVybyIsImNvbnRyaWJ1dG9ycyIsImxvZ2luIiwiaHRtbF91cmwiLCJhdmF0YXJfdXJsIiwibGlzdEluc3RhbGxlZCIsIl9zY2FuIiwiX2xvYWQiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztBQUlBLElBQU1BLGNBQWMsdURBQXBCO0FBQ0EsSUFBTUMsZ0JBQWdCLElBQXRCOztBQUVBQyxPQUFPQyxPQUFQLEdBQWlCLFVBQUNDLE1BQUQsRUFBU0MsZUFBVCxFQUEwQkMsWUFBMUIsRUFBd0NDLGFBQXhDLEVBQTBEO0FBQ3pFLE1BQU1DLE1BQU0sU0FBTkEsR0FBTSxDQUFDQyxLQUFELEVBQW9CO0FBQUEsc0NBQVRDLElBQVM7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QUErQixZQUFNO0FBQUEseUJBQ3RCc0QsS0FBS0MsS0FBTCxDQUFXckIsYUFBR3NCLFlBQUgsQ0FBZ0JvQyxnQkFBaEIsQ0FBWCxDQURzQjtBQUFBLFVBQ2xDOUIsT0FEa0MsZ0JBQ2xDQSxPQURrQzs7QUFHMUMsVUFBTTdFLFNBQVN1RCxpQkFBRThELE1BQUYsQ0FBU3hDLE9BQVQsQ0FBZjs7QUFFQSxVQUFJLENBQUM3RSxNQUFMLEVBQWE7QUFDWCxlQUFPO0FBQ0xzSCxvQkFBVSxRQURMO0FBRUx0QyxrQkFBUSwyQkFGSDtBQUdMdUMsa0JBQVEsc0RBSEg7QUFJTEMseUJBQWUsTUFKVjtBQUtMeEgsa0JBQVE7QUFMSCxTQUFQO0FBT0Q7O0FBRUQsVUFBTXlILE9BQU9sRSxpQkFBRThELE1BQUYsQ0FBU3JILE9BQU8wSCxZQUFoQixDQUFiOztBQUVBLGFBQU87QUFDTEosa0JBQVVHLEtBQUtFLEtBRFY7QUFFTDNDLGdCQUFReUMsS0FBS0csUUFGUjtBQUdMTCxnQkFBUUUsS0FBS0ksVUFIUjtBQUlMTCx1QkFBZUMsS0FBS0QsYUFKZjtBQUtMeEgsZ0JBQVFBLE9BQU84QjtBQUxWLE9BQVA7QUFPRCxLQXhCTSxDQUFQO0FBeUJELEdBNUI4QixDQUEvQjs7QUE4QkEsU0FBTztBQUNMMkUsb0RBREs7QUFFTFcsa0RBRks7QUFHTFUsbUJBQWUxRCxvQkFIVjtBQUlMMkQsV0FBT2pGLFdBSkY7QUFLTGtGLFdBQU83RztBQUxGLEdBQVA7QUFPRCxDQTlPRCIsImZpbGUiOiIuL3NyYy9tb2R1bGVzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXG5pbXBvcnQgaGVscGVycyBmcm9tICcuL2hlbHBlcnMnXG5pbXBvcnQgdXRpbCBmcm9tICcuL3V0aWwnXG5cbmltcG9ydCB7IHByaW50LCBpc0RldmVsb3BpbmcsIG5wbUNtZCwgcmVzb2x2ZU1vZHVsZVJvb3RQYXRoLCByZXNvbHZlRnJvbURpciwgcmVzb2x2ZVByb2plY3RGaWxlIH0gZnJvbSAnLi91dGlsJ1xuXG5jb25zdCBNT0RVTEVTX1VSTCA9ICdodHRwczovL3MzLmFtYXpvbmF3cy5jb20vYm90cHJlc3MtaW8vYWxsLW1vZHVsZXMuanNvbidcbmNvbnN0IEZFVENIX1RJTUVPVVQgPSA1MDAwXG5cbm1vZHVsZS5leHBvcnRzID0gKGxvZ2dlciwgcHJvamVjdExvY2F0aW9uLCBkYXRhTG9jYXRpb24sIGNvbmZpZ01hbmFnZXIpID0+IHtcbiAgY29uc3QgbG9nID0gKGxldmVsLCAuLi5hcmdzKSA9PiB7XG4gICAgaWYgKGxvZ2dlciAmJiBsb2dnZXJbbGV2ZWxdKSB7XG4gICAgICBsb2dnZXJbbGV2ZWxdLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW50LmFwcGx5KHRoaXMsIFtsZXZlbCwgLi4uYXJnc10pXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZmV0Y2hBbGxNb2R1bGVzID0gKCkgPT4ge1xuICAgIHJldHVybiBheGlvc1xuICAgICAgLmdldChNT0RVTEVTX1VSTCwgeyB0aW1lb3V0OiBGRVRDSF9USU1FT1VUIH0pXG4gICAgICAudGhlbigoeyBkYXRhIH0pID0+IGRhdGEpXG4gICAgICAuY2F0Y2goKCkgPT4gbG9nZ2VyLmVycm9yKCdDb3VsZCBub3QgZmV0Y2ggbW9kdWxlcycpKVxuICB9XG5cbiAgY29uc3QgbG9hZE1vZHVsZXMgPSBhc3luYyAobW9kdWxlRGVmaW5pdGlvbnMsIGJvdHByZXNzKSA9PiB7XG4gICAgbGV0IGxvYWRlZENvdW50ID0gMFxuICAgIGNvbnN0IGxvYWRlZE1vZHVsZXMgPSB7fVxuXG4gICAgYXdhaXQgUHJvbWlzZS5tYXBTZXJpZXMobW9kdWxlRGVmaW5pdGlvbnMsIGFzeW5jIG1vZCA9PiB7XG4gICAgICBsZXQgbG9hZGVyID0gbnVsbFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICAgICAgbG9hZGVyID0gZXZhbCgncmVxdWlyZScpKG1vZC5lbnRyeSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gbG9nZ2VyLmVycm9yKGBFcnJvciBsb2FkaW5nIG1vZHVsZSBcIiR7bW9kLm5hbWV9XCI6IGAgKyBlcnIubWVzc2FnZSlcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBsb2FkZXIgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBsb2dnZXIud2FybihgSWdub3JpbmcgbW9kdWxlICR7bW9kLm5hbWV9LiBJbnZhbGlkIGVudHJ5IHBvaW50IHNpZ25hdHVyZS5gKVxuICAgICAgfVxuXG4gICAgICBtb2QuaGFuZGxlcnMgPSBsb2FkZXJcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29uZmlndXJhdGlvbiA9IGNvbmZpZ01hbmFnZXIuZ2V0TW9kdWxlQ29uZmlndXJhdGlvbih7XG4gICAgICAgICAgbmFtZTogbW9kLm5hbWUsXG4gICAgICAgICAgb3B0aW9uczogbG9hZGVyLmNvbmZpZyxcbiAgICAgICAgICBwYXRoOiBtb2Qucm9vdFxuICAgICAgICB9KVxuXG4gICAgICAgIGlmIChhd2FpdCBjb25maWd1cmF0aW9uLmlzQ29uZmlnTWlzc2luZygpKSB7XG4gICAgICAgICAgYXdhaXQgY29uZmlndXJhdGlvbi5ib290c3RyYXAoKVxuICAgICAgICB9XG5cbiAgICAgICAgbW9kLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uXG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKGBJbnZhbGlkIG1vZHVsZSBjb25maWd1cmF0aW9uIGluIG1vZHVsZSAke21vZC5uYW1lfTpgLCBlcnIpXG4gICAgICB9XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGxvYWRlci5pbml0ICYmIChhd2FpdCBsb2FkZXIuaW5pdChib3RwcmVzcywgbW9kLmNvbmZpZ3VyYXRpb24sIGhlbHBlcnMpKVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGxvZ2dlci53YXJuKCdFcnJvciBkdXJpbmcgbW9kdWxlIGluaXRpYWxpemF0aW9uOiAnLCBlcnIpXG4gICAgICB9XG5cbiAgICAgIGxvYWRlZE1vZHVsZXNbbW9kLm5hbWVdID0gbW9kXG4gICAgICBsb2dnZXIuaW5mbyhgTG9hZGVkICR7bW9kLm5hbWV9LCB2ZXJzaW9uICR7bW9kLnZlcnNpb259YClcbiAgICAgIGxvYWRlZENvdW50KytcbiAgICB9KVxuXG4gICAgaWYgKGxvYWRlZENvdW50ID4gMCkge1xuICAgICAgbG9nZ2VyLmluZm8oYExvYWRlZCAke2xvYWRlZENvdW50fSBtb2R1bGVzYClcbiAgICB9XG5cbiAgICByZXR1cm4gbG9hZGVkTW9kdWxlc1xuICB9XG5cbiAgY29uc3Qgc2Nhbk1vZHVsZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgcGFja2FnZVBhdGggPSBwYXRoLmpvaW4ocHJvamVjdExvY2F0aW9uLCAncGFja2FnZS5qc29uJylcblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhwYWNrYWdlUGF0aCkpIHtcbiAgICAgIHJldHVybiBsb2dnZXIud2FybihcbiAgICAgICAgJ05vIHBhY2thZ2UuanNvbiBmb3VuZCBhdCBwcm9qZWN0IHJvb3QsICcgKyBcIndoaWNoIG1lYW5zIGJvdHByZXNzIGNhbid0IGxvYWQgYW55IG1vZHVsZSBmb3IgdGhlIGJvdC5cIlxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1ldmFsXG4gICAgY29uc3QgYm90UGFja2FnZSA9IGV2YWwoJ3JlcXVpcmUnKShwYWNrYWdlUGF0aClcblxuICAgIGxldCBkZXBzID0gYm90UGFja2FnZS5kZXBlbmRlbmNpZXMgfHwge31cbiAgICBpZiAoaXNEZXZlbG9waW5nKSB7XG4gICAgICBkZXBzID0gXy5tZXJnZShkZXBzLCBib3RQYWNrYWdlLmRldkRlcGVuZGVuY2llcyB8fCB7fSlcbiAgICB9XG5cbiAgICByZXR1cm4gXy5yZWR1Y2UoXG4gICAgICBkZXBzLFxuICAgICAgKHJlc3VsdCwgdmFsdWUsIGtleSkgPT4ge1xuICAgICAgICBpZiAoIXV0aWwuaXNCb3RwcmVzc1BhY2thZ2Uoa2V5KSkge1xuICAgICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnRyeSA9IHJlc29sdmVGcm9tRGlyKHByb2plY3RMb2NhdGlvbiwga2V5KVxuICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJvb3QgPSByZXNvbHZlTW9kdWxlUm9vdFBhdGgoZW50cnkpXG4gICAgICAgIGlmICghcm9vdCkge1xuICAgICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1ldmFsXG4gICAgICAgIGNvbnN0IG1vZHVsZVBhY2thZ2UgPSBldmFsKCdyZXF1aXJlJykocGF0aC5qb2luKHJvb3QsICdwYWNrYWdlLmpzb24nKSlcbiAgICAgICAgaWYgKCFtb2R1bGVQYWNrYWdlLmJvdHByZXNzKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICBuYW1lOiBrZXksXG4gICAgICAgICAgICByb290OiByb290LFxuICAgICAgICAgICAgaG9tZXBhZ2U6IG1vZHVsZVBhY2thZ2UuaG9tZXBhZ2UsXG4gICAgICAgICAgICBzZXR0aW5nczogbW9kdWxlUGFja2FnZS5ib3RwcmVzcyxcbiAgICAgICAgICAgIHZlcnNpb246IG1vZHVsZVBhY2thZ2UudmVyc2lvbixcbiAgICAgICAgICAgIGVudHJ5OiBlbnRyeVxuICAgICAgICAgIH0pICYmIHJlc3VsdFxuICAgICAgICApXG4gICAgICB9LFxuICAgICAgW11cbiAgICApXG4gIH1cblxuICBjb25zdCBsaXN0SW5zdGFsbGVkTW9kdWxlcyA9ICgpID0+IHtcbiAgICBjb25zdCBwYWNrYWdlUGF0aCA9IHJlc29sdmVQcm9qZWN0RmlsZSgncGFja2FnZS5qc29uJywgcHJvamVjdExvY2F0aW9uLCB0cnVlKVxuICAgIGNvbnN0IHsgZGVwZW5kZW5jaWVzIH0gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYWNrYWdlUGF0aCkpXG4gICAgY29uc3QgcHJvZERlcHMgPSBfLmtleXMoZGVwZW5kZW5jaWVzKVxuXG4gICAgcmV0dXJuIF8uZmlsdGVyKHByb2REZXBzLCB1dGlsLmlzQm90cHJlc3NQYWNrYWdlKVxuICB9XG5cbiAgY29uc3QgbWFwTW9kdWxlTGlzdCA9IG1vZHVsZXMgPT4ge1xuICAgIGNvbnN0IGluc3RhbGxlZCA9IGxpc3RJbnN0YWxsZWRNb2R1bGVzKClcbiAgICByZXR1cm4gbW9kdWxlcy5tYXAobW9kID0+ICh7XG4gICAgICBuYW1lOiBtb2QubmFtZSxcbiAgICAgIHN0YXJzOiBtb2QuZ2l0aHViLnN0YXJnYXplcnNfY291bnQsXG4gICAgICBmb3JrczogbW9kLmdpdGh1Yi5mb3Jrc19jb3VudCxcbiAgICAgIGRvY0xpbms6IG1vZC5ob21lcGFnZSxcbiAgICAgIHZlcnNpb246IG1vZFsnZGlzdC10YWdzJ10ubGF0ZXN0LFxuICAgICAga2V5d29yZHM6IG1vZC5rZXl3b3JkcyxcbiAgICAgIGZ1bGxOYW1lOiBtb2QuZ2l0aHViLmZ1bGxfbmFtZSxcbiAgICAgIHVwZGF0ZWQ6IG1vZC5naXRodWIudXBkYXRlZF9hdCxcbiAgICAgIGlzc3VlczogbW9kLmdpdGh1Yi5vcGVuX2lzc3Vlc19jb3VudCxcbiAgICAgIGljb246IG1vZC5wYWNrYWdlLmJvdHByZXNzLm1lbnVJY29uLFxuICAgICAgZGVzY3JpcHRpb246IG1vZC5kZXNjcmlwdGlvbixcbiAgICAgIGluc3RhbGxlZDogXy5pbmNsdWRlcyhpbnN0YWxsZWQsIG1vZC5uYW1lKSxcbiAgICAgIGxpY2Vuc2U6IG1vZC5saWNlbnNlLFxuICAgICAgYXV0aG9yOiAhbW9kLmF1dGhvci5uYW1lID8gbW9kLmF1dGhvciA6IG1vZC5hdXRob3IubmFtZSxcbiAgICAgIHRpdGxlOiBtb2QudGl0bGUsXG4gICAgICBjYXRlZ29yeTogbW9kLmNhdGVnb3J5LFxuICAgICAgZmVhdHVyZWQ6IG1vZC5mZWF0dXJlZCxcbiAgICAgIHBvcHVsYXI6IG1vZC5wb3B1bGFyLFxuICAgICAgb2ZmaWNpYWw6IG1vZC5vZmZpY2lhbFxuICAgIH0pKVxuICB9XG5cbiAgY29uc3QgbGlzdEFsbENvbW11bml0eU1vZHVsZXMgPSBQcm9taXNlLm1ldGhvZCgoKSA9PiB7XG4gICAgaWYgKCFmcykge1xuICAgICAgcmV0dXJuIFtdIC8vIFRPRE8gRmV0Y2ggJiByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBtb2R1bGVzQ2FjaGVQYXRoID0gcGF0aC5qb2luKGRhdGFMb2NhdGlvbiwgJy4vbW9kdWxlcy1jYWNoZS5qc29uJylcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMobW9kdWxlc0NhY2hlUGF0aCkpIHtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoXG4gICAgICAgIG1vZHVsZXNDYWNoZVBhdGgsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2R1bGVzOiBbXSxcbiAgICAgICAgICB1cGRhdGVkOiBudWxsXG4gICAgICAgIH0pXG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3QgeyBtb2R1bGVzLCB1cGRhdGVkIH0gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhtb2R1bGVzQ2FjaGVQYXRoKSlcblxuICAgIGlmICh1cGRhdGVkICYmIG1vbWVudCgpLmRpZmYobW9tZW50KHVwZGF0ZWQpLCAnbWludXRlcycpIDw9IDMwKSB7XG4gICAgICByZXR1cm4gbWFwTW9kdWxlTGlzdChtb2R1bGVzKVxuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnByb3BzKHtcbiAgICAgIG5ld01vZHVsZXM6IGZldGNoQWxsTW9kdWxlcygpXG4gICAgfSkudGhlbigoeyBuZXdNb2R1bGVzIH0pID0+IHtcbiAgICAgIGlmICghbmV3TW9kdWxlcyB8fCAhbmV3TW9kdWxlcy5sZW5ndGgpIHtcbiAgICAgICAgaWYgKG1vZHVsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmV0Y2hlZCBpbnZhbGlkIG1vZHVsZXMuIFJlcG9ydCB0aGlzIHRvIHRoZSBCb3RwcmVzcyBUZWFtLicpXG4gICAgICAgICAgcmV0dXJuIG1hcE1vZHVsZUxpc3QobW9kdWxlcylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdNb2R1bGVzID0gbmV3TW9kdWxlcyB8fCBbXVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoXG4gICAgICAgIG1vZHVsZXNDYWNoZVBhdGgsXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2R1bGVzOiBuZXdNb2R1bGVzLFxuICAgICAgICAgIHVwZGF0ZWQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSlcbiAgICAgIClcblxuICAgICAgcmV0dXJuIG1hcE1vZHVsZUxpc3QobmV3TW9kdWxlcylcbiAgICB9KVxuICB9KVxuXG4gIGNvbnN0IGdldFJhbmRvbUNvbW11bml0eUhlcm8gPSBQcm9taXNlLm1ldGhvZCgoKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlc0NhY2hlUGF0aCA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sICcuL21vZHVsZXMtY2FjaGUuanNvbicpXG5cbiAgICByZXR1cm4gbGlzdEFsbENvbW11bml0eU1vZHVsZXMoKS50aGVuKCgpID0+IHtcbiAgICAgIGNvbnN0IHsgbW9kdWxlcyB9ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMobW9kdWxlc0NhY2hlUGF0aCkpXG5cbiAgICAgIGNvbnN0IG1vZHVsZSA9IF8uc2FtcGxlKG1vZHVsZXMpXG5cbiAgICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcm5hbWU6ICdkYW55ZnMnLFxuICAgICAgICAgIGdpdGh1YjogJ2h0dHBzOi8vZ2l0aHViLmNvbS9kYW55ZnMnLFxuICAgICAgICAgIGF2YXRhcjogJ2h0dHBzOi8vYXZhdGFyczEuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvNTYyOTk4Nz92PTMnLFxuICAgICAgICAgIGNvbnRyaWJ1dGlvbnM6ICdtYW55JyxcbiAgICAgICAgICBtb2R1bGU6ICdib3RwcmVzcydcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBoZXJvID0gXy5zYW1wbGUobW9kdWxlLmNvbnRyaWJ1dG9ycylcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcm5hbWU6IGhlcm8ubG9naW4sXG4gICAgICAgIGdpdGh1YjogaGVyby5odG1sX3VybCxcbiAgICAgICAgYXZhdGFyOiBoZXJvLmF2YXRhcl91cmwsXG4gICAgICAgIGNvbnRyaWJ1dGlvbnM6IGhlcm8uY29udHJpYnV0aW9ucyxcbiAgICAgICAgbW9kdWxlOiBtb2R1bGUubmFtZVxuICAgICAgfVxuICAgIH0pXG4gIH0pXG5cbiAgcmV0dXJuIHtcbiAgICBsaXN0QWxsQ29tbXVuaXR5TW9kdWxlcyxcbiAgICBnZXRSYW5kb21Db21tdW5pdHlIZXJvLFxuICAgIGxpc3RJbnN0YWxsZWQ6IGxpc3RJbnN0YWxsZWRNb2R1bGVzLFxuICAgIF9zY2FuOiBzY2FuTW9kdWxlcyxcbiAgICBfbG9hZDogbG9hZE1vZHVsZXNcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/modules.js\n");

/***/ }),

/***/ "./src/notifications.js":
/*!******************************!*\
  !*** ./src/notifications.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _nanoid = __webpack_require__(/*! nanoid */ \"nanoid\");\n\nvar _nanoid2 = _interopRequireDefault(_nanoid);\n\nvar _helpers = __webpack_require__(/*! ./database/helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _util = __webpack_require__(/*! ./util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar getOriginatingModule = function getOriginatingModule() {\n  var origPrepareStackTrace = Error.prepareStackTrace;\n  Error.prepareStackTrace = function (_, stack) {\n    return stack;\n  };\n\n  var err = new Error();\n  var stack = err.stack;\n  Error.prepareStackTrace = origPrepareStackTrace;\n  stack.shift();\n\n  return stack[1].getFileName();\n};\n\nvar notifications = function notifications(_ref) {\n  var knex = _ref.knex,\n      modules = _ref.modules,\n      logger = _ref.logger,\n      events = _ref.events;\n\n  var toDatabase = function toDatabase(knex, notification) {\n    return {\n      id: notification.id,\n      message: notification.message,\n      level: notification.level,\n      module_id: notification.moduleId,\n      module_icon: notification.icon,\n      module_name: notification.name,\n      redirect_url: notification.url,\n      created_on: (0, _helpers2.default)(knex).date.now(),\n      read: (0, _helpers2.default)(knex).bool.false(),\n      archived: (0, _helpers2.default)(knex).bool.false()\n    };\n  };\n\n  var fromDatabase = function fromDatabase(knex, row) {\n    return {\n      id: row.id,\n      message: row.message,\n      level: row.level,\n      moduleId: row.module_id,\n      icon: row.module_icon,\n      name: row.module_name,\n      url: row.redirect_url,\n      date: new Date(row.created_on),\n      sound: false,\n      read: (0, _helpers2.default)(knex).bool.parse(row.read)\n    };\n  };\n\n  // TODO: a bunch of functions below doesn't use `await`, should they actually be `async`?\n\n  /**\n   * Marks a single notification as read (but doesn't archive it)\n   * @param  {string} notificationId The id of the notification to mark as read\n   * @return {Promise}\n   */\n  var markAsRead = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(notificationId) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt('return', knex('notifications').where({ id: notificationId }).update({ read: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function markAsRead(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Marks all notifications as read (but doesn't archive them)\n   * @return {Promise}\n   */\n  var markAllAsRead = function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt('return', knex('notifications').update({ read: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function markAllAsRead() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Get the top 100 (unseen) notifications\n   * @return {Promise<Array<Notification>>} The list of all unseen notifications\n   */\n  var getInbox = function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              return _context3.abrupt('return', knex('notifications').where({ archived: (0, _helpers2.default)(knex).bool.false() }).orderBy('created_on', 'DESC').limit(100).then(function (rows) {\n                return rows.map(function (row) {\n                  return fromDatabase(knex, row);\n                });\n              }));\n\n            case 1:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function getInbox() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Returns all archived notifications\n   * @return {Promise<Array<Notification>>} The list of all archived notifications\n   */\n  var getArchived = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              return _context4.abrupt('return', knex('notifications').where({ archived: (0, _helpers2.default)(knex).bool.true() }).orderBy('created_on', 'DESC').limit(100).then(function (rows) {\n                return rows.map(function (row) {\n                  return fromDatabase(knex, row);\n                });\n              }));\n\n            case 1:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function getArchived() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  /**\n  * Archives a single notification\n  * @param  {string} notificationId The id of the notification to archive\n  * @return {Promise}\n  */\n  var archive = function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(notificationId) {\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              return _context5.abrupt('return', knex('notifications').where({ id: notificationId }).update({ archived: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, undefined);\n    }));\n\n    return function archive(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  /**\n  * Archives all notifications\n  * @return {Promise}\n  */\n  var archiveAll = function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              return _context6.abrupt('return', knex('notifications').update({ archived: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, undefined);\n    }));\n\n    return function archiveAll() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  // Internal use only\n  // Binds events to actions\n  var _bindEvents = function _bindEvents() {\n    events.on('notifications.getAll', _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.t0 = events;\n              _context7.next = 3;\n              return getInbox();\n\n            case 3:\n              _context7.t1 = _context7.sent;\n\n              _context7.t0.emit.call(_context7.t0, 'notifications.all', _context7.t1);\n\n            case 5:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, undefined);\n    })));\n\n    events.on('notifications.read', function () {\n      var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(id) {\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return markAsRead(id);\n\n              case 2:\n                _context8.t0 = events;\n                _context8.next = 5;\n                return getInbox();\n\n              case 5:\n                _context8.t1 = _context8.sent;\n\n                _context8.t0.emit.call(_context8.t0, 'notifications.all', _context8.t1);\n\n              case 7:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, _callee8, undefined);\n      }));\n\n      return function (_x3) {\n        return _ref9.apply(this, arguments);\n      };\n    }());\n\n    events.on('notifications.allRead', _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {\n      return regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.next = 2;\n              return markAllAsRead();\n\n            case 2:\n              _context9.t0 = events;\n              _context9.next = 5;\n              return getInbox();\n\n            case 5:\n              _context9.t1 = _context9.sent;\n\n              _context9.t0.emit.call(_context9.t0, 'notifications.all', _context9.t1);\n\n            case 7:\n            case 'end':\n              return _context9.stop();\n          }\n        }\n      }, _callee9, undefined);\n    })));\n\n    events.on('notifications.trashAll', _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {\n      return regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return archiveAll();\n\n            case 2:\n              _context10.t0 = events;\n              _context10.next = 5;\n              return getInbox();\n\n            case 5:\n              _context10.t1 = _context10.sent;\n\n              _context10.t0.emit.call(_context10.t0, 'notifications.all', _context10.t1);\n\n            case 7:\n            case 'end':\n              return _context10.stop();\n          }\n        }\n      }, _callee10, undefined);\n    })));\n  };\n\n  /**\n   * Create and append a new Notification in the Hub. Emits a `notifications.new` event.\n   * @param  {string} options.message     (required) The body message of the notification\n   * @param  {string} options.redirectUrl (optional) The URL the users will be redirected to\n   *                                      when clicking on the notification\n   * @param  {string} options.level       (optional) The level (info, success, error, warning). Defaults to `info`.\n   * @param  {bool} options.enableSound (optional) Whether the notification will trigger a buzzing sound\n   *                                    if a user is currently logged on the dashboard. (defaults to `false`)\n   * @return {Promise}\n   */\n  var create = function () {\n    var _ref12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(_ref13) {\n      var message = _ref13.message,\n          redirectUrl = _ref13.redirectUrl,\n          level = _ref13.level,\n          enableSound = _ref13.enableSound;\n      var callingFile, callingModuleRoot, module, options, notification, logMessage, loggerLevel;\n      return regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              if (!(!message || typeof message !== 'string')) {\n                _context11.next = 2;\n                break;\n              }\n\n              throw new Error(\"'message' is mandatory and should be a string\");\n\n            case 2:\n\n              if (!level || typeof level !== 'string' || !_lodash2.default.includes(['info', 'error', 'success'], level.toLowerCase())) {\n                level = 'info';\n              } else {\n                level = level.toLowerCase();\n              }\n\n              callingFile = getOriginatingModule();\n              callingModuleRoot = callingFile && (0, _util.resolveModuleRootPath)(callingFile);\n              module = _lodash2.default.find(modules, function (mod) {\n                return mod.root === callingModuleRoot;\n              });\n              options = {\n                moduleId: 'botpress',\n                icon: 'view_module',\n                name: 'botpress',\n                url: _lodash2.default.isString(redirectUrl) ? redirectUrl : '/'\n              };\n\n\n              if (module) {\n                // because the bot itself can send notifications\n                options = {\n                  moduleId: module.name,\n                  icon: module.settings.menuIcon,\n                  name: module.settings.menuText,\n                  url: redirectUrl\n                };\n\n                if (!redirectUrl || typeof url !== 'string') {\n                  options.url = '/modules/' + module.name;\n                }\n              }\n\n              notification = {\n                id: (0, _nanoid2.default)(),\n                message: message,\n                level: level,\n                moduleId: options.moduleId,\n                icon: options.icon,\n                name: options.name,\n                url: options.url,\n                date: new Date(),\n                sound: enableSound || false,\n                read: false\n              };\n              _context11.next = 11;\n              return knex('notifications').insert(toDatabase(knex, notification)).then();\n\n            case 11:\n\n              if (logger) {\n                logMessage = '[notification::' + notification.moduleId + '] ' + notification.message;\n                loggerLevel = logger[level] || logger.info;\n\n                loggerLevel(logMessage);\n              }\n\n              if (events) {\n                events.emit('notifications.new', notification);\n              }\n\n            case 13:\n            case 'end':\n              return _context11.stop();\n          }\n        }\n      }, _callee11, undefined);\n    }));\n\n    return function create(_x4) {\n      return _ref12.apply(this, arguments);\n    };\n  }();\n\n  return {\n    // ----> Start of legacy API (DEPRECATED as of Botpress 1.1)\n    load: getInbox,\n    send: function send(_ref14) {\n      var message = _ref14.message,\n          url = _ref14.url,\n          level = _ref14.level,\n          sound = _ref14.sound;\n\n      return create({ message: message, redirectUrl: url, level: level, enableSound: sound });\n    },\n    // End of legacy API <---\n    markAsRead: markAsRead,\n    markAllAsRead: markAllAsRead,\n    archiveAll: archiveAll,\n    archive: archive,\n    getInbox: getInbox,\n    getArchived: getArchived,\n    create: create,\n    // internal API\n    _bindEvents: _bindEvents\n  };\n};\n\nmodule.exports = notifications;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbm90aWZpY2F0aW9ucy5qcz8zOGQzIl0sIm5hbWVzIjpbImdldE9yaWdpbmF0aW5nTW9kdWxlIiwib3JpZ1ByZXBhcmVTdGFja1RyYWNlIiwiRXJyb3IiLCJwcmVwYXJlU3RhY2tUcmFjZSIsIl8iLCJzdGFjayIsImVyciIsInNoaWZ0IiwiZ2V0RmlsZU5hbWUiLCJub3RpZmljYXRpb25zIiwia25leCIsIm1vZHVsZXMiLCJsb2dnZXIiLCJldmVudHMiLCJ0b0RhdGFiYXNlIiwibm90aWZpY2F0aW9uIiwiaWQiLCJtZXNzYWdlIiwibGV2ZWwiLCJtb2R1bGVfaWQiLCJtb2R1bGVJZCIsIm1vZHVsZV9pY29uIiwiaWNvbiIsIm1vZHVsZV9uYW1lIiwibmFtZSIsInJlZGlyZWN0X3VybCIsInVybCIsImNyZWF0ZWRfb24iLCJkYXRlIiwibm93IiwicmVhZCIsImJvb2wiLCJmYWxzZSIsImFyY2hpdmVkIiwiZnJvbURhdGFiYXNlIiwicm93IiwiRGF0ZSIsInNvdW5kIiwicGFyc2UiLCJtYXJrQXNSZWFkIiwibm90aWZpY2F0aW9uSWQiLCJ3aGVyZSIsInVwZGF0ZSIsInRydWUiLCJ0aGVuIiwibWFya0FsbEFzUmVhZCIsImdldEluYm94Iiwib3JkZXJCeSIsImxpbWl0Iiwicm93cyIsIm1hcCIsImdldEFyY2hpdmVkIiwiYXJjaGl2ZSIsImFyY2hpdmVBbGwiLCJfYmluZEV2ZW50cyIsIm9uIiwiZW1pdCIsImNyZWF0ZSIsInJlZGlyZWN0VXJsIiwiZW5hYmxlU291bmQiLCJpbmNsdWRlcyIsInRvTG93ZXJDYXNlIiwiY2FsbGluZ0ZpbGUiLCJjYWxsaW5nTW9kdWxlUm9vdCIsIm1vZHVsZSIsImZpbmQiLCJtb2QiLCJyb290Iiwib3B0aW9ucyIsImlzU3RyaW5nIiwic2V0dGluZ3MiLCJtZW51SWNvbiIsIm1lbnVUZXh0IiwiaW5zZXJ0IiwibG9nTWVzc2FnZSIsImxvZ2dlckxldmVsIiwiaW5mbyIsImxvYWQiLCJzZW5kIiwi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SyxHQUFQO0FBaUJELENBaE5EOztBQWtOQVUsT0FBT2UsT0FBUCxHQUFpQnRFLGFBQWpCIiwiZmlsZSI6Ii4vc3JjL25vdGlmaWNhdGlvbnMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgbmFub2lkIGZyb20gJ25hbm9pZCdcblxuaW1wb3J0IGhlbHBlcnMgZnJvbSAnLi9kYXRhYmFzZS9oZWxwZXJzJ1xuXG5pbXBvcnQgeyByZXNvbHZlTW9kdWxlUm9vdFBhdGggfSBmcm9tICcuL3V0aWwnXG5cbmNvbnN0IGdldE9yaWdpbmF0aW5nTW9kdWxlID0gKCkgPT4ge1xuICBjb25zdCBvcmlnUHJlcGFyZVN0YWNrVHJhY2UgPSBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZVxuICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IChfLCBzdGFjaykgPT4gc3RhY2tcblxuICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoKVxuICBjb25zdCBzdGFjayA9IGVyci5zdGFja1xuICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IG9yaWdQcmVwYXJlU3RhY2tUcmFjZVxuICBzdGFjay5zaGlmdCgpXG5cbiAgcmV0dXJuIHN0YWNrWzFdLmdldEZpbGVOYW1lKClcbn1cblxuY29uc3Qgbm90aWZpY2F0aW9ucyA9ICh7IGtuZXgsIG1vZHVsZXMsIGxvZ2dlciwgZXZlbnRzIH0pID0+IHtcbiAgY29uc3QgdG9EYXRhYmFzZSA9IChrbmV4LCBub3RpZmljYXRpb24pID0+ICh7XG4gICAgaWQ6IG5vdGlmaWNhdGlvbi5pZCxcbiAgICBtZXNzYWdlOiBub3RpZmljYXRpb24ubWVzc2FnZSxcbiAgICBsZXZlbDogbm90aWZpY2F0aW9uLmxldmVsLFxuICAgIG1vZHVsZV9pZDogbm90aWZpY2F0aW9uLm1vZHVsZUlkLFxuICAgIG1vZHVsZV9pY29uOiBub3RpZmljYXRpb24uaWNvbixcbiAgICBtb2R1bGVfbmFtZTogbm90aWZpY2F0aW9uLm5hbWUsXG4gICAgcmVkaXJlY3RfdXJsOiBub3RpZmljYXRpb24udXJsLFxuICAgIGNyZWF0ZWRfb246IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKSxcbiAgICByZWFkOiBoZWxwZXJzKGtuZXgpLmJvb2wuZmFsc2UoKSxcbiAgICBhcmNoaXZlZDogaGVscGVycyhrbmV4KS5ib29sLmZhbHNlKClcbiAgfSlcblxuICBjb25zdCBmcm9tRGF0YWJhc2UgPSAoa25leCwgcm93KSA9PiAoe1xuICAgIGlkOiByb3cuaWQsXG4gICAgbWVzc2FnZTogcm93Lm1lc3NhZ2UsXG4gICAgbGV2ZWw6IHJvdy5sZXZlbCxcbiAgICBtb2R1bGVJZDogcm93Lm1vZHVsZV9pZCxcbiAgICBpY29uOiByb3cubW9kdWxlX2ljb24sXG4gICAgbmFtZTogcm93Lm1vZHVsZV9uYW1lLFxuICAgIHVybDogcm93LnJlZGlyZWN0X3VybCxcbiAgICBkYXRlOiBuZXcgRGF0ZShyb3cuY3JlYXRlZF9vbiksXG4gICAgc291bmQ6IGZhbHNlLFxuICAgIHJlYWQ6IGhlbHBlcnMoa25leCkuYm9vbC5wYXJzZShyb3cucmVhZClcbiAgfSlcblxuICAvLyBUT0RPOiBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyBiZWxvdyBkb2Vzbid0IHVzZSBgYXdhaXRgLCBzaG91bGQgdGhleSBhY3R1YWxseSBiZSBgYXN5bmNgP1xuXG4gIC8qKlxuICAgKiBNYXJrcyBhIHNpbmdsZSBub3RpZmljYXRpb24gYXMgcmVhZCAoYnV0IGRvZXNuJ3QgYXJjaGl2ZSBpdClcbiAgICogQHBhcmFtICB7c3RyaW5nfSBub3RpZmljYXRpb25JZCBUaGUgaWQgb2YgdGhlIG5vdGlmaWNhdGlvbiB0byBtYXJrIGFzIHJlYWRcbiAgICogQHJldHVybiB7UHJvbWlzZX1cbiAgICovXG4gIGNvbnN0IG1hcmtBc1JlYWQgPSBhc3luYyBub3RpZmljYXRpb25JZCA9PlxuICAgIGtuZXgoJ25vdGlmaWNhdGlvbnMnKVxuICAgICAgLndoZXJlKHsgaWQ6IG5vdGlmaWNhdGlvbklkIH0pXG4gICAgICAudXBkYXRlKHsgcmVhZDogaGVscGVycyhrbmV4KS5ib29sLnRydWUoKSB9KVxuICAgICAgLnRoZW4oKVxuXG4gIC8qKlxuICAgKiBNYXJrcyBhbGwgbm90aWZpY2F0aW9ucyBhcyByZWFkIChidXQgZG9lc24ndCBhcmNoaXZlIHRoZW0pXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAqL1xuICBjb25zdCBtYXJrQWxsQXNSZWFkID0gYXN5bmMgKCkgPT5cbiAgICBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC51cGRhdGUoeyByZWFkOiBoZWxwZXJzKGtuZXgpLmJvb2wudHJ1ZSgpIH0pXG4gICAgICAudGhlbigpXG5cbiAgLyoqXG4gICAqIEdldCB0aGUgdG9wIDEwMCAodW5zZWVuKSBub3RpZmljYXRpb25zXG4gICAqIEByZXR1cm4ge1Byb21pc2U8QXJyYXk8Tm90aWZpY2F0aW9uPj59IFRoZSBsaXN0IG9mIGFsbCB1bnNlZW4gbm90aWZpY2F0aW9uc1xuICAgKi9cbiAgY29uc3QgZ2V0SW5ib3ggPSBhc3luYyAoKSA9PlxuICAgIGtuZXgoJ25vdGlmaWNhdGlvbnMnKVxuICAgICAgLndoZXJlKHsgYXJjaGl2ZWQ6IGhlbHBlcnMoa25leCkuYm9vbC5mYWxzZSgpIH0pXG4gICAgICAub3JkZXJCeSgnY3JlYXRlZF9vbicsICdERVNDJylcbiAgICAgIC5saW1pdCgxMDApXG4gICAgICAudGhlbihyb3dzID0+IHJvd3MubWFwKHJvdyA9PiBmcm9tRGF0YWJhc2Uoa25leCwgcm93KSkpXG5cbiAgLyoqXG4gICAqIFJldHVybnMgYWxsIGFyY2hpdmVkIG5vdGlmaWNhdGlvbnNcbiAgICogQHJldHVybiB7UHJvbWlzZTxBcnJheTxOb3RpZmljYXRpb24+Pn0gVGhlIGxpc3Qgb2YgYWxsIGFyY2hpdmVkIG5vdGlmaWNhdGlvbnNcbiAgICovXG4gIGNvbnN0IGdldEFyY2hpdmVkID0gYXN5bmMgKCkgPT5cbiAgICBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC53aGVyZSh7IGFyY2hpdmVkOiBoZWxwZXJzKGtuZXgpLmJvb2wudHJ1ZSgpIH0pXG4gICAgICAub3JkZXJCeSgnY3JlYXRlZF9vbicsICdERVNDJylcbiAgICAgIC5saW1pdCgxMDApXG4gICAgICAudGhlbihyb3dzID0+IHJvd3MubWFwKHJvdyA9PiBmcm9tRGF0YWJhc2Uoa25leCwgcm93KSkpXG5cbiAgLyoqXG4gKiBBcmNoaXZlcyBhIHNpbmdsZSBub3RpZmljYXRpb25cbiAqIEBwYXJhbSAge3N0cmluZ30gbm90aWZpY2F0aW9uSWQgVGhlIGlkIG9mIHRoZSBub3RpZmljYXRpb24gdG8gYXJjaGl2ZVxuICogQHJldHVybiB7UHJvbWlzZX1cbiAqL1xuICBjb25zdCBhcmNoaXZlID0gYXN5bmMgbm90aWZpY2F0aW9uSWQgPT5cbiAgICBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC53aGVyZSh7IGlkOiBub3RpZmljYXRpb25JZCB9KVxuICAgICAgLnVwZGF0ZSh7IGFyY2hpdmVkOiBoZWxwZXJzKGtuZXgpLmJvb2wudHJ1ZSgpIH0pXG4gICAgICAudGhlbigpXG5cbiAgLyoqXG4gKiBBcmNoaXZlcyBhbGwgbm90aWZpY2F0aW9uc1xuICogQHJldHVybiB7UHJvbWlzZX1cbiAqL1xuICBjb25zdCBhcmNoaXZlQWxsID0gYXN5bmMgKCkgPT5cbiAgICBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC51cGRhdGUoeyBhcmNoaXZlZDogaGVscGVycyhrbmV4KS5ib29sLnRydWUoKSB9KVxuICAgICAgLnRoZW4oKVxuXG4gIC8vIEludGVybmFsIHVzZSBvbmx5XG4gIC8vIEJpbmRzIGV2ZW50cyB0byBhY3Rpb25zXG4gIGNvbnN0IF9iaW5kRXZlbnRzID0gKCkgPT4ge1xuICAgIGV2ZW50cy5vbignbm90aWZpY2F0aW9ucy5nZXRBbGwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBldmVudHMuZW1pdCgnbm90aWZpY2F0aW9ucy5hbGwnLCBhd2FpdCBnZXRJbmJveCgpKVxuICAgIH0pXG5cbiAgICBldmVudHMub24oJ25vdGlmaWNhdGlvbnMucmVhZCcsIGFzeW5jIGlkID0+IHtcbiAgICAgIGF3YWl0IG1hcmtBc1JlYWQoaWQpXG4gICAgICBldmVudHMuZW1pdCgnbm90aWZpY2F0aW9ucy5hbGwnLCBhd2FpdCBnZXRJbmJveCgpKVxuICAgIH0pXG5cbiAgICBldmVudHMub24oJ25vdGlmaWNhdGlvbnMuYWxsUmVhZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IG1hcmtBbGxBc1JlYWQoKVxuICAgICAgZXZlbnRzLmVtaXQoJ25vdGlmaWNhdGlvbnMuYWxsJywgYXdhaXQgZ2V0SW5ib3goKSlcbiAgICB9KVxuXG4gICAgZXZlbnRzLm9uKCdub3RpZmljYXRpb25zLnRyYXNoQWxsJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgYXJjaGl2ZUFsbCgpXG4gICAgICBldmVudHMuZW1pdCgnbm90aWZpY2F0aW9ucy5hbGwnLCBhd2FpdCBnZXRJbmJveCgpKVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGFuZCBhcHBlbmQgYSBuZXcgTm90aWZpY2F0aW9uIGluIHRoZSBIdWIuIEVtaXRzIGEgYG5vdGlmaWNhdGlvbnMubmV3YCBldmVudC5cbiAgICogQHBhcmFtICB7c3RyaW5nfSBvcHRpb25zLm1lc3NhZ2UgICAgIChyZXF1aXJlZCkgVGhlIGJvZHkgbWVzc2FnZSBvZiB0aGUgbm90aWZpY2F0aW9uXG4gICAqIEBwYXJhbSAge3N0cmluZ30gb3B0aW9ucy5yZWRpcmVjdFVybCAob3B0aW9uYWwpIFRoZSBVUkwgdGhlIHVzZXJzIHdpbGwgYmUgcmVkaXJlY3RlZCB0b1xuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiBjbGlja2luZyBvbiB0aGUgbm90aWZpY2F0aW9uXG4gICAqIEBwYXJhbSAge3N0cmluZ30gb3B0aW9ucy5sZXZlbCAgICAgICAob3B0aW9uYWwpIFRoZSBsZXZlbCAoaW5mbywgc3VjY2VzcywgZXJyb3IsIHdhcm5pbmcpLiBEZWZhdWx0cyB0byBgaW5mb2AuXG4gICAqIEBwYXJhbSAge2Jvb2x9IG9wdGlvbnMuZW5hYmxlU291bmQgKG9wdGlvbmFsKSBXaGV0aGVyIHRoZSBub3RpZmljYXRpb24gd2lsbCB0cmlnZ2VyIGEgYnV6emluZyBzb3VuZFxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGEgdXNlciBpcyBjdXJyZW50bHkgbG9nZ2VkIG9uIHRoZSBkYXNoYm9hcmQuIChkZWZhdWx0cyB0byBgZmFsc2VgKVxuICAgKiBAcmV0dXJuIHtQcm9taXNlfVxuICAgKi9cbiAgY29uc3QgY3JlYXRlID0gYXN5bmMgKHsgbWVzc2FnZSwgcmVkaXJlY3RVcmwsIGxldmVsLCBlbmFibGVTb3VuZCB9KSA9PiB7XG4gICAgaWYgKCFtZXNzYWdlIHx8IHR5cGVvZiBtZXNzYWdlICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ21lc3NhZ2UnIGlzIG1hbmRhdG9yeSBhbmQgc2hvdWxkIGJlIGEgc3RyaW5nXCIpXG4gICAgfVxuXG4gICAgaWYgKCFsZXZlbCB8fCB0eXBlb2YgbGV2ZWwgIT09ICdzdHJpbmcnIHx8ICFfLmluY2x1ZGVzKFsnaW5mbycsICdlcnJvcicsICdzdWNjZXNzJ10sIGxldmVsLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICBsZXZlbCA9ICdpbmZvJ1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXZlbCA9IGxldmVsLnRvTG93ZXJDYXNlKClcbiAgICB9XG5cbiAgICBjb25zdCBjYWxsaW5nRmlsZSA9IGdldE9yaWdpbmF0aW5nTW9kdWxlKClcbiAgICBjb25zdCBjYWxsaW5nTW9kdWxlUm9vdCA9IGNhbGxpbmdGaWxlICYmIHJlc29sdmVNb2R1bGVSb290UGF0aChjYWxsaW5nRmlsZSlcblxuICAgIGNvbnN0IG1vZHVsZSA9IF8uZmluZChtb2R1bGVzLCBtb2QgPT4ge1xuICAgICAgcmV0dXJuIG1vZC5yb290ID09PSBjYWxsaW5nTW9kdWxlUm9vdFxuICAgIH0pXG5cbiAgICBsZXQgb3B0aW9ucyA9IHtcbiAgICAgIG1vZHVsZUlkOiAnYm90cHJlc3MnLFxuICAgICAgaWNvbjogJ3ZpZXdfbW9kdWxlJyxcbiAgICAgIG5hbWU6ICdib3RwcmVzcycsXG4gICAgICB1cmw6IF8uaXNTdHJpbmcocmVkaXJlY3RVcmwpID8gcmVkaXJlY3RVcmwgOiAnLydcbiAgICB9XG5cbiAgICBpZiAobW9kdWxlKSB7XG4gICAgICAvLyBiZWNhdXNlIHRoZSBib3QgaXRzZWxmIGNhbiBzZW5kIG5vdGlmaWNhdGlvbnNcbiAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgIG1vZHVsZUlkOiBtb2R1bGUubmFtZSxcbiAgICAgICAgaWNvbjogbW9kdWxlLnNldHRpbmdzLm1lbnVJY29uLFxuICAgICAgICBuYW1lOiBtb2R1bGUuc2V0dGluZ3MubWVudVRleHQsXG4gICAgICAgIHVybDogcmVkaXJlY3RVcmxcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZWRpcmVjdFVybCB8fCB0eXBlb2YgdXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICBvcHRpb25zLnVybCA9IGAvbW9kdWxlcy8ke21vZHVsZS5uYW1lfWBcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBub3RpZmljYXRpb24gPSB7XG4gICAgICBpZDogbmFub2lkKCksXG4gICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgbGV2ZWw6IGxldmVsLFxuICAgICAgbW9kdWxlSWQ6IG9wdGlvbnMubW9kdWxlSWQsXG4gICAgICBpY29uOiBvcHRpb25zLmljb24sXG4gICAgICBuYW1lOiBvcHRpb25zLm5hbWUsXG4gICAgICB1cmw6IG9wdGlvbnMudXJsLFxuICAgICAgZGF0ZTogbmV3IERhdGUoKSxcbiAgICAgIHNvdW5kOiBlbmFibGVTb3VuZCB8fCBmYWxzZSxcbiAgICAgIHJlYWQ6IGZhbHNlXG4gICAgfVxuXG4gICAgYXdhaXQga25leCgnbm90aWZpY2F0aW9ucycpXG4gICAgICAuaW5zZXJ0KHRvRGF0YWJhc2Uoa25leCwgbm90aWZpY2F0aW9uKSlcbiAgICAgIC50aGVuKClcblxuICAgIGlmIChsb2dnZXIpIHtcbiAgICAgIGNvbnN0IGxvZ01lc3NhZ2UgPSBgW25vdGlmaWNhdGlvbjo6JHtub3RpZmljYXRpb24ubW9kdWxlSWR9XSAke25vdGlmaWNhdGlvbi5tZXNzYWdlfWBcbiAgICAgIGNvbnN0IGxvZ2dlckxldmVsID0gbG9nZ2VyW2xldmVsXSB8fCBsb2dnZXIuaW5mb1xuICAgICAgbG9nZ2VyTGV2ZWwobG9nTWVzc2FnZSlcbiAgICB9XG5cbiAgICBpZiAoZXZlbnRzKSB7XG4gICAgICBldmVudHMuZW1pdCgnbm90aWZpY2F0aW9ucy5uZXcnLCBub3RpZmljYXRpb24pXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICAvLyAtLS0tPiBTdGFydCBvZiBsZWdhY3kgQVBJIChERVBSRUNBVEVEIGFzIG9mIEJvdHByZXNzIDEuMSlcbiAgICBsb2FkOiBnZXRJbmJveCxcbiAgICBzZW5kOiAoeyBtZXNzYWdlLCB1cmwsIGxldmVsLCBzb3VuZCB9KSA9PiB7XG4gICAgICByZXR1cm4gY3JlYXRlKHsgbWVzc2FnZSwgcmVkaXJlY3RVcmw6IHVybCwgbGV2ZWwsIGVuYWJsZVNvdW5kOiBzb3VuZCB9KVxuICAgIH0sXG4gICAgLy8gRW5kIG9mIGxlZ2FjeSBBUEkgPC0tLVxuICAgIG1hcmtBc1JlYWQsXG4gICAgbWFya0FsbEFzUmVhZCxcbiAgICBhcmNoaXZlQWxsLFxuICAgIGFyY2hpdmUsXG4gICAgZ2V0SW5ib3gsXG4gICAgZ2V0QXJjaGl2ZWQsXG4gICAgY3JlYXRlLFxuICAgIC8vIGludGVybmFsIEFQSVxuICAgIF9iaW5kRXZlbnRzXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBub3RpZmljYXRpb25zXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/notifications.js\n");

/***/ }),

/***/ "./src/queues/memory.js":
/*!******************************!*\
  !*** ./src/queues/memory.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _nanoid = __webpack_require__(/*! nanoid */ \"nanoid\");\n\nvar _nanoid2 = _interopRequireDefault(_nanoid);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MemoryQueue = function () {\n  function MemoryQueue(name, logger) {\n    var _this = this;\n\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    _classCallCheck(this, MemoryQueue);\n\n    this.drain = function () {\n      _this.queue.length > 0 && _this.tick();\n    };\n\n    this.name = name;\n    this.logger = logger;\n    this.options = Object.assign({ retries: 2, drainInterval: 2000 }, options);\n    this.queue = [];\n    this.subscribers = [];\n    this._lock = {};\n\n    this._drain = setInterval(this.drain, this.options.drainInterval);\n  }\n\n  _createClass(MemoryQueue, [{\n    key: 'getQueueId',\n    value: function getQueueId(job) {\n      var event = job.event || job;\n\n      return _lodash2.default.get(event, 'user.id') || _lodash2.default.get(event, 'user.userId') || _lodash2.default.get(event, 'userId') || _lodash2.default.get(event, 'raw.user.id') || _lodash2.default.get(event, 'raw.userId') || _lodash2.default.get(event, 'raw.to') || 'default';\n    }\n  }, {\n    key: 'enqueue',\n    value: function enqueue(job) {\n      var retries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var isPriority = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      var jobWrapped = { job: job, id: (0, _nanoid2.default)(), timestamp: new Date(), retries: retries };\n      if (isPriority) {\n        this.queue.unshift(jobWrapped);\n      } else {\n        this.queue.push(jobWrapped);\n      }\n      this.tick();\n    }\n  }, {\n    key: 'dequeue',\n    value: function dequeue() {\n      return this.queue.shift();\n    }\n  }, {\n    key: 'cancelAll',\n    value: function cancelAll(job) {\n      var _this2 = this;\n\n      var jobQueueId = this.getQueueId(job);\n      this.queue = this.queue.filter(function (item) {\n        return _this2.getQueueId(item.job) !== jobQueueId;\n      });\n    }\n  }, {\n    key: 'peek',\n    value: function peek(job) {\n      var _this3 = this;\n\n      var jobQueueId = this.getQueueId(job);\n      return this.queue.find(function (item) {\n        return _this3.getQueueId(item.job) === jobQueueId;\n      });\n    }\n  }, {\n    key: 'tick',\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this4 = this;\n\n        var toDequeueIdx, _$pullAt, _$pullAt2, _$pullAt2$, job, retries, queueId;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                toDequeueIdx = _lodash2.default.findIndex(this.queue, function (el) {\n                  var queueId = _this4.getQueueId(el.job);\n                  return !_this4._lock[queueId];\n                });\n\n                if (!(toDequeueIdx === -1)) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt('return');\n\n              case 3:\n                _$pullAt = _lodash2.default.pullAt(this.queue, [toDequeueIdx]), _$pullAt2 = _slicedToArray(_$pullAt, 1), _$pullAt2$ = _$pullAt2[0], job = _$pullAt2$.job, retries = _$pullAt2$.retries;\n                queueId = this.getQueueId(job);\n\n                this._lock[queueId] = true;\n\n                _context.prev = 6;\n                _context.next = 9;\n                return _bluebird2.default.mapSeries(this.subscribers, function (fn) {\n                  return fn(job);\n                });\n\n              case 9:\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context['catch'](6);\n\n                this.logger.warn(this.name + ' queue failed to process job: ' + _context.t0.message);\n\n                if (retries + 1 <= this.options.retries) {\n                  this.enqueue(job, retries + 1, true);\n                } else {\n                  this.logger.error('Retrying job within ' + this.name + ' queue failed ' + this.options.retries + ' times. Abandoning the job.');\n                }\n\n              case 15:\n                _context.prev = 15;\n\n                delete this._lock[queueId];\n                if (this.queue.length) {\n                  this.tick();\n                }\n                return _context.finish(15);\n\n              case 19:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[6, 11, 15, 19]]);\n      }));\n\n      function tick() {\n        return _ref.apply(this, arguments);\n      }\n\n      return tick;\n    }()\n  }, {\n    key: 'subscribe',\n    value: function subscribe(fn) {\n      this.subscribers.push(fn);\n    }\n  }]);\n\n  return MemoryQueue;\n}();\n\nexports.default = MemoryQueue;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcXVldWVzL21lbW9yeS5qcz83YWY1Il0sIm5hbWVzIjpbIk1lbW9yeVF1ZXVlIiwibmFtZSIsImxvZ2dlciIsIm9wdGlvbnMiLCJkcmFpbiIsInF1ZXVlIiwibGVuZ3RoIiwidGljayIsIk9iamVjdCIsImFzc2lnbiIsInJldHJpZXMiLCJkcmFpbkludGVydmFsIiwic3Vic2NyaWJlcnMiLCJfbG9jayIsIl9kcmFpbiIsInNldEludGVydmFsIiwiam9iIiwiZXZlbnQiLCJfIiwiZ2V0IiwiaXNQcmlvcml0eSIsImpvYldyYXBwZWQiLCJpZCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ1bnNoaWZ0IiwicHVzaCIsInNoaWZ0Iiwiam9iUXVldWVJZCIsImdldFF1ZXVlSWQiLCJmaWx0ZXIiLCJpdGVtIiwiZmluZCIsInRvRGVxdWV1ZUlkeCIsImZpbmRJbmRleCIsInF1ZXVlSWQiLCJlbCIsInB1bGxBdCIsIlByb21pc2UiLCJtYXBTZXJpZXMiLCJmbiIsIndhcm4iLCJtZXNzYWdlIiwiZW5xdWV1ZSIsImVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7Ozs7O0lBRXFCQSxXO0FBQ25CLHVCQUFZQyxJQUFaLEVBQWtCQyxNQUFsQixFQUF3QztBQUFBOztBQUFBLFFBQWRDLE9BQWMsdUVBQUosRUFBSTs7QUFBQTs7QUFBQSxTQVd4Q0MsS0FYd0MsR0FXaEMsWUFBTTtBQUNaLFlBQUtDLEtBQUwsQ0FBV0MsTUFBWCxHQUFvQixDQUFwQixJQUF5QixNQUFLQyxJQUFMLEVBQXpCO0FBQ0QsS0FidUM7O0FBQ3RDLFNBQUtOLElBQUwsR0FBWUEsSUFBWjtBQUNBLFNBQUtDLE1BQUwsR0FBY0EsTUFBZDtBQUNBLFNBQUtDLE9BQUwsR0FBZUssT0FBT0MsTUFBUCxDQUFjLEVBQUVDLFNBQVMsQ0FBWCxFQUFjQyxlQUFlLElBQTdCLEVBQWQsRUFBbURSLE9BQW5ELENBQWY7QUFDQSxTQUFLRSxL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aEMsVUFBVSxDQUFWLElBQWUsS0FBS1AsT0FBTCxDQUFhTyxPQUFoQyxFQUF5QztBQUN2Qyx1QkFBS2lDLE9BQUwsQ0FBYTNCLEdBQWIsRUFBa0JOLFVBQVUsQ0FBNUIsRUFBK0IsSUFBL0I7QUFDRCxpQkFGRCxNQUVPO0FBQ0wsdUJBQUtSLE1BQUwsQ0FBWTBDLEtBQVosMEJBQ3lCLEtBQUszQyxJQUQ5QixzQkFDbUQsS0FBS0UsT0FBTCxDQUFhTyxPQURoRTtBQUdEOzs7OztBQUVELHVCQUFPLEtBQUtHLEtBQUwsQ0FBV3NCLE9BQVgsQ0FBUDtBQUNBLG9CQUFJLEtBQUs5QixLQUFMLENBQVdDLE1BQWYsRUFBdUI7QUFDckIsdUJBQUtDLElBQUw7QUFDRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs4QkFJS2lDLEUsRUFBSTtBQUNaLFdBQUs1QixXQUFMLENBQWlCYyxJQUFqQixDQUFzQmMsRUFBdEI7QUFDRDs7Ozs7O2tCQTFGa0J4QyxXIiwiZmlsZSI6Ii4vc3JjL3F1ZXVlcy9tZW1vcnkuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbmFub2lkIGZyb20gJ25hbm9pZCdcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZW1vcnlRdWV1ZSB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIGxvZ2dlciwgb3B0aW9ucyA9IHt9KSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZVxuICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyXG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IHJldHJpZXM6IDIsIGRyYWluSW50ZXJ2YWw6IDIwMDAgfSwgb3B0aW9ucylcbiAgICB0aGlzLnF1ZXVlID0gW11cbiAgICB0aGlzLnN1YnNjcmliZXJzID0gW11cbiAgICB0aGlzLl9sb2NrID0ge31cblxuICAgIHRoaXMuX2RyYWluID0gc2V0SW50ZXJ2YWwodGhpcy5kcmFpbiwgdGhpcy5vcHRpb25zLmRyYWluSW50ZXJ2YWwpXG4gIH1cblxuICBkcmFpbiA9ICgpID0+IHtcbiAgICB0aGlzLnF1ZXVlLmxlbmd0aCA+IDAgJiYgdGhpcy50aWNrKClcbiAgfVxuXG4gIGdldFF1ZXVlSWQoam9iKSB7XG4gICAgY29uc3QgZXZlbnQgPSBqb2IuZXZlbnQgfHwgam9iXG5cbiAgICByZXR1cm4gKFxuICAgICAgXy5nZXQoZXZlbnQsICd1c2VyLmlkJykgfHxcbiAgICAgIF8uZ2V0KGV2ZW50LCAndXNlci51c2VySWQnKSB8fFxuICAgICAgXy5nZXQoZXZlbnQsICd1c2VySWQnKSB8fFxuICAgICAgXy5nZXQoZXZlbnQsICdyYXcudXNlci5pZCcpIHx8XG4gICAgICBfLmdldChldmVudCwgJ3Jhdy51c2VySWQnKSB8fFxuICAgICAgXy5nZXQoZXZlbnQsICdyYXcudG8nKSB8fFxuICAgICAgJ2RlZmF1bHQnXG4gICAgKVxuICB9XG5cbiAgZW5xdWV1ZShqb2IsIHJldHJpZXMgPSAwLCBpc1ByaW9yaXR5ID0gZmFsc2UpIHtcbiAgICBjb25zdCBqb2JXcmFwcGVkID0geyBqb2IsIGlkOiBuYW5vaWQoKSwgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLCByZXRyaWVzIH1cbiAgICBpZiAoaXNQcmlvcml0eSkge1xuICAgICAgdGhpcy5xdWV1ZS51bnNoaWZ0KGpvYldyYXBwZWQpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucXVldWUucHVzaChqb2JXcmFwcGVkKVxuICAgIH1cbiAgICB0aGlzLnRpY2soKVxuICB9XG5cbiAgZGVxdWV1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5xdWV1ZS5zaGlmdCgpXG4gIH1cblxuICBjYW5jZWxBbGwoam9iKSB7XG4gICAgY29uc3Qgam9iUXVldWVJZCA9IHRoaXMuZ2V0UXVldWVJZChqb2IpXG4gICAgdGhpcy5xdWV1ZSA9IHRoaXMucXVldWUuZmlsdGVyKGl0ZW0gPT4gdGhpcy5nZXRRdWV1ZUlkKGl0ZW0uam9iKSAhPT0gam9iUXVldWVJZClcbiAgfVxuXG4gIHBlZWsoam9iKSB7XG4gICAgY29uc3Qgam9iUXVldWVJZCA9IHRoaXMuZ2V0UXVldWVJZChqb2IpXG4gICAgcmV0dXJuIHRoaXMucXVldWUuZmluZChpdGVtID0+IHRoaXMuZ2V0UXVldWVJZChpdGVtLmpvYikgPT09IGpvYlF1ZXVlSWQpXG4gIH1cblxuICBhc3luYyB0aWNrKCkge1xuICAgIGNvbnN0IHRvRGVxdWV1ZUlkeCA9IF8uZmluZEluZGV4KHRoaXMucXVldWUsIGVsID0+IHtcbiAgICAgIGNvbnN0IHF1ZXVlSWQgPSB0aGlzLmdldFF1ZXVlSWQoZWwuam9iKVxuICAgICAgcmV0dXJuICF0aGlzLl9sb2NrW3F1ZXVlSWRdXG4gICAgfSlcblxuICAgIGlmICh0b0RlcXVldWVJZHggPT09IC0xKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBbeyBqb2IsIHJldHJpZXMgfV0gPSBfLnB1bGxBdCh0aGlzLnF1ZXVlLCBbdG9EZXF1ZXVlSWR4XSlcbiAgICBjb25zdCBxdWV1ZUlkID0gdGhpcy5nZXRRdWV1ZUlkKGpvYilcbiAgICB0aGlzLl9sb2NrW3F1ZXVlSWRdID0gdHJ1ZVxuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IFByb21pc2UubWFwU2VyaWVzKHRoaXMuc3Vic2NyaWJlcnMsIGZuID0+IGZuKGpvYikpXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aGlzLmxvZ2dlci53YXJuKGAke3RoaXMubmFtZX0gcXVldWUgZmFpbGVkIHRvIHByb2Nlc3Mgam9iOiAke2Vyci5tZXNzYWdlfWApXG5cbiAgICAgIGlmIChyZXRyaWVzICsgMSA8PSB0aGlzLm9wdGlvbnMucmV0cmllcykge1xuICAgICAgICB0aGlzLmVucXVldWUoam9iLCByZXRyaWVzICsgMSwgdHJ1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAgIGBSZXRyeWluZyBqb2Igd2l0aGluICR7dGhpcy5uYW1lfSBxdWV1ZSBmYWlsZWQgJHt0aGlzLm9wdGlvbnMucmV0cmllc30gdGltZXMuIEFiYW5kb25pbmcgdGhlIGpvYi5gXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgZGVsZXRlIHRoaXMuX2xvY2tbcXVldWVJZF1cbiAgICAgIGlmICh0aGlzLnF1ZXVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLnRpY2soKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHN1YnNjcmliZShmbikge1xuICAgIHRoaXMuc3Vic2NyaWJlcnMucHVzaChmbilcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/queues/memory.js\n");

/***/ }),

/***/ "./src/renderers/engine.js":
/*!*********************************!*\
  !*** ./src/renderers/engine.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _mustache = __webpack_require__(/*! mustache */ \"mustache\");\n\nvar _mustache2 = _interopRequireDefault(_mustache);\n\nvar _ms = __webpack_require__(/*! ms */ \"ms\");\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// TODO: can use typed-error that handles stack capturing\nvar ParsingError = function (_Error) {\n  _inherits(ParsingError, _Error);\n\n  function ParsingError(bloc, instructionIndex, error) {\n    _classCallCheck(this, ParsingError);\n\n    var _this = _possibleConstructorReturn(this, (ParsingError.__proto__ || Object.getPrototypeOf(ParsingError)).call(this, 'Error parsing bloc \\'' + bloc + '\\' at instruction ' + (instructionIndex + 1) + ': ' + error));\n\n    _this.bloc = bloc;\n    _this.instructionIndex = instructionIndex;\n    _this.internalMessage = error;\n    Error.captureStackTrace(_this, ParsingError);\n    return _this;\n  }\n\n  return ParsingError;\n}(Error);\n\nvar premapInstruction = function premapInstruction(_ref) {\n  var currentPlatform = _ref.currentPlatform;\n  return function (_ref2) {\n    var instruction = _ref2.instruction,\n        index = _ref2.index,\n        instructions = _ref2.instructions,\n        detectedPlatforms = _ref2.detectedPlatforms,\n        blocName = _ref2.blocName;\n\n    if (typeof instruction === 'string' || _lodash2.default.isArray(instruction)) {\n      return [{\n        text: instruction\n      }];\n    }\n\n    // Parsing conditionals\n    var evaluate = function evaluate(val, exp) {\n      if (typeof exp === 'boolean') {\n        return val === exp;\n      }\n      if (_lodash2.default.isArrayLike(exp)) {\n        return val ? !_lodash2.default.isEmpty(exp) : _lodash2.default.isEmpty(exp);\n      } else {\n        return val ? !!exp : !exp;\n      }\n    };\n\n    if (!_lodash2.default.isNil(instruction.if) && !_lodash2.default.isNil(instruction.unless)) {\n      throw new ParsingError(blocName, index, \"Message can't be both 'if' and 'else'.\");\n    }\n\n    if (!_lodash2.default.isNil(instruction.unless) && !evaluate(false, instruction.unless)) {\n      return [];\n    }\n\n    if (!_lodash2.default.isNil(instruction.if) && !evaluate(true, instruction.if)) {\n      return [];\n    }\n\n    // Parsing \".on\"\n    var i = Object.assign({}, instruction);\n    if (instruction.on) {\n      if (typeof instruction.on === 'string') {\n        var platforms = instruction.on.toLowerCase().split('+').map(_lodash2.default.trim);\n        if (!_lodash2.default.includes(platforms, currentPlatform.toLowerCase())) {\n          return [];\n        } else {\n          i['__platformSpecific'] = true;\n        }\n      } else if (_lodash2.default.isPlainObject(instruction.on)) {\n        var on = _lodash2.default.mapKeys(instruction.on, function (__, key) {\n          return key.toLowerCase();\n        });\n\n        // This allows multiple platforms to be specified\n        // e.g. \"messenger+slack+web\"\n        _lodash2.default.keys(on).forEach(function (key) {\n          if (key.indexOf('+') >= 0) {\n            _lodash2.default.split(key, '+').forEach(function (alias) {\n              var trimmed = _lodash2.default.trim(alias);\n              on[trimmed] = _lodash2.default.merge({}, on[trimmed] || {}, on[key]);\n            });\n          }\n        });\n\n        i = Object.assign(i, on[currentPlatform.toLowerCase()], { on: currentPlatform });\n      } else {\n        throw new ParsingError(blocName, index, '\"on\" must be a string or a plain object but was a ' + _typeof(instruction.on));\n      }\n    }\n\n    return [i];\n  };\n};\n\nvar mapInstruction = function mapInstruction(_ref3) {\n  var currentPlatform = _ref3.currentPlatform,\n      processors = _ref3.processors,\n      incomingEvent = _ref3.incomingEvent;\n  return function (_ref4) {\n    var instruction = _ref4.instruction,\n        messages = _ref4.messages,\n        blocName = _ref4.blocName;\n\n    var ret = [];\n\n    if (!_lodash2.default.isNil(instruction.wait)) {\n      ret.push({\n        __internal: true,\n        type: 'wait',\n        wait: _lodash2.default.isString(instruction.wait) ? (0, _ms2.default)(instruction.wait || 1000) : parseInt(instruction.wait) || 1000\n      });\n    }\n\n    if (!_lodash2.default.isNil(instruction.typing)) {\n      instruction.typing = _lodash2.default.isString(instruction.typing) ? (0, _ms2.default)(instruction.typing || 1000) : parseInt(instruction.typing) || 1000;\n    }\n\n    var raw = _lodash2.default.omit(instruction, ['unless', 'if', 'on', 'wait']);\n\n    if (!_lodash2.default.keys(raw).length) {\n      return ret;\n    }\n\n    if (_lodash2.default.isArray(instruction.text)) {\n      instruction.text = _lodash2.default.sample(instruction.text);\n    }\n\n    var processor = currentPlatform && processors[currentPlatform];\n    if (processor) {\n      var msg = processor({ instruction: instruction, messages: messages, blocName: blocName, event: incomingEvent });\n      if (msg) {\n        ret.push(msg);\n      }\n\n      return ret;\n    }\n\n    throw new Error('Unsupported platform: ' + currentPlatform);\n  };\n};\n\nvar mapBloc = function mapBloc(bloc, blocName, options, processors, incomingEvent) {\n  var currentPlatform = options.currentPlatform,\n      _options$throwIfNoPla = options.throwIfNoPlatform,\n      throwIfNoPlatform = _options$throwIfNoPla === undefined ? false : _options$throwIfNoPla;\n\n\n  if (!currentPlatform && throwIfNoPlatform) {\n    throw new Error('You need to supply `currentplatform`');\n  }\n\n  var _premapInstruction = premapInstruction({ currentPlatform: currentPlatform });\n  var _mapInstruction = mapInstruction({ currentPlatform: currentPlatform, processors: processors, incomingEvent: incomingEvent });\n\n  if (!Array.isArray(bloc)) {\n    bloc = [bloc];\n  }\n\n  var messages = [];\n  var detectedPlatforms = [];\n  var instructions = [];\n\n  // Premapping allows for modifications, drop and addition of instructions\n  _lodash2.default.forEach(bloc, function (instruction, index) {\n    var add = _premapInstruction({\n      instruction: instruction,\n      index: index,\n      instructions: bloc,\n      detectedPlatforms: detectedPlatforms,\n      blocName: blocName\n    });\n\n    add && _lodash2.default.forEach(add, function (i) {\n      return instructions.push(i);\n    });\n  });\n\n  _lodash2.default.forEach(instructions, function (instruction) {\n    var m = _mapInstruction({ instruction: instruction, messages: messages, blocName: blocName });\n\n    if (m != null) {\n      // Messages can be null when the instruction only modified existing messages\n      m.forEach(function (message) {\n        return messages.push(message);\n      });\n    }\n  });\n\n  return messages;\n};\n\nvar renderMustache = function renderMustache(template, context) {\n  _mustache2.default.parse(template);\n  return _mustache2.default.render(template, context);\n};\n\nvar hydrateMustache = function hydrateMustache(obj, context) {\n  if (_lodash2.default.isString(obj)) {\n    return renderMustache(obj, context);\n  }\n  if (Array.isArray(obj)) {\n    return obj.map(function (v) {\n      return hydrateMustache(v, context);\n    });\n  }\n  if (_lodash2.default.isObject(obj)) {\n    return _lodash2.default.mapValues(obj, function (v) {\n      return hydrateMustache(v, context);\n    });\n  }\n  return obj;\n};\n\nmodule.exports = function (_ref5) {\n  var rendererName = _ref5.rendererName,\n      rendererFn = _ref5.rendererFn,\n      context = _ref5.context,\n      options = _ref5.options,\n      processors = _ref5.processors,\n      incomingEvent = _ref5.incomingEvent;\n\n  // We're running it a second time to do second-level variable replacement\n  // This happens often when there are variables used in the Content Manager\n  var rawBloc = hydrateMustache(hydrateMustache(rendererFn(context), context), context);\n\n  return mapBloc(rawBloc, rendererName, options, processors, incomingEvent);\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcmVuZGVyZXJzL2VuZ2luZS5qcz9kNzcxIl0sIm5hbWVzIjpbIlBhcnNpbmdFcnJvciIsImJsb2MiLCJpbnN0cnVjdGlvbkluZGV4IiwiZXJyb3IiLCJpbnRlcm5hbE1lc3NhZ2UiLCJFcnJvciIsImNhcHR1cmVTdGFja1RyYWNlIiwicHJlbWFwSW5zdHJ1Y3Rpb24iLCJjdXJyZW50UGxhdGZvcm0iLCJpbnN0cnVjdGlvbiIsImluZGV4IiwiaW5zdHJ1Y3Rpb25zIiwiZGV0ZWN0ZWRQbGF0Zm9ybXMiLCJibG9jTmFtZSIsIl8iLCJpc0FycmF5IiwidGV4dCIsImV2YWx1YXRlIiwidmFsIiwiZXhwIiwiaXNBcnJheUxpa2UiLCJpc0VtcHR5IiwiaXNOaWwiLCJpZiIsInVubGVzcyIsImkiLCJPYmplY3QiLCJhc3NpZ24iLCJvbiIsInBsYXRmb3JtcyIsInRvTG93ZXJDYXNlIiwic3BsaXQiLCJtYXAiLCJ0cmltIiwiaW5jbHVkZXMiLCJpc1BsYWluT2JqZWN0IiwibWFwS2V5cyIsIl9fIiwia2V5Iiwia2V5cyIsImZvckVhY2giLCJpbmRleE9mIiwidHJpbW1lZCIsImFsaWFzIiwibWVyZ2UiLCJtYXBJbnN0cnVjdGlvbiIsInByb2Nlc3NvcnMiLCJpbmNvbWluZ0V2ZW50IiwibWVzc2FnZXMiLCJyZXQiLCJ3YWl0IiwicHVzaCIsIl9faW50ZXJuYWwiLCJ0eXBlIiwiaXNTdHJpbmciLCJwYXJzZUludCIsInR5cGluZyIsInJhdyIsIm9taXQiLCJsZW5ndGgiLCJzYW1wbGUiLCJwcm9jZXNzb3IiLCJtc2ciLCJldmVudCIsIm1hcEJsb2MiLCJvcHRpb25zIiwidGhyb3dJZk5vUGxhdGZvcm0iLCJfcHJlbWFwSW5zdHJ1Y3Rpb24iLCJfbWFwSW5zdHJ1Y3Rpb24iLCJBcnJheSIsImFkZCIsIm0iLCJtZXNzYWdlIiwicmVuZGVyTXVzdGFjaGUiLCJ0ZW1wbGF0ZSIsImNvbnRleHQiLCJNdXN0YWNoZSIsInBhcnNlIiwicmVuZGVyIiwiaHlkcmF0ZU11c3RhY2hlIiwib2JqIiwidiIsImlzT2JqZWN0IiwibWFwVmFsdWVzIiwibW9kdWxlIiwiZXhwb3J0cyIsInJlbmRlcmVyTmFtZSIsInJlbmRlcmVyRm4iLCJyYXdCbG9jIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7Ozs7Ozs7QUFFQTtJQUNNQSxZOzs7QUFDSix3QkFBWUMsSUFBWixFQUFrQkMsZ0JBQWxCLEVBQW9DQyxLQUFwQyxFQUEyQztBQUFBOztBQUFBLHNKQUNaRixJQURZLDJCQUNZQyxtQkFBbUIsQ0FEL0IsV0FDcUNDLEtBRHJDOztBQUV6QyxVQUFLRixJQUFMLEdBQVlBLElBQVo7QUFDQSxVQUFLQyxnQkFBTCxHQUF3QkEsZ0JBQXhCO0FBQ0EsVUFBS0UsZUFBTCxHQUF1QkQsS0FBdkI7QUFDQUUsVUFBTUMsaUJBQU4sUUFBOEJOLFlBQTlCO0FBTHlDO0FBTTFDOzs7RUFQd0JLLEs7O0FBVTNCLElBQU1FLG9CQUFvQixTQUFwQkEsaUJBQW9CO0FBQUEsTUFBR0MsZUFBSCxRQUFHQSxlQUFIO0FBQUEsU0FBeUIsaUJBTTdDO0FBQUEsUUFMSkMsV0FLSSxTQUxKQSxXQUtJO0FBQUEsUUFKSkMsS0FJSSxTQUpKQSxLQUlJO0FBQUEsUUFISkMsWUFHSSxTQUhKQSxZQUdJO0FBQUEsUUFGSkMsaUJBRUksU0FGSkEsaUJBRUk7QUFBQSxRQURKQyxRQUNJLFNBREpBLFFBQ0k7O0FBQ0osUUFBSSxPQUFPSixXQUFQLEtBQXVCLFFBQXZCLElBQW1DSyxpQkFBRUMsT0FBRixDQUFVTixXQUFWLENBQXZDLEVBQStEO0FBQzdELGFBQU8sQ0FDTDtBQUNFTyxjQUFNUDtBQURSLE9BREssQ0FBUDtBQUtEOztBQUVEO0FBQ0EsUUFBTVEsV0FBVyxTQUFYQSxRQUFXLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQzdCLFVBQUksT0FBT0EsR0FBUCxLQUFlLFNBQW5CLEVBQThCO0FBQzVCLGVBQU9ELFFBQVFDLEdBQWY7QUFDRDtBQUNELFVBQUlM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bmdpbmUuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTXVzdGFjaGUgZnJvbSAnbXVzdGFjaGUnXG5pbXBvcnQgbXMgZnJvbSAnbXMnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5cbi8vIFRPRE86IGNhbiB1c2UgdHlwZWQtZXJyb3IgdGhhdCBoYW5kbGVzIHN0YWNrIGNhcHR1cmluZ1xuY2xhc3MgUGFyc2luZ0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihibG9jLCBpbnN0cnVjdGlvbkluZGV4LCBlcnJvcikge1xuICAgIHN1cGVyKGBFcnJvciBwYXJzaW5nIGJsb2MgJyR7YmxvY30nIGF0IGluc3RydWN0aW9uICR7aW5zdHJ1Y3Rpb25JbmRleCArIDF9OiAke2Vycm9yfWApXG4gICAgdGhpcy5ibG9jID0gYmxvY1xuICAgIHRoaXMuaW5zdHJ1Y3Rpb25JbmRleCA9IGluc3RydWN0aW9uSW5kZXhcbiAgICB0aGlzLmludGVybmFsTWVzc2FnZSA9IGVycm9yXG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgUGFyc2luZ0Vycm9yKVxuICB9XG59XG5cbmNvbnN0IHByZW1hcEluc3RydWN0aW9uID0gKHsgY3VycmVudFBsYXRmb3JtIH0pID0+ICh7XG4gIGluc3RydWN0aW9uLFxuICBpbmRleCxcbiAgaW5zdHJ1Y3Rpb25zLFxuICBkZXRlY3RlZFBsYXRmb3JtcyxcbiAgYmxvY05hbWVcbn0pID0+IHtcbiAgaWYgKHR5cGVvZiBpbnN0cnVjdGlvbiA9PT0gJ3N0cmluZycgfHwgXy5pc0FycmF5KGluc3RydWN0aW9uKSkge1xuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIHRleHQ6IGluc3RydWN0aW9uXG4gICAgICB9XG4gICAgXVxuICB9XG5cbiAgLy8gUGFyc2luZyBjb25kaXRpb25hbHNcbiAgY29uc3QgZXZhbHVhdGUgPSAodmFsLCBleHApID0+IHtcbiAgICBpZiAodHlwZW9mIGV4cCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4gdmFsID09PSBleHBcbiAgICB9XG4gICAgaWYgKF8uaXNBcnJheUxpa2UoZXhwKSkge1xuICAgICAgcmV0dXJuIHZhbCA/ICFfLmlzRW1wdHkoZXhwKSA6IF8uaXNFbXB0eShleHApXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB2YWwgPyAhIWV4cCA6ICFleHBcbiAgICB9XG4gIH1cblxuICBpZiAoIV8uaXNOaWwoaW5zdHJ1Y3Rpb24uaWYpICYmICFfLmlzTmlsKGluc3RydWN0aW9uLnVubGVzcykpIHtcbiAgICB0aHJvdyBuZXcgUGFyc2luZ0Vycm9yKGJsb2NOYW1lLCBpbmRleCwgXCJNZXNzYWdlIGNhbid0IGJlIGJvdGggJ2lmJyBhbmQgJ2Vsc2UnLlwiKVxuICB9XG5cbiAgaWYgKCFfLmlzTmlsKGluc3RydWN0aW9uLnVubGVzcykgJiYgIWV2YWx1YXRlKGZhbHNlLCBpbnN0cnVjdGlvbi51bmxlc3MpKSB7XG4gICAgcmV0dXJuIFtdXG4gIH1cblxuICBpZiAoIV8uaXNOaWwoaW5zdHJ1Y3Rpb24uaWYpICYmICFldmFsdWF0ZSh0cnVlLCBpbnN0cnVjdGlvbi5pZikpIHtcbiAgICByZXR1cm4gW11cbiAgfVxuXG4gIC8vIFBhcnNpbmcgXCIub25cIlxuICBsZXQgaSA9IE9iamVjdC5hc3NpZ24oe30sIGluc3RydWN0aW9uKVxuICBpZiAoaW5zdHJ1Y3Rpb24ub24pIHtcbiAgICBpZiAodHlwZW9mIGluc3RydWN0aW9uLm9uID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgcGxhdGZvcm1zID0gaW5zdHJ1Y3Rpb24ub25cbiAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgICAgLnNwbGl0KCcrJylcbiAgICAgICAgLm1hcChfLnRyaW0pXG4gICAgICBpZiAoIV8uaW5jbHVkZXMocGxhdGZvcm1zLCBjdXJyZW50UGxhdGZvcm0udG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpWydfX3BsYXRmb3JtU3BlY2lmaWMnXSA9IHRydWVcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKF8uaXNQbGFpbk9iamVjdChpbnN0cnVjdGlvbi5vbikpIHtcbiAgICAgIGNvbnN0IG9uID0gXy5tYXBLZXlzKGluc3RydWN0aW9uLm9uLCAoX18sIGtleSkgPT4ga2V5LnRvTG93ZXJDYXNlKCkpXG5cbiAgICAgIC8vIFRoaXMgYWxsb3dzIG11bHRpcGxlIHBsYXRmb3JtcyB0byBiZSBzcGVjaWZpZWRcbiAgICAgIC8vIGUuZy4gXCJtZXNzZW5nZXIrc2xhY2srd2ViXCJcbiAgICAgIF8ua2V5cyhvbikuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAoa2V5LmluZGV4T2YoJysnKSA+PSAwKSB7XG4gICAgICAgICAgXy5zcGxpdChrZXksICcrJykuZm9yRWFjaChhbGlhcyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0cmltbWVkID0gXy50cmltKGFsaWFzKVxuICAgICAgICAgICAgb25bdHJpbW1lZF0gPSBfLm1lcmdlKHt9LCBvblt0cmltbWVkXSB8fCB7fSwgb25ba2V5XSlcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBpID0gT2JqZWN0LmFzc2lnbihpLCBvbltjdXJyZW50UGxhdGZvcm0udG9Mb3dlckNhc2UoKV0sIHsgb246IGN1cnJlbnRQbGF0Zm9ybSB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2luZ0Vycm9yKFxuICAgICAgICBibG9jTmFtZSxcbiAgICAgICAgaW5kZXgsXG4gICAgICAgICdcIm9uXCIgbXVzdCBiZSBhIHN0cmluZyBvciBhIHBsYWluIG9iamVjdCBidXQgd2FzIGEgJyArIHR5cGVvZiBpbnN0cnVjdGlvbi5vblxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBbaV1cbn1cblxuY29uc3QgbWFwSW5zdHJ1Y3Rpb24gPSAoeyBjdXJyZW50UGxhdGZvcm0sIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQgfSkgPT4gKHsgaW5zdHJ1Y3Rpb24sIG1lc3NhZ2VzLCBibG9jTmFtZSB9KSA9PiB7XG4gIGNvbnN0IHJldCA9IFtdXG5cbiAgaWYgKCFfLmlzTmlsKGluc3RydWN0aW9uLndhaXQpKSB7XG4gICAgcmV0LnB1c2goe1xuICAgICAgX19pbnRlcm5hbDogdHJ1ZSxcbiAgICAgIHR5cGU6ICd3YWl0JyxcbiAgICAgIHdhaXQ6IF8uaXNTdHJpbmcoaW5zdHJ1Y3Rpb24ud2FpdCkgPyBtcyhpbnN0cnVjdGlvbi53YWl0IHx8IDEwMDApIDogcGFyc2VJbnQoaW5zdHJ1Y3Rpb24ud2FpdCkgfHwgMTAwMFxuICAgIH0pXG4gIH1cblxuICBpZiAoIV8uaXNOaWwoaW5zdHJ1Y3Rpb24udHlwaW5nKSkge1xuICAgIGluc3RydWN0aW9uLnR5cGluZyA9IF8uaXNTdHJpbmcoaW5zdHJ1Y3Rpb24udHlwaW5nKVxuICAgICAgPyBtcyhpbnN0cnVjdGlvbi50eXBpbmcgfHwgMTAwMClcbiAgICAgIDogcGFyc2VJbnQoaW5zdHJ1Y3Rpb24udHlwaW5nKSB8fCAxMDAwXG4gIH1cblxuICBjb25zdCByYXcgPSBfLm9taXQoaW5zdHJ1Y3Rpb24sIFsndW5sZXNzJywgJ2lmJywgJ29uJywgJ3dhaXQnXSlcblxuICBpZiAoIV8ua2V5cyhyYXcpLmxlbmd0aCkge1xuICAgIHJldHVybiByZXRcbiAgfVxuXG4gIGlmIChfLmlzQXJyYXkoaW5zdHJ1Y3Rpb24udGV4dCkpIHtcbiAgICBpbnN0cnVjdGlvbi50ZXh0ID0gXy5zYW1wbGUoaW5zdHJ1Y3Rpb24udGV4dClcbiAgfVxuXG4gIGNvbnN0IHByb2Nlc3NvciA9IGN1cnJlbnRQbGF0Zm9ybSAmJiBwcm9jZXNzb3JzW2N1cnJlbnRQbGF0Zm9ybV1cbiAgaWYgKHByb2Nlc3Nvcikge1xuICAgIGNvbnN0IG1zZyA9IHByb2Nlc3Nvcih7IGluc3RydWN0aW9uLCBtZXNzYWdlcywgYmxvY05hbWUsIGV2ZW50OiBpbmNvbWluZ0V2ZW50IH0pXG4gICAgaWYgKG1zZykge1xuICAgICAgcmV0LnB1c2gobXNnKVxuICAgIH1cblxuICAgIHJldHVybiByZXRcbiAgfVxuXG4gIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgcGxhdGZvcm06ICcgKyBjdXJyZW50UGxhdGZvcm0pXG59XG5cbmNvbnN0IG1hcEJsb2MgPSAoYmxvYywgYmxvY05hbWUsIG9wdGlvbnMsIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQpID0+IHtcbiAgY29uc3QgeyBjdXJyZW50UGxhdGZvcm0sIHRocm93SWZOb1BsYXRmb3JtID0gZmFsc2UgfSA9IG9wdGlvbnNcblxuICBpZiAoIWN1cnJlbnRQbGF0Zm9ybSAmJiB0aHJvd0lmTm9QbGF0Zm9ybSkge1xuICAgIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdG8gc3VwcGx5IGBjdXJyZW50cGxhdGZvcm1gJylcbiAgfVxuXG4gIGNvbnN0IF9wcmVtYXBJbnN0cnVjdGlvbiA9IHByZW1hcEluc3RydWN0aW9uKHsgY3VycmVudFBsYXRmb3JtIH0pXG4gIGNvbnN0IF9tYXBJbnN0cnVjdGlvbiA9IG1hcEluc3RydWN0aW9uKHsgY3VycmVudFBsYXRmb3JtLCBwcm9jZXNzb3JzLCBpbmNvbWluZ0V2ZW50IH0pXG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KGJsb2MpKSB7XG4gICAgYmxvYyA9IFtibG9jXVxuICB9XG5cbiAgY29uc3QgbWVzc2FnZXMgPSBbXVxuICBjb25zdCBkZXRlY3RlZFBsYXRmb3JtcyA9IFtdXG4gIGNvbnN0IGluc3RydWN0aW9ucyA9IFtdXG5cbiAgLy8gUHJlbWFwcGluZyBhbGxvd3MgZm9yIG1vZGlmaWNhdGlvbnMsIGRyb3AgYW5kIGFkZGl0aW9uIG9mIGluc3RydWN0aW9uc1xuICBfLmZvckVhY2goYmxvYywgKGluc3RydWN0aW9uLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IGFkZCA9IF9wcmVtYXBJbnN0cnVjdGlvbih7XG4gICAgICBpbnN0cnVjdGlvbixcbiAgICAgIGluZGV4LFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBibG9jLFxuICAgICAgZGV0ZWN0ZWRQbGF0Zm9ybXMsXG4gICAgICBibG9jTmFtZVxuICAgIH0pXG5cbiAgICBhZGQgJiYgXy5mb3JFYWNoKGFkZCwgaSA9PiBpbnN0cnVjdGlvbnMucHVzaChpKSlcbiAgfSlcblxuICBfLmZvckVhY2goaW5zdHJ1Y3Rpb25zLCBpbnN0cnVjdGlvbiA9PiB7XG4gICAgY29uc3QgbSA9IF9tYXBJbnN0cnVjdGlvbih7IGluc3RydWN0aW9uLCBtZXNzYWdlcywgYmxvY05hbWUgfSlcblxuICAgIGlmIChtICE9IG51bGwpIHtcbiAgICAgIC8vIE1lc3NhZ2VzIGNhbiBiZSBudWxsIHdoZW4gdGhlIGluc3RydWN0aW9uIG9ubHkgbW9kaWZpZWQgZXhpc3RpbmcgbWVzc2FnZXNcbiAgICAgIG0uZm9yRWFjaChtZXNzYWdlID0+IG1lc3NhZ2VzLnB1c2gobWVzc2FnZSkpXG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBtZXNzYWdlc1xufVxuXG5jb25zdCByZW5kZXJNdXN0YWNoZSA9ICh0ZW1wbGF0ZSwgY29udGV4dCkgPT4ge1xuICBNdXN0YWNoZS5wYXJzZSh0ZW1wbGF0ZSlcbiAgcmV0dXJuIE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgY29udGV4dClcbn1cblxuY29uc3QgaHlkcmF0ZU11c3RhY2hlID0gKG9iaiwgY29udGV4dCkgPT4ge1xuICBpZiAoXy5pc1N0cmluZyhvYmopKSB7XG4gICAgcmV0dXJuIHJlbmRlck11c3RhY2hlKG9iaiwgY29udGV4dClcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgcmV0dXJuIG9iai5tYXAodiA9PiBoeWRyYXRlTXVzdGFjaGUodiwgY29udGV4dCkpXG4gIH1cbiAgaWYgKF8uaXNPYmplY3Qob2JqKSkge1xuICAgIHJldHVybiBfLm1hcFZhbHVlcyhvYmosIHYgPT4gaHlkcmF0ZU11c3RhY2hlKHYsIGNvbnRleHQpKVxuICB9XG4gIHJldHVybiBvYmpcbn1cblxubW9kdWxlLmV4cG9ydHMgPSAoeyByZW5kZXJlck5hbWUsIHJlbmRlcmVyRm4sIGNvbnRleHQsIG9wdGlvbnMsIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQgfSkgPT4ge1xuICAvLyBXZSdyZSBydW5uaW5nIGl0IGEgc2Vjb25kIHRpbWUgdG8gZG8gc2Vjb25kLWxldmVsIHZhcmlhYmxlIHJlcGxhY2VtZW50XG4gIC8vIFRoaXMgaGFwcGVucyBvZnRlbiB3aGVuIHRoZXJlIGFyZSB2YXJpYWJsZXMgdXNlZCBpbiB0aGUgQ29udGVudCBNYW5hZ2VyXG4gIGNvbnN0IHJhd0Jsb2MgPSBoeWRyYXRlTXVzdGFjaGUoaHlkcmF0ZU11c3RhY2hlKHJlbmRlcmVyRm4oY29udGV4dCksIGNvbnRleHQpLCBjb250ZXh0KVxuXG4gIHJldHVybiBtYXBCbG9jKHJhd0Jsb2MsIHJlbmRlcmVyTmFtZSwgb3B0aW9ucywgcHJvY2Vzc29ycywgaW5jb21pbmdFdmVudClcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/renderers/engine.js\n");

/***/ }),

/***/ "./src/renderers/index.js":
/*!********************************!*\
  !*** ./src/renderers/index.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _engine = __webpack_require__(/*! ./engine */ \"./src/renderers/engine.js\");\n\nvar _engine2 = _interopRequireDefault(_engine);\n\nvar _proactive = __webpack_require__(/*! ./proactive */ \"./src/renderers/proactive.js\");\n\nvar _proactive2 = _interopRequireDefault(_proactive);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * The Content Renderer is in charge of transforming an {@link ContentManager~Element}\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * into a channel-specific object.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @namespace ContentRenderer\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * bp.renderers\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */\n\nmodule.exports = function (_ref) {\n  var logger = _ref.logger,\n      middlewares = _ref.middlewares,\n      db = _ref.db,\n      contentManager = _ref.contentManager,\n      botfile = _ref.botfile;\n\n  var processors = {}; // A map of all the platforms that can process outgoing messages\n  var renderers = {}; // A map of all the registered renderers\n\n  var registerChannel = function registerChannel(_ref2) {\n    var platform = _ref2.platform,\n        processOutgoing = _ref2.processOutgoing;\n\n    if (!_lodash2.default.isString(platform)) {\n      throw new Error('[Renderers] Platform must be a string, got: ' + platform + '.');\n    }\n    if (processors[platform]) {\n      throw new Error('[Renderers] Platform should only be registered once, platform: ' + platform + '.');\n    }\n    if (!_lodash2.default.isFunction(processOutgoing)) {\n      throw new Error('[Renderers] processOutgoing must be a function, platform: ' + platform + '.');\n    }\n\n    logger.verbose('[Renderers] Enabled for ' + platform + '.');\n\n    processors[platform] = processOutgoing;\n  };\n\n  /**\n   * @callback Renderer\n   * @memberof! ContentRenderer\n   * @example\n   * bp.renderers.register('#text', data => ({ text: data.englishText }))\n   */\n\n  /**\n   * Registers a new renderer\n   * @param  {String} name Unique name of the renderer (e.g. `#text`).\n   * @param  {ContentRenderer.Renderer} rendererFn The rendering function\n   * @memberOf! ContentRenderer\n   */\n  var register = function register(name, rendererFn) {\n    if (!_lodash2.default.isString(name)) {\n      throw new Error('Renderer name must be a string, received ' + name);\n    }\n    if (name.startsWith('#')) {\n      name = name.substr(1);\n    }\n\n    renderers[name] = rendererFn;\n  };\n\n  /**\n   * Removes a specific renderer if it exists\n   * @param  {String} name Unique name of the renderer (e.g. `#text`)\n   * @memberOf! ContentRenderer\n   */\n  var unregister = function unregister(name) {\n    if (!_lodash2.default.isString(name)) {\n      throw new Error('Renderer name must be a string, received ' + name);\n    }\n    if (name.startsWith('#')) {\n      name = name.substr(1);\n    }\n    delete renderers[name];\n  };\n\n  /**\n   * Returns whether or not a renderer is already registered\n   * @param  {String} name Unique name of the renderer (e.g. `#text`)\n   * @return {Boolean}\n   * @memberOf! ContentRenderer\n   */\n  var isRegistered = function isRegistered(name) {\n    if (!_lodash2.default.isString(name)) {\n      throw new Error('Renderer name must be a string, received ' + name);\n    }\n    if (name.startsWith('#')) {\n      name = name.substr(1);\n    }\n    return !!renderers[name];\n  };\n\n  var invoke = function invoke(_ref3) {\n    var rendererFn = _ref3.rendererFn,\n        rendererName = _ref3.rendererName,\n        context = _ref3.context,\n        outputPlatform = _ref3.outputPlatform,\n        _ref3$incomingEvent = _ref3.incomingEvent,\n        incomingEvent = _ref3$incomingEvent === undefined ? null : _ref3$incomingEvent;\n\n    // TODO throw if incomingEvents null <<<==== MOCK IT\n\n    var options = {\n      throwIfNoPlatform: true,\n      currentPlatform: outputPlatform\n    };\n\n    return (0, _engine2.default)({ rendererFn: rendererFn, rendererName: rendererName, context: context, options: options, processors: processors, incomingEvent: incomingEvent });\n  };\n\n  var doSendContent = function doSendContent(rendererFn, _ref4) {\n    var rendererName = _ref4.rendererName,\n        context = _ref4.context,\n        outputPlatform = _ref4.outputPlatform,\n        incomingEvent = _ref4.incomingEvent;\n\n    var messages = invoke({ rendererFn: rendererFn, rendererName: rendererName, context: context, outputPlatform: outputPlatform, incomingEvent: incomingEvent });\n\n    return _bluebird2.default.mapSeries(messages, function (message) {\n      if (message.__internal) {\n        if (message.type === 'wait') {\n          return _bluebird2.default.delay(message.wait);\n        }\n      } else {\n        return middlewares.sendOutgoing(message);\n      }\n    });\n  };\n\n  var sendContent = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(incomingEvent, rendererName) {\n      var additionalData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var initialData, itemName, contentItem, itemCategoryId, itemCategory, itemRenderer, fullContext, renderer, error;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              rendererName = rendererName.startsWith('#') ? rendererName.substr(1) : rendererName;\n\n              // \"magic\" constants that can be used in the renderers\n              initialData = {\n                BOT_URL: botfile.botUrl\n              };\n\n              if (!rendererName.startsWith('!')) {\n                _context.next = 18;\n                break;\n              }\n\n              itemName = rendererName.substr(1);\n              _context.next = 6;\n              return contentManager.getItem(itemName);\n\n            case 6:\n              contentItem = _context.sent;\n\n              if (contentItem) {\n                _context.next = 9;\n                break;\n              }\n\n              throw new Error('Could not find content item with ID \"' + itemName + '\" in the Content Manager');\n\n            case 9:\n              itemCategoryId = contentItem.categoryId;\n              itemCategory = contentManager.getCategorySchema(itemCategoryId);\n\n              if (itemCategory) {\n                _context.next = 13;\n                break;\n              }\n\n              throw new Error('Could not find category \"' + itemCategoryId + '\" in the Content Manager' + (' for item with ID \"' + itemName + '\"'));\n\n            case 13:\n              itemRenderer = itemCategory.renderer;\n\n              if (!(!_lodash2.default.isString(itemRenderer) || !itemRenderer.startsWith('#') || itemRenderer.length <= 1)) {\n                _context.next = 16;\n                break;\n              }\n\n              throw new Error('Invalid renderer \\'' + itemRenderer + '\\' in category \\'' + itemCategoryId + '\\' of Content Manager.\\n         A renderer must start with \\'#\\'');\n\n            case 16:\n\n              rendererName = itemRenderer.substr(1);\n              Object.assign(initialData, _lodash2.default.isArray(contentItem.data) ? { items: contentItem.data } : contentItem.data);\n\n            case 18:\n              fullContext = Object.assign(initialData, {\n                user: incomingEvent.user,\n                event: _lodash2.default.pick(incomingEvent, ['raw', 'text', 'type', 'platform', 'user'])\n              }, additionalData);\n              renderer = renderers[rendererName];\n\n              if (renderer) {\n                _context.next = 24;\n                break;\n              }\n\n              error = '[Renderer] Renderer not defined (#' + rendererName + ')';\n\n              logger.error(error);\n              throw new Error(error);\n\n            case 24:\n              _context.next = 26;\n              return doSendContent(renderer, {\n                rendererName: rendererName,\n                context: fullContext,\n                outputPlatform: incomingEvent.platform,\n                incomingEvent: incomingEvent\n              });\n\n            case 26:\n              return _context.abrupt('return', {\n                renderer: rendererName,\n                context: fullContext,\n                outputPlatform: incomingEvent.platform\n              });\n\n            case 27:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function sendContent(_x, _x2) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var processIncoming = function processIncoming(event, next) {\n    event.reply = function (rendererName) {\n      var additionalData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      return sendContent(event, rendererName, additionalData);\n    };\n\n    next();\n  };\n\n  var incomingMiddleware = {\n    name: 'rendering.instrumentation',\n    type: 'incoming',\n    order: 2, // Should really be first\n    module: 'botpress',\n    description: 'Built-in Botpress middleware that adds a `.reply` to events. Works with renderers.',\n    handler: processIncoming\n  };\n\n  var proactiveMethods = (0, _proactive2.default)({ sendContent: sendContent, db: db });\n\n  return _extends({\n    registerChannel: registerChannel,\n    registerConnector: registerChannel, // DEPRECATED Use \"channel\" instead of \"connector\"\n    register: register,\n    unregister: unregister,\n    isRegistered: isRegistered,\n    incomingMiddleware: incomingMiddleware\n  }, proactiveMethods);\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcmVuZGVyZXJzL2luZGV4LmpzP2Y5MjgiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImxvZ2dlciIsIm1pZGRsZXdhcmVzIiwiZGIiLCJjb250ZW50TWFuYWdlciIsImJvdGZpbGUiLCJwcm9jZXNzb3JzIiwicmVuZGVyZXJzIiwicmVnaXN0ZXJDaGFubmVsIiwicGxhdGZvcm0iLCJwcm9jZXNzT3V0Z29pbmciLCJfIiwiaXNTdHJpbmciLCJFcnJvciIsImlzRnVuY3Rpb24iLCJ2ZXJib3NlIiwicmVnaXN0ZXIiLCJuYW1lIiwicmVuZGVyZXJGbiIsInN0YXJ0c1dpdGgiLCJzdWJzdHIiLCJ1bnJlZ2lzdGVyIiwiaXNSZWdpc3RlcmVkIiwiaW52b2tlIiwicmVuZGVyZXJOYW1lIiwiY29udGV4dCIsIm91dHB1dFBsYXRmb3JtIiwiaW5jb21pbmdFdmVudCIsIm9wdGlvbnMiLCJ0aHJvd0lmTm9QbGF0Zm9ybSIsImN1cnJlbnRQbGF0Zm9ybSIsImRvU2VuZENvbnRlbnQiLCJtZXNzYWdlcyIsIlByb21pc2UiLCJtYXBTZXJpZXMiLCJtZXNzYWdlIiwiX19pbnRlcm5hbCIsInR5cGUiLCJkZWxheSIsIndhaXQiLCJzZW5kT3V0Z29pbmciLCJzZW5kQ29udGVudCIsImFkZGl0aW9uYWxEYXRhIiwiaW5pdGlhbERhdGEiLCJCT1RfVVJMIiwiYm90VXJsIiwiaXRlbU5hbWUiLCJnZXRJdGVtIiwiY29udGVudEl0ZW0iLCJpdGVtQ2F0ZWdvcnlJZCIsImNhdGVnb3J5SWQiLCJpdGVtQ2F0ZWdvcnkiLCJnZXRDYXRlZ29yeVNjaGVtYSIsIml0ZW1SZW5kZXJlciIsInJlbmRlcmVyIiwibGVuZ3RoIiwiT2JqZWN0IiwiYXNzaWduIiwiaXNBcnJheSIsImRhdGEiLCJpdGVtcyIsImZ1bGxDb250ZXh0IiwidXNlciIsImV2ZW50IiwicGljayIsImVycm9yIiwicHJvY2Vzc0luY29taW5nIiwibmV4dCIsInJlcGx5IiwiaW5jb21pbmdNaWRkbGV3YXJlIiwib3JkZXIiLCJkZXNjcmlwdGlvbiIsImhhbmRsZXIiLCJwcm9hY3RpdmVNZXRob2RzIiwicmVnaXN0ZXJDb25uZWN0b3IiXSwibWFwcGluZ3MiOiI7Ozs7QUFRQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7Ozs7O2llQVpBOzs7Ozs7OztBQWNBQSxPQUFPQyxPQUFQLEdBQWlCLGdCQUEwRDtBQUFBLE1BQXZEQyxNQUF1RCxRQUF2REEsTUFBdUQ7QUFBQSxNQUEvQ0MsV0FBK0MsUUFBL0NBLFdBQStDO0FBQUEsTUFBbENDLEVBQWtDLFFBQWxDQSxFQUFrQztBQUFBLE1BQTlCQyxjQUE4QixRQUE5QkEsY0FBOEI7QUFBQSxNQUFkQyxPQUFjLFFBQWRBLE9BQWM7O0FBQ3pFLE1BQU1DLGFBQWEsRUFBbkIsQ0FEeUUsQ0FDbkQ7QUFDdEIsTUFBTUMsWUFBWSxFQUFsQixDQUZ5RSxDQUVwRDs7QUFFckIsTUFBTUMsa0JBQWtCLFNBQWxCQSxlQUFrQixRQUFtQztBQUFBLFFBQWhDQyxRQUFnQyxTQUFoQ0EsUUFBZ0M7QUFBQSxRQUF0QkMsZUFBc0IsU0FBdEJBLGVBQXNCOztBQUN6RCxRQUFJLENBQUNDLGlCQUFFQyxRQUFGLENBQVdILFFBQVgsQ0FBTCxFQUEyQjtBQUN6QixZQUFNLElBQUlJLEtBQUosa0RBQXlESixRQUF6RCxPQUFOO0FBQ0Q7QUFDRCxRQUFJSCxXQUFXRyxRQUFYLENBQUosRUFBMEI7QUFDeEIsWUFBTSxJQUFJSSxLQUFKLHFFQUE0RUosUUFBNUUsT0FBTjtBQUNEO0FBQ0QsUUFBSSxDQUFDRSxpQkFBRUcsVUFBRixDQUFhSixlQUFiLENBQUwsRUFBb0M7QUFDbEMsWUFBTSxJQUFJRyxLQUFKLGdFQUF1RUosUUFBdkUsT0FBTjtBQUNEOztBQUVEUixXQUFPYyxPQUFQLDhCQUEwQ04sUUFBMUM7O0FBRUFILGVBQVdHLFFBQVgsSUFBdUJDLGVBQXZCO0FBQ0QsR0FkRDs7QUFnQkE7Ozs7Ozs7QUFPQTs7Ozs7O0FBTUEsTUFBTU0sV0FBVyxTQUFYQSxRQUFXLENB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aUI7QUFDdkNKLFVBQU1LLEtBQU4sR0FBYyxVQUFDNUMsWUFBRCxFQUF1QztBQUFBLFVBQXhCa0IsY0FBd0IsdUVBQVAsRUFBTzs7QUFDbkQsYUFBT0QsWUFBWXNCLEtBQVosRUFBbUJ2QyxZQUFuQixFQUFpQ2tCLGNBQWpDLENBQVA7QUFDRCxLQUZEOztBQUlBeUI7QUFDRCxHQU5EOztBQVFBLE1BQU1FLHFCQUFxQjtBQUN6QnBELFVBQU0sMkJBRG1CO0FBRXpCb0IsVUFBTSxVQUZtQjtBQUd6QmlDLFdBQU8sQ0FIa0IsRUFHZjtBQUNWdkUsWUFBUSxVQUppQjtBQUt6QndFLGlCQUFhLG9GQUxZO0FBTXpCQyxhQUFTTjtBQU5nQixHQUEzQjs7QUFTQSxNQUFNTyxtQkFBbUIseUJBQVUsRUFBRWhDLHdCQUFGLEVBQWV0QyxNQUFmLEVBQVYsQ0FBekI7O0FBRUE7QUFDRUssb0NBREY7QUFFRWtFLHVCQUFtQmxFLGVBRnJCLEVBRXNDO0FBQ3BDUSxzQkFIRjtBQUlFSywwQkFKRjtBQUtFQyw4QkFMRjtBQU1FK0M7QUFORixLQU9LSSxnQkFQTDtBQVNELENBbk1EIiwiZmlsZSI6Ii4vc3JjL3JlbmRlcmVycy9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGhlIENvbnRlbnQgUmVuZGVyZXIgaXMgaW4gY2hhcmdlIG9mIHRyYW5zZm9ybWluZyBhbiB7QGxpbmsgQ29udGVudE1hbmFnZXJ+RWxlbWVudH1cbiAqIGludG8gYSBjaGFubmVsLXNwZWNpZmljIG9iamVjdC5cbiAqIEBuYW1lc3BhY2UgQ29udGVudFJlbmRlcmVyXG4gKiBAZXhhbXBsZVxuICogYnAucmVuZGVyZXJzXG4gKi9cblxuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmltcG9ydCBFbmdpbmUgZnJvbSAnLi9lbmdpbmUnXG5pbXBvcnQgUHJvYWN0aXZlIGZyb20gJy4vcHJvYWN0aXZlJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IGxvZ2dlciwgbWlkZGxld2FyZXMsIGRiLCBjb250ZW50TWFuYWdlciwgYm90ZmlsZSB9KSA9PiB7XG4gIGNvbnN0IHByb2Nlc3NvcnMgPSB7fSAvLyBBIG1hcCBvZiBhbGwgdGhlIHBsYXRmb3JtcyB0aGF0IGNhbiBwcm9jZXNzIG91dGdvaW5nIG1lc3NhZ2VzXG4gIGNvbnN0IHJlbmRlcmVycyA9IHt9IC8vIEEgbWFwIG9mIGFsbCB0aGUgcmVnaXN0ZXJlZCByZW5kZXJlcnNcblxuICBjb25zdCByZWdpc3RlckNoYW5uZWwgPSAoeyBwbGF0Zm9ybSwgcHJvY2Vzc091dGdvaW5nIH0pID0+IHtcbiAgICBpZiAoIV8uaXNTdHJpbmcocGxhdGZvcm0pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFtSZW5kZXJlcnNdIFBsYXRmb3JtIG11c3QgYmUgYSBzdHJpbmcsIGdvdDogJHtwbGF0Zm9ybX0uYClcbiAgICB9XG4gICAgaWYgKHByb2Nlc3NvcnNbcGxhdGZvcm1dKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFtSZW5kZXJlcnNdIFBsYXRmb3JtIHNob3VsZCBvbmx5IGJlIHJlZ2lzdGVyZWQgb25jZSwgcGxhdGZvcm06ICR7cGxhdGZvcm19LmApXG4gICAgfVxuICAgIGlmICghXy5pc0Z1bmN0aW9uKHByb2Nlc3NPdXRnb2luZykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgW1JlbmRlcmVyc10gcHJvY2Vzc091dGdvaW5nIG11c3QgYmUgYSBmdW5jdGlvbiwgcGxhdGZvcm06ICR7cGxhdGZvcm19LmApXG4gICAgfVxuXG4gICAgbG9nZ2VyLnZlcmJvc2UoYFtSZW5kZXJlcnNdIEVuYWJsZWQgZm9yICR7cGxhdGZvcm19LmApXG5cbiAgICBwcm9jZXNzb3JzW3BsYXRmb3JtXSA9IHByb2Nlc3NPdXRnb2luZ1xuICB9XG5cbiAgLyoqXG4gICAqIEBjYWxsYmFjayBSZW5kZXJlclxuICAgKiBAbWVtYmVyb2YhIENvbnRlbnRSZW5kZXJlclxuICAgKiBAZXhhbXBsZVxuICAgKiBicC5yZW5kZXJlcnMucmVnaXN0ZXIoJyN0ZXh0JywgZGF0YSA9PiAoeyB0ZXh0OiBkYXRhLmVuZ2xpc2hUZXh0IH0pKVxuICAgKi9cblxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgbmV3IHJlbmRlcmVyXG4gICAqIEBwYXJhbSAge1N0cmluZ30gbmFtZSBVbmlxdWUgbmFtZSBvZiB0aGUgcmVuZGVyZXIgKGUuZy4gYCN0ZXh0YCkuXG4gICAqIEBwYXJhbSAge0NvbnRlbnRSZW5kZXJlci5SZW5kZXJlcn0gcmVuZGVyZXJGbiBUaGUgcmVuZGVyaW5nIGZ1bmN0aW9uXG4gICAqIEBtZW1iZXJPZiEgQ29udGVudFJlbmRlcmVyXG4gICAqL1xuICBjb25zdCByZWdpc3RlciA9IChuYW1lLCByZW5kZXJlckZuKSA9PiB7XG4gICAgaWYgKCFfLmlzU3RyaW5nKG5hbWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFJlbmRlcmVyIG5hbWUgbXVzdCBiZSBhIHN0cmluZywgcmVjZWl2ZWQgJHtuYW1lfWApXG4gICAgfVxuICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyKDEpXG4gICAgfVxuXG4gICAgcmVuZGVyZXJzW25hbWVdID0gcmVuZGVyZXJGblxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgYSBzcGVjaWZpYyByZW5kZXJlciBpZiBpdCBleGlzdHNcbiAgICogQHBhcmFtICB7U3RyaW5nfSBuYW1lIFVuaXF1ZSBuYW1lIG9mIHRoZSByZW5kZXJlciAoZS5nLiBgI3RleHRgKVxuICAgKiBAbWVtYmVyT2YhIENvbnRlbnRSZW5kZXJlclxuICAgKi9cbiAgY29uc3QgdW5yZWdpc3RlciA9IG5hbWUgPT4ge1xuICAgIGlmICghXy5pc1N0cmluZyhuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZW5kZXJlciBuYW1lIG11c3QgYmUgYSBzdHJpbmcsIHJlY2VpdmVkICR7bmFtZX1gKVxuICAgIH1cbiAgICBpZiAobmFtZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cigxKVxuICAgIH1cbiAgICBkZWxldGUgcmVuZGVyZXJzW25hbWVdXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCBhIHJlbmRlcmVyIGlzIGFscmVhZHkgcmVnaXN0ZXJlZFxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IG5hbWUgVW5pcXVlIG5hbWUgb2YgdGhlIHJlbmRlcmVyIChlLmcuIGAjdGV4dGApXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAqIEBtZW1iZXJPZiEgQ29udGVudFJlbmRlcmVyXG4gICAqL1xuICBjb25zdCBpc1JlZ2lzdGVyZWQgPSBuYW1lID0+IHtcbiAgICBpZiAoIV8uaXNTdHJpbmcobmFtZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUmVuZGVyZXIgbmFtZSBtdXN0IGJlIGEgc3RyaW5nLCByZWNlaXZlZCAke25hbWV9YClcbiAgICB9XG4gICAgaWYgKG5hbWUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICBuYW1lID0gbmFtZS5zdWJzdHIoMSlcbiAgICB9XG4gICAgcmV0dXJuICEhcmVuZGVyZXJzW25hbWVdXG4gIH1cblxuICBjb25zdCBpbnZva2UgPSAoeyByZW5kZXJlckZuLCByZW5kZXJlck5hbWUsIGNvbnRleHQsIG91dHB1dFBsYXRmb3JtLCBpbmNvbWluZ0V2ZW50ID0gbnVsbCB9KSA9PiB7XG4gICAgLy8gVE9ETyB0aHJvdyBpZiBpbmNvbWluZ0V2ZW50cyBudWxsIDw8PD09PT0gTU9DSyBJVFxuXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIHRocm93SWZOb1BsYXRmb3JtOiB0cnVlLFxuICAgICAgY3VycmVudFBsYXRmb3JtOiBvdXRwdXRQbGF0Zm9ybVxuICAgIH1cblxuICAgIHJldHVybiBFbmdpbmUoeyByZW5kZXJlckZuLCByZW5kZXJlck5hbWUsIGNvbnRleHQsIG9wdGlvbnMsIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQgfSlcbiAgfVxuXG4gIGNvbnN0IGRvU2VuZENvbnRlbnQgPSAocmVuZGVyZXJGbiwgeyByZW5kZXJlck5hbWUsIGNvbnRleHQsIG91dHB1dFBsYXRmb3JtLCBpbmNvbWluZ0V2ZW50IH0pID0+IHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IGludm9rZSh7IHJlbmRlcmVyRm4sIHJlbmRlcmVyTmFtZSwgY29udGV4dCwgb3V0cHV0UGxhdGZvcm0sIGluY29taW5nRXZlbnQgfSlcblxuICAgIHJldHVybiBQcm9taXNlLm1hcFNlcmllcyhtZXNzYWdlcywgbWVzc2FnZSA9PiB7XG4gICAgICBpZiAobWVzc2FnZS5fX2ludGVybmFsKSB7XG4gICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICd3YWl0Jykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLmRlbGF5KG1lc3NhZ2Uud2FpdClcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG1pZGRsZXdhcmVzLnNlbmRPdXRnb2luZyhtZXNzYWdlKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBjb25zdCBzZW5kQ29udGVudCA9IGFzeW5jIChpbmNvbWluZ0V2ZW50LCByZW5kZXJlck5hbWUsIGFkZGl0aW9uYWxEYXRhID0ge30pID0+IHtcbiAgICByZW5kZXJlck5hbWUgPSByZW5kZXJlck5hbWUuc3RhcnRzV2l0aCgnIycpID8gcmVuZGVyZXJOYW1lLnN1YnN0cigxKSA6IHJlbmRlcmVyTmFtZVxuXG4gICAgLy8gXCJtYWdpY1wiIGNvbnN0YW50cyB0aGF0IGNhbiBiZSB1c2VkIGluIHRoZSByZW5kZXJlcnNcbiAgICBjb25zdCBpbml0aWFsRGF0YSA9IHtcbiAgICAgIEJPVF9VUkw6IGJvdGZpbGUuYm90VXJsXG4gICAgfVxuXG4gICAgaWYgKHJlbmRlcmVyTmFtZS5zdGFydHNXaXRoKCchJykpIHtcbiAgICAgIGNvbnN0IGl0ZW1OYW1lID0gcmVuZGVyZXJOYW1lLnN1YnN0cigxKVxuICAgICAgY29uc3QgY29udGVudEl0ZW0gPSBhd2FpdCBjb250ZW50TWFuYWdlci5nZXRJdGVtKGl0ZW1OYW1lKVxuXG4gICAgICBpZiAoIWNvbnRlbnRJdGVtKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgY29udGVudCBpdGVtIHdpdGggSUQgXCIke2l0ZW1OYW1lfVwiIGluIHRoZSBDb250ZW50IE1hbmFnZXJgKVxuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGNhdGVnb3J5SWQ6IGl0ZW1DYXRlZ29yeUlkIH0gPSBjb250ZW50SXRlbVxuXG4gICAgICBjb25zdCBpdGVtQ2F0ZWdvcnkgPSBjb250ZW50TWFuYWdlci5nZXRDYXRlZ29yeVNjaGVtYShpdGVtQ2F0ZWdvcnlJZClcblxuICAgICAgaWYgKCFpdGVtQ2F0ZWdvcnkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIGBDb3VsZCBub3QgZmluZCBjYXRlZ29yeSBcIiR7aXRlbUNhdGVnb3J5SWR9XCIgaW4gdGhlIENvbnRlbnQgTWFuYWdlcmAgKyBgIGZvciBpdGVtIHdpdGggSUQgXCIke2l0ZW1OYW1lfVwiYFxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGl0ZW1SZW5kZXJlciA9IGl0ZW1DYXRlZ29yeS5yZW5kZXJlclxuICAgICAgaWYgKCFfLmlzU3RyaW5nKGl0ZW1SZW5kZXJlcikgfHwgIWl0ZW1SZW5kZXJlci5zdGFydHNXaXRoKCcjJykgfHwgaXRlbVJlbmRlcmVyLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCByZW5kZXJlciAnJHtpdGVtUmVuZGVyZXJ9JyBpbiBjYXRlZ29yeSAnJHtpdGVtQ2F0ZWdvcnlJZH0nIG9mIENvbnRlbnQgTWFuYWdlci5cbiAgICAgICAgIEEgcmVuZGVyZXIgbXVzdCBzdGFydCB3aXRoICcjJ2ApXG4gICAgICB9XG5cbiAgICAgIHJlbmRlcmVyTmFtZSA9IGl0ZW1SZW5kZXJlci5zdWJzdHIoMSlcbiAgICAgIE9iamVjdC5hc3NpZ24oaW5pdGlhbERhdGEsIF8uaXNBcnJheShjb250ZW50SXRlbS5kYXRhKSA/IHsgaXRlbXM6IGNvbnRlbnRJdGVtLmRhdGEgfSA6IGNvbnRlbnRJdGVtLmRhdGEpXG4gICAgfVxuXG4gICAgY29uc3QgZnVsbENvbnRleHQgPSBPYmplY3QuYXNzaWduKFxuICAgICAgaW5pdGlhbERhdGEsXG4gICAgICB7XG4gICAgICAgIHVzZXI6IGluY29taW5nRXZlbnQudXNlcixcbiAgICAgICAgZXZlbnQ6IF8ucGljayhpbmNvbWluZ0V2ZW50LCBbJ3JhdycsICd0ZXh0JywgJ3R5cGUnLCAncGxhdGZvcm0nLCAndXNlciddKVxuICAgICAgfSxcbiAgICAgIGFkZGl0aW9uYWxEYXRhXG4gICAgKVxuXG4gICAgY29uc3QgcmVuZGVyZXIgPSByZW5kZXJlcnNbcmVuZGVyZXJOYW1lXVxuXG4gICAgaWYgKCFyZW5kZXJlcikge1xuICAgICAgY29uc3QgZXJyb3IgPSBgW1JlbmRlcmVyXSBSZW5kZXJlciBub3QgZGVmaW5lZCAoIyR7cmVuZGVyZXJOYW1lfSlgXG4gICAgICBsb2dnZXIuZXJyb3IoZXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpXG4gICAgfVxuXG4gICAgYXdhaXQgZG9TZW5kQ29udGVudChyZW5kZXJlciwge1xuICAgICAgcmVuZGVyZXJOYW1lLFxuICAgICAgY29udGV4dDogZnVsbENvbnRleHQsXG4gICAgICBvdXRwdXRQbGF0Zm9ybTogaW5jb21pbmdFdmVudC5wbGF0Zm9ybSxcbiAgICAgIGluY29taW5nRXZlbnRcbiAgICB9KVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlbmRlcmVyOiByZW5kZXJlck5hbWUsXG4gICAgICBjb250ZXh0OiBmdWxsQ29udGV4dCxcbiAgICAgIG91dHB1dFBsYXRmb3JtOiBpbmNvbWluZ0V2ZW50LnBsYXRmb3JtXG4gICAgfVxuICB9XG5cbiAgY29uc3QgcHJvY2Vzc0luY29taW5nID0gKGV2ZW50LCBuZXh0KSA9PiB7XG4gICAgZXZlbnQucmVwbHkgPSAocmVuZGVyZXJOYW1lLCBhZGRpdGlvbmFsRGF0YSA9IHt9KSA9PiB7XG4gICAgICByZXR1cm4gc2VuZENvbnRlbnQoZXZlbnQsIHJlbmRlcmVyTmFtZSwgYWRkaXRpb25hbERhdGEpXG4gICAgfVxuXG4gICAgbmV4dCgpXG4gIH1cblxuICBjb25zdCBpbmNvbWluZ01pZGRsZXdhcmUgPSB7XG4gICAgbmFtZTogJ3JlbmRlcmluZy5pbnN0cnVtZW50YXRpb24nLFxuICAgIHR5cGU6ICdpbmNvbWluZycsXG4gICAgb3JkZXI6IDIsIC8vIFNob3VsZCByZWFsbHkgYmUgZmlyc3RcbiAgICBtb2R1bGU6ICdib3RwcmVzcycsXG4gICAgZGVzY3JpcHRpb246ICdCdWlsdC1pbiBCb3RwcmVzcyBtaWRkbGV3YXJlIHRoYXQgYWRkcyBhIGAucmVwbHlgIHRvIGV2ZW50cy4gV29ya3Mgd2l0aCByZW5kZXJlcnMuJyxcbiAgICBoYW5kbGVyOiBwcm9jZXNzSW5jb21pbmdcbiAgfVxuXG4gIGNvbnN0IHByb2FjdGl2ZU1ldGhvZHMgPSBQcm9hY3RpdmUoeyBzZW5kQ29udGVudCwgZGIgfSlcblxuICByZXR1cm4ge1xuICAgIHJlZ2lzdGVyQ2hhbm5lbCxcbiAgICByZWdpc3RlckNvbm5lY3RvcjogcmVnaXN0ZXJDaGFubmVsLCAvLyBERVBSRUNBVEVEIFVzZSBcImNoYW5uZWxcIiBpbnN0ZWFkIG9mIFwiY29ubmVjdG9yXCJcbiAgICByZWdpc3RlcixcbiAgICB1bnJlZ2lzdGVyLFxuICAgIGlzUmVnaXN0ZXJlZCxcbiAgICBpbmNvbWluZ01pZGRsZXdhcmUsXG4gICAgLi4ucHJvYWN0aXZlTWV0aG9kc1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/renderers/index.js\n");

/***/ }),

/***/ "./src/renderers/proactive.js":
/*!************************************!*\
  !*** ./src/renderers/proactive.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(/*! util */ \"util\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var sendContent = _ref.sendContent,\n      db = _ref.db;\n\n  var getUser = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(id) {\n      var knex, users;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context.sent;\n              _context.next = 5;\n              return knex('users').where({ id: id }).orWhere('userId', id).limit(1).select('*');\n\n            case 5:\n              users = _context.sent;\n\n              if (!(!users || users.length <= 0)) {\n                _context.next = 8;\n                break;\n              }\n\n              throw new Error('User \"' + id + '\" not found in the database');\n\n            case 8:\n              return _context.abrupt('return', users[0]);\n\n            case 9:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function getUser(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Proactively sends a user a message\n   * @param  {string|object} user id or a full user object\n   * @param  {string} elementOrRenderer The name of the renderer to use OR an element id\n   * @param  {object} data Additionnal data that will be passed to the renderer\n   * @async\n   * @memberof! ContentRenderer\n   * @example\n   * bp.renderers.sendToUser(event.user.id, '#!text-77734', { typingIndicators: false })\n   */\n  var sendToUser = function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(user, elementOrRenderer, data) {\n      var text, forgedEvent;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (_lodash2.default.isString(elementOrRenderer)) {\n                _context2.next = 2;\n                break;\n              }\n\n              throw new Error('Invalid renderer: ' + elementOrRenderer);\n\n            case 2:\n              if (!_lodash2.default.isString(user)) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 5;\n              return getUser(user);\n\n            case 5:\n              user = _context2.sent;\n\n            case 6:\n              if (!(!user || !user.id)) {\n                _context2.next = 8;\n                break;\n              }\n\n              throw new Error('Invalid user object: ' + _util2.default.inspect(user));\n\n            case 8:\n              text = 'This is not a real event, it has been forged by proactive.';\n              forgedEvent = {\n                platform: user.platform,\n                user: user,\n                type: 'proactive',\n                text: text,\n                raw: { forged: true, message: text, to: user && user.id }\n              };\n              return _context2.abrupt('return', sendContent(forgedEvent, elementOrRenderer, data));\n\n            case 11:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function sendToUser(_x2, _x3, _x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return { sendToUser: sendToUser };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvcmVuZGVyZXJzL3Byb2FjdGl2ZS5qcz9jZDlhIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJzZW5kQ29udGVudCIsImRiIiwiZ2V0VXNlciIsImlkIiwiZ2V0Iiwia25leCIsIndoZXJlIiwib3JXaGVyZSIsImxpbWl0Iiwic2VsZWN0IiwidXNlcnMiLCJsZW5ndGgiLCJFcnJvciIsInNlbmRUb1VzZXIiLCJ1c2VyIiwiZWxlbWVudE9yUmVuZGVyZXIiLCJkYXRhIiwiXyIsImlzU3RyaW5nIiwidXRpbCIsImluc3BlY3QiLCJ0ZXh0IiwiZm9yZ2VkRXZlbnQiLCJwbGF0Zm9ybSIsInR5cGUiLCJyYXciLCJmb3JnZWQiLCJtZXNzYWdlIiwidG8iXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFFQTs7OztBQUNBOzs7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLGdCQUF5QjtBQUFBLE1BQXRCQyxXQUFzQixRQUF0QkEsV0FBc0I7QUFBQSxNQUFUQyxFQUFTLFFBQVRBLEVBQVM7O0FBQ3hDLE1BQU1DO0FBQUEsd0VBQVUsaUJBQU1DLEVBQU47QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxxQkFDS0YsR0FBR0csR0FBSCxFQURMOztBQUFBO0FBQ1JDLGtCQURRO0FBQUE7QUFBQSxxQkFFTUEsS0FBSyxPQUFMLEVBQ2pCQyxLQURpQixDQUNYLEVBQUVILElBQUlBLEVBQU4sRUFEVyxFQUVqQkksT0FGaUIsQ0FFVCxRQUZTLEVBRUNKLEVBRkQsRUFHakJLLEtBSGlCLENBR1gsQ0FIVyxFQUlqQkMsTUFKaUIsQ0FJVixHQUpVLENBRk47O0FBQUE7QUFFUkMsbUJBRlE7O0FBQUEsb0JBUVYsQ0FBQ0EsS0FBRCxJQUFVQSxNQUFNQyxNQUFOLElBQWdCLENBUmhCO0FBQUE7QUFBQTtBQUFBOztBQUFBLG9CQVNOLElBQUlDLEtBQUosWUFBbUJULEVBQW5CLGlDQVRNOztBQUFBO0FBQUEsK0NBWVBPLE1BQU0sQ0FBTixDQVpPOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQVY7O0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBTjs7QUFlQTs7Ozs7Ozs7OztBQVVBLE1BQU1HO0FBQUEsd0VBQWEsa0JBQU9DLElBQVAsRUFBYUMsaUJBQWIsRUFBZ0NDLElBQWhDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGtCQUNaQyxpQkFBRUMsUUFBRixDQUFXSCxpQkFBWCxDQURZO0FBQUE7QUFBQTtBQUFBOztBQUFBLG9CQUVULElBQUlILEtBQUosQ0FBVSx1QkFBdUJHLGlCQUFqQyxDQUZTOztBQUFBO0FBQUEsbUJBS2JFLGlCQUFFQyxRQUFGLENBQVdKLElBQVgsQ0FMYTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBLHFCQU1GWixRQUFRWSxJQUFSLENBTkU7O0FBQUE7QUFNZkEsa0JBTmU7O0FBQUE7QUFBQSxvQkFTYixDQUFDQSxJQUFELElBQVMsQ0FBQ0EsS0FBS1gsRUFURjtBQUFBO0FBQUE7QUFBQTs7QUFBQSxvQkFVVCxJQUFJUyxLQUFKLENBQVUsMEJBQTBCTyxlQUFLQyxPQUFMLENBQWFOLElBQWIsQ0FBcEMsQ0FWUzs7QUFBQTtBQWFYTyxrQkFiVyxHQWFKLDREQWJJO0FBY1hDLHlCQWRXLEdBY0c7QUFDbEJDLDBCQUFVVCxLQUFLUyxRQURHO0FBRWxCVCxzQkFBTUEsSUFGWTtBQUdsQlUsc0JBQU0sV0FIWTtBQUlsQkgsc0JBQU1BLElBSlk7QUFLbEJJLHFCQUFLLEVBQUVDLFFBQVEsSUFBVixFQUFnQkMsU0FBU04sSUFBekIsRUFBK0JPLElBQUlkLFFBQVFBLEtBQUtYLEVBQWhEO0FBTGEsZUFkSDtBQUFBLGdEQXNCVkgsWUFBWXNCLFdBQVosRUFBeUJQLGlCQUF6QixFQUE0Q0MsSUFBNUMsQ0F0QlU7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBYjs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQXlCQSxTQUFPLEVBQUVILHNCQUFGLEVBQVA7QUFDRCxDQXBERCIsImZpbGUiOiIuL3NyYy9yZW5kZXJlcnMvcHJvYWN0aXZlLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHV0aWwgZnJvbSAndXRpbCdcblxuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbm1vZHVsZS5leHBvcnRzID0gKHsgc2VuZENvbnRlbnQsIGRiIH0pID0+IHtcbiAgY29uc3QgZ2V0VXNlciA9IGFzeW5jIGlkID0+IHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcbiAgICBjb25zdCB1c2VycyA9IGF3YWl0IGtuZXgoJ3VzZXJzJylcbiAgICAgIC53aGVyZSh7IGlkOiBpZCB9KVxuICAgICAgLm9yV2hlcmUoJ3VzZXJJZCcsIGlkKVxuICAgICAgLmxpbWl0KDEpXG4gICAgICAuc2VsZWN0KCcqJylcblxuICAgIGlmICghdXNlcnMgfHwgdXNlcnMubGVuZ3RoIDw9IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVXNlciBcIiR7aWR9XCIgbm90IGZvdW5kIGluIHRoZSBkYXRhYmFzZWApXG4gICAgfVxuXG4gICAgcmV0dXJuIHVzZXJzWzBdXG4gIH1cblxuICAvKipcbiAgICogUHJvYWN0aXZlbHkgc2VuZHMgYSB1c2VyIGEgbWVzc2FnZVxuICAgKiBAcGFyYW0gIHtzdHJpbmd8b2JqZWN0fSB1c2VyIGlkIG9yIGEgZnVsbCB1c2VyIG9iamVjdFxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IGVsZW1lbnRPclJlbmRlcmVyIFRoZSBuYW1lIG9mIHRoZSByZW5kZXJlciB0byB1c2UgT1IgYW4gZWxlbWVudCBpZFxuICAgKiBAcGFyYW0gIHtvYmplY3R9IGRhdGEgQWRkaXRpb25uYWwgZGF0YSB0aGF0IHdpbGwgYmUgcGFzc2VkIHRvIHRoZSByZW5kZXJlclxuICAgKiBAYXN5bmNcbiAgICogQG1lbWJlcm9mISBDb250ZW50UmVuZGVyZXJcbiAgICogQGV4YW1wbGVcbiAgICogYnAucmVuZGVyZXJzLnNlbmRUb1VzZXIoZXZlbnQudXNlci5pZCwgJyMhdGV4dC03NzczNCcsIHsgdHlwaW5nSW5kaWNhdG9yczogZmFsc2UgfSlcbiAgICovXG4gIGNvbnN0IHNlbmRUb1VzZXIgPSBhc3luYyAodXNlciwgZWxlbWVudE9yUmVuZGVyZXIsIGRhdGEpID0+IHtcbiAgICBpZiAoIV8uaXNTdHJpbmcoZWxlbWVudE9yUmVuZGVyZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVuZGVyZXI6ICcgKyBlbGVtZW50T3JSZW5kZXJlcilcbiAgICB9XG5cbiAgICBpZiAoXy5pc1N0cmluZyh1c2VyKSkge1xuICAgICAgdXNlciA9IGF3YWl0IGdldFVzZXIodXNlcilcbiAgICB9XG5cbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB1c2VyIG9iamVjdDogJyArIHV0aWwuaW5zcGVjdCh1c2VyKSlcbiAgICB9XG5cbiAgICBjb25zdCB0ZXh0ID0gJ1RoaXMgaXMgbm90IGEgcmVhbCBldmVudCwgaXQgaGFzIGJlZW4gZm9yZ2VkIGJ5IHByb2FjdGl2ZS4nXG4gICAgY29uc3QgZm9yZ2VkRXZlbnQgPSB7XG4gICAgICBwbGF0Zm9ybTogdXNlci5wbGF0Zm9ybSxcbiAgICAgIHVzZXI6IHVzZXIsXG4gICAgICB0eXBlOiAncHJvYWN0aXZlJyxcbiAgICAgIHRleHQ6IHRleHQsXG4gICAgICByYXc6IHsgZm9yZ2VkOiB0cnVlLCBtZXNzYWdlOiB0ZXh0LCB0bzogdXNlciAmJiB1c2VyLmlkIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc2VuZENvbnRlbnQoZm9yZ2VkRXZlbnQsIGVsZW1lbnRPclJlbmRlcmVyLCBkYXRhKVxuICB9XG5cbiAgcmV0dXJuIHsgc2VuZFRvVXNlciB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/renderers/proactive.js\n");

/***/ }),

/***/ "./src/security/cloud/index.js":
/*!*************************************!*\
  !*** ./src/security/cloud/index.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _jsonwebtoken = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n\nvar _jsonwebtoken2 = _interopRequireDefault(_jsonwebtoken);\n\nvar _provider = __webpack_require__(/*! ../provider */ \"./src/security/provider.js\");\n\nvar _provider2 = _interopRequireDefault(_provider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CloudAuthentication = function (_AbstractAuthenticati) {\n  _inherits(CloudAuthentication, _AbstractAuthenticati);\n\n  function CloudAuthentication(options) {\n    _classCallCheck(this, CloudAuthentication);\n\n    var _this = _possibleConstructorReturn(this, (CloudAuthentication.__proto__ || Object.getPrototypeOf(CloudAuthentication)).call(this, options));\n\n    var _ref = _this.cloud.getPairingInfo() || {},\n        botId = _ref.botId;\n\n    _this.botId = botId;\n    _this.botEnv = _this.cloud.getBotEnv();\n    _this.endpoint = _this.cloud.getCloudEndpoint();\n    return _this;\n  }\n\n  _createClass(CloudAuthentication, [{\n    key: 'login',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt('return', { success: false, reason: 'Root authentication is disabled when using Botpress Cloud [BPCLOUDERR]' });\n\n              case 1:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function login() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'getAuthenticationInfo',\n    value: function getAuthenticationInfo() {\n      return {\n        type: 'cloud',\n        botId: this.botId,\n        botEnv: this.botEnv,\n        endpoint: this.endpoint\n      };\n    }\n  }, {\n    key: 'authenticateWithError',\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(authHeader) {\n        var allowProof = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n        var _authHeader$split, _authHeader$split2, scheme, token, secret, algorithm, decoded;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (authHeader) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw new Error('Missing auth header');\n\n              case 2:\n                _authHeader$split = authHeader.split(' '), _authHeader$split2 = _slicedToArray(_authHeader$split, 2), scheme = _authHeader$split2[0], token = _authHeader$split2[1];\n\n                if (!(scheme.toLowerCase() !== 'bearer')) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw new Error('Wrong scheme \\'' + scheme + '\\', expected Bearer');\n\n              case 5:\n                _context2.next = 7;\n                return this.cloud.getCertificate();\n\n              case 7:\n                secret = _context2.sent;\n                algorithm = 'RS256';\n                decoded = _jsonwebtoken2.default.verify(token, secret, { algorithms: [algorithm] });\n\n                if (!(!allowProof && decoded.identity_proof_only)) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                return _context2.abrupt('return', false);\n\n              case 12:\n                if (!(decoded.aud !== 'urn:bot/' + this.botId)) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                return _context2.abrupt('return', false);\n\n              case 14:\n                return _context2.abrupt('return', decoded.user);\n\n              case 15:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function authenticateWithError(_x) {\n        return _ref3.apply(this, arguments);\n      }\n\n      return authenticateWithError;\n    }()\n  }, {\n    key: 'refreshToken',\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(authHeader) {\n        var _authHeader$split3, _authHeader$split4, scheme, token;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _authHeader$split3 = authHeader.split(' '), _authHeader$split4 = _slicedToArray(_authHeader$split3, 2), scheme = _authHeader$split4[0], token = _authHeader$split4[1];\n\n                if (!(scheme.toLowerCase() !== 'bearer')) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                return _context3.abrupt('return', {\n                  success: false,\n                  reason: 'Wrong scheme \\'' + scheme + '\\', expected Bearer'\n                });\n\n              case 3:\n                return _context3.abrupt('return', {\n                  success: true,\n                  token: token\n                });\n\n              case 4:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function refreshToken(_x3) {\n        return _ref4.apply(this, arguments);\n      }\n\n      return refreshToken;\n    }()\n  }, {\n    key: 'getUserIdentity',\n    value: function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(token) {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt('return', this.authenticateWithError('bearer ' + token, true));\n\n              case 1:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getUserIdentity(_x4) {\n        return _ref5.apply(this, arguments);\n      }\n\n      return getUserIdentity;\n    }()\n  }, {\n    key: 'getJWTSecretOrCertificate',\n    value: function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt('return', this.cloud.getCertificate());\n\n              case 1:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getJWTSecretOrCertificate() {\n        return _ref6.apply(this, arguments);\n      }\n\n      return getJWTSecretOrCertificate;\n    }()\n  }]);\n\n  return CloudAuthentication;\n}(_provider2.default);\n\nexports.default = CloudAuthentication;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VjdXJpdHkvY2xvdWQvaW5kZXguanM/NWRkNyJdLCJuYW1lcyI6WyJDbG91ZEF1dGhlbnRpY2F0aW9uIiwib3B0aW9ucyIsImNsb3VkIiwiZ2V0UGFpcmluZ0luZm8iLCJib3RJZCIsImJvdEVudiIsImdldEJvdEVudiIsImVuZHBvaW50IiwiZ2V0Q2xvdWRFbmRwb2ludCIsInN1Y2Nlc3MiLCJyZWFzb24iLCJ0eXBlIiwiYXV0aEhlYWRlciIsImFsbG93UHJvb2YiLCJFcnJvciIsInNwbGl0Iiwic2NoZW1lIiwidG9rZW4iLCJ0b0xvd2VyQ2FzZSIsImdldENlcnRpZmljYXRlIiwic2VjcmV0IiwiYWxnb3JpdGhtIiwiZGVjb2RlZCIsImp3dCIsInZlcmlmeSIsImFsZ29yaXRobXMiLCJpZGVudGl0eV9wcm9vZl9vbmx5IiwiYXVkIiwidXNlciIsImF1dGhlbnRpY2F0ZVdpdGhFcnJvciIsIkFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7O0FBRUE7Ozs7Ozs7Ozs7Ozs7O0lBRXFCQSxtQjs7O0FBQ25CLCtCQUFZQyxPQUFaLEVBQXFCO0FBQUE7O0FBQUEsMElBQ2JBLE9BRGE7O0FBQUEsZUFHRCxNQUFLQyxLQUFMLENBQVdDLGNBQVgsTUFBK0IsRUFIOUI7QUFBQSxRQUdYQyxLQUhXLFFBR1hBLEtBSFc7O0FBS25CLFVBQUtBLEtBQUwsR0FBYUEsS0FBYjtBQUNBLFVBQUtDLE1BQUwsR0FBYyxNQUFLSCxLQUFMLENBQVdJLFNBQVgsRUFBZDtBQUNBLFVBQUtDLFFBQUwsR0FBZ0IsTUFBS0wsS0FBTCxDQUFXTSxnQkFBWCxFQUFoQjtBQVBtQjtBQVFwQjs7Ozs7Ozs7OztpREFHUSxFQUFFQyxTQUFTLEtBQVgsRUFBa0JDLFFBQVEsd0VBQTFCLEU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs0Q0FHZTtBQUN0QixhQUFPO0FBQ0xDLGNBQU0sT0FERDtBQUVMUCxlQUFPLEtBQUtBLEtBRlA7QUFHTEMsZ0JBQVEsS0FBS0EsTUFIUjtBQUlMRSxrQkFBVSxLQUFLQTtBQUpWLE9BQVA7QUFNRDs7Ozs0RkFFMkJLLFU7WUFBWUMsVSx1RUFBYSxLOzs7Ozs7OztvQkFDOUNELFU7Ozs7O3NCQUNHLElBQUlFLEtBQUosQ0FBVSxxQkFBVixDOzs7b0NBR2dCRixXQUFXRyxLQUFYLENBQWlCLEdBQWpCLEMsNkRBQWpCQyxNLDBCQUFRQyxLOztzQkFFWEQsT0FBT0UsV0FBUCxPQUF5QixROzs7OztzQkFDckIsSUFBSUosS0FBSixxQkFBMkJFLE1BQTNCLHlCOzs7O3VCQUdhLEtBQUtkLEtBQUwsQ0FBV2lCLGNBQVgsRTs7O0FBQWZDLHNCO0FBQ0FDLHlCLEdBQVksTztBQUVaQyx1QixHQUFVQyx1QkFBSUMsTUFBSixDQUFXUCxLQUFYLEVBQWtCRyxNQUFsQixFQUEwQixFQUFFSyxZQUFZLENBQUNKLFNBQUQsQ0FBZCxFQUExQixDOztzQkFFWixDQUFDUixVQUFELElBQWVTLFFBQVFJLG1COzs7OztrREFDbEIsSzs7O3NCQUdMSixRQUFRSyxHQUFSLGtCQUEyQixLQUFLdkIsSzs7Ozs7a0RBQzNCLEs7OztrREFHRmtCLFFBQVFNLEk7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEZBR0VoQixVOzs7Ozs7O3FDQUNPQSxXQUFXRyxLQUFYLENBQWlCLEdBQWpCLEMsOERBQWpCQyxNLDBCQUFRQyxLOztzQkFDWEQsT0FBT0UsV0FBUCxPQUF5QixROzs7OztrREFFcEI7QUFDTFQsMkJBQVMsS0FESjtBQUVMQyw4Q0FBeUJNLE1BQXpCO0FBRkssaUI7OztrREFPRjtBQUNMUCwyQkFBUyxJQURKO0FBRUxRO0FBRkssaUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEZBTWFBLEs7Ozs7O2tEQUNiLEtBQUtZLHFCQUFMLENBQTJCLFlBQVlaLEtBQXZDLEVBQThDLElBQTlDLEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrREFJQSxLQUFLZixLQUFMLENBQVdpQixjQUFYLEU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7RUF6RXNDVyxrQjs7a0JBQTVCOUIsbUIiLCJmaWxlIjoiLi9zcmMvc2VjdXJpdHkvY2xvdWQvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbidcblxuaW1wb3J0IEFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciBmcm9tICcuLi9wcm92aWRlcidcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2xvdWRBdXRoZW50aWNhdGlvbiBleHRlbmRzIEFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKVxuXG4gICAgY29uc3QgeyBib3RJZCB9ID0gdGhpcy5jbG91ZC5nZXRQYWlyaW5nSW5mbygpIHx8IHt9XG5cbiAgICB0aGlzLmJvdElkID0gYm90SWRcbiAgICB0aGlzLmJvdEVudiA9IHRoaXMuY2xvdWQuZ2V0Qm90RW52KClcbiAgICB0aGlzLmVuZHBvaW50ID0gdGhpcy5jbG91ZC5nZXRDbG91ZEVuZHBvaW50KClcbiAgfVxuXG4gIGFzeW5jIGxvZ2luKCkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCByZWFzb246ICdSb290IGF1dGhlbnRpY2F0aW9uIGlzIGRpc2FibGVkIHdoZW4gdXNpbmcgQm90cHJlc3MgQ2xvdWQgW0JQQ0xPVURFUlJdJyB9XG4gIH1cblxuICBnZXRBdXRoZW50aWNhdGlvbkluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdjbG91ZCcsXG4gICAgICBib3RJZDogdGhpcy5ib3RJZCxcbiAgICAgIGJvdEVudjogdGhpcy5ib3RFbnYsXG4gICAgICBlbmRwb2ludDogdGhpcy5lbmRwb2ludFxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGF1dGhlbnRpY2F0ZVdpdGhFcnJvcihhdXRoSGVhZGVyLCBhbGxvd1Byb29mID0gZmFsc2UpIHtcbiAgICBpZiAoIWF1dGhIZWFkZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBhdXRoIGhlYWRlcicpXG4gICAgfVxuXG4gICAgY29uc3QgW3NjaGVtZSwgdG9rZW5dID0gYXV0aEhlYWRlci5zcGxpdCgnICcpXG5cbiAgICBpZiAoc2NoZW1lLnRvTG93ZXJDYXNlKCkgIT09ICdiZWFyZXInKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFdyb25nIHNjaGVtZSAnJHtzY2hlbWV9JywgZXhwZWN0ZWQgQmVhcmVyYClcbiAgICB9XG5cbiAgICBjb25zdCBzZWNyZXQgPSBhd2FpdCB0aGlzLmNsb3VkLmdldENlcnRpZmljYXRlKClcbiAgICBjb25zdCBhbGdvcml0aG0gPSAnUlMyNTYnXG5cbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgc2VjcmV0LCB7IGFsZ29yaXRobXM6IFthbGdvcml0aG1dIH0pXG5cbiAgICBpZiAoIWFsbG93UHJvb2YgJiYgZGVjb2RlZC5pZGVudGl0eV9wcm9vZl9vbmx5KSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoZGVjb2RlZC5hdWQgIT09IGB1cm46Ym90LyR7dGhpcy5ib3RJZH1gKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICByZXR1cm4gZGVjb2RlZC51c2VyXG4gIH1cblxuICBhc3luYyByZWZyZXNoVG9rZW4oYXV0aEhlYWRlcikge1xuICAgIGNvbnN0IFtzY2hlbWUsIHRva2VuXSA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVxuICAgIGlmIChzY2hlbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2JlYXJlcicpIHtcbiAgICAgIC8vIG9ubHkgc3VwcG9ydCBCZWFyZXIgc2NoZW1lXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgcmVhc29uOiBgV3Jvbmcgc2NoZW1lICcke3NjaGVtZX0nLCBleHBlY3RlZCBCZWFyZXJgXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gZG9lc24ndCBtYXR0ZXIsIGNhbiByZXR1cm4gdGhlIHNhbWUgdG9rZW5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHRva2VuXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VXNlcklkZW50aXR5KHRva2VuKSB7XG4gICAgcmV0dXJuIHRoaXMuYXV0aGVudGljYXRlV2l0aEVycm9yKCdiZWFyZXIgJyArIHRva2VuLCB0cnVlKVxuICB9XG5cbiAgYXN5bmMgZ2V0SldUU2VjcmV0T3JDZXJ0aWZpY2F0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jbG91ZC5nZXRDZXJ0aWZpY2F0ZSgpXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/security/cloud/index.js\n");

/***/ }),

/***/ "./src/security/index.js":
/*!*******************************!*\
  !*** ./src/security/index.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _joi = __webpack_require__(/*! joi */ \"joi\");\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nvar _root = __webpack_require__(/*! ./root */ \"./src/security/root/index.js\");\n\nvar _root2 = _interopRequireDefault(_root);\n\nvar _cloud = __webpack_require__(/*! ./cloud */ \"./src/security/cloud/index.js\");\n\nvar _cloud2 = _interopRequireDefault(_cloud);\n\nvar _none = __webpack_require__(/*! ./none */ \"./src/security/none/index.js\");\n\nvar _none2 = _interopRequireDefault(_none);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(options) {\n    var schema, isCloudPaired;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (_util.isDeveloping) {\n              schema = _joi2.default.object().keys({\n                dataLocation: _joi2.default.string().min(1).required(),\n                projectLocation: _joi2.default.string().min(1).required(),\n                securityConfig: _joi2.default.object().required(),\n                db: _joi2.default.object().required(),\n                cloud: _joi2.default.object().required(),\n                logger: _joi2.default.object().required()\n              });\n\n\n              _joi2.default.assert(options, schema, 'Invalid constructor elements for Authentication Provider');\n            }\n\n            _context.t0 = options.securityConfig.useCloud;\n\n            if (!_context.t0) {\n              _context.next = 6;\n              break;\n            }\n\n            _context.next = 5;\n            return options.cloud.isPaired();\n\n          case 5:\n            _context.t0 = _context.sent;\n\n          case 6:\n            isCloudPaired = _context.t0;\n\n            if (options.securityConfig.enabled) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt('return', new _none2.default(options));\n\n          case 9:\n            if (!isCloudPaired) {\n              _context.next = 13;\n              break;\n            }\n\n            return _context.abrupt('return', new _cloud2.default(options));\n\n          case 13:\n            return _context.abrupt('return', new _root2.default(options));\n\n          case 14:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VjdXJpdHkvaW5kZXguanM/NjIyMiJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwib3B0aW9ucyIsImlzRGV2ZWxvcGluZyIsInNjaGVtYSIsIkpvaSIsIm9iamVjdCIsImtleXMiLCJkYXRhTG9jYXRpb24iLCJzdHJpbmciLCJtaW4iLCJyZXF1aXJlZCIsInByb2plY3RMb2NhdGlvbiIsInNlY3VyaXR5Q29uZmlnIiwiZGIiLCJjbG91ZCIsImxvZ2dlciIsImFzc2VydCIsInVzZUNsb3VkIiwiaXNQYWlyZWQiLCJpc0Nsb3VkUGFpcmVkIiwiZW5hYmxlZCIsIk5vbmVBdXRoZW50aWNhdGlvbiIsIkNsb3VkQXV0aGVudGljYXRpb24iLCJSb290QXV0aGVudGljYXRpb24iXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFFQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUFBLE9BQU9DLE9BQVA7QUFBQSxxRUFBaUIsaUJBQU1DLE9BQU47QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ2YsZ0JBQUlDLGtCQUFKLEVBQWtCO0FBQ1ZDLG9CQURVLEdBQ0RDLGNBQUlDLE1BQUosR0FBYUMsSUFBYixDQUFrQjtBQUMvQkMsOEJBQWNILGNBQUlJLE1BQUosR0FDWEMsR0FEVyxDQUNQLENBRE8sRUFFWEMsUUFGVyxFQURpQjtBQUkvQkMsaUNBQWlCUCxjQUFJSSxNQUFKLEdBQ2RDLEdBRGMsQ0FDVixDQURVLEVBRWRDLFFBRmMsRUFKYztBQU8vQkUsZ0NBQWdCUixjQUFJQyxNQUFKLEdBQWFLLFFBQWIsRUFQZTtBQVEvQkcsb0JBQUlULGNBQUlDLE1BQUosR0FBYUssUUFBYixFQVIyQjtBQVMvQkksdUJBQU9WLGNBQUlDLE1BQUosR0FBYUssUUFBYixFQVR3QjtBQVUvQkssd0JBQVFYLGNBQUlDLE1BQUosR0FBYUssUUFBYjtBQVZ1QixlQUFsQixDQURDOzs7QUFjaEJOLDRCQUFJWSxNQUFKLENBQVdmLE9BQVgsRUFBb0JFLE1BQXBCLEVBQTRCLDBEQUE1QjtBQUNEOztBQWhCYywwQkFrQk9GLFFBQVFXLGNBQVIsQ0FBdUJLLFFBbEI5Qjs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBLG1CQWtCaURoQixRQUFRYSxLQUFSLENBQWNJLFFBQWQsRUFsQmpEOztBQUFBO0FBQUE7O0FBQUE7QUFrQlRDLHlCQWxCUzs7QUFBQSxnQkFvQlZsQixRQUFRVyxjQUFSLENBQXVCUSxPQXBCYjtBQUFBO0FBQUE7QUFBQTs7QUFBQSw2Q0FxQk4sSUFBSUMsY0FBSixDQUF1QnBCLE9BQXZCLENBckJNOztBQUFBO0FBQUEsaUJBd0JYa0IsYUF4Qlc7QUFBQTtBQUFBO0FBQUE7O0FBQUEsNkNBeUJOLElBQUlHLGVBQUosQ0FBd0JyQixPQUF4QixDQXpCTTs7QUFBQTtBQUFBLDZDQTJCTixJQUFJc0IsY0FBSixDQUF1QnRCLE9BQXZCLENBM0JNOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWpCOztBQUFBO0FBQUE7QUFBQTtBQUFBIiwiZmlsZSI6Ii4vc3JjL3NlY3VyaXR5L2luZGV4LmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEpvaSBmcm9tICdqb2knXG5cbmltcG9ydCBSb290QXV0aGVudGljYXRpb24gZnJvbSAnLi9yb290J1xuaW1wb3J0IENsb3VkQXV0aGVudGljYXRpb24gZnJvbSAnLi9jbG91ZCdcbmltcG9ydCBOb25lQXV0aGVudGljYXRpb24gZnJvbSAnLi9ub25lJ1xuaW1wb3J0IHsgaXNEZXZlbG9waW5nIH0gZnJvbSAnLi4vdXRpbCdcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyBvcHRpb25zID0+IHtcbiAgaWYgKGlzRGV2ZWxvcGluZykge1xuICAgIGNvbnN0IHNjaGVtYSA9IEpvaS5vYmplY3QoKS5rZXlzKHtcbiAgICAgIGRhdGFMb2NhdGlvbjogSm9pLnN0cmluZygpXG4gICAgICAgIC5taW4oMSlcbiAgICAgICAgLnJlcXVpcmVkKCksXG4gICAgICBwcm9qZWN0TG9jYXRpb246IEpvaS5zdHJpbmcoKVxuICAgICAgICAubWluKDEpXG4gICAgICAgIC5yZXF1aXJlZCgpLFxuICAgICAgc2VjdXJpdHlDb25maWc6IEpvaS5vYmplY3QoKS5yZXF1aXJlZCgpLFxuICAgICAgZGI6IEpvaS5vYmplY3QoKS5yZXF1aXJlZCgpLFxuICAgICAgY2xvdWQ6IEpvaS5vYmplY3QoKS5yZXF1aXJlZCgpLFxuICAgICAgbG9nZ2VyOiBKb2kub2JqZWN0KCkucmVxdWlyZWQoKVxuICAgIH0pXG5cbiAgICBKb2kuYXNzZXJ0KG9wdGlvbnMsIHNjaGVtYSwgJ0ludmFsaWQgY29uc3RydWN0b3IgZWxlbWVudHMgZm9yIEF1dGhlbnRpY2F0aW9uIFByb3ZpZGVyJylcbiAgfVxuXG4gIGNvbnN0IGlzQ2xvdWRQYWlyZWQgPSBvcHRpb25zLnNlY3VyaXR5Q29uZmlnLnVzZUNsb3VkICYmIChhd2FpdCBvcHRpb25zLmNsb3VkLmlzUGFpcmVkKCkpXG5cbiAgaWYgKCFvcHRpb25zLnNlY3VyaXR5Q29uZmlnLmVuYWJsZWQpIHtcbiAgICByZXR1cm4gbmV3IE5vbmVBdXRoZW50aWNhdGlvbihvcHRpb25zKVxuICB9XG5cbiAgaWYgKGlzQ2xvdWRQYWlyZWQpIHtcbiAgICByZXR1cm4gbmV3IENsb3VkQXV0aGVudGljYXRpb24ob3B0aW9ucylcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbmV3IFJvb3RBdXRoZW50aWNhdGlvbihvcHRpb25zKVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/security/index.js\n");

/***/ }),

/***/ "./src/security/none/index.js":
/*!************************************!*\
  !*** ./src/security/none/index.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _provider = __webpack_require__(/*! ../provider */ \"./src/security/provider.js\");\n\nvar _provider2 = _interopRequireDefault(_provider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar RootAuthentication = function (_AbstractAuthenticati) {\n  _inherits(RootAuthentication, _AbstractAuthenticati);\n\n  function RootAuthentication() {\n    _classCallCheck(this, RootAuthentication);\n\n    return _possibleConstructorReturn(this, (RootAuthentication.__proto__ || Object.getPrototypeOf(RootAuthentication)).apply(this, arguments));\n  }\n\n  _createClass(RootAuthentication, [{\n    key: 'login',\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(user, password) {\n        var ip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'all';\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt('return', {\n                  success: true,\n                  token: 'none'\n                });\n\n              case 1:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function login(_x, _x2) {\n        return _ref.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'authenticateWithError',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(authHeader) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt('return', {\n                  id: 0,\n                  username: 'admin',\n                  email: 'admin@botpress.io',\n                  first_name: 'Admin',\n                  last_name: 'Admin',\n                  avatar_url: null,\n                  roles: ['admin']\n                });\n\n              case 1:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function authenticateWithError(_x4) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return authenticateWithError;\n    }()\n  }, {\n    key: 'getAuthenticationInfo',\n    value: function getAuthenticationInfo() {\n      return {\n        type: 'none'\n      };\n    }\n  }, {\n    key: 'refreshToken',\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(authHeader) {\n        var _authHeader$split, _authHeader$split2, scheme, token;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _authHeader$split = authHeader.split(' '), _authHeader$split2 = _slicedToArray(_authHeader$split, 2), scheme = _authHeader$split2[0], token = _authHeader$split2[1];\n\n                if (!(scheme.toLowerCase() !== 'bearer')) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                return _context3.abrupt('return', {\n                  success: false,\n                  reason: 'Wrong scheme ' + scheme + ', expected Bearer'\n                });\n\n              case 3:\n                return _context3.abrupt('return', {\n                  success: true,\n                  token: token\n                });\n\n              case 4:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function refreshToken(_x5) {\n        return _ref3.apply(this, arguments);\n      }\n\n      return refreshToken;\n    }()\n  }, {\n    key: 'getUserIdentity',\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(token) {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt('return', this.authenticateWithError('bearer ' + token));\n\n              case 1:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getUserIdentity(_x6) {\n        return _ref4.apply(this, arguments);\n      }\n\n      return getUserIdentity;\n    }()\n  }, {\n    key: 'getJWTSecretOrCertificate',\n    value: function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt('return', null);\n\n              case 1:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getJWTSecretOrCertificate() {\n        return _ref5.apply(this, arguments);\n      }\n\n      return getJWTSecretOrCertificate;\n    }()\n  }]);\n\n  return RootAuthentication;\n}(_provider2.default);\n\nexports.default = RootAuthentication;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VjdXJpdHkvbm9uZS9pbmRleC5qcz9mY2M2Il0sIm5hbWVzIjpbIlJvb3RBdXRoZW50aWNhdGlvbiIsInVzZXIiLCJwYXNzd29yZCIsImlwIiwic3VjY2VzcyIsInRva2VuIiwiYXV0aEhlYWRlciIsImlkIiwidXNlcm5hbWUiLCJlbWFpbCIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJhdmF0YXJfdXJsIiwicm9sZXMiLCJ0eXBlIiwic3BsaXQiLCJzY2hlbWUiLCJ0b0xvd2VyQ2FzZSIsInJlYXNvbiIsImF1dGhlbnRpY2F0ZVdpdGhFcnJvciIsIkFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7OztJQUVxQkEsa0I7Ozs7Ozs7Ozs7OzswRkFDUEMsSSxFQUFNQyxRO1lBQVVDLEUsdUVBQUssSzs7Ozs7aURBQ3hCO0FBQ0xDLDJCQUFTLElBREo7QUFFTEMseUJBQU87QUFGRixpQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs0RkFNbUJDLFU7Ozs7O2tEQUNuQjtBQUNMQyxzQkFBSSxDQURDO0FBRUxDLDRCQUFVLE9BRkw7QUFHTEMseUJBQU8sbUJBSEY7QUFJTEMsOEJBQVksT0FKUDtBQUtMQyw2QkFBVyxPQUxOO0FBTUxDLDhCQUFZLElBTlA7QUFPTEMseUJBQU8sQ0FBQyxPQUFEO0FBUEYsaUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs0Q0FXZTtBQUN0QixhQUFPO0FBQ0xDLGNBQU07QUFERCxPQUFQO0FBR0Q7Ozs7NEZBRWtCUixVOzs7Ozs7O29DQUNPQSxXQUFXUyxLQUFYLENBQWlCLEdBQWpCLEMsNkRBQWpCQyxNLDBCQUFRWCxLOztzQkFDWFcsT0FBT0MsV0FBUCxPQUF5QixROzs7OztrREFFcEI7QUFDTGIsMkJBQVMsS0FESjtBQUVMYyw0Q0FBd0JGLE1BQXhCO0FBRkssaUI7OztrREFPRjtBQUNMWiwyQkFBUyxJQURKO0FBRUxDO0FBRkssaUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NEZBTWFBLEs7Ozs7O2tEQUNiLEtBQUtjLHFCQUFMLENBQTJCLFlBQVlkLEtBQXZDLEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrREFJQSxJOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0VBaERxQ2Usa0I7O2tCQUEzQnBCLGtCIiwiZmlsZSI6Ii4vc3JjL3NlY3VyaXR5L25vbmUvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQWJzdHJhY3RBdXRoZW50aWNhdGlvblByb3ZpZGVyIGZyb20gJy4uL3Byb3ZpZGVyJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb290QXV0aGVudGljYXRpb24gZXh0ZW5kcyBBYnN0cmFjdEF1dGhlbnRpY2F0aW9uUHJvdmlkZXIge1xuICBhc3luYyBsb2dpbih1c2VyLCBwYXNzd29yZCwgaXAgPSAnYWxsJykge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdG9rZW46ICdub25lJ1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGF1dGhlbnRpY2F0ZVdpdGhFcnJvcihhdXRoSGVhZGVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiAwLFxuICAgICAgdXNlcm5hbWU6ICdhZG1pbicsXG4gICAgICBlbWFpbDogJ2FkbWluQGJvdHByZXNzLmlvJyxcbiAgICAgIGZpcnN0X25hbWU6ICdBZG1pbicsXG4gICAgICBsYXN0X25hbWU6ICdBZG1pbicsXG4gICAgICBhdmF0YXJfdXJsOiBudWxsLFxuICAgICAgcm9sZXM6IFsnYWRtaW4nXVxuICAgIH1cbiAgfVxuXG4gIGdldEF1dGhlbnRpY2F0aW9uSW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ25vbmUnXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVmcmVzaFRva2VuKGF1dGhIZWFkZXIpIHtcbiAgICBjb25zdCBbc2NoZW1lLCB0b2tlbl0gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylcbiAgICBpZiAoc2NoZW1lLnRvTG93ZXJDYXNlKCkgIT09ICdiZWFyZXInKSB7XG4gICAgICAvLyBvbmx5IHN1cHBvcnQgQmVhcmVyIHNjaGVtZVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIHJlYXNvbjogYFdyb25nIHNjaGVtZSAke3NjaGVtZX0sIGV4cGVjdGVkIEJlYXJlcmBcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBkb2Vzbid0IG1hdHRlciwgY2FuIHJldHVybiB0aGUgc2FtZSB0b2tlblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdG9rZW5cbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRVc2VySWRlbnRpdHkodG9rZW4pIHtcbiAgICByZXR1cm4gdGhpcy5hdXRoZW50aWNhdGVXaXRoRXJyb3IoJ2JlYXJlciAnICsgdG9rZW4pXG4gIH1cblxuICBhc3luYyBnZXRKV1RTZWNyZXRPckNlcnRpZmljYXRlKCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/security/none/index.js\n");

/***/ }),

/***/ "./src/security/provider.js":
/*!**********************************!*\
  !*** ./src/security/provider.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Security Provider\n * @private\n * @module security\n */\n\nvar AbstractAuthenticationProvider = function () {\n  function AbstractAuthenticationProvider(options) {\n    _classCallCheck(this, AbstractAuthenticationProvider);\n\n    Object.assign(this, options);\n  }\n\n  /**\n   * @abstract\n   * @description Login a user to the configured provider\n   * @return {object} An authenticated User object or false if invalid login\n   */\n\n\n  _createClass(AbstractAuthenticationProvider, [{\n    key: 'login',\n    value: function login() {\n      throw new Error('Abstract Class: Needs to be implemented');\n    }\n\n    /**\n     * @abstract\n     * @description Returns a fresh token from an old (but still active) token\n     * @return {{ success: bool, token: string, reason: string }} A token object\n     */\n\n  }, {\n    key: 'refreshToken',\n    value: function refreshToken() {\n      throw new Error('Abstract Class: Needs to be implemented');\n    }\n\n    /**\n     * Authenticates a user from an authentication header\n     * @description Example of header is: \"bearer your_token_here\"\n     * @return {object} An authenticated User object or false if invalid login\n     */\n\n  }, {\n    key: 'authenticate',\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(authHeader) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.authenticateWithError(authHeader);\n\n              case 3:\n                return _context.abrupt('return', _context.sent);\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context['catch'](0);\n\n                this.logger.debug('[Login]', _context.t0.message);\n                return _context.abrupt('return', false);\n\n              case 10:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 6]]);\n      }));\n\n      function authenticate(_x) {\n        return _ref.apply(this, arguments);\n      }\n\n      return authenticate;\n    }()\n\n    /**\n     * @abstract\n     */\n\n  }, {\n    key: 'authenticateWithError',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                throw new Error('Abstract Class: Needs to be implemented');\n\n              case 1:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function authenticateWithError() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return authenticateWithError;\n    }()\n\n    /**\n     * @abstract\n     * @description Retrieve the user's identity from an authentication token\n     * @return {object} An authenticated User object or false if invalid token\n     */\n\n  }, {\n    key: 'getUserIdentity',\n    value: function getUserIdentity() {\n      throw new Error('Abstract Class: Needs to be implemented');\n    }\n\n    /**\n     * @abstract\n     * @description Returns information about the authentication provider and authentication status\n     * @return {Object} Varies from provider to the other\n     */\n\n  }, {\n    key: 'getAuthenticationInfo',\n    value: function getAuthenticationInfo() {\n      throw new Error('Abstract Class: Needs to be implemented');\n    }\n\n    /**\n     * @abstract\n     * @description Returns a public JWT certificate or a private JWT key used to sign tokens and validate its origin\n     * @return {String} The public certificate or private secret\n     */\n\n  }, {\n    key: 'getJWTSecretOrCertificate',\n    value: function getJWTSecretOrCertificate() {\n      throw new Error('Abstract Class: Needs to be implemented');\n    }\n  }]);\n\n  return AbstractAuthenticationProvider;\n}();\n\nexports.default = AbstractAuthenticationProvider;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VjdXJpdHkvcHJvdmlkZXIuanM/NjFhYSJdLCJuYW1lcyI6WyJBYnN0cmFjdEF1dGhlbnRpY2F0aW9uUHJvdmlkZXIiLCJvcHRpb25zIiwiT2JqZWN0IiwiYXNzaWduIiwiRXJyb3IiLCJhdXRoSGVhZGVyIiwiYXV0aGVudGljYXRlV2l0aEVycm9yIiwibG9nZ2VyIiwiZGVidWciLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTs7Ozs7O0lBTXFCQSw4QjtBQUNuQiwwQ0FBWUMsT0FBWixFQUFxQjtBQUFBOztBQUNuQkMsV0FBT0MsTUFBUCxDQUFjLElBQWQsRUFBb0JGLE9BQXBCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs0QkFLUTtBQUNOLFlBQU0sSUFBSUcsS0FBSixDQUFVLHlDQUFWLENBQU47QUFDRDs7QUFFRDs7Ozs7Ozs7bUNBS2U7QUFDYixZQUFNLElBQUlBLEtBQUosQ0FBVSx5Q0FBVixDQUFOO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OzswRkFLbUJDLFU7Ozs7Ozs7dUJBRUYsS0FBS0MscUJBQUwsQ0FBMkJELFVBQTNCLEM7Ozs7Ozs7OztBQUViLHFCQUFLRSxNQUFMLENBQVlDLEtBQVosQ0FBa0IsU0FBbEIsRUFBNkIsWUFBSUMsT0FBakM7aURBQ08sSzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFJWDs7Ozs7Ozs7Ozs7O3NCQUlRLElBQUlMLEtBQUosQ0FBVSx5Q0FBVixDOzs7Ozs7Ozs7Ozs7Ozs7OztBQUdSOzs7Ozs7OztzQ0FLa0I7QUFDaEIsWUFBTSxJQUFJQSxLQUFKLENBQVUseUNBQVYsQ0FBTjtBQUNEOztBQUVEOzs7Ozs7Ozs0Q0FLd0I7QUFDdEIsWUFBTSxJQUFJQSxLQUFKLENBQVUseUNBQVYsQ0FBTjtBQUNEOztBQUVEOzs7Ozs7OztnREFLNEI7QUFDMUIsWUFBTSxJQUFJQSxLQUFKLENBQVUseUNBQVYsQ0FBTjtBQUNEOzs7Ozs7a0JBckVrQkosOEIiLCJmaWxlIjoiLi9zcmMvc2VjdXJpdHkvcHJvdmlkZXIuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNlY3VyaXR5IFByb3ZpZGVyXG4gKiBAcHJpdmF0ZVxuICogQG1vZHVsZSBzZWN1cml0eVxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpXG4gIH1cblxuICAvKipcbiAgICogQGFic3RyYWN0XG4gICAqIEBkZXNjcmlwdGlvbiBMb2dpbiBhIHVzZXIgdG8gdGhlIGNvbmZpZ3VyZWQgcHJvdmlkZXJcbiAgICogQHJldHVybiB7b2JqZWN0fSBBbiBhdXRoZW50aWNhdGVkIFVzZXIgb2JqZWN0IG9yIGZhbHNlIGlmIGludmFsaWQgbG9naW5cbiAgICovXG4gIGxvZ2luKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignQWJzdHJhY3QgQ2xhc3M6IE5lZWRzIHRvIGJlIGltcGxlbWVudGVkJylcbiAgfVxuXG4gIC8qKlxuICAgKiBAYWJzdHJhY3RcbiAgICogQGRlc2NyaXB0aW9uIFJldHVybnMgYSBmcmVzaCB0b2tlbiBmcm9tIGFuIG9sZCAoYnV0IHN0aWxsIGFjdGl2ZSkgdG9rZW5cbiAgICogQHJldHVybiB7eyBzdWNjZXNzOiBib29sLCB0b2tlbjogc3RyaW5nLCByZWFzb246IHN0cmluZyB9fSBBIHRva2VuIG9iamVjdFxuICAgKi9cbiAgcmVmcmVzaFRva2VuKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignQWJzdHJhY3QgQ2xhc3M6IE5lZWRzIHRvIGJlIGltcGxlbWVudGVkJylcbiAgfVxuXG4gIC8qKlxuICAgKiBBdXRoZW50aWNhdGVzIGEgdXNlciBmcm9tIGFuIGF1dGhlbnRpY2F0aW9uIGhlYWRlclxuICAgKiBAZGVzY3JpcHRpb24gRXhhbXBsZSBvZiBoZWFkZXIgaXM6IFwiYmVhcmVyIHlvdXJfdG9rZW5faGVyZVwiXG4gICAqIEByZXR1cm4ge29iamVjdH0gQW4gYXV0aGVudGljYXRlZCBVc2VyIG9iamVjdCBvciBmYWxzZSBpZiBpbnZhbGlkIGxvZ2luXG4gICAqL1xuICBhc3luYyBhdXRoZW50aWNhdGUoYXV0aEhlYWRlcikge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoZW50aWNhdGVXaXRoRXJyb3IoYXV0aEhlYWRlcilcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKCdbTG9naW5dJywgZXJyLm1lc3NhZ2UpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGFic3RyYWN0XG4gICAqL1xuICBhc3luYyBhdXRoZW50aWNhdGVXaXRoRXJyb3IoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBYnN0cmFjdCBDbGFzczogTmVlZHMgdG8gYmUgaW1wbGVtZW50ZWQnKVxuICB9XG5cbiAgLyoqXG4gICAqIEBhYnN0cmFjdFxuICAgKiBAZGVzY3JpcHRpb24gUmV0cmlldmUgdGhlIHVzZXIncyBpZGVudGl0eSBmcm9tIGFuIGF1dGhlbnRpY2F0aW9uIHRva2VuXG4gICAqIEByZXR1cm4ge29iamVjdH0gQW4gYXV0aGVudGljYXRlZCBVc2VyIG9iamVjdCBvciBmYWxzZSBpZiBpbnZhbGlkIHRva2VuXG4gICAqL1xuICBnZXRVc2VySWRlbnRpdHkoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBYnN0cmFjdCBDbGFzczogTmVlZHMgdG8gYmUgaW1wbGVtZW50ZWQnKVxuICB9XG5cbiAgLyoqXG4gICAqIEBhYnN0cmFjdFxuICAgKiBAZGVzY3JpcHRpb24gUmV0dXJucyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgYXV0aGVudGljYXRpb24gcHJvdmlkZXIgYW5kIGF1dGhlbnRpY2F0aW9uIHN0YXR1c1xuICAgKiBAcmV0dXJuIHtPYmplY3R9IFZhcmllcyBmcm9tIHByb3ZpZGVyIHRvIHRoZSBvdGhlclxuICAgKi9cbiAgZ2V0QXV0aGVudGljYXRpb25JbmZvKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignQWJzdHJhY3QgQ2xhc3M6IE5lZWRzIHRvIGJlIGltcGxlbWVudGVkJylcbiAgfVxuXG4gIC8qKlxuICAgKiBAYWJzdHJhY3RcbiAgICogQGRlc2NyaXB0aW9uIFJldHVybnMgYSBwdWJsaWMgSldUIGNlcnRpZmljYXRlIG9yIGEgcHJpdmF0ZSBKV1Qga2V5IHVzZWQgdG8gc2lnbiB0b2tlbnMgYW5kIHZhbGlkYXRlIGl0cyBvcmlnaW5cbiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgcHVibGljIGNlcnRpZmljYXRlIG9yIHByaXZhdGUgc2VjcmV0XG4gICAqL1xuICBnZXRKV1RTZWNyZXRPckNlcnRpZmljYXRlKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignQWJzdHJhY3QgQ2xhc3M6IE5lZWRzIHRvIGJlIGltcGxlbWVudGVkJylcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/security/provider.js\n");

/***/ }),

/***/ "./src/security/root/index.js":
/*!************************************!*\
  !*** ./src/security/root/index.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _crypto = __webpack_require__(/*! crypto */ \"crypto\");\n\nvar _crypto2 = _interopRequireDefault(_crypto);\n\nvar _jsonwebtoken = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n\nvar _jsonwebtoken2 = _interopRequireDefault(_jsonwebtoken);\n\nvar _provider = __webpack_require__(/*! ../provider */ \"./src/security/provider.js\");\n\nvar _provider2 = _interopRequireDefault(_provider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar RootAuthentication = function (_AbstractAuthenticati) {\n  _inherits(RootAuthentication, _AbstractAuthenticati);\n\n  function RootAuthentication(options) {\n    _classCallCheck(this, RootAuthentication);\n\n    var _this = _possibleConstructorReturn(this, (RootAuthentication.__proto__ || Object.getPrototypeOf(RootAuthentication)).call(this, options));\n\n    _this._bootstrapToken();\n    _this.attempts = {};\n    return _this;\n  }\n\n  _createClass(RootAuthentication, [{\n    key: '_bootstrapToken',\n    value: function _bootstrapToken() {\n      var secret = '';\n      var secretPath = _path2.default.join(this.dataLocation, 'secret.key');\n\n      var createNewSecret = function createNewSecret() {\n        secret = _crypto2.default.randomBytes(256).toString();\n        _fs2.default.writeFileSync(secretPath, secret);\n        return secret;\n      };\n\n      if (_fs2.default.existsSync(secretPath)) {\n        secret = _fs2.default.readFileSync(secretPath);\n      }\n\n      if (!secret || secret.length < 15) {\n        secret = createNewSecret();\n      }\n\n      this.secret = secret;\n    }\n  }, {\n    key: '_buildToken',\n    value: function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(loginUser) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt('return', _jsonwebtoken2.default.sign({ user: loginUser }, this.secret, {\n                  issuer: 'bot.root',\n                  expiresIn: this.securityConfig.tokenExpiry,\n                  algorithm: 'HS256'\n                }));\n\n              case 1:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _buildToken(_x) {\n        return _ref.apply(this, arguments);\n      }\n\n      return _buildToken;\n    }()\n  }, {\n    key: '_attempt',\n    value: function _attempt(ip) {\n      var _securityConfig = this.securityConfig,\n          maxAttempts = _securityConfig.maxAttempts,\n          resetAfter = _securityConfig.resetAfter;\n\n      // reset the cache if time elapsed\n\n      if (new Date() - this.lastCleanTimestamp >= resetAfter) {\n        this.attempts = {};\n        this.lastCleanTimestamp = new Date();\n      }\n\n      return (this.attempts[ip] || 0) < maxAttempts;\n    }\n  }, {\n    key: '_login',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(user, password) {\n        var ip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'all';\n        var adminPassword;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                adminPassword = process.env.BOTPRESS_ADMIN_PASSWORD || this.securityConfig.password;\n\n                if (!(typeof user === 'string' && user.toLowerCase() === 'admin' && typeof password === 'string' && password === adminPassword)) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                this.attempts[ip] = 0;\n                return _context2.abrupt('return', {\n                  id: 0,\n                  username: 'admin',\n                  email: 'admin@botpress.io',\n                  first_name: 'Admin',\n                  last_name: 'Admin',\n                  avatar_url: null,\n                  roles: ['admin']\n                });\n\n              case 6:\n                this.attempts[ip] = (this.attempts[ip] || 0) + 1;\n                return _context2.abrupt('return', null);\n\n              case 8:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function _login(_x2, _x3) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return _login;\n    }()\n  }, {\n    key: 'login',\n    value: function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(user, password) {\n        var ip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'all';\n        var canAttempt, loginUser;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                canAttempt = this._attempt(ip);\n\n                if (canAttempt) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                return _context3.abrupt('return', { success: false, reason: 'Too many login attempts. Try again later.' });\n\n              case 3:\n                _context3.next = 5;\n                return this._login(user, password, ip);\n\n              case 5:\n                loginUser = _context3.sent;\n\n                if (!loginUser) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                _context3.next = 9;\n                return this._buildToken(loginUser);\n\n              case 9:\n                _context3.t0 = _context3.sent;\n                return _context3.abrupt('return', {\n                  success: true,\n                  token: _context3.t0\n                });\n\n              case 13:\n                return _context3.abrupt('return', {\n                  success: false,\n                  reason: 'Bad username / password'\n                });\n\n              case 14:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function login(_x5, _x6) {\n        return _ref3.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'authenticateWithError',\n    value: function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(authHeader) {\n        var _split, _split2, scheme, token, decoded;\n\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _split = (authHeader || 'invalid header').split(' '), _split2 = _slicedToArray(_split, 2), scheme = _split2[0], token = _split2[1];\n\n                if (!(scheme.toLowerCase() !== 'bearer')) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                throw new Error('Wrong scheme ' + scheme + ', expected Bearer');\n\n              case 3:\n                decoded = _jsonwebtoken2.default.verify(token, this.secret, { algorithms: ['HS256'] });\n\n                if (!decoded.identity_proof_only) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                return _context4.abrupt('return', false);\n\n              case 6:\n                return _context4.abrupt('return', decoded.user);\n\n              case 7:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function authenticateWithError(_x8) {\n        return _ref4.apply(this, arguments);\n      }\n\n      return authenticateWithError;\n    }()\n  }, {\n    key: 'getAuthenticationInfo',\n    value: function getAuthenticationInfo() {\n      return {\n        type: 'root'\n      };\n    }\n  }, {\n    key: 'refreshToken',\n    value: function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(authHeader) {\n        var loginUser;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this.authenticateWithError(authHeader);\n\n              case 3:\n                loginUser = _context5.sent;\n                _context5.next = 6;\n                return this.buildToken(loginUser);\n\n              case 6:\n                _context5.t0 = _context5.sent;\n                return _context5.abrupt('return', {\n                  success: true,\n                  token: _context5.t0\n                });\n\n              case 10:\n                _context5.prev = 10;\n                _context5.t1 = _context5['catch'](0);\n                return _context5.abrupt('return', {\n                  success: false,\n                  reason: _context5.t1.message || 'The token is invalid or expired'\n                });\n\n              case 13:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 10]]);\n      }));\n\n      function refreshToken(_x9) {\n        return _ref5.apply(this, arguments);\n      }\n\n      return refreshToken;\n    }()\n  }, {\n    key: 'getUserIdentity',\n    value: function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(token) {\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                return _context6.abrupt('return', this.authenticateWithError('bearer ' + token));\n\n              case 1:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function getUserIdentity(_x10) {\n        return _ref6.apply(this, arguments);\n      }\n\n      return getUserIdentity;\n    }()\n  }, {\n    key: 'getJWTSecretOrCertificate',\n    value: function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                return _context7.abrupt('return', this.secret);\n\n              case 1:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function getJWTSecretOrCertificate() {\n        return _ref7.apply(this, arguments);\n      }\n\n      return getJWTSecretOrCertificate;\n    }()\n  }]);\n\n  return RootAuthentication;\n}(_provider2.default);\n\nexports.default = RootAuthentication;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VjdXJpdHkvcm9vdC9pbmRleC5qcz9kZTNhIl0sIm5hbWVzIjpbIlJvb3RBdXRoZW50aWNhdGlvbiIsIm9wdGlvbnMiLCJfYm9vdHN0cmFwVG9rZW4iLCJhdHRlbXB0cyIsInNlY3JldCIsInNlY3JldFBhdGgiLCJwYXRoIiwiam9pbiIsImRhdGFMb2NhdGlvbiIsImNyZWF0ZU5ld1NlY3JldCIsImNyeXB0byIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJmcyIsIndyaXRlRmlsZVN5bmMiLCJleGlzdHNTeW5jIiwicmVhZEZpbGVTeW5jIiwibGVuZ3RoIiwibG9naW5Vc2VyIiwiand0Iiwic2lnbiIsInVzZXIiLCJpc3N1ZXIiLCJleHBpcmVzSW4iLCJzZWN1cml0eUNvbmZpZyIsInRva2VuRXhwaXJ5IiwiYWxnb3JpdGhtIiwiaXAiLCJtYXhBdHRlbXB0cyIsInJlc2V0QWZ0ZXIiLCJEYXRlIiwibGFzdENsZWFuVGltZXN0YW1wIiwicGFzc3dvcmQiLCJhZG1pblBhc3N3b3JkIiwicHJvY2VzcyIsImVudiIsIkJPVFBSRVNTX0FETUlOX1BBU1NXT1JEIiwidG9Mb3dlckNhc2UiLCJpZCIsInVzZXJuYW1lIiwiZW1haWwiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiYXZhdGFyX3VybCIsInJvbGVzIiwiY2FuQXR0ZW1wdCIsIl9hdHRlbXB0Iiwic3VjY2VzcyIsInJlYXNvbiIsIl9sb2dpbiIsIl9idWlsZFRva2VuIiwidG9rZW4iLCJhdXRoSGVhZGVyIiwic3BsaXQiLCJzY2hlbWUiLCJFcnJvciIsImRlY29kZWQiLCJ2ZXJpZnkiLCJhbGdvcml0aG1zIiwiaWRlbnRpdHlfcHJvb2Zfb25seSIsInR5cGUiLCJhdXRoZW50aWNhdGVXaXRoRXJyb3IiLCJidWlsZFRva2VuIiwibWVzc2FnZSIsIkFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7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c2VjdXJpdHkvcm9vdC9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0bydcblxuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXG5cbmltcG9ydCBBYnN0cmFjdEF1dGhlbnRpY2F0aW9uUHJvdmlkZXIgZnJvbSAnLi4vcHJvdmlkZXInXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJvb3RBdXRoZW50aWNhdGlvbiBleHRlbmRzIEFic3RyYWN0QXV0aGVudGljYXRpb25Qcm92aWRlciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKVxuXG4gICAgdGhpcy5fYm9vdHN0cmFwVG9rZW4oKVxuICAgIHRoaXMuYXR0ZW1wdHMgPSB7fVxuICB9XG5cbiAgX2Jvb3RzdHJhcFRva2VuKCkge1xuICAgIGxldCBzZWNyZXQgPSAnJ1xuICAgIGNvbnN0IHNlY3JldFBhdGggPSBwYXRoLmpvaW4odGhpcy5kYXRhTG9jYXRpb24sICdzZWNyZXQua2V5JylcblxuICAgIGNvbnN0IGNyZWF0ZU5ld1NlY3JldCA9ICgpID0+IHtcbiAgICAgIHNlY3JldCA9IGNyeXB0by5yYW5kb21CeXRlcygyNTYpLnRvU3RyaW5nKClcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoc2VjcmV0UGF0aCwgc2VjcmV0KVxuICAgICAgcmV0dXJuIHNlY3JldFxuICAgIH1cblxuICAgIGlmIChmcy5leGlzdHNTeW5jKHNlY3JldFBhdGgpKSB7XG4gICAgICBzZWNyZXQgPSBmcy5yZWFkRmlsZVN5bmMoc2VjcmV0UGF0aClcbiAgICB9XG5cbiAgICBpZiAoIXNlY3JldCB8fCBzZWNyZXQubGVuZ3RoIDwgMTUpIHtcbiAgICAgIHNlY3JldCA9IGNyZWF0ZU5ld1NlY3JldCgpXG4gICAgfVxuXG4gICAgdGhpcy5zZWNyZXQgPSBzZWNyZXRcbiAgfVxuXG4gIGFzeW5jIF9idWlsZFRva2VuKGxvZ2luVXNlcikge1xuICAgIHJldHVybiBqd3Quc2lnbih7IHVzZXI6IGxvZ2luVXNlciB9LCB0aGlzLnNlY3JldCwge1xuICAgICAgaXNzdWVyOiAnYm90LnJvb3QnLFxuICAgICAgZXhwaXJlc0luOiB0aGlzLnNlY3VyaXR5Q29uZmlnLnRva2VuRXhwaXJ5LFxuICAgICAgYWxnb3JpdGhtOiAnSFMyNTYnXG4gICAgfSlcbiAgfVxuXG4gIF9hdHRlbXB0KGlwKSB7XG4gICAgY29uc3QgeyBtYXhBdHRlbXB0cywgcmVzZXRBZnRlciB9ID0gdGhpcy5zZWN1cml0eUNvbmZpZ1xuXG4gICAgLy8gcmVzZXQgdGhlIGNhY2hlIGlmIHRpbWUgZWxhcHNlZFxuICAgIGlmIChuZXcgRGF0ZSgpIC0gdGhpcy5sYXN0Q2xlYW5UaW1lc3RhbXAgPj0gcmVzZXRBZnRlcikge1xuICAgICAgdGhpcy5hdHRlbXB0cyA9IHt9XG4gICAgICB0aGlzLmxhc3RDbGVhblRpbWVzdGFtcCA9IG5ldyBEYXRlKClcbiAgICB9XG5cbiAgICByZXR1cm4gKHRoaXMuYXR0ZW1wdHNbaXBdIHx8IDApIDwgbWF4QXR0ZW1wdHNcbiAgfVxuXG4gIGFzeW5jIF9sb2dpbih1c2VyLCBwYXNzd29yZCwgaXAgPSAnYWxsJykge1xuICAgIGNvbnN0IGFkbWluUGFzc3dvcmQgPSBwcm9jZXNzLmVudi5CT1RQUkVTU19BRE1JTl9QQVNTV09SRCB8fCB0aGlzLnNlY3VyaXR5Q29uZmlnLnBhc3N3b3JkXG5cbiAgICBpZiAoXG4gICAgICB0eXBlb2YgdXNlciA9PT0gJ3N0cmluZycgJiZcbiAgICAgIHVzZXIudG9Mb3dlckNhc2UoKSA9PT0gJ2FkbWluJyAmJlxuICAgICAgdHlwZW9mIHBhc3N3b3JkID09PSAnc3RyaW5nJyAmJlxuICAgICAgcGFzc3dvcmQgPT09IGFkbWluUGFzc3dvcmRcbiAgICApIHtcbiAgICAgIHRoaXMuYXR0ZW1wdHNbaXBdID0gMFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IDAsXG4gICAgICAgIHVzZXJuYW1lOiAnYWRtaW4nLFxuICAgICAgICBlbWFpbDogJ2FkbWluQGJvdHByZXNzLmlvJyxcbiAgICAgICAgZmlyc3RfbmFtZTogJ0FkbWluJyxcbiAgICAgICAgbGFzdF9uYW1lOiAnQWRtaW4nLFxuICAgICAgICBhdmF0YXJfdXJsOiBudWxsLFxuICAgICAgICByb2xlczogWydhZG1pbiddXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXR0ZW1wdHNbaXBdID0gKHRoaXMuYXR0ZW1wdHNbaXBdIHx8IDApICsgMVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBhc3luYyBsb2dpbih1c2VyLCBwYXNzd29yZCwgaXAgPSAnYWxsJykge1xuICAgIGNvbnN0IGNhbkF0dGVtcHQgPSB0aGlzLl9hdHRlbXB0KGlwKVxuICAgIGlmICghY2FuQXR0ZW1wdCkge1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIHJlYXNvbjogJ1RvbyBtYW55IGxvZ2luIGF0dGVtcHRzLiBUcnkgYWdhaW4gbGF0ZXIuJyB9XG4gICAgfVxuXG4gICAgY29uc3QgbG9naW5Vc2VyID0gYXdhaXQgdGhpcy5fbG9naW4odXNlciwgcGFzc3dvcmQsIGlwKVxuXG4gICAgaWYgKGxvZ2luVXNlcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgdG9rZW46IGF3YWl0IHRoaXMuX2J1aWxkVG9rZW4obG9naW5Vc2VyKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgcmVhc29uOiAnQmFkIHVzZXJuYW1lIC8gcGFzc3dvcmQnXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYXV0aGVudGljYXRlV2l0aEVycm9yKGF1dGhIZWFkZXIpIHtcbiAgICBjb25zdCBbc2NoZW1lLCB0b2tlbl0gPSAoYXV0aEhlYWRlciB8fCAnaW52YWxpZCBoZWFkZXInKS5zcGxpdCgnICcpXG5cbiAgICBpZiAoc2NoZW1lLnRvTG93ZXJDYXNlKCkgIT09ICdiZWFyZXInKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFdyb25nIHNjaGVtZSAke3NjaGVtZX0sIGV4cGVjdGVkIEJlYXJlcmApXG4gICAgfVxuXG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHRoaXMuc2VjcmV0LCB7IGFsZ29yaXRobXM6IFsnSFMyNTYnXSB9KVxuXG4gICAgaWYgKGRlY29kZWQuaWRlbnRpdHlfcHJvb2Zfb25seSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgcmV0dXJuIGRlY29kZWQudXNlclxuICB9XG5cbiAgZ2V0QXV0aGVudGljYXRpb25JbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAncm9vdCdcbiAgICB9XG4gIH1cblxuICBhc3luYyByZWZyZXNoVG9rZW4oYXV0aEhlYWRlcikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBsb2dpblVzZXIgPSBhd2FpdCB0aGlzLmF1dGhlbnRpY2F0ZVdpdGhFcnJvcihhdXRoSGVhZGVyKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgdG9rZW46IGF3YWl0IHRoaXMuYnVpbGRUb2tlbihsb2dpblVzZXIpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgcmVhc29uOiBlcnIubWVzc2FnZSB8fCAnVGhlIHRva2VuIGlzIGludmFsaWQgb3IgZXhwaXJlZCdcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRVc2VySWRlbnRpdHkodG9rZW4pIHtcbiAgICByZXR1cm4gdGhpcy5hdXRoZW50aWNhdGVXaXRoRXJyb3IoJ2JlYXJlciAnICsgdG9rZW4pXG4gIH1cblxuICBhc3luYyBnZXRKV1RTZWNyZXRPckNlcnRpZmljYXRlKCkge1xuICAgIHJldHVybiB0aGlzLnNlY3JldFxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/security/root/index.js\n");

/***/ }),

/***/ "./src/server/anonymous.js":
/*!*********************************!*\
  !*** ./src/server/anonymous.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp, app) {\n  app.get('/api/auth/info', function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(req, res) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              bp.stats.track('api', 'auth', 'info');\n              res.json(bp.security.getAuthenticationInfo());\n\n            case 2:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  app.post('/api/auth/refresh_token', function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(req, res) {\n      var result;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              bp.stats.track('api', 'auth', 'refresh_token');\n              _context2.next = 3;\n              return bp.security.refreshToken(req.headers.authorization);\n\n            case 3:\n              result = _context2.sent;\n\n              if (result.success) {\n                res.send(result.token);\n              } else {\n                res.status(400).send(result.reason);\n              }\n\n            case 5:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function (_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n\n  app.post('/api/login', function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(req, res) {\n      var result;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              bp.stats.track('api', 'auth', 'login');\n              _context3.next = 3;\n              return bp.security.login(req.body.user, req.body.password, req.ip);\n\n            case 3:\n              result = _context3.sent;\n\n              res.send(result);\n\n            case 5:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function (_x5, _x6) {\n      return _ref3.apply(this, arguments);\n    };\n  }());\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL2Fub255bW91cy5qcz82MzBkIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJicCIsImFwcCIsImdldCIsInJlcSIsInJlcyIsInN0YXRzIiwidHJhY2siLCJqc29uIiwic2VjdXJpdHkiLCJnZXRBdXRoZW50aWNhdGlvbkluZm8iLCJwb3N0IiwicmVmcmVzaFRva2VuIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJyZXN1bHQiLCJzdWNjZXNzIiwic2VuZCIsInRva2VuIiwic3RhdHVzIiwicmVhc29uIiwibG9naW4iLCJib2R5IiwidXNlciIsInBhc3N3b3JkIiwiaXAiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQUEsT0FBT0MsT0FBUCxHQUFpQixVQUFDQyxFQUFELEVBQUtDLEdBQUwsRUFBYTtBQUM1QkEsTUFBSUMsR0FBSixDQUFRLGdCQUFSO0FBQUEsdUVBQTBCLGlCQUFPQyxHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUN4QkosaUJBQUdLLEtBQUgsQ0FBU0MsS0FBVCxDQUFlLEtBQWYsRUFBc0IsTUFBdEIsRUFBOEIsTUFBOUI7QUFDQUYsa0JBQUlHLElBQUosQ0FBU1AsR0FBR1EsUUFBSCxDQUFZQyxxQkFBWixFQUFUOztBQUZ3QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUExQjs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFLQVIsTUFBSVMsSUFBSixDQUFTLHlCQUFUO0FBQUEsd0VBQW9DLGtCQUFPUCxHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ2xDSixpQkFBR0ssS0FBSCxDQUFTQyxLQUFULENBQWUsS0FBZixFQUFzQixNQUF0QixFQUE4QixlQUE5QjtBQURrQztBQUFBLHFCQUViTixHQUFHUSxRQUFILENBQVlHLFlBQVosQ0FBeUJSLElBQUlTLE9BQUosQ0FBWUMsYUFBckMsQ0FGYTs7QUFBQTtBQUU1QkMsb0JBRjRCOztBQUdsQyxrQkFBSUEsT0FBT0MsT0FBWCxFQUFvQjtBQUNsQlgsb0JBQUlZLElBQUosQ0FBU0YsT0FBT0csS0FBaEI7QUFDRCxlQUZELE1BRU87QUFDTGIsb0JBQUljLE1BQUosQ0FBVyxHQUFYLEVBQWdCRixJQUFoQixDQUFxQkYsT0FBT0ssTUFBNUI7QUFDRDs7QUFQaUM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBcEM7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBVUFsQixNQUFJUyxJQUFKLENBQVMsWUFBVDtBQUFBLHdFQUF1QixrQkFBT1AsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNyQkosaUJBQUdLLEtBQUgsQ0FBU0MsS0FBVCxDQUFlLEtBQWYsRUFBc0IsTUFBdEIsRUFBOEIsT0FBOUI7QUFEcUI7QUFBQSxxQkFFQU4sR0FBR1EsUUFBSCxDQUFZWSxLQUFaLENBQWtCakIsSUFBSWtCLElBQUosQ0FBU0MsSUFBM0IsRUFBaUNuQixJQUFJa0IsSUFBSixDQUFTRSxRQUExQyxFQUFvRHBCLElBQUlxQixFQUF4RCxDQUZBOztBQUFBO0FBRWZWLG9CQUZlOztBQUdyQlYsa0JBQUlZLElBQUosQ0FBU0YsTUFBVDs7QUFIcUI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBdkI7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFLRCxDQXJCRCIsImZpbGUiOiIuL3NyYy9zZXJ2ZXIvYW5vbnltb3VzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSAoYnAsIGFwcCkgPT4ge1xuICBhcHAuZ2V0KCcvYXBpL2F1dGgvaW5mbycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLnN0YXRzLnRyYWNrKCdhcGknLCAnYXV0aCcsICdpbmZvJylcbiAgICByZXMuanNvbihicC5zZWN1cml0eS5nZXRBdXRoZW50aWNhdGlvbkluZm8oKSlcbiAgfSlcblxuICBhcHAucG9zdCgnL2FwaS9hdXRoL3JlZnJlc2hfdG9rZW4nLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBicC5zdGF0cy50cmFjaygnYXBpJywgJ2F1dGgnLCAncmVmcmVzaF90b2tlbicpXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYnAuc2VjdXJpdHkucmVmcmVzaFRva2VuKHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24pXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXMuc2VuZChyZXN1bHQudG9rZW4pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHJlc3VsdC5yZWFzb24pXG4gICAgfVxuICB9KVxuXG4gIGFwcC5wb3N0KCcvYXBpL2xvZ2luJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgYnAuc3RhdHMudHJhY2soJ2FwaScsICdhdXRoJywgJ2xvZ2luJylcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBicC5zZWN1cml0eS5sb2dpbihyZXEuYm9keS51c2VyLCByZXEuYm9keS5wYXNzd29yZCwgcmVxLmlwKVxuICAgIHJlcy5zZW5kKHJlc3VsdClcbiAgfSlcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/server/anonymous.js\n");

/***/ }),

/***/ "./src/server/api.js":
/*!***************************!*\
  !*** ./src/server/api.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bodyParser = __webpack_require__(/*! body-parser */ \"body-parser\");\n\nvar _bodyParser2 = _interopRequireDefault(_bodyParser);\n\nvar _express = __webpack_require__(/*! express */ \"express\");\n\nvar _queryString = __webpack_require__(/*! query-string */ \"query-string\");\n\nvar _queryString2 = _interopRequireDefault(_queryString);\n\nvar _utilRoles = __webpack_require__(/*! @botpress/util-roles */ \"@botpress/util-roles\");\n\nvar _anonymous = __webpack_require__(/*! ./anonymous */ \"./src/server/anonymous.js\");\n\nvar _anonymous2 = _interopRequireDefault(_anonymous);\n\nvar _nonSecured = __webpack_require__(/*! ./non-secured */ \"./src/server/non-secured.js\");\n\nvar _nonSecured2 = _interopRequireDefault(_nonSecured);\n\nvar _secured = __webpack_require__(/*! ./secured */ \"./src/server/secured.js\");\n\nvar _secured2 = _interopRequireDefault(_secured);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar routersConditions = {};\nvar routers = {};\n\nvar maybeApply = function maybeApply(name, fn) {\n  return function (req, res, next) {\n    var router = req.originalUrl.match(/\\/api\\/(botpress-[^\\/]+).*$/i);\n    if (!router) {\n      return fn(req, res, next);\n    }\n\n    if (!routersConditions[router[1]]) {\n      return fn(req, res, next);\n    }\n\n    var condition = routersConditions[router[1]][name];\n    if (condition === false) {\n      next();\n    } else if (typeof condition === 'function' && condition(req) === false) {\n      next();\n    } else {\n      return fn(req, res, next);\n    }\n  };\n};\n\nmodule.exports = function (bp) {\n  var _authenticationMiddleware = function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(req, res, next) {\n      var user;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              res.maybeSendRequireLogin = function () {\n                if (!bp.botfile.login.enabled) {\n                  res.status(400).send({\n                    message: 'Login must be turned on for this API method'\n                  });\n\n                  return true;\n                } else {\n                  return false;\n                }\n              };\n\n              if (bp.botfile.login.enabled) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt('return', next());\n\n            case 3:\n              _context.next = 5;\n              return bp.security.authenticate(req.headers.authorization);\n\n            case 5:\n              user = _context.sent;\n\n              if (!!user) {\n                req.user = user;\n                next();\n              } else {\n                res.status(401).location('/login').end();\n              }\n\n            case 7:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function _authenticationMiddleware(_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getCloudRoles = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(req) {\n      var _bp$botfile$login, useCloud, enabled, isUsingCloud, _ref3, roles;\n\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _bp$botfile$login = bp.botfile.login, useCloud = _bp$botfile$login.useCloud, enabled = _bp$botfile$login.enabled;\n              _context2.t0 = !!useCloud;\n\n              if (!_context2.t0) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 5;\n              return bp.cloud.isPaired();\n\n            case 5:\n              _context2.t0 = _context2.sent;\n\n            case 6:\n              isUsingCloud = _context2.t0;\n\n              if (!(!isUsingCloud || !enabled)) {\n                _context2.next = 9;\n                break;\n              }\n\n              return _context2.abrupt('return', false);\n\n            case 9:\n              _ref3 = req.user || {}, roles = _ref3.roles;\n\n              if (roles) {\n                _context2.next = 12;\n                break;\n              }\n\n              return _context2.abrupt('return', null);\n\n            case 12:\n              return _context2.abrupt('return', bp.cloud.getUserRoles(roles));\n\n            case 13:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function getCloudRoles(_x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var installProtector = function installProtector(app) {\n    app.secure = function (operation, resource) {\n      var wrap = function wrap(method) {\n        return function (route) {\n          for (var _len = arguments.length, handlers = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            handlers[_key - 1] = arguments[_key];\n          }\n\n          var secureMiddleware = function () {\n            var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(req, res, next) {\n              var roles;\n              return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                while (1) {\n                  switch (_context3.prev = _context3.next) {\n                    case 0:\n                      _context3.prev = 0;\n                      _context3.next = 3;\n                      return getCloudRoles(req);\n\n                    case 3:\n                      roles = _context3.sent;\n\n                      if (!(roles === false)) {\n                        _context3.next = 6;\n                        break;\n                      }\n\n                      return _context3.abrupt('return', next());\n\n                    case 6:\n                      if ((0, _utilRoles.checkMultipleRoles)(roles, operation, resource)) {\n                        _context3.next = 8;\n                        break;\n                      }\n\n                      return _context3.abrupt('return', res.sendStatus(403));\n\n                    case 8:\n                      return _context3.abrupt('return', next());\n\n                    case 11:\n                      _context3.prev = 11;\n                      _context3.t0 = _context3['catch'](0);\n                      return _context3.abrupt('return', res.status(500).send({ message: _context3.t0.message }));\n\n                    case 14:\n                    case 'end':\n                      return _context3.stop();\n                  }\n                }\n              }, _callee3, undefined, [[0, 11]]);\n            }));\n\n            return function secureMiddleware(_x5, _x6, _x7) {\n              return _ref4.apply(this, arguments);\n            };\n          }();\n\n          return app[method].apply(app, [route, secureMiddleware].concat(handlers));\n        };\n      };\n\n      return {\n        get: wrap('get'),\n        post: wrap('post'),\n        put: wrap('put'),\n        patch: wrap('patch'),\n        delete: wrap('delete')\n      };\n    };\n  };\n\n  var installRouter = function installRouter(app) {\n    /**\n     * Creates an HTTP [Express Router]{@link https://expressjs.com/} that is protected by authentication\n     * The router routes are available at \"http://bot_url/api/:name\"\n     * Where `name` is a string starting with `botpress-`\n     * @func\n     * @alias getRouter\n     * @memberOf! Botpress\n     * @param  {String} name       The name of the router. Must start with `botpress-`\n     * @param  {object=} [conditions] See examples. Conditionally disables built-in Botpress middlewares.\n     * @example\n     * const securedRouter = bp.getRouter('botpress-custom')\n     * const publicRouter = bp.getRouter('botpress-custom', { auth: false })\n     *\n     * // Conditions can also be used like below\n     * const conditions = { 'auth': req => !/\\/webhook/i.test(req.originalUrl) }\n     * const conditionalAuthentication = bp.getRouter('botpress-custom', conditions)\n     */\n    bp.getRouter = function (name, conditions) {\n      if (!/^botpress-/.test(name)) {\n        throw new Error('The name of a router must start with \\'botpress-\\'. Received: ' + name);\n      }\n\n      if (!routers[name]) {\n        var router = (0, _express.Router)();\n        routers[name] = router;\n        app.use('/api/' + name + '/', router);\n      }\n\n      if (conditions) {\n        routersConditions[name] = Object.assign(routersConditions[name] || {}, conditions);\n      }\n\n      installProtector(routers[name]);\n      return routers[name];\n    };\n\n    var links = {};\n\n    /**\n     * Creates a short link for a specific API route, making it easier to share, more verbose and elegant.\n     * Short links are available as `http://bot_url/s/{name}`\n     * @alias  createShortlink\n     * @param  {String} name        Unique, url-friendly name of the short link\n     * @param  {String} destination The original route to redirect to\n     * @param  {Object} params      Query parameters to pass the route. Will be serialized.\n     * @memberof! Botpress\n     * @example\n     *   const config = {\n    botName: 'Superbot',\n    botConvoDescription: \"Tell me something!\",\n    backgroundColor: '#ffffff'\n    }\n    // Visiting \"http://bot_url/s/chat\" will display the webchat in fullscreen\n    bp.createShortlink('chat', '/lite', {\n    m: 'channel-web',\n    v: 'fullscreen',\n    options: JSON.stringify({ config: config })\n    })\n     */\n    bp.createShortlink = function (name, destination, params) {\n      name = name.toLowerCase();\n\n      if (links[name]) {\n        throw new Error('There\\'s already a shortlink named \"' + name + '\"');\n      }\n\n      var q = params ? '?' + _queryString2.default.stringify(params) : '';\n      links[name] = '' + destination + q;\n    };\n\n    app.get('/s/:name', function (req, res) {\n      var name = req.params.name.toLowerCase();\n\n      if (!links[name]) {\n        return res.status(404).send({ error: 'Shortlink \"' + name + '\" not registered' });\n      }\n\n      res.redirect(links[name]);\n    });\n  };\n\n  var installMaybeUse = function installMaybeUse(app) {\n    app.maybeUse = function () {\n      if (arguments.length === 3) {\n        app.use(arguments[0], maybeApply(arguments[1], arguments[2]));\n      } else if (arguments.length === 2) {\n        app.use(maybeApply(arguments[0], arguments[1]));\n      }\n    };\n  };\n\n  var install = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(app) {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              installRouter(app);\n              installProtector(app);\n              installMaybeUse(app);\n\n              app.maybeUse('bodyParser.json', _bodyParser2.default.json({ limit: _lodash2.default.get(bp.botfile, 'api.bodyMaxSize') || '1mb' }));\n              app.maybeUse('bodyParser.urlencoded', _bodyParser2.default.urlencoded({ extended: true }));\n\n              (0, _anonymous2.default)(bp, app);\n\n              app.use('/api/*', maybeApply('auth', _authenticationMiddleware));\n\n              (0, _nonSecured2.default)(bp, app);\n              (0, _secured2.default)(bp, app);\n\n            case 9:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function install(_x8) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return { install: install };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL2FwaS5qcz9iMTJmIl0sIm5hbWVzIjpbInJvdXRlcnNDb25kaXRpb25zIiwicm91dGVycyIsIm1heWJlQXBwbHkiLCJuYW1lIiwiZm4iLCJyZXEiLCJyZXMiLCJuZXh0Iiwicm91dGVyIiwib3JpZ2luYWxVcmwiLCJtYXRjaCIsImNvbmRpdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiLCJfYXV0aGVudGljYXRpb25NaWRkbGV3YXJlIiwibWF5YmVTZW5kUmVxdWlyZUxvZ2luIiwiYnAiLCJib3RmaWxlIiwibG9naW4iLCJlbmFibGVkIiwic3RhdHVzIiwic2VuZCIsIm1lc3NhZ2UiLCJzZWN1cml0eSIsImF1dGhlbnRpY2F0ZSIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwidXNlciIsImxvY2F0aW9uIiwiZW5kIiwiZ2V0Q2xvdWRSb2xlcyIsInVzZUNsb3VkIiwiY2xvdWQiLCJpc1BhaXJlZCIsImlzVXNpbmdDbG91ZCIsInJvbGVzIiwiZ2V0VXNlclJvbGVzIiwiaW5zdGFsbFByb3RlY3RvciIsImFwcCIsInNlY3VyZSIsIm9wZXJhdGlvbiIsInJlc291cmNlIiwid3JhcCIsInJvdXRlIiwiaGFuZGxlcnMiLCJzZWN1cmVNaWRkbGV3YXJlIiwic2VuZFN0YXR1cyIsIm1ldGhvZCIsImdldCIsInBvc3QiLCJwdXQiLCJwYXRjaCIsImRlbGV0ZSIsImluc3RhbGxSb3V0ZXIiLCJnZXRSb3V0ZXIiLCJjb25kaXRpb25zIiwidGVzdCIsIkVycm9yIiwidXNlIiwiT2JqZWN0IiwiYXNzaWduIiwibGlua3MiLCJjcmVhdGVTaG9ydGxpbmsiLCJkZXN0aW5hdGlvbiIsInBhcmFtcyIsInRvTG93ZXJDYXNlIiwicSIsInFzIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJyZWRpcmVjdCIsImluc3RhbGxNYXliZVVzZSIsIm1heWJlVXNlIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiaW5zdGFsbCIsImJvZHlQYXJzZXIiLCJqc29u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VUFBVSxDQUFWLENBQXpCLENBQXRCO0FBQ0QsT0FGRCxNQUVPLElBQUlBLFVBQVVDLE1BQVYsS0FBcUIsQ0FBekIsRUFBNEI7QUFDakNwQyxZQUFJb0IsR0FBSixDQUFReEQsV0FBV3VFLFVBQVUsQ0FBVixDQUFYLEVBQXlCQSxVQUFVLENBQVYsQ0FBekIsQ0FBUjtBQUNEO0FBQ0YsS0FORDtBQU9ELEdBUkQ7O0FBVUEsTUFBTUU7QUFBQSx3RUFBVSxrQkFBTXJDLEdBQU47QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNkZSw0QkFBY2YsR0FBZDtBQUNBRCwrQkFBaUJDLEdBQWpCO0FBQ0FpQyw4QkFBZ0JqQyxHQUFoQjs7QUFFQUEsa0JBQUlrQyxRQUFKLENBQWEsaUJBQWIsRUFBZ0NJLHFCQUFXQyxJQUFYLENBQWdCLEVBQUVDLE9BQU9DLGlCQUFFL0IsR0FBRixDQUFNaEMsR0FBR0MsT0FBVCxFQUFrQixpQkFBbEIsS0FBd0MsS0FBakQsRUFBaEIsQ0FBaEM7QUFDQXFCLGtCQUFJa0MsUUFBSixDQUFhLHVCQUFiLEVBQXNDSSxxQkFBV0ksVUFBWCxDQUFzQixFQUFFQyxVQUFVLElBQVosRUFBdEIsQ0FBdEM7O0FBRUEsdUNBQWNqRSxFQUFkLEVBQWtCc0IsR0FBbEI7O0FBRUFBLGtCQUFJb0IsR0FBSixDQUFRLFFBQVIsRUFBa0J4RCxXQUFXLE1BQVgsRUFBbUJZLHlCQUFuQixDQUFsQjs7QUFFQSx3Q0FBZUUsRUFBZixFQUFtQnNCLEdBQW5CO0FBQ0EscUNBQVl0QixFQUFaLEVBQWdCc0IsR0FBaEI7O0FBYmM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBVjs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQWdCQSxTQUFPLEVBQUVxQyxnQkFBRixFQUFQO0FBQ0QsQ0E1TEQiLCJmaWxlIjoiLi9zcmMvc2VydmVyL2FwaS5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBib2R5UGFyc2VyIGZyb20gJ2JvZHktcGFyc2VyJ1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcydcbmltcG9ydCBxcyBmcm9tICdxdWVyeS1zdHJpbmcnXG5pbXBvcnQgeyBjaGVja011bHRpcGxlUm9sZXMgfSBmcm9tICdAYm90cHJlc3MvdXRpbC1yb2xlcydcblxuaW1wb3J0IGFub255bW91c0FwaXMgZnJvbSAnLi9hbm9ueW1vdXMnXG5pbXBvcnQgbm9uU2VjdXJlZEFwaXMgZnJvbSAnLi9ub24tc2VjdXJlZCdcbmltcG9ydCBzZWN1cmVkQXBpcyBmcm9tICcuL3NlY3VyZWQnXG5cbmNvbnN0IHJvdXRlcnNDb25kaXRpb25zID0ge31cbmNvbnN0IHJvdXRlcnMgPSB7fVxuXG5jb25zdCBtYXliZUFwcGx5ID0gKG5hbWUsIGZuKSA9PiB7XG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCByb3V0ZXIgPSByZXEub3JpZ2luYWxVcmwubWF0Y2goL1xcL2FwaVxcLyhib3RwcmVzcy1bXlxcL10rKS4qJC9pKVxuICAgIGlmICghcm91dGVyKSB7XG4gICAgICByZXR1cm4gZm4ocmVxLCByZXMsIG5leHQpXG4gICAgfVxuXG4gICAgaWYgKCFyb3V0ZXJzQ29uZGl0aW9uc1tyb3V0ZXJbMV1dKSB7XG4gICAgICByZXR1cm4gZm4ocmVxLCByZXMsIG5leHQpXG4gICAgfVxuXG4gICAgY29uc3QgY29uZGl0aW9uID0gcm91dGVyc0NvbmRpdGlvbnNbcm91dGVyWzFdXVtuYW1lXVxuICAgIGlmIChjb25kaXRpb24gPT09IGZhbHNlKSB7XG4gICAgICBuZXh0KClcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb25kaXRpb24gPT09ICdmdW5jdGlvbicgJiYgY29uZGl0aW9uKHJlcSkgPT09IGZhbHNlKSB7XG4gICAgICBuZXh0KClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZuKHJlcSwgcmVzLCBuZXh0KVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJwID0+IHtcbiAgY29uc3QgX2F1dGhlbnRpY2F0aW9uTWlkZGxld2FyZSA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHJlcy5tYXliZVNlbmRSZXF1aXJlTG9naW4gPSAoKSA9PiB7XG4gICAgICBpZiAoIWJwLmJvdGZpbGUubG9naW4uZW5hYmxlZCkge1xuICAgICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZCh7XG4gICAgICAgICAgbWVzc2FnZTogJ0xvZ2luIG11c3QgYmUgdHVybmVkIG9uIGZvciB0aGlzIEFQSSBtZXRob2QnXG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghYnAuYm90ZmlsZS5sb2dpbi5lbmFibGVkKSB7XG4gICAgICByZXR1cm4gbmV4dCgpXG4gICAgfVxuXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGJwLnNlY3VyaXR5LmF1dGhlbnRpY2F0ZShyZXEuaGVhZGVycy5hdXRob3JpemF0aW9uKVxuICAgIGlmICghIXVzZXIpIHtcbiAgICAgIHJlcS51c2VyID0gdXNlclxuICAgICAgbmV4dCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDQwMSlcbiAgICAgICAgLmxvY2F0aW9uKCcvbG9naW4nKVxuICAgICAgICAuZW5kKClcbiAgICB9XG4gIH1cblxuICBjb25zdCBnZXRDbG91ZFJvbGVzID0gYXN5bmMgcmVxID0+IHtcbiAgICBjb25zdCB7IHVzZUNsb3VkLCBlbmFibGVkIH0gPSBicC5ib3RmaWxlLmxvZ2luXG4gICAgY29uc3QgaXNVc2luZ0Nsb3VkID0gISF1c2VDbG91ZCAmJiAoYXdhaXQgYnAuY2xvdWQuaXNQYWlyZWQoKSlcbiAgICBpZiAoIWlzVXNpbmdDbG91ZCB8fCAhZW5hYmxlZCkge1xuICAgICAgLy8gTm8gY2xvdWQsIHNraXAgY2hlY2tcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICBjb25zdCB7IHJvbGVzIH0gPSByZXEudXNlciB8fCB7fVxuICAgIGlmICghcm9sZXMpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIHJldHVybiBicC5jbG91ZC5nZXRVc2VyUm9sZXMocm9sZXMpXG4gIH1cblxuICBjb25zdCBpbnN0YWxsUHJvdGVjdG9yID0gYXBwID0+IHtcbiAgICBhcHAuc2VjdXJlID0gKG9wZXJhdGlvbiwgcmVzb3VyY2UpID0+IHtcbiAgICAgIGNvbnN0IHdyYXAgPSBtZXRob2QgPT4gKHJvdXRlLCAuLi5oYW5kbGVycykgPT4ge1xuICAgICAgICBjb25zdCBzZWN1cmVNaWRkbGV3YXJlID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJvbGVzID0gYXdhaXQgZ2V0Q2xvdWRSb2xlcyhyZXEpXG5cbiAgICAgICAgICAgIGlmIChyb2xlcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG5leHQoKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWNoZWNrTXVsdGlwbGVSb2xlcyhyb2xlcywgb3BlcmF0aW9uLCByZXNvdXJjZSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMykgLy8gRm9yYmlkZGVuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBuZXh0KClcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IG1lc3NhZ2U6IGVyci5tZXNzYWdlIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGFwcFttZXRob2RdKHJvdXRlLCBzZWN1cmVNaWRkbGV3YXJlLCAuLi5oYW5kbGVycylcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiB3cmFwKCdnZXQnKSxcbiAgICAgICAgcG9zdDogd3JhcCgncG9zdCcpLFxuICAgICAgICBwdXQ6IHdyYXAoJ3B1dCcpLFxuICAgICAgICBwYXRjaDogd3JhcCgncGF0Y2gnKSxcbiAgICAgICAgZGVsZXRlOiB3cmFwKCdkZWxldGUnKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGluc3RhbGxSb3V0ZXIgPSBhcHAgPT4ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gSFRUUCBbRXhwcmVzcyBSb3V0ZXJde0BsaW5rIGh0dHBzOi8vZXhwcmVzc2pzLmNvbS99IHRoYXQgaXMgcHJvdGVjdGVkIGJ5IGF1dGhlbnRpY2F0aW9uXG4gICAgICogVGhlIHJvdXRlciByb3V0ZXMgYXJlIGF2YWlsYWJsZSBhdCBcImh0dHA6Ly9ib3RfdXJsL2FwaS86bmFtZVwiXG4gICAgICogV2hlcmUgYG5hbWVgIGlzIGEgc3RyaW5nIHN0YXJ0aW5nIHdpdGggYGJvdHByZXNzLWBcbiAgICAgKiBAZnVuY1xuICAgICAqIEBhbGlhcyBnZXRSb3V0ZXJcbiAgICAgKiBAbWVtYmVyT2YhIEJvdHByZXNzXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBuYW1lICAgICAgIFRoZSBuYW1lIG9mIHRoZSByb3V0ZXIuIE11c3Qgc3RhcnQgd2l0aCBgYm90cHJlc3MtYFxuICAgICAqIEBwYXJhbSAge29iamVjdD19IFtjb25kaXRpb25zXSBTZWUgZXhhbXBsZXMuIENvbmRpdGlvbmFsbHkgZGlzYWJsZXMgYnVpbHQtaW4gQm90cHJlc3MgbWlkZGxld2FyZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzZWN1cmVkUm91dGVyID0gYnAuZ2V0Um91dGVyKCdib3RwcmVzcy1jdXN0b20nKVxuICAgICAqIGNvbnN0IHB1YmxpY1JvdXRlciA9IGJwLmdldFJvdXRlcignYm90cHJlc3MtY3VzdG9tJywgeyBhdXRoOiBmYWxzZSB9KVxuICAgICAqXG4gICAgICogLy8gQ29uZGl0aW9ucyBjYW4gYWxzbyBiZSB1c2VkIGxpa2UgYmVsb3dcbiAgICAgKiBjb25zdCBjb25kaXRpb25zID0geyAnYXV0aCc6IHJlcSA9PiAhL1xcL3dlYmhvb2svaS50ZXN0KHJlcS5vcmlnaW5hbFVybCkgfVxuICAgICAqIGNvbnN0IGNvbmRpdGlvbmFsQXV0aGVudGljYXRpb24gPSBicC5nZXRSb3V0ZXIoJ2JvdHByZXNzLWN1c3RvbScsIGNvbmRpdGlvbnMpXG4gICAgICovXG4gICAgYnAuZ2V0Um91dGVyID0gKG5hbWUsIGNvbmRpdGlvbnMpID0+IHtcbiAgICAgIGlmICghL15ib3RwcmVzcy0vLnRlc3QobmFtZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgbmFtZSBvZiBhIHJvdXRlciBtdXN0IHN0YXJ0IHdpdGggJ2JvdHByZXNzLScuIFJlY2VpdmVkOiAke25hbWV9YClcbiAgICAgIH1cblxuICAgICAgaWYgKCFyb3V0ZXJzW25hbWVdKSB7XG4gICAgICAgIGNvbnN0IHJvdXRlciA9IFJvdXRlcigpXG4gICAgICAgIHJvdXRlcnNbbmFtZV0gPSByb3V0ZXJcbiAgICAgICAgYXBwLnVzZShgL2FwaS8ke25hbWV9L2AsIHJvdXRlcilcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmRpdGlvbnMpIHtcbiAgICAgICAgcm91dGVyc0NvbmRpdGlvbnNbbmFtZV0gPSBPYmplY3QuYXNzaWduKHJvdXRlcnNDb25kaXRpb25zW25hbWVdIHx8IHt9LCBjb25kaXRpb25zKVxuICAgICAgfVxuXG4gICAgICBpbnN0YWxsUHJvdGVjdG9yKHJvdXRlcnNbbmFtZV0pXG4gICAgICByZXR1cm4gcm91dGVyc1tuYW1lXVxuICAgIH1cblxuICAgIGNvbnN0IGxpbmtzID0ge31cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzaG9ydCBsaW5rIGZvciBhIHNwZWNpZmljIEFQSSByb3V0ZSwgbWFraW5nIGl0IGVhc2llciB0byBzaGFyZSwgbW9yZSB2ZXJib3NlIGFuZCBlbGVnYW50LlxuICAgICAqIFNob3J0IGxpbmtzIGFyZSBhdmFpbGFibGUgYXMgYGh0dHA6Ly9ib3RfdXJsL3Mve25hbWV9YFxuICAgICAqIEBhbGlhcyAgY3JlYXRlU2hvcnRsaW5rXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBuYW1lICAgICAgICBVbmlxdWUsIHVybC1mcmllbmRseSBuYW1lIG9mIHRoZSBzaG9ydCBsaW5rXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBkZXN0aW5hdGlvbiBUaGUgb3JpZ2luYWwgcm91dGUgdG8gcmVkaXJlY3QgdG9cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IHBhcmFtcyAgICAgIFF1ZXJ5IHBhcmFtZXRlcnMgdG8gcGFzcyB0aGUgcm91dGUuIFdpbGwgYmUgc2VyaWFsaXplZC5cbiAgICAgKiBAbWVtYmVyb2YhIEJvdHByZXNzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgYm90TmFtZTogJ1N1cGVyYm90JyxcbiAgYm90Q29udm9EZXNjcmlwdGlvbjogXCJUZWxsIG1lIHNvbWV0aGluZyFcIixcbiAgYmFja2dyb3VuZENvbG9yOiAnI2ZmZmZmZidcbn1cblxuLy8gVmlzaXRpbmcgXCJodHRwOi8vYm90X3VybC9zL2NoYXRcIiB3aWxsIGRpc3BsYXkgdGhlIHdlYmNoYXQgaW4gZnVsbHNjcmVlblxuYnAuY3JlYXRlU2hvcnRsaW5rKCdjaGF0JywgJy9saXRlJywge1xuICBtOiAnY2hhbm5lbC13ZWInLFxuICB2OiAnZnVsbHNjcmVlbicsXG4gIG9wdGlvbnM6IEpTT04uc3RyaW5naWZ5KHsgY29uZmlnOiBjb25maWcgfSlcbn0pXG4gICAgICovXG4gICAgYnAuY3JlYXRlU2hvcnRsaW5rID0gKG5hbWUsIGRlc3RpbmF0aW9uLCBwYXJhbXMpID0+IHtcbiAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKClcblxuICAgICAgaWYgKGxpbmtzW25hbWVdKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlcmUncyBhbHJlYWR5IGEgc2hvcnRsaW5rIG5hbWVkIFwiJHtuYW1lfVwiYClcbiAgICAgIH1cblxuICAgICAgY29uc3QgcSA9IHBhcmFtcyA/ICc/JyArIHFzLnN0cmluZ2lmeShwYXJhbXMpIDogJydcbiAgICAgIGxpbmtzW25hbWVdID0gYCR7ZGVzdGluYXRpb259JHtxfWBcbiAgICB9XG5cbiAgICBhcHAuZ2V0KGAvcy86bmFtZWAsIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9IHJlcS5wYXJhbXMubmFtZS50b0xvd2VyQ2FzZSgpXG5cbiAgICAgIGlmICghbGlua3NbbmFtZV0pIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHsgZXJyb3I6IGBTaG9ydGxpbmsgXCIke25hbWV9XCIgbm90IHJlZ2lzdGVyZWRgIH0pXG4gICAgICB9XG5cbiAgICAgIHJlcy5yZWRpcmVjdChsaW5rc1tuYW1lXSlcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgaW5zdGFsbE1heWJlVXNlID0gYXBwID0+IHtcbiAgICBhcHAubWF5YmVVc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIGFwcC51c2UoYXJndW1lbnRzWzBdLCBtYXliZUFwcGx5KGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKSlcbiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBhcHAudXNlKG1heWJlQXBwbHkoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0pKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGluc3RhbGwgPSBhc3luYyBhcHAgPT4ge1xuICAgIGluc3RhbGxSb3V0ZXIoYXBwKVxuICAgIGluc3RhbGxQcm90ZWN0b3IoYXBwKVxuICAgIGluc3RhbGxNYXliZVVzZShhcHApXG5cbiAgICBhcHAubWF5YmVVc2UoJ2JvZHlQYXJzZXIuanNvbicsIGJvZHlQYXJzZXIuanNvbih7IGxpbWl0OiBfLmdldChicC5ib3RmaWxlLCAnYXBpLmJvZHlNYXhTaXplJykgfHwgJzFtYicgfSkpXG4gICAgYXBwLm1heWJlVXNlKCdib2R5UGFyc2VyLnVybGVuY29kZWQnLCBib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSlcblxuICAgIGFub255bW91c0FwaXMoYnAsIGFwcClcblxuICAgIGFwcC51c2UoJy9hcGkvKicsIG1heWJlQXBwbHkoJ2F1dGgnLCBfYXV0aGVudGljYXRpb25NaWRkbGV3YXJlKSlcblxuICAgIG5vblNlY3VyZWRBcGlzKGJwLCBhcHApXG4gICAgc2VjdXJlZEFwaXMoYnAsIGFwcClcbiAgfVxuXG4gIHJldHVybiB7IGluc3RhbGwgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/server/api.js\n");

/***/ }),

/***/ "./src/server/index.js":
/*!*****************************!*\
  !*** ./src/server/index.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _express = __webpack_require__(/*! express */ \"express\");\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _compression = __webpack_require__(/*! compression */ \"compression\");\n\nvar _compression2 = _interopRequireDefault(_compression);\n\nvar _http = __webpack_require__(/*! http */ \"http\");\n\nvar _http2 = _interopRequireDefault(_http);\n\nvar _socket = __webpack_require__(/*! ./socket */ \"./src/server/socket.js\");\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _static = __webpack_require__(/*! ./static */ \"./src/server/static.js\");\n\nvar _static2 = _interopRequireDefault(_static);\n\nvar _api = __webpack_require__(/*! ./api */ \"./src/server/api.js\");\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp) {\n  var serveApi = function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(app) {\n      var api;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              api = (0, _api2.default)(bp);\n              return _context.abrupt('return', api.install(app));\n\n            case 2:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function serveApi(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var serveSocket = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(server) {\n      var socket;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              socket = (0, _socket2.default)(bp);\n              return _context2.abrupt('return', socket.install(server));\n\n            case 2:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function serveSocket(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var serveStatic = function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(app) {\n      var staticStuff;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              staticStuff = (0, _static2.default)(bp);\n              return _context3.abrupt('return', staticStuff.install(app));\n\n            case 2:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function serveStatic(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var start = function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n      var app, server, _bp$botfile, port, hostname;\n\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              app = (0, _express2.default)();\n\n              app.use((0, _compression2.default)());\n              server = _http2.default.createServer(app);\n              _bp$botfile = bp.botfile, port = _bp$botfile.port, hostname = _bp$botfile.hostname;\n              _context4.next = 6;\n              return serveApi(app);\n\n            case 6:\n              _context4.next = 8;\n              return serveSocket(server);\n\n            case 8:\n              _context4.next = 10;\n              return serveStatic(app);\n\n            case 10:\n              return _context4.abrupt('return', new Promise(function (resolve) {\n                server.listen(port, hostname, function () {\n                  return resolve(server);\n                });\n              }));\n\n            case 11:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function start() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return { start: start };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL2luZGV4LmpzP2FmODIiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsInNlcnZlQXBpIiwiYXBwIiwiYXBpIiwiYnAiLCJpbnN0YWxsIiwic2VydmVTb2NrZXQiLCJzZXJ2ZXIiLCJzb2NrZXQiLCJzZXJ2ZVN0YXRpYyIsInN0YXRpY1N0dWZmIiwic3RhcnQiLCJ1c2UiLCJodHRwIiwiY3JlYXRlU2VydmVyIiwiYm90ZmlsZSIsInBvcnQiLCJob3N0bmFtZSIsIlByb21pc2UiLCJsaXN0ZW4iLCJyZXNvbHZlIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7QUFFQUEsT0FBT0MsT0FBUCxHQUFpQixjQUFNO0FBQ3JCLE1BQU1DO0FBQUEsdUVBQVcsaUJBQU1DLEdBQU47QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ1RDLGlCQURTLEdBQ0gsbUJBQUlDLEVBQUosQ0FERztBQUFBLCtDQUVSRCxJQUFJRSxPQUFKLENBQVlILEdBQVosQ0FGUTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFYOztBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQU47O0FBS0EsTUFBTUk7QUFBQSx3RUFBYyxrQkFBTUMsTUFBTjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDWkMsb0JBRFksR0FDSCxzQkFBT0osRUFBUCxDQURHO0FBQUEsZ0RBRVhJLE9BQU9ILE9BQVAsQ0FBZUUsTUFBZixDQUZXOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQWQ7O0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBTjs7QUFLQSxNQUFNRTtBQUFBLHdFQUFjLGtCQUFNUCxHQUFOO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNaUSx5QkFEWSxHQUNFLHNCQUFPTixFQUFQLENBREY7QUFBQSxnREFFWE0sWUFBWUwsT0FBWixDQUFvQkgsR0FBcEIsQ0FGVzs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFkOztBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQU47O0FBS0EsTUFBTVM7QUFBQSx3RUFBUTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ05ULGlCQURNLEdBQ0Esd0JBREE7O0FBRVpBLGtCQUFJVSxHQUFKLENBQVEsNEJBQVI7QUFDTUwsb0JBSE0sR0FHR00sZUFBS0MsWUFBTCxDQUFrQlosR0FBbEIsQ0FISDtBQUFBLDRCQUllRSxHQUFHVyxPQUpsQixFQUlKQyxJQUpJLGVBSUpBLElBSkksRUFJRUMsUUFKRixlQUlFQSxRQUpGO0FBQUE7QUFBQSxxQkFNTmhCLFNBQVNDLEdBQVQsQ0FOTTs7QUFBQTtBQUFBO0FBQUEscUJBT05JLFlBQVlDLE1BQVosQ0FQTTs7QUFBQTtBQUFBO0FBQUEscUJBUU5FLFlBQVlQLEdBQVosQ0FSTTs7QUFBQTtBQUFBLGdEQVVMLElBQUlnQixPQUFKLENBQVksbUJBQVc7QUFDNUJYLHVCQUFPWSxNQUFQLENBQWNILElBQWQsRUFBb0JDLFFBQXBCLEVBQThCO0FBQUEseUJBQU1HLFFBQVFiLE1BQVIsQ0FBTjtBQUFBLGlCQUE5QjtBQUNELGVBRk0sQ0FWSzs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFSOztBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQU47O0FBZUEsU0FBTyxFQUFFSSxZQUFGLEVBQVA7QUFDRCxDQWhDRCIsImZpbGUiOiIuL3NyYy9zZXJ2ZXIvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJ1xuaW1wb3J0IGNvbXByZXNzaW9uIGZyb20gJ2NvbXByZXNzaW9uJ1xuaW1wb3J0IGh0dHAgZnJvbSAnaHR0cCdcblxuaW1wb3J0IFNvY2tldCBmcm9tICcuL3NvY2tldCdcbmltcG9ydCBTdGF0aWMgZnJvbSAnLi9zdGF0aWMnXG5pbXBvcnQgQXBpIGZyb20gJy4vYXBpJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IGJwID0+IHtcbiAgY29uc3Qgc2VydmVBcGkgPSBhc3luYyBhcHAgPT4ge1xuICAgIGNvbnN0IGFwaSA9IEFwaShicClcbiAgICByZXR1cm4gYXBpLmluc3RhbGwoYXBwKVxuICB9XG5cbiAgY29uc3Qgc2VydmVTb2NrZXQgPSBhc3luYyBzZXJ2ZXIgPT4ge1xuICAgIGNvbnN0IHNvY2tldCA9IFNvY2tldChicClcbiAgICByZXR1cm4gc29ja2V0Lmluc3RhbGwoc2VydmVyKVxuICB9XG5cbiAgY29uc3Qgc2VydmVTdGF0aWMgPSBhc3luYyBhcHAgPT4ge1xuICAgIGNvbnN0IHN0YXRpY1N0dWZmID0gU3RhdGljKGJwKVxuICAgIHJldHVybiBzdGF0aWNTdHVmZi5pbnN0YWxsKGFwcClcbiAgfVxuXG4gIGNvbnN0IHN0YXJ0ID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IGV4cHJlc3MoKVxuICAgIGFwcC51c2UoY29tcHJlc3Npb24oKSlcbiAgICBjb25zdCBzZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcihhcHApXG4gICAgY29uc3QgeyBwb3J0LCBob3N0bmFtZSB9ID0gYnAuYm90ZmlsZVxuXG4gICAgYXdhaXQgc2VydmVBcGkoYXBwKVxuICAgIGF3YWl0IHNlcnZlU29ja2V0KHNlcnZlcilcbiAgICBhd2FpdCBzZXJ2ZVN0YXRpYyhhcHApXG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICBzZXJ2ZXIubGlzdGVuKHBvcnQsIGhvc3RuYW1lLCAoKSA9PiByZXNvbHZlKHNlcnZlcikpXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiB7IHN0YXJ0IH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/server/index.js\n");

/***/ }),

/***/ "./src/server/non-secured.js":
/*!***********************************!*\
  !*** ./src/server/non-secured.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp, app) {\n  app.get('/api/ping', function (req, res) {\n    res.send('pong');\n  });\n\n  app.get('/api/license', function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(req, res) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = res;\n              _context.next = 3;\n              return bp.licensing.getLicensing();\n\n            case 3:\n              _context.t1 = _context.sent;\n\n              _context.t0.send.call(_context.t0, _context.t1);\n\n            case 5:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  app.delete('/api/guided-tour', function (req, res) {\n    _fs2.default.unlink(_path2.default.join(bp.projectLocation, '.welcome'), function () {\n      bp.isFirstRun = false;\n      res.sendStatus(200);\n    });\n  });\n\n  app.get('/api/my-account', function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(req, res) {\n      var roles;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return bp.cloud.getUserRoles(req.user.roles);\n\n            case 2:\n              roles = _context2.sent;\n\n              res.send(_extends({}, req.user, { roles: roles }));\n\n            case 4:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function (_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL25vbi1zZWN1cmVkLmpzP2JkNGUiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImJwIiwiYXBwIiwiZ2V0IiwicmVxIiwicmVzIiwic2VuZCIsImxpY2Vuc2luZyIsImdldExpY2Vuc2luZyIsImRlbGV0ZSIsImZzIiwidW5saW5rIiwicGF0aCIsImpvaW4iLCJwcm9qZWN0TG9jYXRpb24iLCJpc0ZpcnN0UnVuIiwic2VuZFN0YXR1cyIsImNsb3VkIiwiZ2V0VXNlclJvbGVzIiwidXNlciIsInJvbGVzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7QUFDQTs7OztBQUVBOzs7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLFVBQUNDLEVBQUQsRUFBS0MsR0FBTCxFQUFhO0FBQzVCQSxNQUFJQyxHQUFKLENBQVEsV0FBUixFQUFxQixVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUNqQ0EsUUFBSUMsSUFBSixDQUFTLE1BQVQ7QUFDRCxHQUZEOztBQUlBSixNQUFJQyxHQUFKLENBQVEsY0FBUjtBQUFBLHVFQUF3QixpQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSw0QkFDdEJBLEdBRHNCO0FBQUE7QUFBQSxxQkFDUEosR0FBR00sU0FBSCxDQUFhQyxZQUFiLEVBRE87O0FBQUE7QUFBQTs7QUFBQSwwQkFDbEJGLElBRGtCOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXhCOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBSixNQUFJTyxNQUFKLENBQVcsa0JBQVgsRUFBK0IsVUFBQ0wsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDM0NLLGlCQUFHQyxNQUFILENBQVVDLGVBQUtDLElBQUwsQ0FBVVosR0FBR2EsZUFBYixFQUE4QixVQUE5QixDQUFWLEVBQXFELFlBQU07QUFDekRiLFNBQUdjLFVBQUgsR0FBZ0IsS0FBaEI7QUFDQVYsVUFBSVcsVUFBSixDQUFlLEdBQWY7QUFDRCxLQUhEO0FBSUQsR0FMRDs7QUFPQWQsTUFBSUMsR0FBSixDQUFRLGlCQUFSO0FBQUEsd0VBQTJCLGtCQUFPQyxHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxxQkFDTEosR0FBR2dCLEtBQUgsQ0FBU0MsWUFBVCxDQUFzQmQsSUFBSWUsSUFBSixDQUFTQyxLQUEvQixDQURLOztBQUFBO0FBQ25CQSxtQkFEbUI7O0FBRXpCZixrQkFBSUMsSUFBSixjQUFjRixJQUFJZSxJQUFsQixJQUF3QkMsWUFBeEI7O0FBRnlCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQTNCOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUQsQ0FwQkQiLCJmaWxlIjoiLi9zcmMvc2VydmVyL25vbi1zZWN1cmVkLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcblxuaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcblxubW9kdWxlLmV4cG9ydHMgPSAoYnAsIGFwcCkgPT4ge1xuICBhcHAuZ2V0KCcvYXBpL3BpbmcnLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZCgncG9uZycpXG4gIH0pXG5cbiAgYXBwLmdldCgnL2FwaS9saWNlbnNlJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoYXdhaXQgYnAubGljZW5zaW5nLmdldExpY2Vuc2luZygpKVxuICB9KVxuXG4gIGFwcC5kZWxldGUoJy9hcGkvZ3VpZGVkLXRvdXInLCAocmVxLCByZXMpID0+IHtcbiAgICBmcy51bmxpbmsocGF0aC5qb2luKGJwLnByb2plY3RMb2NhdGlvbiwgJy53ZWxjb21lJyksICgpID0+IHtcbiAgICAgIGJwLmlzRmlyc3RSdW4gPSBmYWxzZVxuICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgIH0pXG4gIH0pXG5cbiAgYXBwLmdldCgnL2FwaS9teS1hY2NvdW50JywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3Qgcm9sZXMgPSBhd2FpdCBicC5jbG91ZC5nZXRVc2VyUm9sZXMocmVxLnVzZXIucm9sZXMpXG4gICAgcmVzLnNlbmQoeyAuLi5yZXEudXNlciwgcm9sZXMgfSlcbiAgfSlcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/server/non-secured.js\n");

/***/ }),

/***/ "./src/server/secured.js":
/*!*******************************!*\
  !*** ./src/server/secured.js ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _nanoid = __webpack_require__(/*! nanoid */ \"nanoid\");\n\nvar _nanoid2 = _interopRequireDefault(_nanoid);\n\nvar _multer = __webpack_require__(/*! multer */ \"multer\");\n\nvar _multer2 = _interopRequireDefault(_multer);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar logsSecret = (0, _nanoid2.default)();\n\nmodule.exports = function (bp, app) {\n  // modules\n\n  app.secure('read', 'bot.modules.list').get('/api/modules', function (req, res) {\n    var modules = _lodash2.default.map(bp._loadedModules, function (module) {\n      return {\n        name: _util2.default.getModuleShortname(module.name),\n        fullName: module.name,\n        homepage: module.homepage,\n        isPlugin: module.settings.isPlugin,\n        menuText: module.settings.menuText || module.name,\n        menuIcon: module.settings.menuIcon || 'view_module',\n        noInterface: !!module.settings.noInterface,\n        moduleView: module.settings.moduleView || { stretched: false },\n        plugins: module.settings.plugins || []\n      };\n    });\n    res.send(modules);\n  });\n\n  app.secure('read', 'bot.modules.list.community').get('/api/module/all', function (req, res) {\n    bp.modules.listAllCommunityModules().then(function (modules) {\n      return res.send(modules);\n    });\n  });\n\n  app.secure('read', 'bot.modules.list.community').get('/api/module/hero', function (req, res) {\n    bp.modules.getRandomCommunityHero().then(function (hero) {\n      return res.send(hero);\n    });\n  });\n\n  app.secure('read', 'bot.modules.list.community').get('/api/bot/contributor', function (req, res) {\n    res.send(bp.bot.getContributor());\n  });\n\n  // middleware\n\n  app.secure('read', 'bot.middleware.list').get('/api/middlewares', function (req, res) {\n    res.send(bp.middlewares.list());\n  });\n\n  app.secure('write', 'bot.middleware.customizations').post('/api/middlewares/customizations', function (req, res) {\n    bp.stats.track('api', 'middlewares', 'customizations');\n    var middlewares = req.body.middlewares;\n\n    bp.middlewares.setCustomizations(middlewares);\n    bp.middlewares.load();\n    res.send(bp.middlewares.list());\n  });\n\n  app.secure('write', 'bot.middleware.customizations').delete('/api/middlewares/customizations', function (req, res) {\n    bp.stats.track('api', 'middlewares', 'customizations');\n    bp.middlewares.resetCustomizations();\n    bp.middlewares.load();\n    res.send(bp.middlewares.list());\n  });\n\n  // notifications\n\n  // DEPRECATED in Botpress 1.1\n  app.secure('read', 'bot.notifications').get('/api/notifications', function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(req, res) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = res;\n              _context.next = 3;\n              return bp.notifications.getInbox();\n\n            case 3:\n              _context.t1 = _context.sent;\n\n              _context.t0.send.call(_context.t0, _context.t1);\n\n            case 5:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.notifications').get('/api/notifications/inbox', function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(req, res) {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.t0 = res;\n              _context2.next = 3;\n              return bp.notifications.getInbox();\n\n            case 3:\n              _context2.t1 = _context2.sent;\n\n              _context2.t0.send.call(_context2.t0, _context2.t1);\n\n            case 5:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function (_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n\n  // bot\n\n  app.secure('read', 'bot.information').get('/api/bot/information', function (req, res) {\n    res.send(bp.about.getBotInformation());\n  });\n\n  app.secure('write', 'bot.information.license').post('/api/license', function (req, res) {\n    bp.stats.track('api', 'license', 'change');\n    bp.licensing.changeLicense(req.body.license).then(function () {\n      res.sendStatus(200);\n    }).catch(function (err) {\n      return res.status(500).send({\n        message: err && err.message\n      });\n    });\n  });\n\n  app.secure('read', 'bot.logs').get('/api/logs', function (req, res) {\n    var options = {\n      from: new Date() - 7 * 24 * 60 * 60 * 1000,\n      until: new Date(),\n      limit: req.query && req.query.limit || 50,\n      start: 0,\n      order: 'desc',\n      fields: ['message', 'level', 'timestamp']\n    };\n\n    bp.logger.query(options, function (err, results) {\n      if (err) {\n        return console.log(err);\n      }\n      res.send(results.file);\n    });\n  });\n\n  app.secure('read', 'bot.logs').get('/api/logs/key', function (req, res) {\n    res.send({ secret: logsSecret });\n  });\n\n  app.secure('read', 'bot.logs.archive').get('/api/logs/archive/:key', function (req, res) {\n    bp.stats.track('api', 'logs', 'archive');\n    if (req.params.key !== logsSecret) {\n      return res.sendStatus(403);\n    }\n\n    bp.logger.archiveToFile().then(function (archivePath) {\n      logsSecret = (0, _nanoid2.default)();\n      res.download(archivePath);\n    });\n  });\n\n  app.secure('read', 'bot.content').get('/api/content/categories', function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(req, res) {\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.t0 = res;\n              _context3.next = 3;\n              return bp.contentManager.listAvailableCategories();\n\n            case 3:\n              _context3.t1 = _context3.sent;\n\n              _context3.t0.send.call(_context3.t0, _context3.t1);\n\n            case 5:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function (_x5, _x6) {\n      return _ref3.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.content').get('/api/content/items', function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(req, res) {\n      var from, count, _req$query, searchTerm, categoryId, orderBy;\n\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              from = req.query.from || 0;\n              count = req.query.count || 50;\n              _req$query = req.query, searchTerm = _req$query.searchTerm, categoryId = _req$query.categoryId, orderBy = _req$query.orderBy;\n\n\n              if (categoryId === 'all') {\n                categoryId = null;\n              }\n\n              _context4.t0 = res;\n              _context4.next = 7;\n              return bp.contentManager.listCategoryItems(categoryId, { from: from, count: count, searchTerm: searchTerm, orderBy: orderBy });\n\n            case 7:\n              _context4.t1 = _context4.sent;\n\n              _context4.t0.send.call(_context4.t0, _context4.t1);\n\n            case 9:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function (_x7, _x8) {\n      return _ref4.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.content').get('/api/content/items/count', function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(req, res) {\n      var categoryId;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              categoryId = req.query.categoryId;\n\n              if (categoryId === 'all') {\n                categoryId = null;\n              }\n              _context5.t0 = res;\n              _context5.next = 5;\n              return bp.contentManager.categoryItemsCount(categoryId);\n\n            case 5:\n              _context5.t1 = _context5.sent;\n              _context5.t2 = {\n                count: _context5.t1\n              };\n\n              _context5.t0.send.call(_context5.t0, _context5.t2);\n\n            case 8:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, undefined);\n    }));\n\n    return function (_x9, _x10) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.content').get('/api/content/items/:id', function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(req, res) {\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.t0 = res;\n              _context6.next = 3;\n              return bp.contentManager.getItem(req.params.id);\n\n            case 3:\n              _context6.t1 = _context6.sent;\n\n              _context6.t0.send.call(_context6.t0, _context6.t1);\n\n            case 5:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, undefined);\n    }));\n\n    return function (_x11, _x12) {\n      return _ref6.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.content').get('/api/content/items-batched/:ids', function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(req, res) {\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.t0 = res;\n              _context7.next = 3;\n              return bp.contentManager.getItems(req.params.ids);\n\n            case 3:\n              _context7.t1 = _context7.sent;\n\n              _context7.t0.send.call(_context7.t0, _context7.t1);\n\n            case 5:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, undefined);\n    }));\n\n    return function (_x13, _x14) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot.content').post('/api/content/categories/:id/items', function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(req, res) {\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.t0 = res;\n              _context8.next = 3;\n              return bp.contentManager.createOrUpdateCategoryItem({\n                formData: req.body.formData,\n                categoryId: req.params.id\n              });\n\n            case 3:\n              _context8.t1 = _context8.sent;\n\n              _context8.t0.send.call(_context8.t0, _context8.t1);\n\n            case 5:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, undefined);\n    }));\n\n    return function (_x15, _x16) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot.content').post('/api/content/categories/:id/items/:itemId', function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(req, res) {\n      return regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.next = 2;\n              return bp.contentManager.createOrUpdateCategoryItem({\n                itemId: req.params.itemId,\n                formData: req.body.formData,\n                categoryId: req.params.id\n              });\n\n            case 2:\n              res.sendStatus(200);\n\n            case 3:\n            case 'end':\n              return _context9.stop();\n          }\n        }\n      }, _callee9, undefined);\n    }));\n\n    return function (_x17, _x18) {\n      return _ref9.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot.content').post('/api/content/categories/all/bulk_delete', function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(req, res) {\n      return regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return bp.contentManager.deleteCategoryItems(req.body);\n\n            case 2:\n              res.sendStatus(200);\n\n            case 3:\n            case 'end':\n              return _context10.stop();\n          }\n        }\n      }, _callee10, undefined);\n    }));\n\n    return function (_x19, _x20) {\n      return _ref10.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.ghost_content').get('/api/ghost_content/status', function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(req, res) {\n      return regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              _context11.t0 = res;\n              _context11.next = 3;\n              return bp.ghostManager.getPending();\n\n            case 3:\n              _context11.t1 = _context11.sent;\n\n              _context11.t0.send.call(_context11.t0, _context11.t1);\n\n            case 5:\n            case 'end':\n              return _context11.stop();\n          }\n        }\n      }, _callee11, undefined);\n    }));\n\n    return function (_x21, _x22) {\n      return _ref11.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.ghost_content').get('/api/ghost_content/export', function () {\n    var _ref12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(req, res) {\n      return regeneratorRuntime.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              _context12.t0 = res;\n              _context12.next = 3;\n              return bp.ghostManager.getPendingWithContent({ stringifyBinary: true });\n\n            case 3:\n              _context12.t1 = _context12.sent;\n\n              _context12.t0.send.call(_context12.t0, _context12.t1);\n\n            case 5:\n            case 'end':\n              return _context12.stop();\n          }\n        }\n      }, _callee12, undefined);\n    }));\n\n    return function (_x23, _x24) {\n      return _ref12.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot.ghost_content').delete('/api/ghost_content/:folder', function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(req, res) {\n      return regeneratorRuntime.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              _context13.t0 = res;\n              _context13.next = 3;\n              return bp.ghostManager.revertAllPendingChangesForFile(req.params.folder, req.query.file);\n\n            case 3:\n              _context13.t1 = _context13.sent;\n\n              _context13.t0.send.call(_context13.t0, _context13.t1);\n\n            case 5:\n            case 'end':\n              return _context13.stop();\n          }\n        }\n      }, _callee13, undefined);\n    }));\n\n    return function (_x25, _x26) {\n      return _ref13.apply(this, arguments);\n    };\n  }());\n\n  var mediaUploadMulter = (0, _multer2.default)({\n    limits: {\n      fileSize: 1024 * 1000 * 10 // 100mb\n    }\n  });\n\n  app.secure('write', 'bot.media').post('/api/media', mediaUploadMulter.single('file'), function () {\n    var _ref14 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14(req, res) {\n      var filename, url;\n      return regeneratorRuntime.wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              _context14.next = 2;\n              return bp.mediaManager.saveFile(req.file.originalname, req.file.buffer);\n\n            case 2:\n              filename = _context14.sent;\n              url = '/media/' + filename;\n              return _context14.abrupt('return', res.json({ url: url }));\n\n            case 5:\n            case 'end':\n              return _context14.stop();\n          }\n        }\n      }, _callee14, undefined);\n    }));\n\n    return function (_x27, _x28) {\n      return _ref14.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.flows').get('/api/flows/all', function () {\n    var _ref15 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(req, res) {\n      var flows;\n      return regeneratorRuntime.wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              _context15.next = 2;\n              return bp.dialogEngine.getFlows();\n\n            case 2:\n              flows = _context15.sent;\n\n              res.send(flows);\n\n            case 4:\n            case 'end':\n              return _context15.stop();\n          }\n        }\n      }, _callee15, undefined);\n    }));\n\n    return function (_x29, _x30) {\n      return _ref15.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot.flows').get('/api/flows/available_actions', function () {\n    var _ref16 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16(req, res) {\n      var actions;\n      return regeneratorRuntime.wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              actions = bp.dialogEngine.getAvailableActions();\n\n              res.send(actions);\n\n            case 2:\n            case 'end':\n              return _context16.stop();\n          }\n        }\n      }, _callee16, undefined);\n    }));\n\n    return function (_x31, _x32) {\n      return _ref16.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot.flows').post('/api/flows/save', function () {\n    var _ref17 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(req, res) {\n      return regeneratorRuntime.wrap(function _callee17$(_context17) {\n        while (1) {\n          switch (_context17.prev = _context17.next) {\n            case 0:\n              _context17.next = 2;\n              return bp.dialogEngine.flowProvider.saveFlows(req.body);\n\n            case 2:\n              res.sendStatus(200);\n\n            case 3:\n            case 'end':\n              return _context17.stop();\n          }\n        }\n      }, _callee17, undefined);\n    }));\n\n    return function (_x33, _x34) {\n      return _ref17.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot.skills').post('/api/skills/:skillId/generate', function () {\n    var _ref18 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18(req, res) {\n      return regeneratorRuntime.wrap(function _callee18$(_context18) {\n        while (1) {\n          switch (_context18.prev = _context18.next) {\n            case 0:\n              _context18.t0 = res;\n              _context18.next = 3;\n              return bp.skills.generateFlow(req.params.skillId, req.body);\n\n            case 3:\n              _context18.t1 = _context18.sent;\n\n              _context18.t0.send.call(_context18.t0, _context18.t1);\n\n            case 5:\n            case 'end':\n              return _context18.stop();\n          }\n        }\n      }, _callee18, undefined);\n    }));\n\n    return function (_x35, _x36) {\n      return _ref18.apply(this, arguments);\n    };\n  }());\n\n  app.get('/api/community/hero', function (req, res) {\n    res.send({ hidden: bp.botfile.heroSection.hidden });\n  });\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL3NlY3VyZWQuanM/NGRhNSJdLCJuYW1lcyI6WyJsb2dzU2VjcmV0IiwibW9kdWxlIiwiZXhwb3J0cyIsImJwIiwiYXBwIiwic2VjdXJlIiwiZ2V0IiwicmVxIiwicmVzIiwibW9kdWxlcyIsIl8iLCJtYXAiLCJfbG9hZGVkTW9kdWxlcyIsIm5hbWUiLCJ1dGlsIiwiZ2V0TW9kdWxlU2hvcnRuYW1lIiwiZnVsbE5hbWUiLCJob21lcGFnZSIsImlzUGx1Z2luIiwic2V0dGluZ3MiLCJtZW51VGV4dCIsIm1lbnVJY29uIiwibm9JbnRlcmZhY2UiLCJtb2R1bGVWaWV3Iiwic3RyZXRjaGVkIiwicGx1Z2lucyIsInNlbmQiLCJsaXN0QWxsQ29tbXVuaXR5TW9kdWxlcyIsInRoZW4iLCJnZXRSYW5kb21Db21tdW5pdHlIZXJvIiwiaGVybyIsImJvdCIsImdldENvbnRyaWJ1dG9yIiwibWlkZGxld2FyZXMiLCJsaXN0IiwicG9zdCIsInN0YXRzIiwidHJhY2siLCJib2R5Iiwic2V0Q3VzdG9taXphdGlvbnMiLCJsb2FkIiwiZGVsZXRlIiwicmVzZXRDdXN0b21pemF0aW9ucyIsIm5vdGlmaWNhdGlvbnMiLCJnZXRJbmJveCIsImFib3V0IiwiZ2V0Qm90SW5mb3JtYXRpb24iLCJsaWNlbnNpbmciLCJjaGFuZ2VMaWNlbnNlIiwibGljZW5zZSIsInNlbmRTdGF0dXMiLCJjYXRjaCIsInN0YXR1cyIsIm1lc3NhZ2UiLCJlcnIiLCJvcHRpb25zIiwiZnJvbSIsIkRhdGUiLCJ1bnRpbCIsImxpbWl0IiwicXVlcnkiLCJzdGFydCIsIm9yZGVyIiwiZmllbGRzIiwibG9nZ2VyIiwicmVzdWx0cyIsImNvbnNvbGUiLCJsb2ciLCJmaWxlIiwic2VjcmV0IiwicGFyYW1zIiwia2V5IiwiYXJjaGl2ZVRvRmlsZSIsImRvd25sb2FkIiwiYXJjaGl2ZVBhdGgiLCJjb250ZW50TWFuYWdlciIsImxpc3RBdmFpbGFibGVDYXRlZ29yaWVzIiwiY291bnQiLCJzZWFyY2hUZXJtIiwiY2F0ZWdvcnlJZCIsIm9yZGVyQnkiLCJsaXN0Q2F0ZWdvcnlJdGVtcyIsImNhdGVnb3J5SXRlbXNDb3VudCIsImdldEl0ZW0iLCJpZCIsImdldEl0ZW1zIiwiaWRzIiwiY3JlYXRlT3JVcGRhdGVDYXRlZ29yeUl0ZW0iLCJmb3JtRGF0YSIsIml0ZW1JZCIsImRlbGV0ZUNhdGVnb3J5SXRlbXMiLCJnaG9zdE1hbmFnZXIiLCJnZXRQZW5kaW5nIiwiZ2V0UGVuZGluZ1dpdGhDb250ZW50Iiwic3RyaW5naWZ5QmluYXJ5IiwicmV2ZXJ0QWxsUGVuZGluZ0NoYW5nZXNGb3JGaWxlIiwiZm9sZGVyIiwibWVkaWFVcGxvYWRNdWx0ZXIiLCJsaW1pdHMiLCJmaWxlU2l6ZSIsInNpbmdsZSIsIm1lZGlhTWFuYWdlciIsInNhdmVGaWxlIiwib3JpZ2luYWxuYW1lIiwiYnVmZmVyIiwiZmlsZW5hbWUiLCJ1cmwiLCJqc29uIiwiZGlhbG9nRW5naW5lIiwiZ2V0Rmxvd3MiLCJmbG93cyIsImFjdGlvbnMiLCJnZXRBdmFpbGFibGVBY3Rpb25zIiwiZmxvd1Byb3ZpZGVyIiwic2F2ZUZsb3dzIiwic2tpbGxzIiwiZ2VuZXJhdGVGbG93Iiwic2tpbGxJZCIsImhpZGRlbiIsImJvdGZpbGUiLCJoZXJvU2VjdGlvbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFFQTs7Ozs7Ozs7QUFFQSxJQUFJQSxhQUFhLHVCQUFqQjs7QUFFQUMsT0FBT0MsT0FBUCxHQUFpQixVQUFDQyxFQUFELEVBQUtDLEdBQUwsRUFBYTtBQUM1Qjs7QUFFQUEsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsa0JBQW5CLEVBQXVDQyxHQUF2QyxDQUEyQyxjQUEzQyxFQUEyRCxVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUN2RSxRQUFNQyxVQUFVQyxpQkFBRUMsR0FBRixDQUFNUixHQUFHUyxjQUFULEVBQXlCLGtCQUFVO0FBQ2pELGFBQU87QUFDTEMsY0FBTUMsZUFBS0Msa0JBQUwsQ0FBd0JkLE9BQU9ZLElBQS9CLENBREQ7QUFFTEcsa0JBQVVmLE9BQU9ZLElBRlo7QUFHTEksa0JBQVVoQixPQUFPZ0IsUUFIWjtBQUlMQyxrQkFBVWpCLE9BQU9rQixRQUFQLENBQWdCRCxRQUpyQjtBQUtMRSxrQkFBVW5CLE9BQU9rQixRQUFQLENBQWdCQyxRQUFoQixJQUE0Qm5CLE9BQU9ZLElBTHhDO0FBTUxRLGtCQUFVcEIsT0FBT2tCLFFBQVAsQ0FBZ0JFLFFBQWhCLElBQTRCLGFBTmpDO0FBT0xDLHFCQUFhLENBQUMsQ0FBQ3JCLE9BQU9rQixRQUFQLENBQWdCRyxXQVAxQjtBQVFMQyxvQkFBWXRCLE9BQU9rQixRQUFQLENBQWdCSSxVQUFoQixJQUE4QixFQUFFQyxXQUFXLEtBQWIsRUFSckM7QUFTTEMsaUJBQVN4QixPQUFPa0IsUUFBUCxDQUFnQk0sT0FBaEIsSUFBMkI7QUFUL0IsT0FBUDtBQVdELEtBWmUsQ0FBaEI7QUFhQWpCLFFBQUlrQixJQUFKLENBQVNqQixPQUFUO0FBQ0QsR0FmRDs7QUFpQkFMLE1BQUlDLE1BQUosQ0FBVyxNQUFYLEVBQW1CLDRCQUFuQixFQUFpREMsR0FBakQsQ0FBcUQsaUJBQXJELEVBQXdFLFVBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQ3BGTCxPQUFHTSxPQUFILENBQVdrQix1QkFBWCxHQUFxQ0MsSUFBckMsQ0FBMEM7QUFBQSxhQUFXcEIsSUFBSWtCLElBQUosQ0FBU2pCLE9BQVQsQ0FBWDtBQUFBLEtBQTFDO0FBQ0QsR0FGRDs7QUFJQUwsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsNEJBQW5CLEVBQWlEQyxHQUFqRCxDQUFxRCxrQkFBckQsRUFBeUUsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDckZMLE9BQUdNLE9BQUgsQ0FBV29CLHNCQUFYLEdBQW9DRCxJQUFwQyxDQUF5QztBQUFBLGFBQVFwQixJQUFJa0IsSUFBSixDQUFTSSxJQUFULENBQVI7QUFBQSxLQUF6QztBQUNELEdBRkQ7O0FBSUExQixNQUFJQyxNQUFKLENBQVcsTUFBWCxFQUFtQiw0QkFBbkIsRUFBaURDLEdBQWpELENBQXFELHNCQUFyRCxFQUE2RSxVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUN6RkEsUUFBSWtCLElBQUosQ0FBU3ZCLEdBQUc0QixHQUFILENBQU9DLGNBQVAsRUFBVDtBQUNELEdBRkQ7O0FBSUE7O0FBRUE1QixNQUFJQyxNQUFKLENBQVcsTUFBWCxFQUFtQixxQkFBbkIsRUFBMENDLEdBQTFDLENBQThDLGtCQUE5QyxFQUFrRSxVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUM5RUEsUUFBSWtCLElBQUosQ0FBU3ZCLEdBQUc4QixXQUFILENBQWVDLElBQWYsRUFBVDtBQUNELEdBRkQ7O0FBSUE5QixNQUFJQyxNQUFKLENBQVcsT0FBWCxFQUFvQiwrQkFBcEIsRUFBcUQ4QixJQUFyRCxDQUEwRCxpQ0FBMUQsRUFBNkYsVUFBQzVCLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQ3pHTCxPQUFHaUMsS0FBSCxDQUFTQyxLQUFULENBQWUsS0FBZixFQUFzQixhQUF0QixFQUFxQyxnQkFBckM7QUFEeUcsUUFFakdKLFdBRmlHLEdBRWpGMUIsSUFBSStCLElBRjZFLENBRWpHTCxXQUZpRzs7QUFHekc5QixPQUFHOEIsV0FBSCxDQUFlTSxpQkFBZixDQUFpQ04sV0FBakM7QUFDQTlCLE9BQUc4QixXQUFILENBQWVPLElBQWY7QUFDQWhDLFFBQUlrQixJQUFKLENBQVN2QixHQUFHOEIsV0FBSCxDQUFlQyxJQUFmLEVBQVQ7QUFDRCxHQU5EOztBQVFBOUIsTUFBSUMsTUFBSixDQUFXLE9BQVgsRUFBb0IsK0JBQXBCLEVBQXFEb0MsTUFBckQsQ0FBNEQsaUNBQTVELEVBQStGLFVBQUNsQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUMzR0wsT0FBR2lDLEtBQUgsQ0FBU0MsS0FBVCxDQUFlLEtBQWYsRUFBc0IsYUFBdEIsRUFBcUMsZ0JBQXJDO0FBQ0FsQyxPQUFHOEIsV0FBSCxDQUFlUyxtQkFBZjtBQUNBdkMsT0FBRzhCLFdBQUgsQ0FBZU8sSUFBZjtBQUNBaEMsUUFBSWtCLElBQUosQ0FBU3ZCLEdBQUc4QixXQUFILENBQWVDLElBQWYsRUFBVDtBQUNELEdBTEQ7O0FBT0E7O0FBRUE7QUFDQTlCLE1BQUlDLE1BQUosQ0FBVyxNQUFYLEVBQW1CLG1CQUFuQixFQUF3Q0MsR0FBeEMsQ0FBNEMsb0JBQTVDO0FBQUEsdUVBQWtFLGlCQUFPQyxHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLDRCQUNoRUEsR0FEZ0U7QUFBQTtBQUFBLHFCQUNqREwsR0FBR3dDLGFBQUgsQ0FBaUJDLFFBQWpCLEVBRGlEOztBQUFBO0FBQUE7O0FBQUEsMEJBQzVEbEIsSUFENEQ7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBbEU7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBSUF0QixNQUFJQyxNQUFKLENBQVcsTUFBWCxFQUFtQixtQkFBbkIsRUFBd0NDLEdBQXhDLENBQTRDLDBCQUE1QztBQUFBLHdFQUF3RSxrQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSw2QkFDdEVBLEdBRHNFO0FBQUE7QUFBQSxxQkFDdkRMLEdBQUd3QyxhQUFILENBQWlCQyxRQUFqQixFQUR1RDs7QUFBQTtBQUFBOztBQUFBLDJCQUNsRWxCLElBRGtFOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXhFOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBOztBQUVBdEIsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsaUJBQW5CLEVBQXNDQyxHQUF0QyxDQUEwQyxzQkFBMUMsRUFBa0UsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDOUVBLFFBQUlrQixJQUFKLENBQVN2QixHQUFHMEMsS0FBSCxDQUFTQyxpQkFBVCxFQUFUO0FBQ0QsR0FGRDs7QUFJQTFDLE1BQUlDLE1BQUosQ0FBVyxPQUFYLEVBQW9CLHlCQUFwQixFQUErQzhCLElBQS9DLENBQW9ELGNBQXBELEVBQW9FLFVBQUM1QixHQUFELEVBQU1DLEdBQU4sRUFBYztBQUNoRkwsT0FBR2lDLEtBQUgsQ0FBU0MsS0FBVCxDQUFlLEtBQWYsRUFBc0IsU0FBdEIsRUFBaUMsUUFBakM7QUFDQWxDLE9BQUc0QyxTQUFILENBQ0dDLGFBREgsQ0FDaUJ6QyxJQUFJK0IsSUFBSixDQUFTVyxPQUQxQixFQUVHckIsSUFGSCxDQUVRLFlBQU07QUFDVnBCLFVBQUkwQyxVQUFKLENBQWUsR0FBZjtBQUNELEtBSkgsRUFLR0MsS0FMSCxDQUtTO0FBQUEsYUFDTDNDLElBQUk0QyxNQUFKLENBQVcsR0FBWCxFQUFnQjFCLElBQWhCLENBQXFCO0FBQ25CMkIsaUJBQVNDLE9BQU9BLElBQUlEO0FBREQsT0FBckIsQ0FESztBQUFBLEtBTFQ7QUFVRCxHQVpEOztBQWNBakQsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsVUFBbkIsRUFBK0JDLEdBQS9CLENBQW1DLFdBQW5DLEVBQWdELFVBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQzVELFFBQU0rQyxVQUFVO0FBQ2RDLFlBQU0sSUFBSUMsSUFBSixLQUFhLElBQUksRUFBSixHQUFTLEVBQVQsR0FBYyxFQUFkLEdBQW1CLElBRHhCO0FBRWRDLGFBQU8sSUFBSUQsSUFBSixFQUZPO0FBR2RFLGFBQVFwRCxJQUFJcUQsS0FBSixJQUFhckQsSUFBSXFELEtBQUosQ0FBVUQsS0FBeEIsSUFBa0MsRUFIM0I7QUFJZEUsYUFBTyxDQUpPO0FBS2RDLGFBQU8sTUFMTztBQU1kQyxjQUFRLENBQUMsU0FBRCxFQUFZLE9BQVosRUFBcUIsV0FBckI7QUFOTSxLQUFoQjs7QUFTQTVELE9BQUc2RCxNQUFILENBQVVKLEtBQVYsQ0FBZ0JMLE9BQWhCLEVBQXlCLFVBQUNELEdBQUQsRUFBTVcsT0FBTixFQUFrQjtBQUN6QyxVQUFJWCxHQUFKLEVBQVM7QUFDUCxlQUFPWSxRQUFRQyxHQUFSLENBQVliLEdBQVosQ0FBUDtBQUNEO0FBQ0Q5QyxVQUFJa0IsSUFBSixDQUFTdUMsUUFBUUcsSUFBakI7QUFDRCxLQUxEO0FBTUQsR0FoQkQ7O0FBa0JBaEUsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsVUFBbkIsRUFBK0JDLEdBQS9CLENBQW1DLGVBQW5DLEVBQW9ELFVBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQ2hFQSxRQUFJa0IsSUFBSixDQUFTLEVBQUUyQyxRQUFRckUsVUFBVixFQUFUO0FBQ0QsR0FGRDs7QUFJQUksTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsa0JBQW5CLEVBQXVDQyxHQUF2QyxDQUEyQyx3QkFBM0MsRUFBcUUsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDakZMLE9BQUdpQyxLQUFILENBQVNDLEtBQVQsQ0FBZSxLQUFmLEVBQXNCLE1BQXRCLEVBQThCLFNBQTlCO0FBQ0EsUUFBSTlCLElBQUkrRCxNQUFKLENBQVdDLEdBQVgsS0FBbUJ2RSxVQUF2QixFQUFtQztBQUNqQyxhQUFPUSxJQUFJMEMsVUFBSixDQUFlLEdBQWYsQ0FBUDtBQUNEOztBQUVEL0MsT0FBRzZELE1BQUgsQ0FBVVEsYUFBVixHQUEwQjVDLElBQTFCLENBQStCLHVCQUFlO0FBQzVDNUIsbUJBQWEsdUJBQWI7QUFDQVEsVUFBSWlFLFFBQUosQ0FBYUMsV0FBYjtBQUNELEtBSEQ7QUFJRCxHQVZEOztBQVlBdEUsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsYUFBbkIsRUFBa0NDLEdBQWxDLENBQXNDLHlCQUF0QztBQUFBLHdFQUFpRSxrQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSw2QkFDL0RBLEdBRCtEO0FBQUE7QUFBQSxxQkFDaERMLEdBQUd3RSxjQUFILENBQWtCQyx1QkFBbEIsRUFEZ0Q7O0FBQUE7QUFBQTs7QUFBQSwyQkFDM0RsRCxJQUQyRDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFqRTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFJQXRCLE1BQUlDLE1BQUosQ0FBVyxNQUFYLEVBQW1CLGFBQW5CLEVBQWtDQyxHQUFsQyxDQUFzQyxvQkFBdEM7QUFBQSx3RUFBNEQsa0JBQU9DLEdBQVAsRUFBWUMsR0FBWjtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ3BEZ0Qsa0JBRG9ELEdBQzdDakQsSUFBSXFELEtBQUosQ0FBVUosSUFBVixJQUFrQixDQUQyQjtBQUVwRHFCLG1CQUZvRCxHQUU1Q3RFLElBQUlxRCxLQUFKLENBQVVpQixLQUFWLElBQW1CLEVBRnlCO0FBQUEsMkJBR2hCdEUsSUFBSXFELEtBSFksRUFHcERrQixVQUhvRCxjQUdwREEsVUFIb0QsRUFHeENDLFVBSHdDLGNBR3hDQSxVQUh3QyxFQUc1QkMsT0FINEIsY0FHNUJBLE9BSDRCOzs7QUFLMUQsa0JBQUlELGVBQWUsS0FBbkIsRUFBMEI7QUFDeEJBLDZCQUFhLElBQWI7QUFDRDs7QUFQeUQsNkJBUzFEdkUsR0FUMEQ7QUFBQTtBQUFBLHFCQVMzQ0wsR0FBR3dFLGNBQUgsQ0FBa0JNLGlCQUFsQixDQUFvQ0YsVUFBcEMsRUFBZ0QsRUFBRXZCLFVBQUYsRUFBUXFCLFlBQVIsRUFBZUMsc0JBQWYsRUFBMkJFLGdCQUEzQixFQUFoRCxDQVQyQzs7QUFBQTtBQUFBOztBQUFBLDJCQVN0RHRELElBVHNEOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQTVEOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQVlBdEIsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsYUFBbkIsRUFBa0NDLEdBQWxDLENBQXNDLDBCQUF0QztBQUFBLHdFQUFrRSxrQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUMxRHVFLHdCQUQwRCxHQUMzQ3hFLElBQUlxRCxLQUR1QyxDQUMxRG1CLFVBRDBEOztBQUVoRSxrQkFBSUEsZUFBZSxLQUFuQixFQUEwQjtBQUN4QkEsNkJBQWEsSUFBYjtBQUNEO0FBSitELDZCQUtoRXZFLEdBTGdFO0FBQUE7QUFBQSxxQkFLeENMLEdBQUd3RSxjQUFILENBQWtCTyxrQkFBbEIsQ0FBcUNILFVBQXJDLENBTHdDOztBQUFBO0FBQUE7QUFBQTtBQUtyREYscUJBTHFEO0FBQUE7O0FBQUEsMkJBSzVEbkQsSUFMNEQ7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBbEU7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBUUF0QixNQUFJQyxNQUFKLENBQVcsTUFBWCxFQUFtQixhQUFuQixFQUFrQ0MsR0FBbEMsQ0FBc0Msd0JBQXRDO0FBQUEsd0VBQWdFLGtCQUFPQyxHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLDZCQUM5REEsR0FEOEQ7QUFBQTtBQUFBLHFCQUMvQ0wsR0FBR3dFLGNBQUgsQ0FBa0JRLE9BQWxCLENBQTBCNUUsSUFBSStELE1BQUosQ0FBV2MsRUFBckMsQ0FEK0M7O0FBQUE7QUFBQTs7QUFBQSwyQkFDMUQxRCxJQUQwRDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFoRTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFJQXRCLE1BQUlDLE1BQUosQ0FBVyxNQUFYLEVBQW1CLGFBQW5CLEVBQWtDQyxHQUFsQyxDQUFzQyxpQ0FBdEM7QUFBQSx3RUFBeUUsa0JBQU9DLEdBQVAsRUFBWUMsR0FBWjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsNkJBQ3ZFQSxHQUR1RTtBQUFBO0FBQUEscUJBQ3hETCxHQUFHd0UsY0FBSCxDQUFrQlUsUUFBbEIsQ0FBMkI5RSxJQUFJK0QsTUFBSixDQUFXZ0IsR0FBdEMsQ0FEd0Q7O0FBQUE7QUFBQTs7QUFBQSwyQkFDbkU1RCxJQURtRTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUF6RTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFJQXRCLE1BQUlDLE1BQUosQ0FBVyxPQUFYLEVBQW9CLGFBQXBCLEVBQW1DOEIsSUFBbkMsQ0FBd0MsbUNBQXhDO0FBQUEsd0VBQTZFLGtCQUFPNUIsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSw2QkFDM0VBLEdBRDJFO0FBQUE7QUFBQSxxQkFFbkVMLEdBQUd3RSxjQUFILENBQWtCWSwwQkFBbEIsQ0FBNkM7QUFDakRDLDBCQUFVakYsSUFBSStCLElBQUosQ0FBU2tELFFBRDhCO0FBRWpEVCw0QkFBWXhFLElBQUkrRCxNQUFKLENBQVdjO0FBRjBCLGVBQTdDLENBRm1FOztBQUFBO0FBQUE7O0FBQUEsMkJBQ3ZFMUQsSUFEdUU7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBN0U7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBU0F0QixNQUFJQyxNQUFKLENBQVcsT0FBWCxFQUFvQixhQUFwQixFQUFtQzhCLElBQW5DLENBQXdDLDJDQUF4QztBQUFBLHdFQUFxRixrQkFBTzVCLEdBQVAsRUFBWUMsR0FBWjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxxQkFDN0VMLEdBQUd3RSxjQUFILENBQWtCWSwwQkFBbEIsQ0FBNkM7QUFDakRFLHdCQUFRbEYsSUFBSStELE1BQUosQ0FBV21CLE1BRDhCO0FBRWpERCwwQkFBVWpGLElBQUkrQixJQUFKLENBQVNrRCxRQUY4QjtBQUdqRFQsNEJBQVl4RSxJQUFJK0QsTUFBSixDQUFXYztBQUgwQixlQUE3QyxDQUQ2RTs7QUFBQTtBQU1uRjVFLGtCQUFJMEMsVUFBSixDQUFlLEdBQWY7O0FBTm1GO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXJGOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQVNBOUMsTUFBSUMsTUFBSixDQUFXLE9BQVgsRUFBb0IsYUFBcEIsRUFBbUM4QixJQUFuQyxDQUF3Qyx5Q0FBeEM7QUFBQSx5RUFBbUYsbUJBQU81QixHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQzNFTCxHQUFHd0UsY0FBSCxDQUFrQmUsbUJBQWxCLENBQXNDbkYsSUFBSStCLElBQTFDLENBRDJFOztBQUFBO0FBRWpGOUIsa0JBQUkwQyxVQUFKLENBQWUsR0FBZjs7QUFGaUY7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBbkY7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBS0E5QyxNQUFJQyxNQUFKLENBQVcsTUFBWCxFQUFtQixtQkFBbkIsRUFBd0NDLEdBQXhDLENBQTRDLDJCQUE1QztBQUFBLHlFQUF5RSxtQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSw4QkFDdkVBLEdBRHVFO0FBQUE7QUFBQSxxQkFDeERMLEdBQUd3RixZQUFILENBQWdCQyxVQUFoQixFQUR3RDs7QUFBQTtBQUFBOztBQUFBLDRCQUNuRWxFLElBRG1FOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXpFOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBdEIsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsbUJBQW5CLEVBQXdDQyxHQUF4QyxDQUE0QywyQkFBNUM7QUFBQSx5RUFBeUUsbUJBQU9DLEdBQVAsRUFBWUMsR0FBWjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsOEJBQ3ZFQSxHQUR1RTtBQUFBO0FBQUEscUJBQ3hETCxHQUFHd0YsWUFBSCxDQUFnQkUscUJBQWhCLENBQXNDLEVBQUVDLGlCQUFpQixJQUFuQixFQUF0QyxDQUR3RDs7QUFBQTtBQUFBOztBQUFBLDRCQUNuRXBFLElBRG1FOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXpFOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBdEIsTUFBSUMsTUFBSixDQUFXLE9BQVgsRUFBb0IsbUJBQXBCLEVBQXlDb0MsTUFBekMsQ0FBZ0QsNEJBQWhEO0FBQUEseUVBQThFLG1CQUFPbEMsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSw4QkFDNUVBLEdBRDRFO0FBQUE7QUFBQSxxQkFDN0RMLEdBQUd3RixZQUFILENBQWdCSSw4QkFBaEIsQ0FBK0N4RixJQUFJK0QsTUFBSixDQUFXMEIsTUFBMUQsRUFBa0V6RixJQUFJcUQsS0FBSixDQUFVUSxJQUE1RSxDQUQ2RDs7QUFBQTtBQUFBOztBQUFBLDRCQUN4RTFDLElBRHdFOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQTlFOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBLE1BQU11RSxvQkFBb0Isc0JBQU87QUFDL0JDLFlBQVE7QUFDTkMsZ0JBQVUsT0FBTyxJQUFQLEdBQWMsRUFEbEIsQ0FDcUI7QUFEckI7QUFEdUIsR0FBUCxDQUExQjs7QUFNQS9GLE1BQUlDLE1BQUosQ0FBVyxPQUFYLEVBQW9CLFdBQXBCLEVBQWlDOEIsSUFBakMsQ0FBc0MsWUFBdEMsRUFBb0Q4RCxrQkFBa0JHLE1BQWxCLENBQXlCLE1BQXpCLENBQXBEO0FBQUEseUVBQXNGLG1CQUFPN0YsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQzdETCxHQUFHa0csWUFBSCxDQUFnQkMsUUFBaEIsQ0FBeUIvRixJQUFJNkQsSUFBSixDQUFTbUMsWUFBbEMsRUFBZ0RoRyxJQUFJNkQsSUFBSixDQUFTb0MsTUFBekQsQ0FENkQ7O0FBQUE7QUFDOUVDLHNCQUQ4RTtBQUU5RUMsaUJBRjhFLGVBRTlERCxRQUY4RDtBQUFBLGlEQUc3RWpHLElBQUltRyxJQUFKLENBQVMsRUFBRUQsUUFBRixFQUFULENBSDZFOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXRGOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQU1BdEcsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsV0FBbkIsRUFBZ0NDLEdBQWhDLENBQW9DLGdCQUFwQztBQUFBLHlFQUFzRCxtQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQ2hDTCxHQUFHeUcsWUFBSCxDQUFnQkMsUUFBaEIsRUFEZ0M7O0FBQUE7QUFDOUNDLG1CQUQ4Qzs7QUFFcER0RyxrQkFBSWtCLElBQUosQ0FBU29GLEtBQVQ7O0FBRm9EO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXREOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUtBMUcsTUFBSUMsTUFBSixDQUFXLE1BQVgsRUFBbUIsV0FBbkIsRUFBZ0NDLEdBQWhDLENBQW9DLDhCQUFwQztBQUFBLHlFQUFvRSxtQkFBT0MsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUM1RHVHLHFCQUQ0RCxHQUNsRDVHLEdBQUd5RyxZQUFILENBQWdCSSxtQkFBaEIsRUFEa0Q7O0FBRWxFeEcsa0JBQUlrQixJQUFKLENBQVNxRixPQUFUOztBQUZrRTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFwRTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFLQTNHLE1BQUlDLE1BQUosQ0FBVyxPQUFYLEVBQW9CLFdBQXBCLEVBQWlDOEIsSUFBakMsQ0FBc0MsaUJBQXRDO0FBQUEseUVBQXlELG1CQUFPNUIsR0FBUCxFQUFZQyxHQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHFCQUNqREwsR0FBR3lHLFlBQUgsQ0FBZ0JLLFlBQWhCLENBQTZCQyxTQUE3QixDQUF1QzNHLElBQUkrQixJQUEzQyxDQURpRDs7QUFBQTtBQUV2RDlCLGtCQUFJMEMsVUFBSixDQUFlLEdBQWY7O0FBRnVEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQXpEOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUtBOUMsTUFBSUMsTUFBSixDQUFXLE9BQVgsRUFBb0IsWUFBcEIsRUFBa0M4QixJQUFsQyxDQUF1QywrQkFBdkM7QUFBQSx5RUFBd0UsbUJBQU81QixHQUFQLEVBQVlDLEdBQVo7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLDhCQUN0RUEsR0FEc0U7QUFBQTtBQUFBLHFCQUN2REwsR0FBR2dILE1BQUgsQ0FBVUMsWUFBVixDQUF1QjdHLElBQUkrRCxNQUFKLENBQVcrQyxPQUFsQyxFQUEyQzlHLElBQUkrQixJQUEvQyxDQUR1RDs7QUFBQTtBQUFBOztBQUFBLDRCQUNsRVosSUFEa0U7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBeEU7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBSUF0QixNQUFJRSxHQUFKLENBQVEscUJBQVIsRUFBK0IsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDM0NBLFFBQUlrQixJQUFKLENBQVMsRUFBRTRGLFFBQVFuSCxHQUFHb0gsT0FBSCxDQUFXQyxXQUFYLENBQXVCRixNQUFqQyxFQUFUO0FBQ0QsR0FGRDtBQUdELENBM05EIiwiZmlsZSI6Ii4vc3JjL3NlcnZlci9zZWN1cmVkLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IG5hbm9pZCBmcm9tICduYW5vaWQnXG5pbXBvcnQgbXVsdGVyIGZyb20gJ211bHRlcidcblxuaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcblxubGV0IGxvZ3NTZWNyZXQgPSBuYW5vaWQoKVxuXG5tb2R1bGUuZXhwb3J0cyA9IChicCwgYXBwKSA9PiB7XG4gIC8vIG1vZHVsZXNcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5tb2R1bGVzLmxpc3QnKS5nZXQoJy9hcGkvbW9kdWxlcycsIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IG1vZHVsZXMgPSBfLm1hcChicC5fbG9hZGVkTW9kdWxlcywgbW9kdWxlID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IHV0aWwuZ2V0TW9kdWxlU2hvcnRuYW1lKG1vZHVsZS5uYW1lKSxcbiAgICAgICAgZnVsbE5hbWU6IG1vZHVsZS5uYW1lLFxuICAgICAgICBob21lcGFnZTogbW9kdWxlLmhvbWVwYWdlLFxuICAgICAgICBpc1BsdWdpbjogbW9kdWxlLnNldHRpbmdzLmlzUGx1Z2luLFxuICAgICAgICBtZW51VGV4dDogbW9kdWxlLnNldHRpbmdzLm1lbnVUZXh0IHx8IG1vZHVsZS5uYW1lLFxuICAgICAgICBtZW51SWNvbjogbW9kdWxlLnNldHRpbmdzLm1lbnVJY29uIHx8ICd2aWV3X21vZHVsZScsXG4gICAgICAgIG5vSW50ZXJmYWNlOiAhIW1vZHVsZS5zZXR0aW5ncy5ub0ludGVyZmFjZSxcbiAgICAgICAgbW9kdWxlVmlldzogbW9kdWxlLnNldHRpbmdzLm1vZHVsZVZpZXcgfHwgeyBzdHJldGNoZWQ6IGZhbHNlIH0sXG4gICAgICAgIHBsdWdpbnM6IG1vZHVsZS5zZXR0aW5ncy5wbHVnaW5zIHx8IFtdXG4gICAgICB9XG4gICAgfSlcbiAgICByZXMuc2VuZChtb2R1bGVzKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90Lm1vZHVsZXMubGlzdC5jb21tdW5pdHknKS5nZXQoJy9hcGkvbW9kdWxlL2FsbCcsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLm1vZHVsZXMubGlzdEFsbENvbW11bml0eU1vZHVsZXMoKS50aGVuKG1vZHVsZXMgPT4gcmVzLnNlbmQobW9kdWxlcykpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QubW9kdWxlcy5saXN0LmNvbW11bml0eScpLmdldCgnL2FwaS9tb2R1bGUvaGVybycsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLm1vZHVsZXMuZ2V0UmFuZG9tQ29tbXVuaXR5SGVybygpLnRoZW4oaGVybyA9PiByZXMuc2VuZChoZXJvKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5tb2R1bGVzLmxpc3QuY29tbXVuaXR5JykuZ2V0KCcvYXBpL2JvdC9jb250cmlidXRvcicsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKGJwLmJvdC5nZXRDb250cmlidXRvcigpKVxuICB9KVxuXG4gIC8vIG1pZGRsZXdhcmVcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5taWRkbGV3YXJlLmxpc3QnKS5nZXQoJy9hcGkvbWlkZGxld2FyZXMnLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChicC5taWRkbGV3YXJlcy5saXN0KCkpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90Lm1pZGRsZXdhcmUuY3VzdG9taXphdGlvbnMnKS5wb3N0KCcvYXBpL21pZGRsZXdhcmVzL2N1c3RvbWl6YXRpb25zJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgYnAuc3RhdHMudHJhY2soJ2FwaScsICdtaWRkbGV3YXJlcycsICdjdXN0b21pemF0aW9ucycpXG4gICAgY29uc3QgeyBtaWRkbGV3YXJlcyB9ID0gcmVxLmJvZHlcbiAgICBicC5taWRkbGV3YXJlcy5zZXRDdXN0b21pemF0aW9ucyhtaWRkbGV3YXJlcylcbiAgICBicC5taWRkbGV3YXJlcy5sb2FkKClcbiAgICByZXMuc2VuZChicC5taWRkbGV3YXJlcy5saXN0KCkpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90Lm1pZGRsZXdhcmUuY3VzdG9taXphdGlvbnMnKS5kZWxldGUoJy9hcGkvbWlkZGxld2FyZXMvY3VzdG9taXphdGlvbnMnLCAocmVxLCByZXMpID0+IHtcbiAgICBicC5zdGF0cy50cmFjaygnYXBpJywgJ21pZGRsZXdhcmVzJywgJ2N1c3RvbWl6YXRpb25zJylcbiAgICBicC5taWRkbGV3YXJlcy5yZXNldEN1c3RvbWl6YXRpb25zKClcbiAgICBicC5taWRkbGV3YXJlcy5sb2FkKClcbiAgICByZXMuc2VuZChicC5taWRkbGV3YXJlcy5saXN0KCkpXG4gIH0pXG5cbiAgLy8gbm90aWZpY2F0aW9uc1xuXG4gIC8vIERFUFJFQ0FURUQgaW4gQm90cHJlc3MgMS4xXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90Lm5vdGlmaWNhdGlvbnMnKS5nZXQoJy9hcGkvbm90aWZpY2F0aW9ucycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKGF3YWl0IGJwLm5vdGlmaWNhdGlvbnMuZ2V0SW5ib3goKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5ub3RpZmljYXRpb25zJykuZ2V0KCcvYXBpL25vdGlmaWNhdGlvbnMvaW5ib3gnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5ub3RpZmljYXRpb25zLmdldEluYm94KCkpXG4gIH0pXG5cbiAgLy8gYm90XG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QuaW5mb3JtYXRpb24nKS5nZXQoJy9hcGkvYm90L2luZm9ybWF0aW9uJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoYnAuYWJvdXQuZ2V0Qm90SW5mb3JtYXRpb24oKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3QuaW5mb3JtYXRpb24ubGljZW5zZScpLnBvc3QoJy9hcGkvbGljZW5zZScsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLnN0YXRzLnRyYWNrKCdhcGknLCAnbGljZW5zZScsICdjaGFuZ2UnKVxuICAgIGJwLmxpY2Vuc2luZ1xuICAgICAgLmNoYW5nZUxpY2Vuc2UocmVxLmJvZHkubGljZW5zZSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT5cbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoe1xuICAgICAgICAgIG1lc3NhZ2U6IGVyciAmJiBlcnIubWVzc2FnZVxuICAgICAgICB9KVxuICAgICAgKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90LmxvZ3MnKS5nZXQoJy9hcGkvbG9ncycsIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBmcm9tOiBuZXcgRGF0ZSgpIC0gNyAqIDI0ICogNjAgKiA2MCAqIDEwMDAsXG4gICAgICB1bnRpbDogbmV3IERhdGUoKSxcbiAgICAgIGxpbWl0OiAocmVxLnF1ZXJ5ICYmIHJlcS5xdWVyeS5saW1pdCkgfHwgNTAsXG4gICAgICBzdGFydDogMCxcbiAgICAgIG9yZGVyOiAnZGVzYycsXG4gICAgICBmaWVsZHM6IFsnbWVzc2FnZScsICdsZXZlbCcsICd0aW1lc3RhbXAnXVxuICAgIH1cblxuICAgIGJwLmxvZ2dlci5xdWVyeShvcHRpb25zLCAoZXJyLCByZXN1bHRzKSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlcnIpXG4gICAgICB9XG4gICAgICByZXMuc2VuZChyZXN1bHRzLmZpbGUpXG4gICAgfSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5sb2dzJykuZ2V0KCcvYXBpL2xvZ3Mva2V5JywgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoeyBzZWNyZXQ6IGxvZ3NTZWNyZXQgfSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5sb2dzLmFyY2hpdmUnKS5nZXQoJy9hcGkvbG9ncy9hcmNoaXZlLzprZXknLCAocmVxLCByZXMpID0+IHtcbiAgICBicC5zdGF0cy50cmFjaygnYXBpJywgJ2xvZ3MnLCAnYXJjaGl2ZScpXG4gICAgaWYgKHJlcS5wYXJhbXMua2V5ICE9PSBsb2dzU2VjcmV0KSB7XG4gICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKVxuICAgIH1cblxuICAgIGJwLmxvZ2dlci5hcmNoaXZlVG9GaWxlKCkudGhlbihhcmNoaXZlUGF0aCA9PiB7XG4gICAgICBsb2dzU2VjcmV0ID0gbmFub2lkKClcbiAgICAgIHJlcy5kb3dubG9hZChhcmNoaXZlUGF0aClcbiAgICB9KVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90LmNvbnRlbnQnKS5nZXQoJy9hcGkvY29udGVudC9jYXRlZ29yaWVzJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoYXdhaXQgYnAuY29udGVudE1hbmFnZXIubGlzdEF2YWlsYWJsZUNhdGVnb3JpZXMoKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5jb250ZW50JykuZ2V0KCcvYXBpL2NvbnRlbnQvaXRlbXMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCBmcm9tID0gcmVxLnF1ZXJ5LmZyb20gfHwgMFxuICAgIGNvbnN0IGNvdW50ID0gcmVxLnF1ZXJ5LmNvdW50IHx8IDUwXG4gICAgbGV0IHsgc2VhcmNoVGVybSwgY2F0ZWdvcnlJZCwgb3JkZXJCeSB9ID0gcmVxLnF1ZXJ5XG5cbiAgICBpZiAoY2F0ZWdvcnlJZCA9PT0gJ2FsbCcpIHtcbiAgICAgIGNhdGVnb3J5SWQgPSBudWxsXG4gICAgfVxuXG4gICAgcmVzLnNlbmQoYXdhaXQgYnAuY29udGVudE1hbmFnZXIubGlzdENhdGVnb3J5SXRlbXMoY2F0ZWdvcnlJZCwgeyBmcm9tLCBjb3VudCwgc2VhcmNoVGVybSwgb3JkZXJCeSB9KSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC5jb250ZW50JykuZ2V0KCcvYXBpL2NvbnRlbnQvaXRlbXMvY291bnQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBsZXQgeyBjYXRlZ29yeUlkIH0gPSByZXEucXVlcnlcbiAgICBpZiAoY2F0ZWdvcnlJZCA9PT0gJ2FsbCcpIHtcbiAgICAgIGNhdGVnb3J5SWQgPSBudWxsXG4gICAgfVxuICAgIHJlcy5zZW5kKHsgY291bnQ6IGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmNhdGVnb3J5SXRlbXNDb3VudChjYXRlZ29yeUlkKSB9KVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90LmNvbnRlbnQnKS5nZXQoJy9hcGkvY29udGVudC9pdGVtcy86aWQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5jb250ZW50TWFuYWdlci5nZXRJdGVtKHJlcS5wYXJhbXMuaWQpKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90LmNvbnRlbnQnKS5nZXQoJy9hcGkvY29udGVudC9pdGVtcy1iYXRjaGVkLzppZHMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5jb250ZW50TWFuYWdlci5nZXRJdGVtcyhyZXEucGFyYW1zLmlkcykpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90LmNvbnRlbnQnKS5wb3N0KCcvYXBpL2NvbnRlbnQvY2F0ZWdvcmllcy86aWQvaXRlbXMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChcbiAgICAgIGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmNyZWF0ZU9yVXBkYXRlQ2F0ZWdvcnlJdGVtKHtcbiAgICAgICAgZm9ybURhdGE6IHJlcS5ib2R5LmZvcm1EYXRhLFxuICAgICAgICBjYXRlZ29yeUlkOiByZXEucGFyYW1zLmlkXG4gICAgICB9KVxuICAgIClcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3QuY29udGVudCcpLnBvc3QoJy9hcGkvY29udGVudC9jYXRlZ29yaWVzLzppZC9pdGVtcy86aXRlbUlkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgYXdhaXQgYnAuY29udGVudE1hbmFnZXIuY3JlYXRlT3JVcGRhdGVDYXRlZ29yeUl0ZW0oe1xuICAgICAgaXRlbUlkOiByZXEucGFyYW1zLml0ZW1JZCxcbiAgICAgIGZvcm1EYXRhOiByZXEuYm9keS5mb3JtRGF0YSxcbiAgICAgIGNhdGVnb3J5SWQ6IHJlcS5wYXJhbXMuaWRcbiAgICB9KVxuICAgIHJlcy5zZW5kU3RhdHVzKDIwMClcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3QuY29udGVudCcpLnBvc3QoJy9hcGkvY29udGVudC9jYXRlZ29yaWVzL2FsbC9idWxrX2RlbGV0ZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmRlbGV0ZUNhdGVnb3J5SXRlbXMocmVxLmJvZHkpXG4gICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90Lmdob3N0X2NvbnRlbnQnKS5nZXQoJy9hcGkvZ2hvc3RfY29udGVudC9zdGF0dXMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5naG9zdE1hbmFnZXIuZ2V0UGVuZGluZygpKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90Lmdob3N0X2NvbnRlbnQnKS5nZXQoJy9hcGkvZ2hvc3RfY29udGVudC9leHBvcnQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5naG9zdE1hbmFnZXIuZ2V0UGVuZGluZ1dpdGhDb250ZW50KHsgc3RyaW5naWZ5QmluYXJ5OiB0cnVlIH0pKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3dyaXRlJywgJ2JvdC5naG9zdF9jb250ZW50JykuZGVsZXRlKCcvYXBpL2dob3N0X2NvbnRlbnQvOmZvbGRlcicsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKGF3YWl0IGJwLmdob3N0TWFuYWdlci5yZXZlcnRBbGxQZW5kaW5nQ2hhbmdlc0ZvckZpbGUocmVxLnBhcmFtcy5mb2xkZXIsIHJlcS5xdWVyeS5maWxlKSlcbiAgfSlcblxuICBjb25zdCBtZWRpYVVwbG9hZE11bHRlciA9IG11bHRlcih7XG4gICAgbGltaXRzOiB7XG4gICAgICBmaWxlU2l6ZTogMTAyNCAqIDEwMDAgKiAxMCAvLyAxMDBtYlxuICAgIH1cbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3QubWVkaWEnKS5wb3N0KCcvYXBpL21lZGlhJywgbWVkaWFVcGxvYWRNdWx0ZXIuc2luZ2xlKCdmaWxlJyksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IGZpbGVuYW1lID0gYXdhaXQgYnAubWVkaWFNYW5hZ2VyLnNhdmVGaWxlKHJlcS5maWxlLm9yaWdpbmFsbmFtZSwgcmVxLmZpbGUuYnVmZmVyKVxuICAgIGNvbnN0IHVybCA9IGAvbWVkaWEvJHtmaWxlbmFtZX1gXG4gICAgcmV0dXJuIHJlcy5qc29uKHsgdXJsIH0pXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QuZmxvd3MnKS5nZXQoJy9hcGkvZmxvd3MvYWxsJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgZmxvd3MgPSBhd2FpdCBicC5kaWFsb2dFbmdpbmUuZ2V0Rmxvd3MoKVxuICAgIHJlcy5zZW5kKGZsb3dzKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90LmZsb3dzJykuZ2V0KCcvYXBpL2Zsb3dzL2F2YWlsYWJsZV9hY3Rpb25zJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgYWN0aW9ucyA9IGJwLmRpYWxvZ0VuZ2luZS5nZXRBdmFpbGFibGVBY3Rpb25zKClcbiAgICByZXMuc2VuZChhY3Rpb25zKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3dyaXRlJywgJ2JvdC5mbG93cycpLnBvc3QoJy9hcGkvZmxvd3Mvc2F2ZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGF3YWl0IGJwLmRpYWxvZ0VuZ2luZS5mbG93UHJvdmlkZXIuc2F2ZUZsb3dzKHJlcS5ib2R5KVxuICAgIHJlcy5zZW5kU3RhdHVzKDIwMClcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3Quc2tpbGxzJykucG9zdCgnL2FwaS9za2lsbHMvOnNraWxsSWQvZ2VuZXJhdGUnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5za2lsbHMuZ2VuZXJhdGVGbG93KHJlcS5wYXJhbXMuc2tpbGxJZCwgcmVxLmJvZHkpKVxuICB9KVxuXG4gIGFwcC5nZXQoJy9hcGkvY29tbXVuaXR5L2hlcm8nLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZCh7IGhpZGRlbjogYnAuYm90ZmlsZS5oZXJvU2VjdGlvbi5oaWRkZW4gfSlcbiAgfSlcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/server/secured.js\n");

/***/ }),

/***/ "./src/server/socket.js":
/*!******************************!*\
  !*** ./src/server/socket.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _socket = __webpack_require__(/*! socket.io */ \"socket.io\");\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _socketioJwt = __webpack_require__(/*! socketio-jwt */ \"socketio-jwt\");\n\nvar _socketioJwt2 = _interopRequireDefault(_socketioJwt);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp) {\n  var install = function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(server) {\n      var io, admin, guest;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              io = (0, _socket2.default)(server);\n              admin = io.of('/admin');\n              guest = io.of('/guest');\n\n              if (!bp.botfile.login.enabled) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.t0 = admin;\n              _context.t1 = _socketioJwt2.default;\n              _context.next = 8;\n              return bp.security.getJWTSecretOrCertificate();\n\n            case 8:\n              _context.t2 = _context.sent;\n              _context.t3 = {\n                secret: _context.t2,\n                handshake: true\n              };\n              _context.t4 = _context.t1.authorize.call(_context.t1, _context.t3);\n\n              _context.t0.use.call(_context.t0, _context.t4);\n\n            case 12:\n\n              admin.on('connection', function (socket) {\n                var visitorId = _lodash2.default.get(socket, 'handshake.query.visitorId');\n                bp.stats.track('socket', 'connected');\n\n                socket.on('event', function (event) {\n                  bp.events.emit(event.name, event.data, 'client', {\n                    visitorId: visitorId,\n                    socketId: socket.id,\n                    guest: false,\n                    admin: true\n                  });\n                });\n              });\n\n              guest.on('connection', function (socket) {\n                var visitorId = _lodash2.default.get(socket, 'handshake.query.visitorId');\n                bp.stats.track('socket', 'connected');\n\n                if (visitorId && visitorId.length > 0) {\n                  socket.join('visitor:' + visitorId);\n                }\n\n                socket.on('event', function (event) {\n                  bp.events.emit(event.name, event.data, 'client', {\n                    socketId: socket.id,\n                    visitorId: visitorId,\n                    guest: true,\n                    admin: false\n                  });\n                });\n              });\n\n              bp.events.onAny(function (event, data, from) {\n                if (from === 'client') {\n                  return; // we sent this ourselves\n                }\n\n                // TODO: use more meaningful name\n                var c = event.startsWith('guest.') ? guest : admin;\n\n                if (data && (data.__socketId || data.__room)) {\n                  // Send only to this socketId or room\n                  return c.to(data.__socketId || data.__room).emit('event', {\n                    name: event,\n                    data: data\n                  });\n                }\n\n                // broadcast event to the front-end clients\n                c.emit('event', {\n                  name: event,\n                  data: data\n                });\n              });\n\n            case 15:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function install(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return { install: install };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL3NvY2tldC5qcz80YmQ2Il0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJpbnN0YWxsIiwic2VydmVyIiwiaW8iLCJhZG1pbiIsIm9mIiwiZ3Vlc3QiLCJicCIsImJvdGZpbGUiLCJsb2dpbiIsImVuYWJsZWQiLCJzb2NrZXRpb0p3dCIsInNlY3VyaXR5IiwiZ2V0SldUU2VjcmV0T3JDZXJ0aWZpY2F0ZSIsInNlY3JldCIsImhhbmRzaGFrZSIsImF1dGhvcml6ZSIsInVzZSIsIm9uIiwidmlzaXRvcklkIiwiXyIsImdldCIsInNvY2tldCIsInN0YXRzIiwidHJhY2siLCJldmVudHMiLCJlbWl0IiwiZXZlbnQiLCJuYW1lIiwiZGF0YSIsInNvY2tldElkIiwiaWQiLCJsZW5ndGgiLCJqb2luIiwib25BbnkiLCJmcm9tIiwiYyIsInN0YXJ0c1dpdGgiLCJfX3NvY2tldElkIiwiX19yb29tIiwidG8iXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLGNBQU07QUFDckIsTUFBTUM7QUFBQSx1RUFBVSxpQkFBTUMsTUFBTjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDUkMsZ0JBRFEsR0FDSCxzQkFBU0QsTUFBVCxDQURHO0FBR1JFLG1CQUhRLEdBR0FELEdBQUdFLEVBQUgsQ0FBTSxRQUFOLENBSEE7QUFJUkMsbUJBSlEsR0FJQUgsR0FBR0UsRUFBSCxDQUFNLFFBQU4sQ0FKQTs7QUFBQSxtQkFNVkUsR0FBR0MsT0FBSCxDQUFXQyxLQUFYLENBQWlCQyxPQU5QO0FBQUE7QUFBQTtBQUFBOztBQUFBLDRCQU9aTixLQVBZO0FBQUEsNEJBUVZPLHFCQVJVO0FBQUE7QUFBQSxxQkFTTUosR0FBR0ssUUFBSCxDQUFZQyx5QkFBWixFQVROOztBQUFBO0FBQUE7QUFBQTtBQVNSQyxzQkFUUTtBQVVSQyx5QkFWUSxFQVVHO0FBVkg7QUFBQSx3Q0FRRUMsU0FSRjs7QUFBQSwwQkFPTkMsR0FQTTs7QUFBQTs7QUFlZGIsb0JBQU1jLEVBQU4sQ0FBUyxZQUFULEVBQXVCLGtCQUFVO0FBQy9CLG9CQUFNQyxZQUFZQyxpQkFBRUMsR0FBRixDQUFNQyxNQUFOLEVBQWMsMkJBQWQsQ0FBbEI7QUFDQWYsbUJBQUdnQixLQUFILENBQVNDLEtBQVQsQ0FBZSxRQUFmLEVBQXlCLFdBQXpCOztBQUVBRix1QkFBT0osRUFBUCxDQUFVLE9BQVYsRUFBbUIsaUJBQVM7QUFDMUJYLHFCQUFHa0IsTUFBSCxDQUFVQyxJQUFWLENBQWVDLE1BQU1DLElBQXJCLEVBQTJCRCxNQUFNRSxJQUFqQyxFQUF1QyxRQUF2QyxFQUFpRDtBQUMvQ1YsK0JBQVdBLFNBRG9DO0FBRS9DVyw4QkFBVVIsT0FBT1MsRUFGOEI7QUFHL0N6QiwyQkFBTyxLQUh3QztBQUkvQ0YsMkJBQU87QUFKd0MsbUJBQWpEO0FBTUQsaUJBUEQ7QUFRRCxlQVpEOztBQWNBRSxvQkFBTVksRUFBTixDQUFTLFlBQVQsRUFBdUIsa0JBQVU7QUFDL0Isb0JBQU1DLFlBQVlDLGlCQUFFQyxHQUFGLENBQU1DLE1BQU4sRUFBYywyQkFBZCxDQUFsQjtBQUNBZixtQkFBR2dCLEtBQUgsQ0FBU0MsS0FBVCxDQUFlLFFBQWYsRUFBeUIsV0FBekI7O0FBRUEsb0JBQUlMLGFBQWFBLFVBQVVhLE1BQVYsR0FBbUIsQ0FBcEMsRUFBdUM7QUFDckNWLHlCQUFPVyxJQUFQLENBQVksYUFBYWQsU0FBekI7QUFDRDs7QUFFREcsdUJBQU9KLEVBQVAsQ0FBVSxPQUFWLEVBQW1CLGlCQUFTO0FBQzFCWCxxQkFBR2tCLE1BQUgsQ0FBVUMsSUFBVixDQUFlQyxNQUFNQyxJQUFyQixFQUEyQkQsTUFBTUUsSUFBakMsRUFBdUMsUUFBdkMsRUFBaUQ7QUFDL0NDLDhCQUFVUixPQUFPUyxFQUQ4QjtBQUUvQ1osK0JBQVdBLFNBRm9DO0FBRy9DYiwyQkFBTyxJQUh3QztBQUkvQ0YsMkJBQU87QUFKd0MsbUJBQWpEO0FBTUQsaUJBUEQ7QUFRRCxlQWhCRDs7QUFrQkFHLGlCQUFHa0IsTUFBSCxDQUFVUyxLQUFWLENBQWdCLFVBQUNQLEtBQUQsRUFBUUUsSUFBUixFQUFjTSxJQUFkLEVBQXVCO0FBQ3JDLG9CQUFJQSxTQUFTLFFBQWIsRUFBdUI7QUFDckIseUJBRHFCLENBQ2Q7QUFDUjs7QUFFRDtBQUNBLG9CQUFNQyxJQUFJVCxNQUFNVSxVQUFOLENBQWlCLFFBQWpCLElBQTZCL0IsS0FBN0IsR0FBcUNGLEtBQS9DOztBQUVBLG9CQUFJeUIsU0FBU0EsS0FBS1MsVUFBTCxJQUFtQlQsS0FBS1UsTUFBakMsQ0FBSixFQUE4QztBQUM1QztBQUNBLHlCQUFPSCxFQUFFSSxFQUFGLENBQUtYLEtBQUtTLFVBQUwsSUFBbUJULEtBQUtVLE1BQTdCLEVBQXFDYixJQUFyQyxDQUEwQyxPQUExQyxFQUFtRDtBQUN4REUsMEJBQU1ELEtBRGtEO0FBRXhERSwwQkFBTUE7QUFGa0QsbUJBQW5ELENBQVA7QUFJRDs7QUFFRDtBQUNBTyxrQkFBRVYsSUFBRixDQUFPLE9BQVAsRUFBZ0I7QUFDZEUsd0JBQU1ELEtBRFE7QUFFZEUsd0JBQU1BO0FBRlEsaUJBQWhCO0FBSUQsZUFyQkQ7O0FBL0NjO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQVY7O0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBTjs7QUF1RUEsU0FBTyxFQUFFNUIsZ0JBQUYsRUFBUDtBQUNELENBekVEIiwiZmlsZSI6Ii4vc3JjL3NlcnZlci9zb2NrZXQuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgc29ja2V0aW8gZnJvbSAnc29ja2V0LmlvJ1xuaW1wb3J0IHNvY2tldGlvSnd0IGZyb20gJ3NvY2tldGlvLWp3dCdcblxubW9kdWxlLmV4cG9ydHMgPSBicCA9PiB7XG4gIGNvbnN0IGluc3RhbGwgPSBhc3luYyBzZXJ2ZXIgPT4ge1xuICAgIGNvbnN0IGlvID0gc29ja2V0aW8oc2VydmVyKVxuXG4gICAgY29uc3QgYWRtaW4gPSBpby5vZignL2FkbWluJylcbiAgICBjb25zdCBndWVzdCA9IGlvLm9mKCcvZ3Vlc3QnKVxuXG4gICAgaWYgKGJwLmJvdGZpbGUubG9naW4uZW5hYmxlZCkge1xuICAgICAgYWRtaW4udXNlKFxuICAgICAgICBzb2NrZXRpb0p3dC5hdXRob3JpemUoe1xuICAgICAgICAgIHNlY3JldDogYXdhaXQgYnAuc2VjdXJpdHkuZ2V0SldUU2VjcmV0T3JDZXJ0aWZpY2F0ZSgpLFxuICAgICAgICAgIGhhbmRzaGFrZTogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgKVxuICAgIH1cblxuICAgIGFkbWluLm9uKCdjb25uZWN0aW9uJywgc29ja2V0ID0+IHtcbiAgICAgIGNvbnN0IHZpc2l0b3JJZCA9IF8uZ2V0KHNvY2tldCwgJ2hhbmRzaGFrZS5xdWVyeS52aXNpdG9ySWQnKVxuICAgICAgYnAuc3RhdHMudHJhY2soJ3NvY2tldCcsICdjb25uZWN0ZWQnKVxuXG4gICAgICBzb2NrZXQub24oJ2V2ZW50JywgZXZlbnQgPT4ge1xuICAgICAgICBicC5ldmVudHMuZW1pdChldmVudC5uYW1lLCBldmVudC5kYXRhLCAnY2xpZW50Jywge1xuICAgICAgICAgIHZpc2l0b3JJZDogdmlzaXRvcklkLFxuICAgICAgICAgIHNvY2tldElkOiBzb2NrZXQuaWQsXG4gICAgICAgICAgZ3Vlc3Q6IGZhbHNlLFxuICAgICAgICAgIGFkbWluOiB0cnVlXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICBndWVzdC5vbignY29ubmVjdGlvbicsIHNvY2tldCA9PiB7XG4gICAgICBjb25zdCB2aXNpdG9ySWQgPSBfLmdldChzb2NrZXQsICdoYW5kc2hha2UucXVlcnkudmlzaXRvcklkJylcbiAgICAgIGJwLnN0YXRzLnRyYWNrKCdzb2NrZXQnLCAnY29ubmVjdGVkJylcblxuICAgICAgaWYgKHZpc2l0b3JJZCAmJiB2aXNpdG9ySWQubGVuZ3RoID4gMCkge1xuICAgICAgICBzb2NrZXQuam9pbigndmlzaXRvcjonICsgdmlzaXRvcklkKVxuICAgICAgfVxuXG4gICAgICBzb2NrZXQub24oJ2V2ZW50JywgZXZlbnQgPT4ge1xuICAgICAgICBicC5ldmVudHMuZW1pdChldmVudC5uYW1lLCBldmVudC5kYXRhLCAnY2xpZW50Jywge1xuICAgICAgICAgIHNvY2tldElkOiBzb2NrZXQuaWQsXG4gICAgICAgICAgdmlzaXRvcklkOiB2aXNpdG9ySWQsXG4gICAgICAgICAgZ3Vlc3Q6IHRydWUsXG4gICAgICAgICAgYWRtaW46IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICBicC5ldmVudHMub25BbnkoKGV2ZW50LCBkYXRhLCBmcm9tKSA9PiB7XG4gICAgICBpZiAoZnJvbSA9PT0gJ2NsaWVudCcpIHtcbiAgICAgICAgcmV0dXJuIC8vIHdlIHNlbnQgdGhpcyBvdXJzZWx2ZXNcbiAgICAgIH1cblxuICAgICAgLy8gVE9ETzogdXNlIG1vcmUgbWVhbmluZ2Z1bCBuYW1lXG4gICAgICBjb25zdCBjID0gZXZlbnQuc3RhcnRzV2l0aCgnZ3Vlc3QuJykgPyBndWVzdCA6IGFkbWluXG5cbiAgICAgIGlmIChkYXRhICYmIChkYXRhLl9fc29ja2V0SWQgfHwgZGF0YS5fX3Jvb20pKSB7XG4gICAgICAgIC8vIFNlbmQgb25seSB0byB0aGlzIHNvY2tldElkIG9yIHJvb21cbiAgICAgICAgcmV0dXJuIGMudG8oZGF0YS5fX3NvY2tldElkIHx8IGRhdGEuX19yb29tKS5lbWl0KCdldmVudCcsIHtcbiAgICAgICAgICBuYW1lOiBldmVudCxcbiAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIGJyb2FkY2FzdCBldmVudCB0byB0aGUgZnJvbnQtZW5kIGNsaWVudHNcbiAgICAgIGMuZW1pdCgnZXZlbnQnLCB7XG4gICAgICAgIG5hbWU6IGV2ZW50LFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICByZXR1cm4geyBpbnN0YWxsIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/server/socket.js\n");

/***/ }),

/***/ "./src/server/static.js":
/*!******************************!*\
  !*** ./src/server/static.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _bluebird = __webpack_require__(/*! bluebird */ \"bluebird\");\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _express = __webpack_require__(/*! express */ \"express\");\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _ms = __webpack_require__(/*! ms */ \"ms\");\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _yn = __webpack_require__(/*! yn */ \"yn\");\n\nvar _yn2 = _interopRequireDefault(_yn);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp) {\n  var serveModule = function serveModule(app, module) {\n    var name = module.name;\n    var shortName = _util2.default.getModuleShortname(module.name);\n\n    if (module.settings.menuIcon === 'custom') {\n      var iconRequestPath = '/img/modules/' + name + '.png';\n      var iconPath = _path2.default.join(module.root, 'icon.png');\n\n      app.get(iconRequestPath, function (req, res) {\n        try {\n          var content = _fs2.default.readFileSync(iconPath);\n          res.contentType('image/png');\n          res.send(content);\n        } catch (err) {\n          bp.logger.warn('Could not serve module icon [' + name + '] at: ' + iconPath);\n        }\n      });\n    }\n\n    var liteDir = _path2.default.join(module.root, module.settings.liteDir || 'bin/lite');\n    var liteViews = _fs2.default.existsSync(liteDir) ? _fs2.default.readdirSync(liteDir).filter(function (b) {\n      return b.endsWith('.js');\n    }) : [];\n\n    app.get(['/js/modules/' + shortName, // The full module view\n    '/js/modules/' + name + '.js', // <<-- DEPRECATED: Will be removed shortly. Only use shortNames\n    '/js/modules/' + shortName + '/:subview' // Lite view\n    ], function (req, res) {\n      var settingsKey = module.settings.webBundle;\n      var bundlePath = req.params && req.params.subview ? _path2.default.join(liteDir, req.params.subview + '.bundle.js') // Render lite view\n      : _path2.default.join(module.root, settingsKey || 'bin/web.bundle.js');\n\n      try {\n        var content = _fs2.default.readFileSync(bundlePath);\n        res.contentType('text/javascript');\n        res.send(content);\n      } catch (err) {\n        bp.logger.warn('Could not serve module [' + name + '] at: ' + bundlePath);\n        res.sendStatus(404);\n      }\n    });\n  };\n\n  var serveCustomTheme = function serveCustomTheme(app) {\n    var customTheme = '';\n\n    if (bp.licensing.getFeatures().whitelabel === true) {\n      var themeLocation = _path2.default.join(bp.projectLocation, 'theme.css');\n      if (_fs2.default.existsSync(themeLocation)) {\n        customTheme = _fs2.default.readFileSync(themeLocation);\n      }\n    }\n\n    app.use('/style/custom-theme.css', function (req, res) {\n      res.contentType('text/css');\n      res.send(customTheme);\n    });\n  };\n\n  var serveMedia = function serveMedia(app) {\n    app.get('/media/:filename', function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(req, res) {\n        var contents, type;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return bp.mediaManager.readFile(req.params.filename);\n\n              case 2:\n                contents = _context.sent;\n\n                if (contents) {\n                  _context.next = 5;\n                  break;\n                }\n\n                return _context.abrupt('return', res.sendStatus(404));\n\n              case 5:\n                type = _path2.default.extname(req.params.filename);\n                // files are never overwritten because of the unique ID\n                // so we can set the header to cache the asset for 1 year\n\n                return _context.abrupt('return', res.set({ 'Cache-Control': 'max-age=31556926' }).type(type).send(contents));\n\n              case 7:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, undefined);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  };\n\n  var install = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(app) {\n      var name, _module;\n\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              for (name in bp._loadedModules) {\n                _module = bp._loadedModules[name];\n\n                serveModule(app, _module);\n              }\n\n              app.use('/js/env.js', function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(req, res) {\n                  var _bp$botfile$login, tokenExpiry, authEnabled, useCloud, ghostEnabled, optOutStats, appName, isUsingCloud, pairingInfo, isFirstRun, version;\n\n                  return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _bp$botfile$login = bp.botfile.login, tokenExpiry = _bp$botfile$login.tokenExpiry, authEnabled = _bp$botfile$login.enabled, useCloud = _bp$botfile$login.useCloud;\n                          ghostEnabled = bp.botfile.ghostContent.enabled;\n                          optOutStats = !!bp.botfile.optOutStats;\n                          appName = bp.botfile.appName || 'Botpress';\n                          _context2.t0 = !!useCloud;\n\n                          if (!_context2.t0) {\n                            _context2.next = 9;\n                            break;\n                          }\n\n                          _context2.next = 8;\n                          return bp.cloud.isPaired();\n\n                        case 8:\n                          _context2.t0 = _context2.sent;\n\n                        case 9:\n                          isUsingCloud = _context2.t0;\n                          pairingInfo = { botId: '', endpoint: '', teamId: '', env: bp.botfile.env };\n\n                          if (!isUsingCloud) {\n                            _context2.next = 19;\n                            break;\n                          }\n\n                          _context2.t1 = Object;\n                          _context2.t2 = pairingInfo;\n                          _context2.next = 16;\n                          return bp.cloud.getPairingInfo();\n\n                        case 16:\n                          _context2.t3 = _context2.sent;\n\n                          _context2.t1.assign.call(_context2.t1, _context2.t2, _context2.t3);\n\n                          delete pairingInfo.token;\n\n                        case 19:\n                          isFirstRun = bp.isFirstRun, version = bp.version;\n\n                          res.contentType('text/javascript');\n                          res.send('(function(window) {\\n        window.NODE_ENV = \"' + (\"development\" || 'development') + '\";\\n        window.BOTPRESS_ENV = \"' + bp.botfile.env + '\";\\n        window.BOTPRESS_CLOUD_ENABLED = ' + isUsingCloud + ';\\n        window.BOTPRESS_CLOUD_SETTINGS = ' + JSON.stringify(pairingInfo) + ';\\n        window.DEV_MODE = ' + _util2.default.isDeveloping + ';\\n        window.AUTH_ENABLED = ' + !!authEnabled + ';\\n        window.AUTH_TOKEN_DURATION = ' + (0, _ms2.default)(tokenExpiry) + ';\\n        window.OPT_OUT_STATS = ' + optOutStats + ';\\n        window.SHOW_GUIDED_TOUR = ' + isFirstRun + ';\\n        window.BOTPRESS_VERSION = \"' + version + '\";\\n        window.APP_NAME = \"' + appName + '\";\\n        window.GHOST_ENABLED = ' + !!ghostEnabled + ';\\n        window.BOTPRESS_FLOW_EDITOR_DISABLED = ' + (0, _yn2.default)(process.env.BOTPRESS_FLOW_EDITOR_DISABLED) + ';\\n      })(typeof window != \\'undefined\\' ? window : {})');\n\n                        case 22:\n                        case 'end':\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2, undefined);\n                }));\n\n                return function (_x4, _x5) {\n                  return _ref3.apply(this, arguments);\n                };\n              }());\n\n              serveCustomTheme(app);\n\n              serveMedia(app);\n\n              app.use((0, _express.static)(_path2.default.join(bp.projectLocation, 'static')));\n\n              app.use((0, _express.static)(_path2.default.join(bp.botpressPath, './lib/web')));\n\n              app.get('*', function (req, res, next) {\n                // If browser requests HTML and request isn't an API request\n                if (/html/i.test(req.headers.accept) && !/^\\/api\\//i.test(req.url)) {\n                  if (req.url && /^\\/lite\\//i.test(req.url)) {\n                    return res.sendFile(_path2.default.join(bp.botpressPath, './lib/web/lite.html'));\n                  }\n\n                  return res.sendFile(_path2.default.join(bp.botpressPath, './lib/web/index.html'));\n                }\n                next();\n              });\n\n              return _context3.abrupt('return', _bluebird2.default.resolve(true));\n\n            case 8:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function install(_x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return { install: install };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2VydmVyL3N0YXRpYy5qcz9kOGM1Il0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJzZXJ2ZU1vZHVsZSIsImFwcCIsIm5hbWUiLCJzaG9ydE5hbWUiLCJ1dGlsIiwiZ2V0TW9kdWxlU2hvcnRuYW1lIiwic2V0dGluZ3MiLCJtZW51SWNvbiIsImljb25SZXF1ZXN0UGF0aCIsImljb25QYXRoIiwicGF0aCIsImpvaW4iLCJyb290IiwiZ2V0IiwicmVxIiwicmVzIiwiY29udGVudCIsImZzIiwicmVhZEZpbGVTeW5jIiwiY29udGVudFR5cGUiLCJzZW5kIiwiZXJyIiwiYnAiLCJsb2dnZXIiLCJ3YXJuIiwibGl0ZURpciIsImxpdGVWaWV3cyIsImV4aXN0c1N5bmMiLCJyZWFkZGlyU3luYyIsImZpbHRlciIsImIiLCJlbmRzV2l0aCIsInNldHRpbmdzS2V5Iiwid2ViQnVuZGxlIiwiYnVuZGxlUGF0aCIsInBhcmFtcyIsInN1YnZpZXciLCJzZW5kU3RhdHVzIiwic2VydmVDdXN0b21UaGVtZSIsImN1c3RvbVRoZW1lIiwibGljZW5zaW5nIiwiZ2V0RmVhdHVyZXMiLCJ3aGl0ZWxhYmVsIiwidGhlbWVMb2NhdGlvbiIsInByb2plY3RMb2NhdGlvbiIsInVzZSIsInNlcnZlTWVkaWEiLCJtZWRpYU1hbmFnZXIiLCJyZWFkRmlsZSIsImZpbGVuYW1lIiwiY29udGVudHMiLCJ0eXBlIiwiZXh0bmFtZSIsInNldCIsImluc3RhbGwiLCJfbG9hZGVkTW9kdWxlcyIsImJvdGZpbGUiLCJsb2dpbiIsInRva2VuRXhwaXJ5IiwiYXV0aEVuYWJsZWQiLCJlbmFibGVkIiwidXNlQ2xvdWQiLCJnaG9zdEVuYWJsZWQiLCJnaG9zdENvbnRlbnQiLCJvcHRPdXRTdGF0cyIsImFwcE5hbWUiLCJjbG91ZCIsImlzUGFpcmVkIiwiaXNVc2luZ0Nsb3VkIiwicGFpcmluZ0luZm8iLCJib3RJZCIsImVuZHBvaW50IiwidGVhbUlkIiwiZW52IiwiT2JqZWN0IiwiZ2V0UGFpcmluZ0luZm8iLCJhc3NpZ24iLCJ0b2tlbiIsImlzRmlyc3RSdW4iLCJ2ZXJzaW9uIiwiSlNPTiIsInN0cmluZ2lmeSIsImlzRGV2ZWxvcGluZyIsInByb2Nlc3MiLCJCT1RQUkVTU19GTE9XX0VESVRPUl9ESVNBQkxFRCIsImJvdHByZXNzUGF0aCIsIm5leHQiLCJ0ZXN0IiwiaGVhZGVycyIsImFjY2VwdCIsInVybCIsInNlbmRGaWxlIiwiUHJvbWlzZSIsInJlc29sdmUiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztBQUVBQSxPQUFPQyxPQUFQLEdBQWlCLGNBQU07QUFDckIsTUFBTUMsY0FBYyxTQUFkQSxXQUFjLENBQUNDLEdBQUQsRUFBTUgsTUFBTixFQUFpQjtBQUNuQyxRQUFNSSxPQUFPSixPQUFPSSxJQUFwQjtBQUNBLFFBQU1DLFlBQVlDLGVBQUtDLGtCQUFMLENBQXdCUCxPQUFPSSxJQUEvQixDQUFsQjs7QUFFQSxRQUFJSixPQUFPUSxRQUFQLENBQWdCQyxRQUFoQixLQUE2QixRQUFqQyxFQUEyQztBQUN6QyxVQUFNQyxvQ0FBa0NOLElBQWxDLFNBQU47QUFDQSxVQUFNTyxXQUFXQyxlQUFLQyxJQUFMLENBQVViLE9BQU9jLElBQWpCLEVBQXVCLFVBQXZCLENBQWpCOztBQUVBWCxVQUFJWSxHQUFKLENBQVFMLGVBQVIsRUFBeUIsVUFBQ00sR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDckMsWUFBSTtBQUNGLGNBQU1DLFVBQVVDLGFBQUdDLFlBQUgsQ0FBZ0JULFFBQWhCLENBQWhCO0FBQ0FNLGNBQUlJLFdBQUosQ0FBZ0IsV0FBaEI7QUFDQUosY0FBSUssSUFBSixDQUFTSixPQUFUO0FBQ0QsU0FKRCxDQUlFLE9BQU9LLEdBQVAsRUFBWTtBQUNaQyxhQUFHQyxNQUFILENBQVVDLElBQVYsbUNBQStDdEIsSUFBL0MsY0FBNERPLFFBQTVEO0FBQ0Q7QUFDRixPQVJEO0FBU0Q7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QUFSOztBQUVBcEYsa0JBQUlZLEdBQUosQ0FBUSxHQUFSLEVBQWEsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQVd1RSxJQUFYLEVBQW9CO0FBQy9CO0FBQ0Esb0JBQUksUUFBUUMsSUFBUixDQUFhekUsSUFBSTBFLE9BQUosQ0FBWUMsTUFBekIsS0FBb0MsQ0FBQyxZQUFZRixJQUFaLENBQWlCekUsSUFBSTRFLEdBQXJCLENBQXpDLEVBQW9FO0FBQ2xFLHNCQUFJNUUsSUFBSTRFLEdBQUosSUFBVyxhQUFhSCxJQUFiLENBQWtCekUsSUFBSTRFLEdBQXRCLENBQWYsRUFBMkM7QUFDekMsMkJBQU8zRSxJQUFJNEUsUUFBSixDQUFhakYsZUFBS0MsSUFBTCxDQUFVVyxHQUFHK0QsWUFBYixFQUEyQixxQkFBM0IsQ0FBYixDQUFQO0FBQ0Q7O0FBRUQseUJBQU90RSxJQUFJNEUsUUFBSixDQUFhakYsZUFBS0MsSUFBTCxDQUFVVyxHQUFHK0QsWUFBYixFQUEyQixzQkFBM0IsQ0FBYixDQUFQO0FBQ0Q7QUFDREM7QUFDRCxlQVZEOztBQTlDYyxnREEwRFBNLG1CQUFRQyxPQUFSLENBQWdCLElBQWhCLENBMURPOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQVY7O0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBTjs7QUE2REEsU0FBTyxFQUFFdkMsZ0JBQUYsRUFBUDtBQUNELENBOUlEIiwiZmlsZSI6Ii4vc3JjL3NlcnZlci9zdGF0aWMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCB7IHN0YXRpYyBhcyBzdGF0aWNNaWRkbGV3YXJlIH0gZnJvbSAnZXhwcmVzcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgbXMgZnJvbSAnbXMnXG5pbXBvcnQgdXRpbCBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IHluIGZyb20gJ3luJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IGJwID0+IHtcbiAgY29uc3Qgc2VydmVNb2R1bGUgPSAoYXBwLCBtb2R1bGUpID0+IHtcbiAgICBjb25zdCBuYW1lID0gbW9kdWxlLm5hbWVcbiAgICBjb25zdCBzaG9ydE5hbWUgPSB1dGlsLmdldE1vZHVsZVNob3J0bmFtZShtb2R1bGUubmFtZSlcblxuICAgIGlmIChtb2R1bGUuc2V0dGluZ3MubWVudUljb24gPT09ICdjdXN0b20nKSB7XG4gICAgICBjb25zdCBpY29uUmVxdWVzdFBhdGggPSBgL2ltZy9tb2R1bGVzLyR7bmFtZX0ucG5nYFxuICAgICAgY29uc3QgaWNvblBhdGggPSBwYXRoLmpvaW4obW9kdWxlLnJvb3QsICdpY29uLnBuZycpXG5cbiAgICAgIGFwcC5nZXQoaWNvblJlcXVlc3RQYXRoLCAocmVxLCByZXMpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGljb25QYXRoKVxuICAgICAgICAgIHJlcy5jb250ZW50VHlwZSgnaW1hZ2UvcG5nJylcbiAgICAgICAgICByZXMuc2VuZChjb250ZW50KVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBicC5sb2dnZXIud2FybihgQ291bGQgbm90IHNlcnZlIG1vZHVsZSBpY29uIFske25hbWV9XSBhdDogJHtpY29uUGF0aH1gKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IGxpdGVEaXIgPSBwYXRoLmpvaW4obW9kdWxlLnJvb3QsIG1vZHVsZS5zZXR0aW5ncy5saXRlRGlyIHx8ICdiaW4vbGl0ZScpXG4gICAgY29uc3QgbGl0ZVZpZXdzID0gZnMuZXhpc3RzU3luYyhsaXRlRGlyKSA/IGZzLnJlYWRkaXJTeW5jKGxpdGVEaXIpLmZpbHRlcihiID0+IGIuZW5kc1dpdGgoJy5qcycpKSA6IFtdXG5cbiAgICBhcHAuZ2V0KFxuICAgICAgW1xuICAgICAgICBgL2pzL21vZHVsZXMvJHtzaG9ydE5hbWV9YCwgLy8gVGhlIGZ1bGwgbW9kdWxlIHZpZXdcbiAgICAgICAgYC9qcy9tb2R1bGVzLyR7bmFtZX0uanNgLCAvLyA8PC0tIERFUFJFQ0FURUQ6IFdpbGwgYmUgcmVtb3ZlZCBzaG9ydGx5LiBPbmx5IHVzZSBzaG9ydE5hbWVzXG4gICAgICAgIGAvanMvbW9kdWxlcy8ke3Nob3J0TmFtZX0vOnN1YnZpZXdgIC8vIExpdGUgdmlld1xuICAgICAgXSxcbiAgICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5nc0tleSA9IG1vZHVsZS5zZXR0aW5ncy53ZWJCdW5kbGVcbiAgICAgICAgY29uc3QgYnVuZGxlUGF0aCA9XG4gICAgICAgICAgcmVxLnBhcmFtcyAmJiByZXEucGFyYW1zLnN1YnZpZXdcbiAgICAgICAgICAgID8gcGF0aC5qb2luKGxpdGVEaXIsIHJlcS5wYXJhbXMuc3VidmlldyArICcuYnVuZGxlLmpzJykgLy8gUmVuZGVyIGxpdGUgdmlld1xuICAgICAgICAgICAgOiBwYXRoLmpvaW4obW9kdWxlLnJvb3QsIHNldHRpbmdzS2V5IHx8ICdiaW4vd2ViLmJ1bmRsZS5qcycpXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGJ1bmRsZVBhdGgpXG4gICAgICAgICAgcmVzLmNvbnRlbnRUeXBlKCd0ZXh0L2phdmFzY3JpcHQnKVxuICAgICAgICAgIHJlcy5zZW5kKGNvbnRlbnQpXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGJwLmxvZ2dlci53YXJuKGBDb3VsZCBub3Qgc2VydmUgbW9kdWxlIFske25hbWV9XSBhdDogJHtidW5kbGVQYXRofWApXG4gICAgICAgICAgcmVzLnNlbmRTdGF0dXMoNDA0KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgKVxuICB9XG5cbiAgY29uc3Qgc2VydmVDdXN0b21UaGVtZSA9IGFwcCA9PiB7XG4gICAgbGV0IGN1c3RvbVRoZW1lID0gJydcblxuICAgIGlmIChicC5saWNlbnNpbmcuZ2V0RmVhdHVyZXMoKS53aGl0ZWxhYmVsID09PSB0cnVlKSB7XG4gICAgICBjb25zdCB0aGVtZUxvY2F0aW9uID0gcGF0aC5qb2luKGJwLnByb2plY3RMb2NhdGlvbiwgJ3RoZW1lLmNzcycpXG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyh0aGVtZUxvY2F0aW9uKSkge1xuICAgICAgICBjdXN0b21UaGVtZSA9IGZzLnJlYWRGaWxlU3luYyh0aGVtZUxvY2F0aW9uKVxuICAgICAgfVxuICAgIH1cblxuICAgIGFwcC51c2UoJy9zdHlsZS9jdXN0b20tdGhlbWUuY3NzJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgICByZXMuY29udGVudFR5cGUoJ3RleHQvY3NzJylcbiAgICAgIHJlcy5zZW5kKGN1c3RvbVRoZW1lKVxuICAgIH0pXG4gIH1cblxuICBjb25zdCBzZXJ2ZU1lZGlhID0gYXBwID0+IHtcbiAgICBhcHAuZ2V0KCcvbWVkaWEvOmZpbGVuYW1lJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCBjb250ZW50cyA9IGF3YWl0IGJwLm1lZGlhTWFuYWdlci5yZWFkRmlsZShyZXEucGFyYW1zLmZpbGVuYW1lKVxuICAgICAgaWYgKCFjb250ZW50cykge1xuICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDA0KVxuICAgICAgfVxuICAgICAgY29uc3QgdHlwZSA9IHBhdGguZXh0bmFtZShyZXEucGFyYW1zLmZpbGVuYW1lKVxuICAgICAgLy8gZmlsZXMgYXJlIG5ldmVyIG92ZXJ3cml0dGVuIGJlY2F1c2Ugb2YgdGhlIHVuaXF1ZSBJRFxuICAgICAgLy8gc28gd2UgY2FuIHNldCB0aGUgaGVhZGVyIHRvIGNhY2hlIHRoZSBhc3NldCBmb3IgMSB5ZWFyXG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zZXQoeyAnQ2FjaGUtQ29udHJvbCc6ICdtYXgtYWdlPTMxNTU2OTI2JyB9KVxuICAgICAgICAudHlwZSh0eXBlKVxuICAgICAgICAuc2VuZChjb250ZW50cylcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgaW5zdGFsbCA9IGFzeW5jIGFwcCA9PiB7XG4gICAgZm9yIChjb25zdCBuYW1lIGluIGJwLl9sb2FkZWRNb2R1bGVzKSB7XG4gICAgICBjb25zdCBtb2R1bGUgPSBicC5fbG9hZGVkTW9kdWxlc1tuYW1lXVxuICAgICAgc2VydmVNb2R1bGUoYXBwLCBtb2R1bGUpXG4gICAgfVxuXG4gICAgYXBwLnVzZSgnL2pzL2Vudi5qcycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyB0b2tlbkV4cGlyeSwgZW5hYmxlZDogYXV0aEVuYWJsZWQsIHVzZUNsb3VkIH0gPSBicC5ib3RmaWxlLmxvZ2luXG4gICAgICBjb25zdCB7IGVuYWJsZWQ6IGdob3N0RW5hYmxlZCB9ID0gYnAuYm90ZmlsZS5naG9zdENvbnRlbnRcbiAgICAgIGNvbnN0IG9wdE91dFN0YXRzID0gISFicC5ib3RmaWxlLm9wdE91dFN0YXRzXG4gICAgICBjb25zdCBhcHBOYW1lID0gYnAuYm90ZmlsZS5hcHBOYW1lIHx8ICdCb3RwcmVzcydcblxuICAgICAgY29uc3QgaXNVc2luZ0Nsb3VkID0gISF1c2VDbG91ZCAmJiAoYXdhaXQgYnAuY2xvdWQuaXNQYWlyZWQoKSlcbiAgICAgIGNvbnN0IHBhaXJpbmdJbmZvID0geyBib3RJZDogJycsIGVuZHBvaW50OiAnJywgdGVhbUlkOiAnJywgZW52OiBicC5ib3RmaWxlLmVudiB9XG4gICAgICBpZiAoaXNVc2luZ0Nsb3VkKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ocGFpcmluZ0luZm8sIGF3YWl0IGJwLmNsb3VkLmdldFBhaXJpbmdJbmZvKCkpXG4gICAgICAgIGRlbGV0ZSBwYWlyaW5nSW5mby50b2tlblxuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGlzRmlyc3RSdW4sIHZlcnNpb24gfSA9IGJwXG4gICAgICByZXMuY29udGVudFR5cGUoJ3RleHQvamF2YXNjcmlwdCcpXG4gICAgICByZXMuc2VuZChgKGZ1bmN0aW9uKHdpbmRvdykge1xuICAgICAgICB3aW5kb3cuTk9ERV9FTlYgPSBcIiR7cHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50J31cIjtcbiAgICAgICAgd2luZG93LkJPVFBSRVNTX0VOViA9IFwiJHticC5ib3RmaWxlLmVudn1cIjtcbiAgICAgICAgd2luZG93LkJPVFBSRVNTX0NMT1VEX0VOQUJMRUQgPSAke2lzVXNpbmdDbG91ZH07XG4gICAgICAgIHdpbmRvdy5CT1RQUkVTU19DTE9VRF9TRVRUSU5HUyA9ICR7SlNPTi5zdHJpbmdpZnkocGFpcmluZ0luZm8pfTtcbiAgICAgICAgd2luZG93LkRFVl9NT0RFID0gJHt1dGlsLmlzRGV2ZWxvcGluZ307XG4gICAgICAgIHdpbmRvdy5BVVRIX0VOQUJMRUQgPSAkeyEhYXV0aEVuYWJsZWR9O1xuICAgICAgICB3aW5kb3cuQVVUSF9UT0tFTl9EVVJBVElPTiA9ICR7bXModG9rZW5FeHBpcnkpfTtcbiAgICAgICAgd2luZG93Lk9QVF9PVVRfU1RBVFMgPSAke29wdE91dFN0YXRzfTtcbiAgICAgICAgd2luZG93LlNIT1dfR1VJREVEX1RPVVIgPSAke2lzRmlyc3RSdW59O1xuICAgICAgICB3aW5kb3cuQk9UUFJFU1NfVkVSU0lPTiA9IFwiJHt2ZXJzaW9ufVwiO1xuICAgICAgICB3aW5kb3cuQVBQX05BTUUgPSBcIiR7YXBwTmFtZX1cIjtcbiAgICAgICAgd2luZG93LkdIT1NUX0VOQUJMRUQgPSAkeyEhZ2hvc3RFbmFibGVkfTtcbiAgICAgICAgd2luZG93LkJPVFBSRVNTX0ZMT1dfRURJVE9SX0RJU0FCTEVEID0gJHt5bihwcm9jZXNzLmVudi5CT1RQUkVTU19GTE9XX0VESVRPUl9ESVNBQkxFRCl9O1xuICAgICAgfSkodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHt9KWApXG4gICAgfSlcblxuICAgIHNlcnZlQ3VzdG9tVGhlbWUoYXBwKVxuXG4gICAgc2VydmVNZWRpYShhcHApXG5cbiAgICBhcHAudXNlKHN0YXRpY01pZGRsZXdhcmUocGF0aC5qb2luKGJwLnByb2plY3RMb2NhdGlvbiwgJ3N0YXRpYycpKSlcblxuICAgIGFwcC51c2Uoc3RhdGljTWlkZGxld2FyZShwYXRoLmpvaW4oYnAuYm90cHJlc3NQYXRoLCAnLi9saWIvd2ViJykpKVxuXG4gICAgYXBwLmdldCgnKicsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgLy8gSWYgYnJvd3NlciByZXF1ZXN0cyBIVE1MIGFuZCByZXF1ZXN0IGlzbid0IGFuIEFQSSByZXF1ZXN0XG4gICAgICBpZiAoL2h0bWwvaS50ZXN0KHJlcS5oZWFkZXJzLmFjY2VwdCkgJiYgIS9eXFwvYXBpXFwvL2kudGVzdChyZXEudXJsKSkge1xuICAgICAgICBpZiAocmVxLnVybCAmJiAvXlxcL2xpdGVcXC8vaS50ZXN0KHJlcS51cmwpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4oYnAuYm90cHJlc3NQYXRoLCAnLi9saWIvd2ViL2xpdGUuaHRtbCcpKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4oYnAuYm90cHJlc3NQYXRoLCAnLi9saWIvd2ViL2luZGV4Lmh0bWwnKSlcbiAgICAgIH1cbiAgICAgIG5leHQoKVxuICAgIH0pXG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gIH1cblxuICByZXR1cm4geyBpbnN0YWxsIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/server/static.js\n");

/***/ }),

/***/ "./src/skills/index.js":
/*!*****************************!*\
  !*** ./src/skills/index.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _util = __webpack_require__(/*! ../util */ \"./src/util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _validator = __webpack_require__(/*! ../dialog/validator */ \"./src/dialog/validator.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SKILLS_PREFIX = 'skill-';\nvar SKILLS_PREFIX_REGEX = new RegExp('^' + SKILLS_PREFIX);\n\nvar SkillsManager = function () {\n  function SkillsManager(_ref) {\n    var _this = this;\n\n    var logger = _ref.logger;\n\n    _classCallCheck(this, SkillsManager);\n\n    this._log = function (level, msg) {\n      _this.logger && _this.logger[level] && _this.logger[level](msg);\n    };\n\n    this.logger = logger;\n    this._log('info', '[Skills] Initiated');\n  }\n\n  _createClass(SkillsManager, [{\n    key: 'registerSkillsFromModules',\n    value: function registerSkillsFromModules(modules) {\n      var _this2 = this;\n\n      this._skills = modules.filter(function (mod) {\n        var shortName = _util2.default.getModuleShortname(mod.name);\n        return SKILLS_PREFIX_REGEX.test(shortName);\n      }).reduce(function (acc, curr) {\n        var shortName = _util2.default.getModuleShortname(curr.name);\n        if (!curr.handlers.generate) {\n          _this2._log('warn', 'Skill \"' + shortName + '\" has no flow generator (\"generate\" method exposed)');\n          return acc;\n        }\n\n        if (!_lodash2.default.isFunction(curr.handlers.generate)) {\n          _this2._log('warn', 'Skill \"' + shortName + '\" generator is not a valid function');\n          return acc;\n        }\n\n        acc[shortName] = curr.handlers.generate;\n        return acc;\n      }, {});\n\n      this._log('info', '[Skills] Loaded ' + _lodash2.default.keys(this._skills).length + ' skills');\n    }\n  }, {\n    key: 'generateFlow',\n    value: function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(skillId, data) {\n        var generator, generatedFlow, validationError;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this._skills) {\n                  _context.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Skills haven't been initialized yet\");\n\n              case 2:\n\n                //vv Backward compatible with old skills, just making sure there's no @botpress or botpress-\n                skillId = _util2.default.getModuleShortname(skillId);\n\n                if (!SKILLS_PREFIX_REGEX.test(skillId)) {\n                  skillId = SKILLS_PREFIX + skillId;\n                }\n\n                generator = this._skills[skillId];\n\n                if (generator) {\n                  _context.next = 7;\n                  break;\n                }\n\n                throw new Error('Skill \"' + skillId + '\" not found');\n\n              case 7:\n                _context.next = 9;\n                return generator(data);\n\n              case 9:\n                generatedFlow = _context.sent;\n                validationError = (0, _validator.validateFlowSchema)(generatedFlow.flow);\n\n                if (!validationError) {\n                  _context.next = 13;\n                  break;\n                }\n\n                throw new Error('Skill \"' + skillId + '\" generated an invalid flow: ' + validationError);\n\n              case 13:\n                if (!(!generatedFlow.transitions || !_lodash2.default.isArray(generatedFlow.transitions))) {\n                  _context.next = 15;\n                  break;\n                }\n\n                throw new Error('Skill \"' + skillId + '\" didn\\'t generate valid \"transitions\"');\n\n              case 15:\n                return _context.abrupt('return', generatedFlow);\n\n              case 16:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function generateFlow(_x, _x2) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return generateFlow;\n    }()\n  }]);\n\n  return SkillsManager;\n}();\n\nexports.default = SkillsManager;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc2tpbGxzL2luZGV4LmpzP2EwYjYiXSwibmFtZXMiOlsiU0tJTExTX1BSRUZJWCIsIlNLSUxMU19QUkVGSVhfUkVHRVgiLCJSZWdFeHAiLCJTa2lsbHNNYW5hZ2VyIiwibG9nZ2VyIiwiX2xvZyIsImxldmVsIiwibXNnIiwibW9kdWxlcyIsIl9za2lsbHMiLCJmaWx0ZXIiLCJzaG9ydE5hbWUiLCJ1dGlsIiwiZ2V0TW9kdWxlU2hvcnRuYW1lIiwibW9kIiwibmFtZSIsInRlc3QiLCJyZWR1Y2UiLCJhY2MiLCJjdXJyIiwiaGFuZGxlcnMiLCJnZW5lcmF0ZSIsIl8iLCJpc0Z1bmN0aW9uIiwia2V5cyIsImxlbmd0aCIsInNraWxsSWQiLCJkYXRhIiwiRXJyb3IiLCJnZW5lcmF0b3IiLCJnZW5lcmF0ZWRGbG93IiwidmFsaWRhdGlvbkVycm9yIiwiZmxvdyIsInRyYW5zaXRpb25zIiwiaXNBcnJheSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7OztBQUVBOzs7O0FBQ0E7Ozs7Ozs7O0FBRUEsSUFBTUEsZ0JBQWdCLFFBQXRCO0FBQ0EsSUFBTUMsc0JBQXNCLElBQUlDLE1BQUosQ0FBVyxNQUFNRixhQUFqQixDQUE1Qjs7SUFFcUJHLGE7QUFDbkIsK0JBQXdCO0FBQUE7O0FBQUEsUUFBVkMsTUFBVSxRQUFWQSxNQUFVOztBQUFBOztBQUFBLFNBS3hCQyxJQUx3QixHQUtqQixVQUFDQyxLQUFELEVBQVFDLEdBQVIsRUFBZ0I7QUFDckIsWUFBS0gsTUFBTCxJQUFlLE1BQUtBLE1BQUwsQ0FBWUUsS0FBWixDQUFmLElBQXFDLE1BQUtGLE1BQUwsQ0FBWUUsS0FBWixFQUFtQkMsR0FBbkIsQ0FBckM7QUFDRCxLQVB1Qjs7QUFDdEIsU0FBS0gsTUFBTCxHQUFjQSxNQUFkO0FBQ0EsU0FBS0MsSUFBTCxDQUFVLE1BQVY7QUFDRDs7Ozs4Q0FNeUJHLE8sRUFBUztBQUFBOztBQUNqQyxXQUFLQyxPQUFMLEdBQWVELFFBQ1pFLE1BRFksQ0FDTCxlQUFPO0FBQ2IsWUFBTUMsWUFBWUMsZUFBS0Msa0JBQUwsQ0FBd0JDLElBQUlDLElBQTVCLENBQWxCO0FBQ0EsZUFBT2Qsb0JBQW9CZSxJQUFwQixDQUF5QkwsU0FBekIsQ0FBUDtBQUNELE9BSlksRUFLWk0sTUFMWSxDQUtMLFVBQUNDLEdBQUQsRUFBTUMsSUFBTixFQUFlO0FBQ3JCLFlBQU1SLFlBQVlDLGVBQUtDLGtCQUFMLENBQXdCTSxLQUFLSixJQUE3QixDQUFsQjtBQUNBLFlBQUksQ0FBQ0ksS0FBS0MsUUFBTCxDQUFjQyxRQUFuQixFQUE2QjtBQUMzQixpQkFBS2hCLElBQUwsQ0FBVSxNQUFWLGNBQTRCTSxTQUE1QjtBQUNBLGlCQUFPTyxHQUFQO0FBQ0Q7O0FBRUQsWUFBSSxDQUFDSSxpQkFBRUMsVUFBRixDQUFhSixLQUFLQyxRQUFMLENBQWNDLFFBQTNCLENBQUwsRUFBMkM7QUFDekMsaUJBQUtoQixJQUFMLENBQVUsTUFBVixjQUE0Qk0sU0FBNUI7QUFDQSxpQkFBT08sR0FBUDtBQUNEOztBQUVEQSxZQUFJUCxTQUFKLElBQWlCUSxLQUFLQyxRQUFMLENBQWNDLFFBQS9CO0FBQ0EsZUFBT0gsR0FBUDtBQUNELE9BbkJZLEVBbUJWLEVBbkJVLENBQWY7O0FBcUJBLFdBQUtiLElBQUwsQ0FBVSxNQUFWLHVCQUFxQ2lCLGlCQUFFRSxJQUFGLENBQU8sS0FBS2YsT0FBWixFQUFxQmdCLE1BQTFEO0FBQ0Q7Ozs7MkZBRWtCQyxPLEVBQVNDLEk7Ozs7OztvQkFDckIsS0FBS2xCLE87Ozs7O3NCQUNGLElBQUltQixLQUFKLENBQVUscUNBQVYsQzs7OztBQUdSO0FBQ0FGLDBCQUFVZCxlQUFLQyxrQkFBTCxDQUF3QmEsT0FBeEIsQ0FBVjs7QUFFQSxvQkFBSSxDQUFDekIsb0JBQW9CZSxJQUFwQixDQUF5QlUsT0FBekIsQ0FBTCxFQUF3QztBQUN0Q0EsNEJBQVUxQixnQkFBZ0IwQixPQUExQjtBQUNEOztBQUVLRyx5QixHQUFZLEtBQUtwQixPQUFMLENBQWFpQixPQUFiLEM7O29CQUNiRyxTOzs7OztzQkFDRyxJQUFJRCxLQUFKLGFBQW9CRixPQUFwQixpQjs7Ozt1QkFHb0JHLFVBQVVGLElBQVYsQzs7O0FBQXRCRyw2QjtBQUNBQywrQixHQUFrQixtQ0FBbUJELGNBQWNFLElBQWpDLEM7O3FCQUVwQkQsZTs7Ozs7c0JBQ0ksSUFBSUgsS0FBSixhQUFvQkYsT0FBcEIscUNBQTJESyxlQUEzRCxDOzs7c0JBR0osQ0FBQ0QsY0FBY0csV0FBZixJQUE4QixDQUFDWCxpQkFBRVksT0FBRixDQUFVSixjQUFjRyxXQUF4QixDOzs7OztzQkFDM0IsSUFBSUwsS0FBSixhQUFvQkYsT0FBcEIsNEM7OztpREFHREksYTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2tCQS9EVTNCLGEiLCJmaWxlIjoiLi9zcmMvc2tpbGxzL2luZGV4LmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5pbXBvcnQgdXRpbCBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IHsgdmFsaWRhdGVGbG93U2NoZW1hIH0gZnJvbSAnLi4vZGlhbG9nL3ZhbGlkYXRvcidcblxuY29uc3QgU0tJTExTX1BSRUZJWCA9ICdza2lsbC0nXG5jb25zdCBTS0lMTFNfUFJFRklYX1JFR0VYID0gbmV3IFJlZ0V4cCgnXicgKyBTS0lMTFNfUFJFRklYKVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTa2lsbHNNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoeyBsb2dnZXIgfSkge1xuICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyXG4gICAgdGhpcy5fbG9nKCdpbmZvJywgYFtTa2lsbHNdIEluaXRpYXRlZGApXG4gIH1cblxuICBfbG9nID0gKGxldmVsLCBtc2cpID0+IHtcbiAgICB0aGlzLmxvZ2dlciAmJiB0aGlzLmxvZ2dlcltsZXZlbF0gJiYgdGhpcy5sb2dnZXJbbGV2ZWxdKG1zZylcbiAgfVxuXG4gIHJlZ2lzdGVyU2tpbGxzRnJvbU1vZHVsZXMobW9kdWxlcykge1xuICAgIHRoaXMuX3NraWxscyA9IG1vZHVsZXNcbiAgICAgIC5maWx0ZXIobW9kID0+IHtcbiAgICAgICAgY29uc3Qgc2hvcnROYW1lID0gdXRpbC5nZXRNb2R1bGVTaG9ydG5hbWUobW9kLm5hbWUpXG4gICAgICAgIHJldHVybiBTS0lMTFNfUFJFRklYX1JFR0VYLnRlc3Qoc2hvcnROYW1lKVxuICAgICAgfSlcbiAgICAgIC5yZWR1Y2UoKGFjYywgY3VycikgPT4ge1xuICAgICAgICBjb25zdCBzaG9ydE5hbWUgPSB1dGlsLmdldE1vZHVsZVNob3J0bmFtZShjdXJyLm5hbWUpXG4gICAgICAgIGlmICghY3Vyci5oYW5kbGVycy5nZW5lcmF0ZSkge1xuICAgICAgICAgIHRoaXMuX2xvZygnd2FybicsIGBTa2lsbCBcIiR7c2hvcnROYW1lfVwiIGhhcyBubyBmbG93IGdlbmVyYXRvciAoXCJnZW5lcmF0ZVwiIG1ldGhvZCBleHBvc2VkKWApXG4gICAgICAgICAgcmV0dXJuIGFjY1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFfLmlzRnVuY3Rpb24oY3Vyci5oYW5kbGVycy5nZW5lcmF0ZSkpIHtcbiAgICAgICAgICB0aGlzLl9sb2coJ3dhcm4nLCBgU2tpbGwgXCIke3Nob3J0TmFtZX1cIiBnZW5lcmF0b3IgaXMgbm90IGEgdmFsaWQgZnVuY3Rpb25gKVxuICAgICAgICAgIHJldHVybiBhY2NcbiAgICAgICAgfVxuXG4gICAgICAgIGFjY1tzaG9ydE5hbWVdID0gY3Vyci5oYW5kbGVycy5nZW5lcmF0ZVxuICAgICAgICByZXR1cm4gYWNjXG4gICAgICB9LCB7fSlcblxuICAgIHRoaXMuX2xvZygnaW5mbycsIGBbU2tpbGxzXSBMb2FkZWQgJHtfLmtleXModGhpcy5fc2tpbGxzKS5sZW5ndGh9IHNraWxsc2ApXG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUZsb3coc2tpbGxJZCwgZGF0YSkge1xuICAgIGlmICghdGhpcy5fc2tpbGxzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTa2lsbHMgaGF2ZW4ndCBiZWVuIGluaXRpYWxpemVkIHlldFwiKVxuICAgIH1cblxuICAgIC8vdnYgQmFja3dhcmQgY29tcGF0aWJsZSB3aXRoIG9sZCBza2lsbHMsIGp1c3QgbWFraW5nIHN1cmUgdGhlcmUncyBubyBAYm90cHJlc3Mgb3IgYm90cHJlc3MtXG4gICAgc2tpbGxJZCA9IHV0aWwuZ2V0TW9kdWxlU2hvcnRuYW1lKHNraWxsSWQpXG5cbiAgICBpZiAoIVNLSUxMU19QUkVGSVhfUkVHRVgudGVzdChza2lsbElkKSkge1xuICAgICAgc2tpbGxJZCA9IFNLSUxMU19QUkVGSVggKyBza2lsbElkXG4gICAgfVxuXG4gICAgY29uc3QgZ2VuZXJhdG9yID0gdGhpcy5fc2tpbGxzW3NraWxsSWRdXG4gICAgaWYgKCFnZW5lcmF0b3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgU2tpbGwgXCIke3NraWxsSWR9XCIgbm90IGZvdW5kYClcbiAgICB9XG5cbiAgICBjb25zdCBnZW5lcmF0ZWRGbG93ID0gYXdhaXQgZ2VuZXJhdG9yKGRhdGEpXG4gICAgY29uc3QgdmFsaWRhdGlvbkVycm9yID0gdmFsaWRhdGVGbG93U2NoZW1hKGdlbmVyYXRlZEZsb3cuZmxvdylcblxuICAgIGlmICh2YWxpZGF0aW9uRXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgU2tpbGwgXCIke3NraWxsSWR9XCIgZ2VuZXJhdGVkIGFuIGludmFsaWQgZmxvdzogJHt2YWxpZGF0aW9uRXJyb3J9YClcbiAgICB9XG5cbiAgICBpZiAoIWdlbmVyYXRlZEZsb3cudHJhbnNpdGlvbnMgfHwgIV8uaXNBcnJheShnZW5lcmF0ZWRGbG93LnRyYW5zaXRpb25zKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTa2lsbCBcIiR7c2tpbGxJZH1cIiBkaWRuJ3QgZ2VuZXJhdGUgdmFsaWQgXCJ0cmFuc2l0aW9uc1wiYClcbiAgICB9XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVkRmxvd1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/skills/index.js\n");

/***/ }),

/***/ "./src/stats.js":
/*!**********************!*\
  !*** ./src/stats.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _os = __webpack_require__(/*! os */ \"os\");\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _crypto = __webpack_require__(/*! crypto */ \"crypto\");\n\nvar _crypto2 = _interopRequireDefault(_crypto);\n\nvar _universalAnalytics = __webpack_require__(/*! universal-analytics */ \"universal-analytics\");\n\nvar _universalAnalytics2 = _interopRequireDefault(_universalAnalytics);\n\nvar _nodeMachineId = __webpack_require__(/*! node-machine-id */ \"node-machine-id\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (botfile) {\n  var visitor = null;\n  var queued = [];\n\n  (0, _nodeMachineId.machineId)().catch(function () {\n    var hash = _crypto2.default.createHash('sha256');\n    hash.update(_os2.default.arch() + _os2.default.hostname() + _os2.default.platform() + _os2.default.type());\n    return hash.digest('hex');\n  }).then(function (mid) {\n    visitor = (0, _universalAnalytics2.default)('UA-90044826-1', mid, { strictCidFormat: false });\n    queued.forEach(function (a) {\n      return a();\n    });\n    queued = [];\n  });\n\n  var track = function track(category, action) {\n    var label = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n    if (!!botfile.optOutStats) {\n      return; // Don't track if bot explicitly opted out from stats collection\n    }\n\n    if (!visitor) {\n      queued.push(function () {\n        return track(category, action, label, value);\n      });\n      return;\n    }\n\n    visitor.event(category, action, label, value, function () {\n      /* ignore errors */\n    });\n  };\n\n  var trackException = function trackException(message) {\n    if (!!botfile.optOutStats) {\n      return; // Don't track if bot explicitly opted out from stats collection\n    }\n\n    if (!visitor) {\n      queued.push(function () {\n        return trackException(message);\n      });\n      return;\n    }\n\n    visitor.event(message, function () {\n      /* ignore errors */\n    });\n  };\n\n  return { track: track, trackException: trackException };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc3RhdHMuanM/NzgzYiJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwidmlzaXRvciIsInF1ZXVlZCIsImNhdGNoIiwiaGFzaCIsImNyeXB0byIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJvcyIsImFyY2giLCJob3N0bmFtZSIsInBsYXRmb3JtIiwidHlwZSIsImRpZ2VzdCIsInRoZW4iLCJtaWQiLCJzdHJpY3RDaWRGb3JtYXQiLCJmb3JFYWNoIiwiYSIsInRyYWNrIiwiY2F0ZWdvcnkiLCJhY3Rpb24iLCJsYWJlbCIsInZhbHVlIiwiYm90ZmlsZSIsIm9wdE91dFN0YXRzIiwicHVzaCIsImV2ZW50IiwidHJhY2tFeGNlcHRpb24iLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUFBLE9BQU9DLE9BQVAsR0FBaUIsbUJBQVc7QUFDMUIsTUFBSUMsVUFBVSxJQUFkO0FBQ0EsTUFBSUMsU0FBUyxFQUFiOztBQUVBLGtDQUNHQyxLQURILENBQ1MsWUFBTTtBQUNYLFFBQU1DLE9BQU9DLGlCQUFPQyxVQUFQLENBQWtCLFFBQWxCLENBQWI7QUFDQUYsU0FBS0csTUFBTCxDQUFZQyxhQUFHQyxJQUFILEtBQVlELGFBQUdFLFFBQUgsRUFBWixHQUE0QkYsYUFBR0csUUFBSCxFQUE1QixHQUE0Q0gsYUFBR0ksSUFBSCxFQUF4RDtBQUNBLFdBQU9SLEtBQUtTLE1BQUwsQ0FBWSxLQUFaLENBQVA7QUFDRCxHQUxILEVBTUdDLElBTkgsQ0FNUSxlQUFPO0FBQ1hiLGNBQVUsa0NBQUcsZUFBSCxFQUFvQmMsR0FBcEIsRUFBeUIsRUFBRUMsaUJBQWlCLEtBQW5CLEVBQXpCLENBQVY7QUFDQWQsV0FBT2UsT0FBUCxDQUFlO0FBQUEsYUFBS0MsR0FBTDtBQUFBLEtBQWY7QUFDQWhCLGFBQVMsRUFBVDtBQUNELEdBVkg7O0FBWUEsTUFBTWlCLFFBQVEsU0FBUkEsS0FBUSxDQUFDQyxRQUFELEVBQVdDLE1BQVgsRUFBa0Q7QUFBQSxRQUEvQkMsS0FBK0IsdUVBQXZCLElBQXVCO0FBQUEsUUFBakJDLEtBQWlCLHVFQUFULElBQVM7O0FBQzlELFFBQUksQ0FBQyxDQUFDQyxRQUFRQyxXQUFkLEVBQTJCO0FBQ3pCLGFBRHlCLENBQ2xCO0FBQ1I7O0FBRUQsUUFBSSxDQUFDeEIsT0FBTCxFQUFjO0FBQ1pDLGFBQU93QixJQUFQLENBQVk7QUFBQSxlQUFNUCxNQUFNQyxRQUFOLEVBQWdCQyxNQUFoQixFQUF3QkMsS0FBeEIsRUFBK0JDLEtBQS9CLENBQU47QUFBQSxPQUFaO0FBQ0E7QUFDRDs7QUFFRHRCLFlBQVEwQixLQUFSLENBQWNQLFFBQWQsRUFBd0JDLE1BQXhCLEVBQWdDQyxLQUFoQyxFQUF1Q0MsS0FBdkMsRUFBOEMsWUFBTTtBQUNsRDtBQUNELEtBRkQ7QUFHRCxHQWJEOztBQWVBLE1BQU1LLGlCQUFpQixTQUFqQkEsY0FBaUIsVUFBVztBQUNoQyxRQUFJLENBQUMsQ0FBQ0osUUFBUUMsV0FBZCxFQUEyQjtBQUN6QixhQUR5QixDQUNsQjtBQUNSOztBQUVELFFBQUksQ0FBQ3hCLE9BQUwsRUFBYztBQUNaQyxhQUFPd0IsSUFBUCxDQUFZO0FBQUEsZUFBTUUsZUFBZUMsT0FBZixDQUFOO0FBQUEsT0FBWjtBQUNBO0FBQ0Q7O0FBRUQ1QixZQUFRMEIsS0FBUixDQUFjRSxPQUFkLEVBQXVCLFlBQU07QUFDM0I7QUFDRCxLQUZEO0FBR0QsR0FiRDs7QUFlQSxTQUFPLEVBQUVWLFlBQUYsRUFBU1MsOEJBQVQsRUFBUDtBQUNELENBL0NEIiwiZmlsZSI6Ii4vc3JjL3N0YXRzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG9zIGZyb20gJ29zJ1xuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nXG5pbXBvcnQgdWEgZnJvbSAndW5pdmVyc2FsLWFuYWx5dGljcydcbmltcG9ydCB7IG1hY2hpbmVJZCB9IGZyb20gJ25vZGUtbWFjaGluZS1pZCdcblxubW9kdWxlLmV4cG9ydHMgPSBib3RmaWxlID0+IHtcbiAgbGV0IHZpc2l0b3IgPSBudWxsXG4gIGxldCBxdWV1ZWQgPSBbXVxuXG4gIG1hY2hpbmVJZCgpXG4gICAgLmNhdGNoKCgpID0+IHtcbiAgICAgIGNvbnN0IGhhc2ggPSBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAgIGhhc2gudXBkYXRlKG9zLmFyY2goKSArIG9zLmhvc3RuYW1lKCkgKyBvcy5wbGF0Zm9ybSgpICsgb3MudHlwZSgpKVxuICAgICAgcmV0dXJuIGhhc2guZGlnZXN0KCdoZXgnKVxuICAgIH0pXG4gICAgLnRoZW4obWlkID0+IHtcbiAgICAgIHZpc2l0b3IgPSB1YSgnVUEtOTAwNDQ4MjYtMScsIG1pZCwgeyBzdHJpY3RDaWRGb3JtYXQ6IGZhbHNlIH0pXG4gICAgICBxdWV1ZWQuZm9yRWFjaChhID0+IGEoKSlcbiAgICAgIHF1ZXVlZCA9IFtdXG4gICAgfSlcblxuICBjb25zdCB0cmFjayA9IChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCA9IG51bGwsIHZhbHVlID0gbnVsbCkgPT4ge1xuICAgIGlmICghIWJvdGZpbGUub3B0T3V0U3RhdHMpIHtcbiAgICAgIHJldHVybiAvLyBEb24ndCB0cmFjayBpZiBib3QgZXhwbGljaXRseSBvcHRlZCBvdXQgZnJvbSBzdGF0cyBjb2xsZWN0aW9uXG4gICAgfVxuXG4gICAgaWYgKCF2aXNpdG9yKSB7XG4gICAgICBxdWV1ZWQucHVzaCgoKSA9PiB0cmFjayhjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdmlzaXRvci5ldmVudChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUsICgpID0+IHtcbiAgICAgIC8qIGlnbm9yZSBlcnJvcnMgKi9cbiAgICB9KVxuICB9XG5cbiAgY29uc3QgdHJhY2tFeGNlcHRpb24gPSBtZXNzYWdlID0+IHtcbiAgICBpZiAoISFib3RmaWxlLm9wdE91dFN0YXRzKSB7XG4gICAgICByZXR1cm4gLy8gRG9uJ3QgdHJhY2sgaWYgYm90IGV4cGxpY2l0bHkgb3B0ZWQgb3V0IGZyb20gc3RhdHMgY29sbGVjdGlvblxuICAgIH1cblxuICAgIGlmICghdmlzaXRvcikge1xuICAgICAgcXVldWVkLnB1c2goKCkgPT4gdHJhY2tFeGNlcHRpb24obWVzc2FnZSkpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB2aXNpdG9yLmV2ZW50KG1lc3NhZ2UsICgpID0+IHtcbiAgICAgIC8qIGlnbm9yZSBlcnJvcnMgKi9cbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIHsgdHJhY2ssIHRyYWNrRXhjZXB0aW9uIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/stats.js\n");

/***/ }),

/***/ "./src/users.js":
/*!**********************!*\
  !*** ./src/users.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _lodash = __webpack_require__(/*! lodash */ \"lodash\");\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _helpers = __webpack_require__(/*! ./database/helpers */ \"./src/database/helpers.js\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * The Users namespace contains operations available for the known users of your bot.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @public\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @namespace Users\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * bp.users\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */\n\nmodule.exports = function (_ref) {\n  var db = _ref.db;\n\n  /**\n   * Returns whether or not a user has a specific tag or not.\n   * @param  {String} userId\n   * @param  {String} tag    The name of the tag. Case insensitive.\n   * @return {Boolean}\n   * @async\n   * @memberof! Users\n   * @example\n   * if (await bp.users.hasTag(event.user.id, 'IS_SUBSCRIBED')) {...}\n   */\n  var hasTag = function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(userId, tag) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context.sent;\n              return _context.abrupt('return', knex('users_tags').select('userId').where({ userId: userId, tag: _lodash2.default.toUpper(tag) }).limit(1).then(function (ret) {\n                return ret.length > 0;\n              }));\n\n            case 4:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function hasTag(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Tags a user with a specific tag (or overwrites an existing one) and a given value for that tag (optional).\n   * Tags can be used to classify users (no value needed) or to store information about them (with a tag value).\n   * Values are useful to store user information like emails, etc.\n   * Value is always assumed to be a string.\n   * @param  {String}  userId\n   * @param  {String}  tag    The name of the tag.\n   * Case insensitive. Note that this property will always be upper-cased.\n   * @param  {String} [value]  Any string value to store info about this tag\n   * @async\n   * @memberof! Users\n   * @example\n   * await bp.users.tag(event.user.id, 'EMAIL', 'sylvain@botpress.io')\n   * await bp.users.tag(event.user.id, 'PAYING_USER')\n   */\n  var tag = function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(userId, _tag) {\n      var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var knex;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context2.sent;\n\n\n              _tag = _lodash2.default.toUpper(_tag);\n\n              _context2.next = 6;\n              return hasTag(userId, _tag);\n\n            case 6:\n              if (!_context2.sent) {\n                _context2.next = 11;\n                break;\n              }\n\n              _context2.next = 9;\n              return knex('users_tags').where({ userId: userId, tag: _tag }).update({\n                userId: userId,\n                tag: _tag,\n                value: value,\n                tagged_on: (0, _helpers2.default)(knex).date.now()\n              }).then();\n\n            case 9:\n              _context2.next = 13;\n              break;\n\n            case 11:\n              _context2.next = 13;\n              return knex('users_tags').insert({\n                userId: userId,\n                tag: _tag,\n                value: value,\n                tagged_on: (0, _helpers2.default)(knex).date.now()\n              }).then();\n\n            case 13:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function tag(_x3, _x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Removes a tag from a user if it exists.\n   * @param  {String} userId\n   * @param  {String} tag    Name of the tag. Case-insensitive.\n   * @memberof! Users\n   */\n  var untag = function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(userId, tag) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context3.sent;\n              _context3.next = 5;\n              return knex('users_tags').where({ userId: userId, tag: _lodash2.default.toUpper(tag) }).del().then();\n\n            case 5:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function untag(_x6, _x7) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Returns the value of a user tag, if it exists\n   * @param  {String} userId [description]\n   * @param  {String} tag    [description]\n   * @return {?String}        Value of the tag\n   * @memberof! Users\n   */\n  var getTag = function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(userId, tag) {\n      var details = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var knex;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context4.sent;\n              return _context4.abrupt('return', knex('users_tags').select('value', 'tagged_on', 'tag').where({ userId: userId, tag: _lodash2.default.toUpper(tag) }).limit(1).then().get(0).then(function (ret) {\n                if (ret && details) {\n                  return _extends({}, ret, {\n                    tagged_on: new Date(ret.tagged_on)\n                  });\n                }\n\n                return ret && ret.value;\n              }));\n\n            case 4:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function getTag(_x8, _x9) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Returns all the tags for a given user\n   * @param  {String} userId [description]\n   * @return {Array.<{ tag: String, value: String}>}        An array of all the tags for this user\n   * @memberof! Users\n   */\n  var getTags = function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(userId) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context5.sent;\n              return _context5.abrupt('return', knex('users_tags').where({ userId: userId }).select('tag', 'value').then(function (tags) {\n                return _lodash2.default.map(tags, function (v) {\n                  return { tag: v.tag, value: v.value };\n                });\n              }));\n\n            case 4:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, undefined);\n    }));\n\n    return function getTags(_x11) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  // TODO: Fix this, list of tags is always empty\n  var list = function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n      var limit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 50;\n      var from = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var knex, isLite, selectTags, subQuery;\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context6.sent;\n              isLite = (0, _helpers2.default)(knex).isLite();\n              selectTags = isLite ? 'group_concat(tag) as tags' : \"string_agg(tag, ',') as tags\";\n              subQuery = knex('users_tags').select('userId', knex.raw(selectTags)).groupBy('userId');\n              return _context6.abrupt('return', knex('users').leftJoin(knex.raw('(' + subQuery.toString() + ') AS t2'), 'users.id', '=', 't2.userId').select('users.id', 'users.userId', 'users.platform', 'users.gender', 'users.timezone', 'users.locale', 'users.picture_url', 'users.first_name', 'users.last_name', 'users.created_on', 't2.tags').orderBy('users.created_on', 'asc').offset(from).limit(limit).then(function (users) {\n                return users.map(function (x) {\n                  return Object.assign(x, {\n                    tags: x.tags && x.tags.split(',') || []\n                  });\n                });\n              }));\n\n            case 7:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, undefined);\n    }));\n\n    return function list() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  // TODO: Fix this, just doesn't work\n  var listWithTags = function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(tags) {\n      var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 50;\n      var from = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var knex, filterByTag, isLite, selectTags, query, i, subQuery;\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context7.sent;\n\n\n              tags = _lodash2.default.filter(tags, function (t) {\n                return _lodash2.default.isString(t);\n              }).map(function (t) {\n                return t.toUpperCase();\n              });\n\n              filterByTag = function filterByTag(tag) {\n                return knex('users_tags').select('userId').where('tag', tag);\n              };\n\n              isLite = (0, _helpers2.default)(knex).isLite();\n              selectTags = isLite ? 'group_concat(tag) as tags' : \"string_agg(tag, ',') as tags\";\n              query = knex('users');\n              i = 0;\n              subQuery = knex('users_tags').select('userId', knex.raw(selectTags)).groupBy('userId');\n\n\n              tags.forEach(function (tag) {\n                var name = 't' + ++i;\n                query = query.join(knex.raw('(' + filterByTag(tag).toString() + ') AS ' + name), 'users.id', '=', name + '.userId');\n              });\n\n              return _context7.abrupt('return', query.leftJoin(knex.raw('(' + subQuery.toString() + ') AS tt'), 'users.id', '=', 'tt.userId').select('users.userId as userId', 'users.platform as platform', 'users.gender as gender', 'users.timezone as timezone', 'users.locale as locale', 'users.picture_url as picture_url', 'users.first_name as first_name', 'users.last_name as last_name', 'users.created_on as created_on', 'tt.tags as tags').orderBy('users.created_on', 'asc').offset(from).limit(limit).then(function (users) {\n                return users.map(function (x) {\n                  return Object.assign(x, {\n                    tags: x.tags && x.tags.split(',') || []\n                  });\n                });\n              }));\n\n            case 12:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, undefined);\n    }));\n\n    return function listWithTags(_x14) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var count = function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context8.sent;\n              return _context8.abrupt('return', knex('users').count('* as count').then().get(0).then(function (ret) {\n                return parseInt(ret && ret.count);\n              }));\n\n            case 4:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, undefined);\n    }));\n\n    return function count() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  return { tag: tag, untag: untag, hasTag: hasTag, getTag: getTag, getTags: getTags, list: list, count: count, listWithTags: listWithTags };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvdXNlcnMuanM/MTlmNyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZGIiLCJoYXNUYWciLCJ1c2VySWQiLCJ0YWciLCJnZXQiLCJrbmV4Iiwic2VsZWN0Iiwid2hlcmUiLCJfIiwidG9VcHBlciIsImxpbWl0IiwidGhlbiIsInJldCIsImxlbmd0aCIsInZhbHVlIiwidXBkYXRlIiwidGFnZ2VkX29uIiwiZGF0ZSIsIm5vdyIsImluc2VydCIsInVudGFnIiwiZGVsIiwiZ2V0VGFnIiwiZGV0YWlscyIsIkRhdGUiLCJnZXRUYWdzIiwibWFwIiwidGFncyIsInYiLCJsaXN0IiwiZnJvbSIsImlzTGl0ZSIsInNlbGVjdFRhZ3MiLCJzdWJRdWVyeSIsInJhdyIsImdyb3VwQnkiLCJsZWZ0Sm9pbiIsInRvU3RyaW5nIiwib3JkZXJCeSIsIm9mZnNldCIsInVzZXJzIiwiT2JqZWN0IiwiYXNzaWduIiwieCIsInNwbGl0IiwibGlzdFdpdGhUYWdzIiwiZmlsdGVyIiwiaXNTdHJpbmciLCJ0IiwidG9VcHBlckNhc2UiLCJmaWx0ZXJCeVRhZyIsInF1ZXJ5IiwiaSIsImZvckVhY2giLCJuYW1lIiwiam9pbiIsImNvdW50IiwicGFyc2VJbnQiXSwibWFwcGluZ3MiOiI7Ozs7QUFRQTs7OztBQUNBOzs7Ozs7MmNBVEE7Ozs7Ozs7O0FBV0FBLE9BQU9DLE9BQVAsR0FBaUIsZ0JBQVk7QUFBQSxNQUFUQyxFQUFTLFFBQVRBLEVBQVM7O0FBQzNCOzs7Ozs7Ozs7O0FBVUEsTUFBTUM7QUFBQSx3RUFBUyxpQkFBT0MsTUFBUCxFQUFlQyxHQUFmO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQ01ILEdBQUdJLEdBQUgsRUFETjs7QUFBQTtBQUNQQyxrQkFETztBQUFBLCtDQUdOQSxLQUFLLFlBQUwsRUFDSkMsTUFESSxDQUNHLFFBREgsRUFFSkMsS0FGSSxDQUVFLEVBQUVMLGNBQUYsRUFBVUMsS0FBS0ssaUJBQUVD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RUFjd0IsS0FkeEIsRUFlSkMsTUFmSSxDQWVHVCxJQWZILEVBZ0JKcEIsS0FoQkksQ0FnQkVBLEtBaEJGLEVBaUJKQyxJQWpCSSxDQWlCQztBQUFBLHVCQUNKNkIsTUFBTWQsR0FBTixDQUFVO0FBQUEseUJBQ1JlLE9BQU9DLE1BQVAsQ0FBY0MsQ0FBZCxFQUFpQjtBQUNmaEIsMEJBQU9nQixFQUFFaEIsSUFBRixJQUFVZ0IsRUFBRWhCLElBQUYsQ0FBT2lCLEtBQVAsQ0FBYSxHQUFiLENBQVgsSUFBaUM7QUFEeEIsbUJBQWpCLENBRFE7QUFBQSxpQkFBVixDQURJO0FBQUEsZUFqQkQsQ0E3Qlk7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FBZjs7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFOOztBQXVEQSxNQUFNWTtBQUFBLHdFQUFRO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBQ094RCxHQUFHSSxHQUFILEVBRFA7O0FBQUE7QUFDTkMsa0JBRE07QUFBQSxnREFHTEEsS0FBSyxPQUFMLEVBQ0ptRCxLQURJLENBQ0UsWUFERixFQUVKN0MsSUFGSSxHQUdKUCxHQUhJLENBR0EsQ0FIQSxFQUlKTyxJQUpJLENBSUM7QUFBQSx1QkFBTzhDLFNBQVM3QyxPQUFPQSxJQUFJNEMsS0FBcEIsQ0FBUDtBQUFBLGVBSkQsQ0FISzs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFSOztBQUFBO0FBQUE7QUFBQTtBQUFBLEtBQU47O0FBVUEsU0FBTyxFQUFFckQsUUFBRixFQUFPaUIsWUFBUCxFQUFjbkIsY0FBZCxFQUFzQnFCLGNBQXRCLEVBQThCRyxnQkFBOUIsRUFBdUNJLFVBQXZDLEVBQTZDMkIsWUFBN0MsRUFBb0RYLDBCQUFwRCxFQUFQO0FBQ0QsQ0F2T0QiLCJmaWxlIjoiLi9zcmMvdXNlcnMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRoZSBVc2VycyBuYW1lc3BhY2UgY29udGFpbnMgb3BlcmF0aW9ucyBhdmFpbGFibGUgZm9yIHRoZSBrbm93biB1c2VycyBvZiB5b3VyIGJvdC5cbiAqIEBwdWJsaWNcbiAqIEBuYW1lc3BhY2UgVXNlcnNcbiAqIEBleGFtcGxlXG4gKiBicC51c2Vyc1xuICovXG5cbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBoZWxwZXJzIGZyb20gJy4vZGF0YWJhc2UvaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBkYiB9KSA9PiB7XG4gIC8qKlxuICAgKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IGEgdXNlciBoYXMgYSBzcGVjaWZpYyB0YWcgb3Igbm90LlxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHVzZXJJZFxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHRhZyAgICBUaGUgbmFtZSBvZiB0aGUgdGFnLiBDYXNlIGluc2Vuc2l0aXZlLlxuICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgKiBAYXN5bmNcbiAgICogQG1lbWJlcm9mISBVc2Vyc1xuICAgKiBAZXhhbXBsZVxuICAgKiBpZiAoYXdhaXQgYnAudXNlcnMuaGFzVGFnKGV2ZW50LnVzZXIuaWQsICdJU19TVUJTQ1JJQkVEJykpIHsuLi59XG4gICAqL1xuICBjb25zdCBoYXNUYWcgPSBhc3luYyAodXNlcklkLCB0YWcpID0+IHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIHJldHVybiBrbmV4KCd1c2Vyc190YWdzJylcbiAgICAgIC5zZWxlY3QoJ3VzZXJJZCcpXG4gICAgICAud2hlcmUoeyB1c2VySWQsIHRhZzogXy50b1VwcGVyKHRhZykgfSlcbiAgICAgIC5saW1pdCgxKVxuICAgICAgLnRoZW4ocmV0ID0+IHJldC5sZW5ndGggPiAwKVxuICB9XG5cbiAgLyoqXG4gICAqIFRhZ3MgYSB1c2VyIHdpdGggYSBzcGVjaWZpYyB0YWcgKG9yIG92ZXJ3cml0ZXMgYW4gZXhpc3Rpbmcgb25lKSBhbmQgYSBnaXZlbiB2YWx1ZSBmb3IgdGhhdCB0YWcgKG9wdGlvbmFsKS5cbiAgICogVGFncyBjYW4gYmUgdXNlZCB0byBjbGFzc2lmeSB1c2VycyAobm8gdmFsdWUgbmVlZGVkKSBvciB0byBzdG9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGVtICh3aXRoIGEgdGFnIHZhbHVlKS5cbiAgICogVmFsdWVzIGFyZSB1c2VmdWwgdG8gc3RvcmUgdXNlciBpbmZvcm1hdGlvbiBsaWtlIGVtYWlscywgZXRjLlxuICAgKiBWYWx1ZSBpcyBhbHdheXMgYXNzdW1lZCB0byBiZSBhIHN0cmluZy5cbiAgICogQHBhcmFtICB7U3RyaW5nfSAgdXNlcklkXG4gICAqIEBwYXJhbSAge1N0cmluZ30gIHRhZyAgICBUaGUgbmFtZSBvZiB0aGUgdGFnLlxuICAgKiBDYXNlIGluc2Vuc2l0aXZlLiBOb3RlIHRoYXQgdGhpcyBwcm9wZXJ0eSB3aWxsIGFsd2F5cyBiZSB1cHBlci1jYXNlZC5cbiAgICogQHBhcmFtICB7U3RyaW5nfSBbdmFsdWVdICBBbnkgc3RyaW5nIHZhbHVlIHRvIHN0b3JlIGluZm8gYWJvdXQgdGhpcyB0YWdcbiAgICogQGFzeW5jXG4gICAqIEBtZW1iZXJvZiEgVXNlcnNcbiAgICogQGV4YW1wbGVcbiAgICogYXdhaXQgYnAudXNlcnMudGFnKGV2ZW50LnVzZXIuaWQsICdFTUFJTCcsICdzeWx2YWluQGJvdHByZXNzLmlvJylcbiAgICogYXdhaXQgYnAudXNlcnMudGFnKGV2ZW50LnVzZXIuaWQsICdQQVlJTkdfVVNFUicpXG4gICAqL1xuICBjb25zdCB0YWcgPSBhc3luYyAodXNlcklkLCB0YWcsIHZhbHVlID0gdHJ1ZSkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgdGFnID0gXy50b1VwcGVyKHRhZylcblxuICAgIGlmIChhd2FpdCBoYXNUYWcodXNlcklkLCB0YWcpKSB7XG4gICAgICBhd2FpdCBrbmV4KCd1c2Vyc190YWdzJylcbiAgICAgICAgLndoZXJlKHsgdXNlcklkLCB0YWcgfSlcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHRhZyxcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICB0YWdnZWRfb246IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKVxuICAgICAgICB9KVxuICAgICAgICAudGhlbigpXG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IGtuZXgoJ3VzZXJzX3RhZ3MnKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgdGFnLFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgIHRhZ2dlZF9vbjogaGVscGVycyhrbmV4KS5kYXRlLm5vdygpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIHRhZyBmcm9tIGEgdXNlciBpZiBpdCBleGlzdHMuXG4gICAqIEBwYXJhbSAge1N0cmluZ30gdXNlcklkXG4gICAqIEBwYXJhbSAge1N0cmluZ30gdGFnICAgIE5hbWUgb2YgdGhlIHRhZy4gQ2FzZS1pbnNlbnNpdGl2ZS5cbiAgICogQG1lbWJlcm9mISBVc2Vyc1xuICAgKi9cbiAgY29uc3QgdW50YWcgPSBhc3luYyAodXNlcklkLCB0YWcpID0+IHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIGF3YWl0IGtuZXgoJ3VzZXJzX3RhZ3MnKVxuICAgICAgLndoZXJlKHsgdXNlcklkLCB0YWc6IF8udG9VcHBlcih0YWcpIH0pXG4gICAgICAuZGVsKClcbiAgICAgIC50aGVuKClcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiBhIHVzZXIgdGFnLCBpZiBpdCBleGlzdHNcbiAgICogQHBhcmFtICB7U3RyaW5nfSB1c2VySWQgW2Rlc2NyaXB0aW9uXVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHRhZyAgICBbZGVzY3JpcHRpb25dXG4gICAqIEByZXR1cm4gez9TdHJpbmd9ICAgICAgICBWYWx1ZSBvZiB0aGUgdGFnXG4gICAqIEBtZW1iZXJvZiEgVXNlcnNcbiAgICovXG4gIGNvbnN0IGdldFRhZyA9IGFzeW5jICh1c2VySWQsIHRhZywgZGV0YWlscyA9IGZhbHNlKSA9PiB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICByZXR1cm4ga25leCgndXNlcnNfdGFncycpXG4gICAgICAuc2VsZWN0KCd2YWx1ZScsICd0YWdnZWRfb24nLCAndGFnJylcbiAgICAgIC53aGVyZSh7IHVzZXJJZCwgdGFnOiBfLnRvVXBwZXIodGFnKSB9KVxuICAgICAgLmxpbWl0KDEpXG4gICAgICAudGhlbigpXG4gICAgICAuZ2V0KDApXG4gICAgICAudGhlbihyZXQgPT4ge1xuICAgICAgICBpZiAocmV0ICYmIGRldGFpbHMpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ucmV0LFxuICAgICAgICAgICAgdGFnZ2VkX29uOiBuZXcgRGF0ZShyZXQudGFnZ2VkX29uKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXQgJiYgcmV0LnZhbHVlXG4gICAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYWxsIHRoZSB0YWdzIGZvciBhIGdpdmVuIHVzZXJcbiAgICogQHBhcmFtICB7U3RyaW5nfSB1c2VySWQgW2Rlc2NyaXB0aW9uXVxuICAgKiBAcmV0dXJuIHtBcnJheS48eyB0YWc6IFN0cmluZywgdmFsdWU6IFN0cmluZ30+fSAgICAgICAgQW4gYXJyYXkgb2YgYWxsIHRoZSB0YWdzIGZvciB0aGlzIHVzZXJcbiAgICogQG1lbWJlcm9mISBVc2Vyc1xuICAgKi9cbiAgY29uc3QgZ2V0VGFncyA9IGFzeW5jIHVzZXJJZCA9PiB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICByZXR1cm4ga25leCgndXNlcnNfdGFncycpXG4gICAgICAud2hlcmUoeyB1c2VySWQgfSlcbiAgICAgIC5zZWxlY3QoJ3RhZycsICd2YWx1ZScpXG4gICAgICAudGhlbih0YWdzID0+IHtcbiAgICAgICAgcmV0dXJuIF8ubWFwKHRhZ3MsIHYgPT4ge1xuICAgICAgICAgIHJldHVybiB7IHRhZzogdi50YWcsIHZhbHVlOiB2LnZhbHVlIH1cbiAgICAgICAgfSlcbiAgICAgIH0pXG4gIH1cblxuICAvLyBUT0RPOiBGaXggdGhpcywgbGlzdCBvZiB0YWdzIGlzIGFsd2F5cyBlbXB0eVxuICBjb25zdCBsaXN0ID0gYXN5bmMgKGxpbWl0ID0gNTAsIGZyb20gPSAwKSA9PiB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICBjb25zdCBpc0xpdGUgPSBoZWxwZXJzKGtuZXgpLmlzTGl0ZSgpXG5cbiAgICBjb25zdCBzZWxlY3RUYWdzID0gaXNMaXRlID8gJ2dyb3VwX2NvbmNhdCh0YWcpIGFzIHRhZ3MnIDogXCJzdHJpbmdfYWdnKHRhZywgJywnKSBhcyB0YWdzXCJcblxuICAgIGNvbnN0IHN1YlF1ZXJ5ID0ga25leCgndXNlcnNfdGFncycpXG4gICAgICAuc2VsZWN0KCd1c2VySWQnLCBrbmV4LnJhdyhzZWxlY3RUYWdzKSlcbiAgICAgIC5ncm91cEJ5KCd1c2VySWQnKVxuXG4gICAgcmV0dXJuIGtuZXgoJ3VzZXJzJylcbiAgICAgIC5sZWZ0Sm9pbihrbmV4LnJhdygnKCcgKyBzdWJRdWVyeS50b1N0cmluZygpICsgJykgQVMgdDInKSwgJ3VzZXJzLmlkJywgJz0nLCAndDIudXNlcklkJylcbiAgICAgIC5zZWxlY3QoXG4gICAgICAgICd1c2Vycy5pZCcsXG4gICAgICAgICd1c2Vycy51c2VySWQnLFxuICAgICAgICAndXNlcnMucGxhdGZvcm0nLFxuICAgICAgICAndXNlcnMuZ2VuZGVyJyxcbiAgICAgICAgJ3VzZXJzLnRpbWV6b25lJyxcbiAgICAgICAgJ3VzZXJzLmxvY2FsZScsXG4gICAgICAgICd1c2Vycy5waWN0dXJlX3VybCcsXG4gICAgICAgICd1c2Vycy5maXJzdF9uYW1lJyxcbiAgICAgICAgJ3VzZXJzLmxhc3RfbmFtZScsXG4gICAgICAgICd1c2Vycy5jcmVhdGVkX29uJyxcbiAgICAgICAgJ3QyLnRhZ3MnXG4gICAgICApXG4gICAgICAub3JkZXJCeSgndXNlcnMuY3JlYXRlZF9vbicsICdhc2MnKVxuICAgICAgLm9mZnNldChmcm9tKVxuICAgICAgLmxpbWl0KGxpbWl0KVxuICAgICAgLnRoZW4odXNlcnMgPT5cbiAgICAgICAgdXNlcnMubWFwKHggPT5cbiAgICAgICAgICBPYmplY3QuYXNzaWduKHgsIHtcbiAgICAgICAgICAgIHRhZ3M6ICh4LnRhZ3MgJiYgeC50YWdzLnNwbGl0KCcsJykpIHx8IFtdXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgKVxuICB9XG5cbiAgLy8gVE9ETzogRml4IHRoaXMsIGp1c3QgZG9lc24ndCB3b3JrXG4gIGNvbnN0IGxpc3RXaXRoVGFncyA9IGFzeW5jICh0YWdzLCBsaW1pdCA9IDUwLCBmcm9tID0gMCkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgdGFncyA9IF8uZmlsdGVyKHRhZ3MsIHQgPT4gXy5pc1N0cmluZyh0KSkubWFwKHQgPT4gdC50b1VwcGVyQ2FzZSgpKVxuICAgIGNvbnN0IGZpbHRlckJ5VGFnID0gdGFnID0+XG4gICAgICBrbmV4KCd1c2Vyc190YWdzJylcbiAgICAgICAgLnNlbGVjdCgndXNlcklkJylcbiAgICAgICAgLndoZXJlKCd0YWcnLCB0YWcpXG5cbiAgICBjb25zdCBpc0xpdGUgPSBoZWxwZXJzKGtuZXgpLmlzTGl0ZSgpXG4gICAgY29uc3Qgc2VsZWN0VGFncyA9IGlzTGl0ZSA/ICdncm91cF9jb25jYXQodGFnKSBhcyB0YWdzJyA6IFwic3RyaW5nX2FnZyh0YWcsICcsJykgYXMgdGFnc1wiXG5cbiAgICBsZXQgcXVlcnkgPSBrbmV4KCd1c2VycycpXG4gICAgbGV0IGkgPSAwXG5cbiAgICBjb25zdCBzdWJRdWVyeSA9IGtuZXgoJ3VzZXJzX3RhZ3MnKVxuICAgICAgLnNlbGVjdCgndXNlcklkJywga25leC5yYXcoc2VsZWN0VGFncykpXG4gICAgICAuZ3JvdXBCeSgndXNlcklkJylcblxuICAgIHRhZ3MuZm9yRWFjaCh0YWcgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9ICd0JyArICsraVxuICAgICAgcXVlcnkgPSBxdWVyeS5qb2luKFxuICAgICAgICBrbmV4LnJhdygnKCcgKyBmaWx0ZXJCeVRhZyh0YWcpLnRvU3RyaW5nKCkgKyAnKSBBUyAnICsgbmFtZSksXG4gICAgICAgICd1c2Vycy5pZCcsXG4gICAgICAgICc9JyxcbiAgICAgICAgbmFtZSArICcudXNlcklkJ1xuICAgICAgKVxuICAgIH0pXG5cbiAgICByZXR1cm4gcXVlcnlcbiAgICAgIC5sZWZ0Sm9pbihrbmV4LnJhdygnKCcgKyBzdWJRdWVyeS50b1N0cmluZygpICsgJykgQVMgdHQnKSwgJ3VzZXJzLmlkJywgJz0nLCAndHQudXNlcklkJylcbiAgICAgIC5zZWxlY3QoXG4gICAgICAgICd1c2Vycy51c2VySWQgYXMgdXNlcklkJyxcbiAgICAgICAgJ3VzZXJzLnBsYXRmb3JtIGFzIHBsYXRmb3JtJyxcbiAgICAgICAgJ3VzZXJzLmdlbmRlciBhcyBnZW5kZXInLFxuICAgICAgICAndXNlcnMudGltZXpvbmUgYXMgdGltZXpvbmUnLFxuICAgICAgICAndXNlcnMubG9jYWxlIGFzIGxvY2FsZScsXG4gICAgICAgICd1c2Vycy5waWN0dXJlX3VybCBhcyBwaWN0dXJlX3VybCcsXG4gICAgICAgICd1c2Vycy5maXJzdF9uYW1lIGFzIGZpcnN0X25hbWUnLFxuICAgICAgICAndXNlcnMubGFzdF9uYW1lIGFzIGxhc3RfbmFtZScsXG4gICAgICAgICd1c2Vycy5jcmVhdGVkX29uIGFzIGNyZWF0ZWRfb24nLFxuICAgICAgICAndHQudGFncyBhcyB0YWdzJ1xuICAgICAgKVxuICAgICAgLm9yZGVyQnkoJ3VzZXJzLmNyZWF0ZWRfb24nLCAnYXNjJylcbiAgICAgIC5vZmZzZXQoZnJvbSlcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC50aGVuKHVzZXJzID0+XG4gICAgICAgIHVzZXJzLm1hcCh4ID0+XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbih4LCB7XG4gICAgICAgICAgICB0YWdzOiAoeC50YWdzICYmIHgudGFncy5zcGxpdCgnLCcpKSB8fCBbXVxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgfVxuXG4gIGNvbnN0IGNvdW50ID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgcmV0dXJuIGtuZXgoJ3VzZXJzJylcbiAgICAgIC5jb3VudCgnKiBhcyBjb3VudCcpXG4gICAgICAudGhlbigpXG4gICAgICAuZ2V0KDApXG4gICAgICAudGhlbihyZXQgPT4gcGFyc2VJbnQocmV0ICYmIHJldC5jb3VudCkpXG4gIH1cblxuICByZXR1cm4geyB0YWcsIHVudGFnLCBoYXNUYWcsIGdldFRhZywgZ2V0VGFncywgbGlzdCwgY291bnQsIGxpc3RXaXRoVGFncyB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/users.js\n");

/***/ }),

/***/ "./src/util.js":
/*!*********************!*\
  !*** ./src/util.js ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _chalk = __webpack_require__(/*! chalk */ \"chalk\");\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(/*! path */ \"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _module = __webpack_require__(/*! module */ \"module\");\n\nvar _module2 = _interopRequireDefault(_module);\n\nvar _fs = __webpack_require__(/*! fs */ \"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _knex = __webpack_require__(/*! knex */ \"knex\");\n\nvar _knex2 = _interopRequireDefault(_knex);\n\nvar _generate = __webpack_require__(/*! nanoid/generate */ \"nanoid/generate\");\n\nvar _generate2 = _interopRequireDefault(_generate);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar IS_DEV = eval(\"process.env.NODE_ENV !== 'production'\"); /* eslint-disable-line no-eval */\n\nvar NPM_CMD = /^win/.test(process.platform) ? 'npm.cmd' : 'npm';\n\nvar PRINT_LEVELS = {\n  info: _chalk2.default.white,\n  warn: _chalk2.default.yellow.bind(_chalk2.default, 'WARN'),\n  error: _chalk2.default.red.bind(_chalk2.default, 'ERR'),\n  success: _chalk2.default.green.bind(_chalk2.default, 'OK')\n};\n\nvar print = function print(level) {\n  for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  var method = PRINT_LEVELS[level];\n\n  if (!method) {\n    args = [level].concat(args);\n    method = PRINT_LEVELS.info;\n  }\n\n  console.log(_chalk2.default.black.bgWhite('[botpress]'), '\\t', method.apply(undefined, _toConsumableArray(args)));\n};\n\nObject.keys(PRINT_LEVELS).forEach(function (level) {\n  print[level] = function () {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return print.apply(undefined, [level].concat(args));\n  };\n});\n\nvar resolveFromDir = function resolveFromDir(fromDir, moduleId) {\n  fromDir = _path2.default.resolve(fromDir);\n  var fromFile = _path2.default.join(fromDir, 'noop.js');\n  try {\n    return _module2.default._resolveFilename(moduleId, {\n      id: fromFile,\n      filename: fromFile,\n      paths: _module2.default._nodeModulePaths(fromDir)\n    });\n  } catch (err) {\n    return null;\n  }\n};\n\nvar resolveModuleRootPath = function resolveModuleRootPath(entryPath) {\n  var current = _path2.default.dirname(entryPath);\n  while (current !== '/') {\n    var lookup = _path2.default.join(current, 'package.json');\n    if (_fs2.default.existsSync(lookup)) {\n      return current;\n    }\n    current = _path2.default.resolve(_path2.default.join(current, '..'));\n  }\n  return null;\n};\n\nvar resolveProjectFile = function resolveProjectFile(file, projectLocation, throwIfNotExist) {\n  var packagePath = _path2.default.resolve(projectLocation || './', file);\n\n  if (!_fs2.default.existsSync(packagePath)) {\n    if (throwIfNotExist) {\n      throw new Error(\"Could not find bot's package.json file\");\n    }\n    return null;\n  }\n\n  return packagePath;\n};\n\nvar getDataLocation = function getDataLocation(dataDir, projectLocation) {\n  return dataDir && _path2.default.isAbsolute(dataDir) ? _path2.default.resolve(dataDir) : _path2.default.resolve(projectLocation, dataDir || 'data');\n};\n\nvar getBotpressVersion = function getBotpressVersion() {\n  var botpressPackagePath = _path2.default.join(__dirname, '../package.json');\n  var botpressJson = JSON.parse(_fs2.default.readFileSync(botpressPackagePath));\n  return botpressJson.version;\n};\n\nvar collectArgs = function collectArgs(val, memo) {\n  memo.push(val);\n  return memo;\n};\n\n// https://github.com/tgriesser/knex/issues/1871#issuecomment-273721116\nvar getInMemoryDb = function getInMemoryDb() {\n  return (0, _knex2.default)({\n    client: 'sqlite3',\n    connection: ':memory:',\n    pool: {\n      min: 1,\n      max: 1,\n      disposeTiemout: 360000 * 1000,\n      idleTimeoutMillis: 360000 * 1000\n    },\n    useNullAsDefault: true\n  });\n};\n\nvar safeId = function safeId() {\n  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;\n  return (0, _generate2.default)('1234567890abcdefghijklmnopqrsuvwxyz', length);\n};\n\nvar isBotpressPackage = function isBotpressPackage(pkg) {\n  var _getPackageName = getPackageName(pkg),\n      _getPackageName2 = _slicedToArray(_getPackageName, 2),\n      scope = _getPackageName2[0],\n      name = _getPackageName2[1];\n\n  var isBotpress = scope === 'botpress' || name.startsWith('botpress-');\n  return isBotpress;\n};\n\nvar getModuleShortname = function getModuleShortname(pkg) {\n  var _getPackageName3 = getPackageName(pkg),\n      _getPackageName4 = _slicedToArray(_getPackageName3, 2),\n      name = _getPackageName4[1];\n\n  var withoutPrefix = name.replace(/^botpress-/i, '');\n  return withoutPrefix;\n};\n\nvar getPackageName = function getPackageName(pkg) {\n  var isScoped = pkg.startsWith('@');\n\n  if (isScoped) {\n    var _pkg$match$slice = pkg.match(/^@(.*)\\/(.*)/).slice(1),\n        _pkg$match$slice2 = _slicedToArray(_pkg$match$slice, 2),\n        scope = _pkg$match$slice2[0],\n        name = _pkg$match$slice2[1];\n\n    return [scope, name];\n  } else {\n    return [null, pkg];\n  }\n};\n\nmodule.exports = {\n  print: print,\n  resolveFromDir: resolveFromDir,\n  isDeveloping: IS_DEV,\n  resolveModuleRootPath: resolveModuleRootPath,\n  resolveProjectFile: resolveProjectFile,\n  getDataLocation: getDataLocation,\n  npmCmd: NPM_CMD,\n  getBotpressVersion: getBotpressVersion,\n  collectArgs: collectArgs,\n  getInMemoryDb: getInMemoryDb,\n  safeId: safeId,\n  isBotpressPackage: isBotpressPackage,\n  getModuleShortname: getModuleShortname\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC5qcz9lMGViIl0sIm5hbWVzIjpbIklTX0RFViIsImV2YWwiLCJOUE1fQ01EIiwidGVzdCIsInByb2Nlc3MiLCJwbGF0Zm9ybSIsIlBSSU5UX0xFVkVMUyIsImluZm8iLCJjaGFsayIsIndoaXRlIiwid2FybiIsInllbGxvdyIsImJpbmQiLCJlcnJvciIsInJlZCIsInN1Y2Nlc3MiLCJncmVlbiIsInByaW50IiwibGV2ZWwiLCJhcmdzIiwibWV0aG9kIiwiY29uY2F0IiwiY29uc29sZSIsImxvZyIsImJsYWNrIiwiYmdXaGl0ZSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwicmVzb2x2ZUZyb21EaXIiLCJmcm9tRGlyIiwibW9kdWxlSWQiLCJwYXRoIiwicmVzb2x2ZSIsImZyb21GaWxlIiwiam9pbiIsIk1vZHVsZSIsIl9yZXNvbHZlRmlsZW5hbWUiLCJpZCIsImZpbGVuYW1lIiwicGF0aHMiLCJfbm9kZU1vZHVsZVBhdGhzIiwiZXJyIiwicmVzb2x2ZU1vZHVsZVJvb3RQYXRoIiwiY3VycmVudCIsImRpcm5hbWUiLCJlbnRyeVBhdGgiLCJsb29rdXAiLCJmcyIsImV4aXN0c1N5bmMiLCJyZXNvbHZlUHJvamVjdEZpbGUiLCJmaWxlIiwicHJvamVjdExvY2F0aW9uIiwidGhyb3dJZk5vdEV4aXN0IiwicGFja2FnZVBhdGgiLCJFcnJvciIsImdldERhdGFMb2NhdGlvbiIsImRhdGFEaXIiLCJpc0Fic29sdXRlIiwiZ2V0Qm90cHJlc3NWZXJzaW9uIiwiYm90cHJlc3NQYWNrYWdlUGF0aCIsIl9fZGlybmFtZSIsImJvdHByZXNzSnNvbiIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlU3luYyIsInZlcnNpb24iLCJjb2xsZWN0QXJncyIsInZhbCIsIm1lbW8iLCJwdXNoIiwiZ2V0SW5NZW1vcnlEYiIsImNsaWVudCIsImNvbm5lY3Rpb24iLCJwb29sIiwibWluIiwibWF4IiwiZGlzcG9zZVRpZW1vdXQiLCJpZGxlVGltZW91dE1pbGxpcyIsInVzZU51bGxBc0RlZmF1bHQiLCJzYWZlSWQiLCJsZW5ndGgiLCJpc0JvdHByZXNzUGFja2FnZSIsImdldFBhY2thZ2VOYW1lIiwicGtnIiwic2NvcGUiLCJuYW1lIiwiaXNCb3RwcmVzcyIsInN0YXJ0c1dpdGgiLCJnZXRNb2R1bGVTaG9ydG5hbWUiLCJ3aXRob3V0UHJlZml4IiwicmVwbGFjZSIsImlzU2NvcGVkIiwibWF0Y2giLCJzbGljZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJpc0RldmVsb3BpbmciLCJucG1DbWQiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7Ozs7O0FBRUEsSUFBTUEsU0FBU0MsS0FBSyx1Q0FBTCxDQUFmLEMsQ0FBNkQ7O0FBRTdELElBQU1DLFVBQVUsT0FBT0MsSUFBUCxDQUFZQyxRQUFRQyxRQUFwQixJQUFnQyxTQUFoQyxHQUE0QyxLQUE1RDs7QUFFQSxJQUFNQyxlQUFlO0FBQ25CQyxRQUFNQyxnQkFBTUMsS0FETztBQUVuQkMsUUFBTUYsZ0JBQU1HLE1BQU4sQ0FBYUMsSUFBYixDQUFrQkosZUFBbEIsRUFBeUIsTUFBekIsQ0FGYTtBQUduQkssU0FBT0wsZ0JBQU1NLEdBQU4sQ0FBVUYsSUFBVixDQUFlSixlQUFmLEVBQXNCLEtBQXRCLENBSFk7QUFJbkJPLFdBQVNQLGdCQUFNUSxLQUFOLENBQVlKLElBQVosQ0FBaUJKLGVBQWpCLEVBQXdCLElBQXhCO0FBSlUsQ0FBckI7O0FBT0EsSUFBTVMsUUFBUSxTQUFSQSxLQUFRLENBQUNDLEtBQUQsRUFBb0I7QUFBQSxvQ0FBVEMsSUFBUztBQUFUQSxRQUFTO0FBQUE7O0FBQ2hDLE1BQUlDLFNBQVNkLGFBQWFZLEtBQWIsQ0FBYjs7QUFFQSxNQUFJLENBQUNFLE1BQUwsRUFBYTtBQUNYRCxXQUFPLENBQUNELEtBQUQsRUFBUUcsTUFBUixDQUFlRixJQUFmLENBQVA7QUFDQUMsYUFBU2QsYUFBYUMsSUFBdEI7QUFDRDs7QUFFRGUs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O0FBQUEsUUFDRUMsSUFERjs7QUFFWixXQUFPLENBQUNELEtBQUQsRUFBUUMsSUFBUixDQUFQO0FBQ0QsR0FIRCxNQUdPO0FBQ0wsV0FBTyxDQUFDLElBQUQsRUFBT0YsR0FBUCxDQUFQO0FBQ0Q7QUFDRixDQVREOztBQVdBVyxPQUFPQyxPQUFQLEdBQWlCO0FBQ2YvRSxjQURlO0FBRWZZLGdDQUZlO0FBR2ZvRSxnQkFBY2pHLE1BSEM7QUFJZjJDLDhDQUplO0FBS2ZPLHdDQUxlO0FBTWZNLGtDQU5lO0FBT2YwQyxVQUFRaEcsT0FQTztBQVFmeUQsd0NBUmU7QUFTZlEsMEJBVGU7QUFVZkksOEJBVmU7QUFXZlMsZ0JBWGU7QUFZZkUsc0NBWmU7QUFhZk87QUFiZSxDQUFqQiIsImZpbGUiOiIuL3NyYy91dGlsLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBNb2R1bGUgZnJvbSAnbW9kdWxlJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IGtuZXggZnJvbSAna25leCdcbmltcG9ydCBnZW5lcmF0ZSBmcm9tICduYW5vaWQvZ2VuZXJhdGUnXG5cbmNvbnN0IElTX0RFViA9IGV2YWwoXCJwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nXCIpIC8qIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXZhbCAqL1xuXG5jb25zdCBOUE1fQ01EID0gL153aW4vLnRlc3QocHJvY2Vzcy5wbGF0Zm9ybSkgPyAnbnBtLmNtZCcgOiAnbnBtJ1xuXG5jb25zdCBQUklOVF9MRVZFTFMgPSB7XG4gIGluZm86IGNoYWxrLndoaXRlLFxuICB3YXJuOiBjaGFsay55ZWxsb3cuYmluZChjaGFsaywgJ1dBUk4nKSxcbiAgZXJyb3I6IGNoYWxrLnJlZC5iaW5kKGNoYWxrLCAnRVJSJyksXG4gIHN1Y2Nlc3M6IGNoYWxrLmdyZWVuLmJpbmQoY2hhbGssICdPSycpXG59XG5cbmNvbnN0IHByaW50ID0gKGxldmVsLCAuLi5hcmdzKSA9PiB7XG4gIGxldCBtZXRob2QgPSBQUklOVF9MRVZFTFNbbGV2ZWxdXG5cbiAgaWYgKCFtZXRob2QpIHtcbiAgICBhcmdzID0gW2xldmVsXS5jb25jYXQoYXJncylcbiAgICBtZXRob2QgPSBQUklOVF9MRVZFTFMuaW5mb1xuICB9XG5cbiAgY29uc29sZS5sb2coY2hhbGsuYmxhY2suYmdXaGl0ZSgnW2JvdHByZXNzXScpLCAnXFx0JywgbWV0aG9kKC4uLmFyZ3MpKVxufVxuXG5PYmplY3Qua2V5cyhQUklOVF9MRVZFTFMpLmZvckVhY2gobGV2ZWwgPT4ge1xuICBwcmludFtsZXZlbF0gPSAoLi4uYXJncykgPT4gcHJpbnQobGV2ZWwsIC4uLmFyZ3MpXG59KVxuXG5jb25zdCByZXNvbHZlRnJvbURpciA9IChmcm9tRGlyLCBtb2R1bGVJZCkgPT4ge1xuICBmcm9tRGlyID0gcGF0aC5yZXNvbHZlKGZyb21EaXIpXG4gIGNvbnN0IGZyb21GaWxlID0gcGF0aC5qb2luKGZyb21EaXIsICdub29wLmpzJylcbiAgdHJ5IHtcbiAgICByZXR1cm4gTW9kdWxlLl9yZXNvbHZlRmlsZW5hbWUobW9kdWxlSWQsIHtcbiAgICAgIGlkOiBmcm9tRmlsZSxcbiAgICAgIGZpbGVuYW1lOiBmcm9tRmlsZSxcbiAgICAgIHBhdGhzOiBNb2R1bGUuX25vZGVNb2R1bGVQYXRocyhmcm9tRGlyKVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuY29uc3QgcmVzb2x2ZU1vZHVsZVJvb3RQYXRoID0gZW50cnlQYXRoID0+IHtcbiAgbGV0IGN1cnJlbnQgPSBwYXRoLmRpcm5hbWUoZW50cnlQYXRoKVxuICB3aGlsZSAoY3VycmVudCAhPT0gJy8nKSB7XG4gICAgY29uc3QgbG9va3VwID0gcGF0aC5qb2luKGN1cnJlbnQsICdwYWNrYWdlLmpzb24nKVxuICAgIGlmIChmcy5leGlzdHNTeW5jKGxvb2t1cCkpIHtcbiAgICAgIHJldHVybiBjdXJyZW50XG4gICAgfVxuICAgIGN1cnJlbnQgPSBwYXRoLnJlc29sdmUocGF0aC5qb2luKGN1cnJlbnQsICcuLicpKVxuICB9XG4gIHJldHVybiBudWxsXG59XG5cbmNvbnN0IHJlc29sdmVQcm9qZWN0RmlsZSA9IChmaWxlLCBwcm9qZWN0TG9jYXRpb24sIHRocm93SWZOb3RFeGlzdCkgPT4ge1xuICBjb25zdCBwYWNrYWdlUGF0aCA9IHBhdGgucmVzb2x2ZShwcm9qZWN0TG9jYXRpb24gfHwgJy4vJywgZmlsZSlcblxuICBpZiAoIWZzLmV4aXN0c1N5bmMocGFja2FnZVBhdGgpKSB7XG4gICAgaWYgKHRocm93SWZOb3RFeGlzdCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGZpbmQgYm90J3MgcGFja2FnZS5qc29uIGZpbGVcIilcbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHJldHVybiBwYWNrYWdlUGF0aFxufVxuXG5jb25zdCBnZXREYXRhTG9jYXRpb24gPSAoZGF0YURpciwgcHJvamVjdExvY2F0aW9uKSA9PlxuICBkYXRhRGlyICYmIHBhdGguaXNBYnNvbHV0ZShkYXRhRGlyKSA/IHBhdGgucmVzb2x2ZShkYXRhRGlyKSA6IHBhdGgucmVzb2x2ZShwcm9qZWN0TG9jYXRpb24sIGRhdGFEaXIgfHwgJ2RhdGEnKVxuXG5jb25zdCBnZXRCb3RwcmVzc1ZlcnNpb24gPSAoKSA9PiB7XG4gIGNvbnN0IGJvdHByZXNzUGFja2FnZVBhdGggPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vcGFja2FnZS5qc29uJylcbiAgY29uc3QgYm90cHJlc3NKc29uID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoYm90cHJlc3NQYWNrYWdlUGF0aCkpXG4gIHJldHVybiBib3RwcmVzc0pzb24udmVyc2lvblxufVxuXG5jb25zdCBjb2xsZWN0QXJncyA9ICh2YWwsIG1lbW8pID0+IHtcbiAgbWVtby5wdXNoKHZhbClcbiAgcmV0dXJuIG1lbW9cbn1cblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3Rncmllc3Nlci9rbmV4L2lzc3Vlcy8xODcxI2lzc3VlY29tbWVudC0yNzM3MjExMTZcbmNvbnN0IGdldEluTWVtb3J5RGIgPSAoKSA9PlxuICBrbmV4KHtcbiAgICBjbGllbnQ6ICdzcWxpdGUzJyxcbiAgICBjb25uZWN0aW9uOiAnOm1lbW9yeTonLFxuICAgIHBvb2w6IHtcbiAgICAgIG1pbjogMSxcbiAgICAgIG1heDogMSxcbiAgICAgIGRpc3Bvc2VUaWVtb3V0OiAzNjAwMDAgKiAxMDAwLFxuICAgICAgaWRsZVRpbWVvdXRNaWxsaXM6IDM2MDAwMCAqIDEwMDBcbiAgICB9LFxuICAgIHVzZU51bGxBc0RlZmF1bHQ6IHRydWVcbiAgfSlcblxuY29uc3Qgc2FmZUlkID0gKGxlbmd0aCA9IDEwKSA9PiBnZW5lcmF0ZSgnMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN1dnd4eXonLCBsZW5ndGgpXG5cbmNvbnN0IGlzQm90cHJlc3NQYWNrYWdlID0gcGtnID0+IHtcbiAgY29uc3QgW3Njb3BlLCBuYW1lXSA9IGdldFBhY2thZ2VOYW1lKHBrZylcbiAgY29uc3QgaXNCb3RwcmVzcyA9IHNjb3BlID09PSAnYm90cHJlc3MnIHx8IG5hbWUuc3RhcnRzV2l0aCgnYm90cHJlc3MtJylcbiAgcmV0dXJuIGlzQm90cHJlc3Ncbn1cblxuY29uc3QgZ2V0TW9kdWxlU2hvcnRuYW1lID0gcGtnID0+IHtcbiAgY29uc3QgWywgbmFtZV0gPSBnZXRQYWNrYWdlTmFtZShwa2cpXG4gIGNvbnN0IHdpdGhvdXRQcmVmaXggPSBuYW1lLnJlcGxhY2UoL15ib3RwcmVzcy0vaSwgJycpXG4gIHJldHVybiB3aXRob3V0UHJlZml4XG59XG5cbmNvbnN0IGdldFBhY2thZ2VOYW1lID0gcGtnID0+IHtcbiAgY29uc3QgaXNTY29wZWQgPSBwa2cuc3RhcnRzV2l0aCgnQCcpXG5cbiAgaWYgKGlzU2NvcGVkKSB7XG4gICAgY29uc3QgW3Njb3BlLCBuYW1lXSA9IHBrZy5tYXRjaCgvXkAoLiopXFwvKC4qKS8pLnNsaWNlKDEpXG4gICAgcmV0dXJuIFtzY29wZSwgbmFtZV1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gW251bGwsIHBrZ11cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcHJpbnQsXG4gIHJlc29sdmVGcm9tRGlyLFxuICBpc0RldmVsb3Bpbmc6IElTX0RFVixcbiAgcmVzb2x2ZU1vZHVsZVJvb3RQYXRoLFxuICByZXNvbHZlUHJvamVjdEZpbGUsXG4gIGdldERhdGFMb2NhdGlvbixcbiAgbnBtQ21kOiBOUE1fQ01ELFxuICBnZXRCb3RwcmVzc1ZlcnNpb24sXG4gIGNvbGxlY3RBcmdzLFxuICBnZXRJbk1lbW9yeURiLFxuICBzYWZlSWQsXG4gIGlzQm90cHJlc3NQYWNrYWdlLFxuICBnZXRNb2R1bGVTaG9ydG5hbWVcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/util.js\n");

/***/ }),

/***/ 0:
/*!************************!*\
  !*** multi ./index.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /Users/raven/Projects/botpress/packages/core/botpress/index.js */"./index.js");


/***/ }),

/***/ "@botpress/util-roles":
/*!***************************************!*\
  !*** external "@botpress/util-roles" ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"@botpress/util-roles\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJAYm90cHJlc3MvdXRpbC1yb2xlc1wiPzI2ZmIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiQGJvdHByZXNzL3V0aWwtcm9sZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJAYm90cHJlc3MvdXRpbC1yb2xlc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///@botpress/util-roles\n");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"axios\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJheGlvc1wiPzcwYzYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYXhpb3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJheGlvc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///axios\n");

/***/ }),

/***/ "babel-polyfill":
/*!*********************************!*\
  !*** external "babel-polyfill" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"babel-polyfill\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJiYWJlbC1wb2x5ZmlsbFwiPzYzNjIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYmFiZWwtcG9seWZpbGwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJiYWJlbC1wb2x5ZmlsbFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///babel-polyfill\n");

/***/ }),

/***/ "bluebird":
/*!***************************!*\
  !*** external "bluebird" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"bluebird\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJibHVlYmlyZFwiPzJjNmIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYmx1ZWJpcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJibHVlYmlyZFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///bluebird\n");

/***/ }),

/***/ "body-parser":
/*!******************************!*\
  !*** external "body-parser" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"body-parser\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiPzgxODgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiYm9keS1wYXJzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///body-parser\n");

/***/ }),

/***/ "chalk":
/*!************************!*\
  !*** external "chalk" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"chalk\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjaGFsa1wiPzA3Y2EiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiY2hhbGsuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjaGFsa1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///chalk\n");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"child_process\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjaGlsZF9wcm9jZXNzXCI/M2RhNyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJjaGlsZF9wcm9jZXNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY2hpbGRfcHJvY2Vzc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///child_process\n");

/***/ }),

/***/ "cluster":
/*!**************************!*\
  !*** external "cluster" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cluster\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjbHVzdGVyXCI/MTVhNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJjbHVzdGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY2x1c3RlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///cluster\n");

/***/ }),

/***/ "commander":
/*!****************************!*\
  !*** external "commander" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"commander\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb21tYW5kZXJcIj84MTIwIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImNvbW1hbmRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNvbW1hbmRlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///commander\n");

/***/ }),

/***/ "compression":
/*!******************************!*\
  !*** external "compression" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"compression\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb21wcmVzc2lvblwiP2Y3OTEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiY29tcHJlc3Npb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjb21wcmVzc2lvblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///compression\n");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"crypto\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjcnlwdG9cIj80Yzc2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImNyeXB0by5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNyeXB0b1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///crypto\n");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"dotenv\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJkb3RlbnZcIj9lNzBmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImRvdGVudi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImRvdGVudlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///dotenv\n");

/***/ }),

/***/ "eventemitter2":
/*!********************************!*\
  !*** external "eventemitter2" ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"eventemitter2\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJldmVudGVtaXR0ZXIyXCI/NGE3NyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJldmVudGVtaXR0ZXIyLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXZlbnRlbWl0dGVyMlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///eventemitter2\n");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzXCI/MjJmZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJleHByZXNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///express\n");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"fs\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJmc1wiP2E0MGQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiZnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJmc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///fs\n");

/***/ }),

/***/ "glob":
/*!***********************!*\
  !*** external "glob" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"glob\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJnbG9iXCI/ODYzMSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJnbG9iLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZ2xvYlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///glob\n");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"http\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJodHRwXCI/OGQxOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJodHRwLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiaHR0cFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///http\n");

/***/ }),

/***/ "joi":
/*!**********************!*\
  !*** external "joi" ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"joi\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJqb2lcIj83ZTVjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImpvaS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImpvaVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///joi\n");

/***/ }),

/***/ "json5":
/*!************************!*\
  !*** external "json5" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"json5\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJqc29uNVwiP2U4MTAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoianNvbjUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJqc29uNVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///json5\n");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"jsonwebtoken\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJqc29ud2VidG9rZW5cIj82NDkwIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Impzb253ZWJ0b2tlbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///jsonwebtoken\n");

/***/ }),

/***/ "knex":
/*!***********************!*\
  !*** external "knex" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"knex\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJrbmV4XCI/NjY3YiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJrbmV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwia25leFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///knex\n");

/***/ }),

/***/ "lodash":
/*!*************************!*\
  !*** external "lodash" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJsb2Rhc2hcIj85N2RlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6ImxvZGFzaC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImxvZGFzaFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///lodash\n");

/***/ }),

/***/ "lodash/get":
/*!*****************************!*\
  !*** external "lodash/get" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash/get\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJsb2Rhc2gvZ2V0XCI/ZGI0YyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJsb2Rhc2gvZ2V0LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibG9kYXNoL2dldFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///lodash/get\n");

/***/ }),

/***/ "lodash/mapValues":
/*!***********************************!*\
  !*** external "lodash/mapValues" ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash/mapValues\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJsb2Rhc2gvbWFwVmFsdWVzXCI/YjVlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJsb2Rhc2gvbWFwVmFsdWVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibG9kYXNoL21hcFZhbHVlc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///lodash/mapValues\n");

/***/ }),

/***/ "lodash/partition":
/*!***********************************!*\
  !*** external "lodash/partition" ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash/partition\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJsb2Rhc2gvcGFydGl0aW9uXCI/Yzc0OSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJsb2Rhc2gvcGFydGl0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibG9kYXNoL3BhcnRpdGlvblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///lodash/partition\n");

/***/ }),

/***/ "lodash/pick":
/*!******************************!*\
  !*** external "lodash/pick" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash/pick\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJsb2Rhc2gvcGlja1wiPzlhNTgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoibG9kYXNoL3BpY2suanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJsb2Rhc2gvcGlja1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///lodash/pick\n");

/***/ }),

/***/ "lodash/uniq":
/*!******************************!*\
  !*** external "lodash/uniq" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash/uniq\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJsb2Rhc2gvdW5pcVwiPzJhNzciXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoibG9kYXNoL3VuaXEuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJsb2Rhc2gvdW5pcVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///lodash/uniq\n");

/***/ }),

/***/ "mkdirp":
/*!*************************!*\
  !*** external "mkdirp" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mkdirp\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJta2RpcnBcIj82YTBkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im1rZGlycC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1rZGlycFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///mkdirp\n");

/***/ }),

/***/ "module":
/*!*************************!*\
  !*** external "module" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"module\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb2R1bGVcIj83YzQ4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im1vZHVsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vZHVsZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///module\n");

/***/ }),

/***/ "moment":
/*!*************************!*\
  !*** external "moment" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"moment\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb21lbnRcIj9iZDc2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im1vbWVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vbWVudFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///moment\n");

/***/ }),

/***/ "monitorctrlc":
/*!*******************************!*\
  !*** external "monitorctrlc" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"monitorctrlc\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb25pdG9yY3RybGNcIj8zNjVjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im1vbml0b3JjdHJsYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vbml0b3JjdHJsY1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///monitorctrlc\n");

/***/ }),

/***/ "ms":
/*!*********************!*\
  !*** external "ms" ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"ms\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtc1wiPzk3NjYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoibXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///ms\n");

/***/ }),

/***/ "multer":
/*!*************************!*\
  !*** external "multer" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"multer\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtdWx0ZXJcIj9hNzA0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im11bHRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm11bHRlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///multer\n");

/***/ }),

/***/ "mustache":
/*!***************************!*\
  !*** external "mustache" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mustache\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtdXN0YWNoZVwiPzNmMDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoibXVzdGFjaGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtdXN0YWNoZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///mustache\n");

/***/ }),

/***/ "mware":
/*!************************!*\
  !*** external "mware" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mware\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtd2FyZVwiP2E2MzUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoibXdhcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtd2FyZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///mware\n");

/***/ }),

/***/ "nanoid":
/*!*************************!*\
  !*** external "nanoid" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"nanoid\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJuYW5vaWRcIj9mNTdhIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im5hbm9pZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm5hbm9pZFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///nanoid\n");

/***/ }),

/***/ "nanoid/generate":
/*!**********************************!*\
  !*** external "nanoid/generate" ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"nanoid/generate\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJuYW5vaWQvZ2VuZXJhdGVcIj80MjE0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im5hbm9pZC9nZW5lcmF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm5hbm9pZC9nZW5lcmF0ZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///nanoid/generate\n");

/***/ }),

/***/ "node-machine-id":
/*!**********************************!*\
  !*** external "node-machine-id" ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"node-machine-id\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJub2RlLW1hY2hpbmUtaWRcIj82ODBkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Im5vZGUtbWFjaGluZS1pZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm5vZGUtbWFjaGluZS1pZFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///node-machine-id\n");

/***/ }),

/***/ "nodemon":
/*!**************************!*\
  !*** external "nodemon" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"nodemon\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJub2RlbW9uXCI/NjJlYyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJub2RlbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibm9kZW1vblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///nodemon\n");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"os\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJvc1wiP2I3MTgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoib3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJvc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///os\n");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"path\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwYXRoXCI/NzRiYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJwYXRoLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicGF0aFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///path\n");

/***/ }),

/***/ "prepend-file":
/*!*******************************!*\
  !*** external "prepend-file" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"prepend-file\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwcmVwZW5kLWZpbGVcIj80MWQ2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InByZXBlbmQtZmlsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInByZXBlbmQtZmlsZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///prepend-file\n");

/***/ }),

/***/ "prompt":
/*!*************************!*\
  !*** external "prompt" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"prompt\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwcm9tcHRcIj83YzFlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InByb21wdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInByb21wdFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///prompt\n");

/***/ }),

/***/ "prompt-confirm":
/*!*********************************!*\
  !*** external "prompt-confirm" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"prompt-confirm\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwcm9tcHQtY29uZmlybVwiP2ZmNjIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoicHJvbXB0LWNvbmZpcm0uanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJwcm9tcHQtY29uZmlybVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///prompt-confirm\n");

/***/ }),

/***/ "query-string":
/*!*******************************!*\
  !*** external "query-string" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"query-string\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJxdWVyeS1zdHJpbmdcIj8yZjBiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InF1ZXJ5LXN0cmluZy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInF1ZXJ5LXN0cmluZ1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///query-string\n");

/***/ }),

/***/ "socket.io":
/*!****************************!*\
  !*** external "socket.io" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"socket.io\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb2NrZXQuaW9cIj9jYjM0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InNvY2tldC5pby5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNvY2tldC5pb1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///socket.io\n");

/***/ }),

/***/ "socketio-jwt":
/*!*******************************!*\
  !*** external "socketio-jwt" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"socketio-jwt\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb2NrZXRpby1qd3RcIj83NTM1Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InNvY2tldGlvLWp3dC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNvY2tldGlvLWp3dFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///socketio-jwt\n");

/***/ }),

/***/ "source-map-support/register":
/*!**********************************************!*\
  !*** external "source-map-support/register" ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"source-map-support/register\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXJcIj9kYTE2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InNvdXJjZS1tYXAtc3VwcG9ydC9yZWdpc3Rlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNvdXJjZS1tYXAtc3VwcG9ydC9yZWdpc3RlclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///source-map-support/register\n");

/***/ }),

/***/ "universal-analytics":
/*!**************************************!*\
  !*** external "universal-analytics" ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"universal-analytics\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1bml2ZXJzYWwtYW5hbHl0aWNzXCI/ZGFlNCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJ1bml2ZXJzYWwtYW5hbHl0aWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidW5pdmVyc2FsLWFuYWx5dGljc1wiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///universal-analytics\n");

/***/ }),

/***/ "username":
/*!***************************!*\
  !*** external "username" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"username\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1c2VybmFtZVwiP2U5MmEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoidXNlcm5hbWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ1c2VybmFtZVwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///username\n");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"util\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1dGlsXCI/YmUwYiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJ1dGlsLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidXRpbFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///util\n");

/***/ }),

/***/ "valid-url":
/*!****************************!*\
  !*** external "valid-url" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"valid-url\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ2YWxpZC11cmxcIj84NzJhIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InZhbGlkLXVybC5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInZhbGlkLXVybFwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///valid-url\n");

/***/ }),

/***/ "verror":
/*!*************************!*\
  !*** external "verror" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"verror\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ2ZXJyb3JcIj8xNzA1Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InZlcnJvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInZlcnJvclwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///verror\n");

/***/ }),

/***/ "vm2":
/*!**********************!*\
  !*** external "vm2" ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"vm2\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ2bTJcIj84ZGE2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6InZtMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInZtMlwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///vm2\n");

/***/ }),

/***/ "winston":
/*!**************************!*\
  !*** external "winston" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"winston\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ3aW5zdG9uXCI/Nzk3YyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiJ3aW5zdG9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwid2luc3RvblwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///winston\n");

/***/ }),

/***/ "yn":
/*!*********************!*\
  !*** external "yn" ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"yn\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ5blwiPzg5ODAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoieW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ5blwiKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///yn\n");

/***/ })

/******/ });